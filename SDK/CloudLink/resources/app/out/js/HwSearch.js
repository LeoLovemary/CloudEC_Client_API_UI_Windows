webpackJsonp([20],{1027:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function c(e,r){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={},c=0;return function(o){var a=r?e[r]:e;clearTimeout(c),c=setTimeout(function(){n={}},O);var u=o?o.trim().split(/\s+/):"";u.length<=128||u.slice(0,128);var i=u;if(!i)return v.default.resolve([]);if(n[i])return n[i].then(function(e){S.info("buffer search finish, count",e.length)}),v.default.resolve(n[i]);var s={},f=0;return n[i]=function e(){if(!(f>=u.length)){var r=u[f++].charAt(0),c=null;return c=t?n[r]||(n[r]=a(r)):a(u[0]),c.then(function(e){return e.forEach(function(e){return!s[e.id]&&(s[e.id]=e)})}).then(e)}}().then(function(){return(0,d.default)(s).map(function(e){return s[e]})})}}function o(e,r,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c="",o=0;return function(a,u){return clearTimeout(o),c=a,e(a).then(function(e){if(e&&(e=e.sort()),isNullOrEmpty(e)||(e=e.filter(function(e){return!e.group_id||!coreIm.isGroupNotifyMessage(e.media_type)})),a===c)return(0,m.asyncMatch)(e,a,function(e){u(e)},function(e,r){if(a!==c)return r.stop()},n,t).then(function(e){if(a===c){if(r instanceof Function)var n=0,i=0,s=function(e){if(!(0!==i&&i>=n)){for(var o={is_need_amount:1,offset:i,count:20,query_key:a,query_type:2},u=arguments.length,s=Array(u>1?u-1:0),f=1;f<u;f++)s[f-1]=arguments[f];return r.apply(void 0,[o].concat(s)).then(function(r){var o=r.list,u=void 0===o?[]:o,s=r.count,f=void 0===s?0:s;if(i=i+window.CLIENTCONFIG.EAB_SEARCH_NUM||20,n=f,isNullOrEmpty(u)&&j(!0),a===c)return(0,m.asyncMatch)(u,a,function(r){e instanceof Function&&e(r,!0,f,i),j(!0)},function(e,r){if(a!==c)return r.stop()},t,"useServe",!0)})}};return e&&e.length>=1?s:(r instanceof Function&&(o=setTimeout(s,300,u)),s)}})})}}function a(){return function(){return v.default.resolve(void 0)}}function u(e){var r={};return v.default.all([coreDb.queryGroupMemberList({searchtext:e})]).then(function(e){e.forEach(function(e){e instanceof Array&&e.forEach(function(e){r[e.group_id]||(r[e.group_id]=e)})});var t=(0,d.default)(r);return t.length?coreGroup.queryGroupListByIdList(t.join()).then(function(e){return e.map(function(e){var t=r[e.group_id];return t.group=e,t})}):[]})}function i(e){var r=e.query_key,t=e.offset;return S.info("eua_offset",t),coreContact.searchServerContact(r,t).then(function(e){if(!e)return{recordAmount:0,userInformationList:[]};E(e.recordAmount);var r=e.recordAmount,t=e.userInformationList;return S.info("server all contacts search finish, count:",r),{list:t,count:r}})}Object.defineProperty(r,"__esModule",{value:!0}),r.getMoreGroupResult=r.getMoreSearchResult=r.setGlobalDirectorySearchLoadLogic=r.setGlobalSearchGroupLogic=r.setGlobalSearchAmountLogic=r.setGoOutSearchLogic=r.searchGroupOnServer=r.searchServerGroupAsync=r.searchGroupLocalAsync=r.searchDirectoryAsync=r.searchContactLocalAsync=r.searchGroupWithMemberAsync=r.searchFileAsync=r.searchMessageAsync=r.searchGroupFromMemberAsync=r.searchGroupAsync=r.searchContactAsync=r.searchGroupWithMember=r.searchFile=r.searchMessage=r.searchGroupFromMember=r.searchGroup=r.searchContact=void 0;var s=t(1),f=n(s),l=t(2),h=n(l),p=t(133),d=n(p),g=t(3),v=n(g),y=r.searchGroupOnServer=function(){var e=(0,h.default)(f.default.mark(function e(r){var t,n,c;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.USE_IM){e.next=13;break}return e.next=3,coreGroup.searchFixedGroupsLogic(r);case 3:if((t=e.sent)&&1!==t.result){e.next=6;break}return e.abrupt("return",{list:[],count:0});case 6:return k(t.record_amount),n=t.record_amount,c=t.group_list,t.group_list.forEach(function(e){e.server_group=!0}),S.info("server all groups search finish, count:",n),e.abrupt("return",{list:c,count:n});case 13:return e.abrupt("return",{list:[],count:0});case 14:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}();r.searchContactOnServer=i;var m=t(1028),S=coreLogger.getLogger("logic")("search/search"),b=["name","account","show_account","foreign_name","q_pin_yin","mobile","dept_name_en","dept_name_cn","address","bind_no","mobile","office_phone","other_phone","other_phone2","short_phone","voip","email","home_phone","fax"],_=["name","group_id"],G=["show_text"],M=["file_real_save_name"],A=r.searchContact=c(coreContact,"queryFriendsBySearchText"),L=r.searchGroup=c(coreGroup,"queryGroupBySearchText"),x=r.searchGroupFromMember=c(coreGroup,"queryGroupByMemberSearch",!1),w=r.searchMessage=c(coreDb,"queryMessageBySearchText"),C=r.searchFile=c(coreDb,"queryFileBySearchText"),F=r.searchGroupWithMember=c(u),O=(r.searchContactAsync=o(A,i,b),r.searchGroupAsync=o(L,null,_),r.searchGroupFromMemberAsync=o(x,null,null,!0),r.searchMessageAsync=o(w,null,G),r.searchFileAsync=o(C,null,M),r.searchGroupWithMemberAsync=o(F),r.searchContactLocalAsync=o(A,null,b),r.searchDirectoryAsync=o(a(),i,b),r.searchGroupLocalAsync=o(L,null,_),r.searchServerGroupAsync=o(a(),y,_),2e3),E=(r.setGoOutSearchLogic=function(e){$dispatch(coreUi.setGoOutSearchBool(e))},r.setGlobalSearchAmountLogic=function(e){$dispatch(coreUi.setGlobalSearchAmount(e))}),k=r.setGlobalSearchGroupLogic=function(e){$dispatch(coreUi.setGlobalSearchGroup(e))},j=r.setGlobalDirectorySearchLoadLogic=function(e){$dispatch(coreUi.setGlobalDirectorySearchLoading(e))};r.getMoreSearchResult=function(){var e=(0,h.default)(f.default.mark(function e(r,t){var n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,S.info("加载企业通讯录更多搜索结果"),n=t,e.abrupt("return",function(e){return coreContact.searchServerContact(t,r).then(function(r){return isNullOrEmpty(r)&&window.Toast(language.THE_NETWORK_IS_ABNORMAL,1,!1),(0,m.asyncMatch)(r.userInformationList||[],t,function(t){e({filtered:t,recordAmount:r.recordAmount},!0)},function(e,r){if(t!==n)return r.stop()},b)})});case 6:e.prev=6,e.t0=e.catch(0),S.error("getMoreSearchResult 加载更多搜索结果",{error:e.t0.toJSON()});case 9:case"end":return e.stop()}},e,void 0,[[0,6]])}));return function(r,t){return e.apply(this,arguments)}}(),r.getMoreGroupResult=function(){var e=(0,h.default)(f.default.mark(function e(r){var t,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S.info("加载更多网络群组搜索结果"),t=r.query_key,n=t,e.abrupt("return",function(){var e=(0,h.default)(f.default.mark(function e(c){var o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreGroup.searchFixedGroupsLogic(r);case 2:return o=e.sent,e.abrupt("return",function(){return isNullOrEmpty(o)&&window.Toast(language.THE_NETWORK_IS_ABNORMAL,1,!1),(0,m.asyncMatch)(o.group_list||[],t,function(e){c({filtered:e,record_amount:o.record_amount},!0)},function(e,r){if(t!==n)return r.stop()})}());case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},1028:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function c(e,r,t){var n=0,c=-1,o="",a=void 0,u=void 0,i=function(e,i){if((!t||t[i]&&!(c>t[i]))&&"string"==typeof e){var s="",f=e.replace(r,function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];if(!s){var n=r[r.length-2].toString(36),c=r[0].length.toString(36),o=0;r.map(function(e,r){return e&&1&r&&o++}),o=o.toString(36),s="0".repeat(3-o.length)+o+"0".repeat(3-c.length)+c+"0".repeat(3-n.length)+n}return r.slice(1,-2).map(function(e,r){return 1&r?e:e?"<b>"+e+"</b>":void 0}).join("").replace(/<\/b><b>/g,"")});s&&(c=t&&t[i],n=s,o=f,a=e,u=i)}};return e instanceof Object?(0,d.default)(e).sort().forEach(function(r){var t=e[r];i(t,r)}):i(e),{power:-parseInt(n,36),mark:o,object:e,origin:a,key:u,reg:r,key_power:c}}function o(e,r){for(var t=!1,n=!1,o=arguments.length,u=Array(o>2?o-2:0),i=2;i<o;i++)u[i-2]=arguments[i];if(u.forEach(function(e){return"boolean"==typeof e?t=e:e instanceof Object?n=e:"string"==typeof e&&(n=[e])}),!e)return[];var s;n instanceof Array?(s={},n.forEach(function(e,r){return s[e]=n.length-r})):n instanceof Object&&(s=n);var f=v(r),l=e.map(function(e,r){var t=c(e,f,s);return t.index=r,t});return r&&!t?l.filter(function(e){return+e.power}).sort(a):t?l:[]}function a(e,r){var t=r.key_power-e.key_power||r.power-e.power;if(0===t){var n=(r.origin||"").toLowerCase(),c=(e.origin||"").toLowerCase();return n<c?1:n>c?-1:0}return t}function u(e,r){for(var t=0,n=e.length;t<n;){var c=t+n>>1;a(e[c],r)<=0?t=c+1:n=c}e.splice(t,0,r)}function i(e,r,t){for(var n=!1,o=!1,a=!1,i=function(){},s=arguments.length,l=Array(s>3?s-3:0),p=3;p<s;p++)l[p-3]=arguments[p];if(l.forEach(function(e){switch(void 0===e?"undefined":(0,h.default)(e)){case"boolean":n=e;break;case"object":o=e;break;case"string":"useServe"===e?a=!0:o=[e];break;case"function":i=e}}),!e)return f.default.resolve([]);var d;o instanceof Array?(d={},o.forEach(function(e,r){return d[e]=o.length-r})):o instanceof Object&&(d=o);var g=v(r),y=0,m=0,S=[],b=f.default.resolve(function o(s){if(!y){if(m>=e.length)return t?t(S):i(S,b||{stop:function(){return y=!0}}),S;for(s>=e.length&&(s=e.length);m<s;){var l=c(e[m],g,d);l.index=m++;(+l.power||r&&n)&&(a?S.push(l):u(S,l))}return i&&i(S,b||{stop:function(){return y=!0}}),new f.default(function(e){return setTimeout(function(){e(m+20)},2)}).then(o)}}(60));return b.onprocess=function(e){i=e},b.stop=function(){return y=!0},b}Object.defineProperty(r,"__esModule",{value:!0}),r.getRegExp=void 0;var s=t(3),f=n(s),l=t(142),h=n(l),p=t(133),d=n(p);r.filterMatch=o,r.asyncMatch=i;var g=t(118),v=(n(g),r.getRegExp=function(e){var r=/\w/gi,t=/([\\?+\-*\/[\]{}()^$.:|])/g,n=e.trim().split(/\s+/g).map(function(e){return r.test(e)?e.trim().split().filter(function(e){return!!e}).map(function(e){return"("+e.replace(t,"\\$1")+")(.*?)"}).join(""):"("+e.replace(t,"\\$1")+")(.*?)"}).join("|");return new RegExp(n,"ig")})},107:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.HwSearchSdk=void 0;var c=t(123),o=n(c),a=t(4),u=n(a),i=t(1851);r.HwSearchSdk=function e(){(0,u.default)(this,e),this.getGroupApi=i.getSearchApi,(0,o.default)(this,(0,i.getSearchApi)().getApiList())}},118:function(e,r,t){e.exports=t(0)(0)},119:function(e,r,t){e.exports={default:t(145),__esModule:!0}},120:function(e,r,t){e.exports=t(0)(45)},121:function(e,r,t){e.exports=t(0)(47)},123:function(e,r,t){e.exports=t(0)(562)},128:function(e,r,t){"use strict";r.__esModule=!0;var n=t(143),c=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return(0,c.default)(e)}},130:function(e,r,t){e.exports=t(0)(238)},133:function(e,r,t){e.exports={default:t(169),__esModule:!0}},137:function(e,r,t){var n=t(10),c=t(8),o=t(138);e.exports=function(e,r){var t=(c.Object||{})[e]||Object[e],a={};a[e]=r(t),n(n.S+n.F*o(function(){t(1)}),"Object",a)}},138:function(e,r,t){e.exports=t(0)(59)},142:function(e,r,t){e.exports=t(0)(84)},143:function(e,r,t){e.exports={default:t(158),__esModule:!0}},145:function(e,r,t){t(146),e.exports=t(8).Object.getPrototypeOf},146:function(e,r,t){var n=t(130),c=t(147);t(137)("getPrototypeOf",function(){return function(e){return c(n(e))}})},147:function(e,r,t){e.exports=t(0)(585)},158:function(e,r,t){t(22),t(159),e.exports=t(8).Array.from},159:function(e,r,t){"use strict";var n=t(11),c=t(10),o=t(130),a=t(32),u=t(33),i=t(27),s=t(160),f=t(26);c(c.S+c.F*!t(34)(function(e){Array.from(e)}),"Array",{from:function(e){var r,t,c,l,h=o(e),p="function"==typeof this?this:Array,d=arguments.length,g=d>1?arguments[1]:void 0,v=void 0!==g,y=0,m=f(h);if(v&&(g=n(g,d>2?arguments[2]:void 0,2)),void 0==m||p==Array&&u(m))for(r=i(h.length),t=new p(r);r>y;y++)s(t,y,v?g(h[y],y):h[y]);else for(l=m.call(h),t=new p;!(c=l.next()).done;y++)s(t,y,v?a(l,g,[c.value,y],!0):c.value);return t.length=y,t}})},160:function(e,r,t){"use strict";var n=t(25),c=t(161);e.exports=function(e,r,t){r in e?n.f(e,r,c(0,t)):e[r]=t}},161:function(e,r,t){e.exports=t(0)(79)},162:function(e,r,t){e.exports=t(0)(80)},169:function(e,r,t){t(170),e.exports=t(8).Object.keys},170:function(e,r,t){var n=t(130),c=t(162);t(137)("keys",function(){return function(e){return c(n(e))}})},1851:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.SearchImpl=r.getSearchApi=void 0;var c=t(119),o=n(c),a=t(4),u=n(a),i=t(120),s=n(i),f=t(121),l=n(f),h=t(1852),p=n(h),d=t(1853),g=t(1028),v=t(1027),y=void 0,m=(r.getSearchApi=function(){return isNullOrEmpty(y)&&(y=new m),y},r.SearchImpl=function(e){function r(){(0,u.default)(this,r);var e=(0,s.default)(this,(r.__proto__||(0,o.default)(r)).call(this));return e.clearGlobalData=function(){return(0,d.clearGlobalData)()},e.filterMatch=function(e){return(0,g.filterMatch)(e.searchList,e.key,e.matchItem)},e.getMoreSearchResult=function(e){return(0,v.getMoreSearchResult)(e.offSet,e.val)},e.search=function(e){return(0,d.search)(e)},e.searchContact=function(e){return(0,v.searchContact)(e)},e.searchContactLocalAsync=function(e){var r=e.text,t=e.callback;return(0,v.searchContactLocalAsync)(r,t)},e.searchDirectoryAsync=function(e){var r=e.text,t=e.callback;return(0,v.searchDirectoryAsync)(r,t)},e.searchGroup=function(e){return(0,v.searchGroup)(e)},e.searchGroupLocalAsync=function(e){var r=e.text,t=e.callback;return(0,v.searchGroupLocalAsync)(r,t)},e.searchGroupFromMemberAsync=function(e){var r=e.text,t=e.callback;return(0,v.searchGroupFromMemberAsync)(r,t)},e.searchMessageAsync=function(e){var r=e.text,t=e.callback;return(0,v.searchMessageAsync)(r,t)},e.searchFileAsync=function(e){var r=e.text,t=e.callback;return(0,v.searchFileAsync)(r,t)},e.searchLocalContact=function(e){return(0,d.searchLocalContact)(e)},e.searchLocalTeam=function(e){return(0,d.searchLocalTeam)(e)},e.searchServerContact=function(){return(0,d.searchServerContact)()},e.searchServerFixedGroup=function(){return(0,d.searchServerFixedGroup)()},e.searchServerGroupAsync=function(e){var r=e.text,t=e.callback;return(0,v.searchServerGroupAsync)(r,t)},e.setGlobalDirectorySearchLoadLogic=function(e){return(0,v.setGlobalDirectorySearchLoadLogic)(e)},e.showCollapseSearchResult=function(e){return(0,d.showCollapseSearchResult)(e)},e.showMoreSearchResult=function(e){return(0,d.showMoreSearchResult)(e)},e}return(0,l.default)(r,e),r}(p.default))},1852:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=t(119),o=n(c),a=t(4),u=n(a),i=t(120),s=n(i),f=t(121),l=n(f),h=function(e){function r(){var e,t,n,c;(0,u.default)(this,r);for(var a=arguments.length,i=Array(a),f=0;f<a;f++)i[f]=arguments[f];return t=n=(0,s.default)(this,(e=r.__proto__||(0,o.default)(r)).call.apply(e,[this].concat(i))),n.clearGlobalData=function(){},n.filterMatch=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]},n.getMoreSearchResult=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]},n.search=function(e){},n.searchContact=function(e){},n.searchContactLocalAsync=function(e){e.text,e.callback},n.searchDirectoryAsync=function(e){e.text,e.callback},n.searchGroup=function(e){},n.searchGroupLocalAsync=function(e){e.text,e.callback},n.searchGroupFromMemberAsync=function(e){e.text,e.callback},n.searchMessageAsync=function(e){e.text,e.callback},n.searchFileAsync=function(e){e.text,e.callback},n.searchLocalContact=function(e){},n.searchLocalTeam=function(e){},n.searchServerContact=function(){},n.searchServerFixedGroup=function(){},n.searchServerGroupAsync=function(e){e.text,e.callback},n.setGlobalDirectorySearchLoadLogic=function(e){},n.showCollapseSearchResult=function(e){},n.showMoreSearchResult=function(e){},c=t,(0,s.default)(n,c)}return(0,l.default)(r,e),r}(coreCommon.Interface);r.default=h},1853:function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function c(e){if(void 0===e&&(e=$getState().search.searchText),$dispatch(coreUi.updateSearchData({searchText:e})),""===e.trim())return a();a(!0),window.CLIENTCONFIG.USE_IM?(b(e),_(e),G(e),M(e),A(e),L(e),x(e)):b(e)}function o(){S=S={contact:"",group:"",message:"",file:""}}function a(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y.info("clear search data"),S=S={contact:"",group:"",message:"",file:""},e?$dispatch(coreUi.updateSearchData({coordinate:-1})):coreUi.resetSearchData()}function u(e,r){return function(t){t=t.slice(0,128);var n=w(e),c=n.update,o=n.search,a=n.useServer;$dispatch(c({isSearching:!0}));var u=void 0,i=0,s=!1;o(t,function(){var n=(0,g.default)(p.default.mark(function n(o){var f,l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],h=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return p.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(y.info("searchGenerator["+e+"] searchtext length "+t.length+" local search finish count "+o.length),n.t0=r instanceof Function,!n.t0){n.next=5;break}return n.next=5,r(o);case 5:u=l,f={},o=o.filter(function(e){var r=e.object.account;if(r){if(f.hasOwnProperty(r))return!1;f[r]=!0}return!0}),"contact"===e&&(i+=1,s=0===o.length&&1===i),"message"===e&&(o=o.filter(function(e){return e.object.media_type===constant.MEDIA_TYPE.TEXT})),$dispatch(c({list:o,displayLength:Math.min(o.length,3),hasSearchServer:!a||u,serverHasMore:d<h,isSearching:s}));case 11:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()).then(function(r){a&&(u?m[e]=function(){}:($getState().login.sipLoginOnly&&isNullOrEmpty($getState().conf.confTempAcsAccount)&&(window.CLIENTCONFIG.ISMOBILE||(window.alert(language.UNABLE_SEARCH),y.info("本地 ：匿名入会不可搜索联系人"),$dispatch(c({list:[]})))),m[e]=r))})}}Object.defineProperty(r,"__esModule",{value:!0}),r.showCollapseSearchResult=r.showMoreSearchResult=r.getSearchObject=r.searchServerFixedGroup=r.searchServerContact=r.searchLocalMessage=r.searchLocalFile=r.searchGroupFromMember=r.searchLocalGroup=r.searchTeamFromMember=r.searchLocalTeam=r.searchLocalContact=void 0;var i=t(123),s=n(i),f=t(128),l=n(f),h=t(1),p=n(h),d=t(2),g=n(d);r.search=c,r.clearGlobalData=o,r.resetSearch=a;var v=t(1027),y=coreLogger.getLogger("logic")("search/basic"),m={contact:null,group:null},S={contact:"",group:"",message:"",file:""},b=r.searchLocalContact=u("contact",function(e){!window.CLIENTCONFIG.ISMOBILE&&coreIm.detectContactStatus({accountList:e.map(function(e){return e.object.account})});var r=$getState().search.searchText.trim().slice(0,128);/(?=(\b|\D))(((\d{1,2})|(1\d{1,2})|(2[0-4]\d)|(25[0-5]))\.){3}((\d{1,2})|(1\d{1,2})|(2[0-4]\d)|(25[0-5]))(?=(\b|\D))/.test(r)?e.unshift({object:{name:r},type:"phone"}):/^.+?[@].+\..+$/.test(r)&&e.unshift({object:{name:r},type:"phone"})}),_=r.searchLocalTeam=u("team",function(e){for(var r=0;r<e.length;r++){e[r].object.group_type===constant.GROUP_TYPE.FIXED_GROUP||e.splice(r--,1)}}),G=r.searchTeamFromMember=u("teamFromMember",function(e){for(var r=0;r<e.length;r++){e[r].object.group_type===constant.GROUP_TYPE.FIXED_GROUP||e.splice(r--,1)}}),M=r.searchLocalGroup=u("group",function(e){for(var r=0;r<e.length;r++){e[r].object.group_type===constant.GROUP_TYPE.FIXED_GROUP&&e.splice(r--,1)}}),A=r.searchGroupFromMember=u("groupFromMember",function(e){for(var r=0;r<e.length;r++){e[r].object.group_type===constant.GROUP_TYPE.FIXED_GROUP&&e.splice(r--,1)}}),L=r.searchLocalFile=u("file"),x=r.searchLocalMessage=u("message",function(){var e=(0,g.default)(p.default.mark(function e(r){var t,n,c,o,a;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<r.length)){e.next=20;break}if(n=r[t].object,!(c=coreIm.isGroup(n.chat_type))||!n.group_id){e.next=17;break}return e.next=7,coreGroup.getGroupInfoFromDB(n.group_id);case 7:if(o=e.sent,!o.name){e.next=13;break}r[t].object.group_name=o.name,r[t].object.group_type=o.group_type,e.next=17;break;case 13:return e.next=15,coreIm.getLocalRecent({owner:n.group_id});case 15:a=e.sent,r[t].object.group_name=a.last_message.group_name;case 17:t++,e.next=1;break;case 20:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()),w=(r.searchServerContact=function(){if(m.contact instanceof Function)m.contact(function(e,r,t,n){y.info("server search conatcts add showing finish,count",e.length),!window.CLIENTCONFIG.ISMOBILE&&coreIm.detectContactStatus({accountList:e.map(function(e){return e.object.account})});var c=$getState().search.contact.list,o={};c.reduce(function(e,r){return e[r.object.account]=!0,e},o);var a=1;e.forEach(function(e){!o[e.object.account]&&c.push(e),o[e.object.account]&&y.info("has been filtered["+a+++"]")}),y.info("server current showing search contacts finish,count",c.length),y.info("contact_isloaded",r);var u={};c=c.filter(function(e){var r=e.object.account;if(r){if(u.hasOwnProperty(r))return!1;u[r]=!0}return!0}),$dispatch(coreUi.updateSearchContactData({list:[].concat((0,l.default)(c)),displayLength:c.length,hasSearchServer:r,serverHasMore:0!==t&&n<t,isSearching:!1}))});else{var e=$getState().search.contact.list;$dispatch(coreUi.updateSearchContactData({list:[],displayLength:e.length,hasSearchServer:!0,serverHasMore:!1,isSearching:!1}))}return!0},r.searchServerFixedGroup=function(){if(m.group instanceof Function)m.group(function(e,r,t,n){y.info("server search groups add showing finish,count",e.length);var c=$getState().search.group.list,o={};c.reduce(function(e,r){return e[r.object.group_id]=!0,e},o);var a=1;e.forEach(function(e){!o[e.object.group_id]&&c.push(e),o[e.object.group_id]&&y.info("has been filtered["+a+++"]")});var u=[];c.map(function(e){e.object.server_group&&u.push(e.object.server_group)}),y.info("server group_id_array, count",u.length),y.info("server current showing search groups finish,count",c.length),y.info("group_isloaded",r),$dispatch(coreUi.updateSearchGroupData({list:[].concat((0,l.default)(c)),displayLength:c.length,hasSearchServer:r,serverHasMore:0!==t&&n<t,isSearching:!1}))});else{var e=$getState().search.group.list;$dispatch(coreUi.updateSearchGroupData({list:[],displayLength:e.length,hasSearchServer:!0,serverHasMore:!1,isSearching:!1}))}},r.getSearchObject=function(e){var r={contact:{update:coreUi.updateSearchContactData,search:v.searchContactAsync,useServer:!0},team:{update:coreUi.updateSearchTeamData,search:v.searchGroupAsync,useServer:!1},teamFromMember:{update:coreUi.updateSearchTeamFromMemberData,search:v.searchGroupFromMemberAsync,useServer:!1},group:{update:coreUi.updateSearchGroupData,search:v.searchGroupAsync,useServer:!1},groupFromMember:{update:coreUi.updateSearchGroupFromMemberData,search:v.searchGroupFromMemberAsync,useServer:!1},file:{update:coreUi.updateSearchFileData,search:v.searchFileAsync,useServer:!1},message:{update:coreUi.updateSearchMessageData,search:v.searchMessageAsync,useServer:!1}},t=$getState().search;return(0,s.default)(r[e],{state:t[e]})});r.showMoreSearchResult=function(e){return function(){y.info("userClick  look more results");var r=w(e),t=r.state,n=r.update;$dispatch(coreUi.updateSearchData({coordinate:-1})),$dispatch(n({displayLength:t.displayLength+20>t.list.length?t.list.length:t.displayLength+20}))}},r.showCollapseSearchResult=function(e){return function(){y.info("userClick  look collapse results");var r=w(e),t=r.state,n=r.update;$dispatch(coreUi.updateSearchData({coordinate:-1})),$dispatch(n({displayLength:Math.min(t.list.length,3)}))}}}});