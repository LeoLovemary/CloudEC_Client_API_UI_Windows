webpackJsonp([11],{1e3:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=this,r=l.default.createElement("div",{className:"upgrade-window-content-text-wrap"},l.default.createElement("ul",{className:"upgrade-window-content-text-detail-ul"},l.default.createElement("li",{className:"upgrade-window-content-text-detail-li"},language.EMUI_8_NOTIFY_LINE_1),l.default.createElement("li",{className:"upgrade-window-content-text-detail-li"},language.EMUI_8_NOTIFY_LINE_2),l.default.createElement("li",{className:"upgrade-window-content-text-detail-li"},language.EMUI_8_NOTIFY_LINE_3)));window.confirm(r,"EMUI_COME_CALL_NOTIFY_TITLE",!0,{leftButton:language.BTN_ENSURE_TO_SKIP,rightButton:language.BTN_ENSURE_TO_SET}).then(function(){var r=(0,c.default)(s.default.mark(function r(n){var o;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=n.ret,o?(coreDb.saveLoginSetting({key:f,value:"1"}),window.webView.goToSystemCloudLinkSetting()):(e+=1,coreDb.saveLoginSetting({key:p,value:e}));case 2:case"end":return t.stop()}},r,t)}));return function(e){return r.apply(this,arguments)}}())}function a(e){var t=this,r=l.default.createElement("div",{className:"upgrade-window-content-text-wrap"},l.default.createElement("ul",{className:"upgrade-window-content-text-detail-ul"},l.default.createElement("li",{className:"upgrade-window-content-text-detail-li"},language.EMUI_5_NOTIFY_LINE_1),l.default.createElement("li",{className:"upgrade-window-content-text-detail-li"},language.EMUI_5_NOTIFY_LINE_2),l.default.createElement("li",{className:"upgrade-window-content-text-detail-li"},language.EMUI_5_NOTIFY_LINE_3)));window.confirm(r,"EMUI_COME_CALL_NOTIFY_TITLE",!0,{leftButton:language.BTN_ENSURE_TO_SKIP,rightButton:language.BTN_ENSURE_TO_SET}).then(function(){var r=(0,c.default)(s.default.mark(function r(n){var o;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=n.ret,o?(coreDb.saveLoginSetting({key:f,value:"1"}),window.webView.goToSystemCloudLinkSetting()):(e+=1,coreDb.saveLoginSetting({key:p,value:e}));case 2:case"end":return t.stop()}},r,t)}));return function(e){return r.apply(this,arguments)}}())}Object.defineProperty(t,"__esModule",{value:!0}),t.checkHuaweiPhonePushSetting=t.DB_KEY_SKIP_SETTING_COUNT=t.DB_KEY_HAS_SHOW_SETTING_DIALOG=void 0;var i=r(1),s=n(i),u=r(2),c=n(u),d=r(116),l=n(d),f=t.DB_KEY_HAS_SHOW_SETTING_DIALOG="has_show_setting_dialog",p=t.DB_KEY_SKIP_SETTING_COUNT="has_skip_setting_count";t.checkHuaweiPhonePushSetting=function(){coreDb.queryLoginSetting({key:f}).then(function(e){var t="0";isNullOrEmpty(e)||!e.hasOwnProperty("key")||!e.hasOwnProperty("value")||isNullOrEmpty(e.key)||isNullOrEmpty(e.value)||(t=e.value),"1"!==t&&coreDb.queryLoginSetting({key:p}).then(function(e){var t=0;isNullOrEmpty(e)||isNullOrEmpty(e.key)||isNullOrEmpty(e.value)||(t=parseInt(e.value)),t<2&&appService.getEMUI().then(function(e){""!==e&&(e.includes("5.")?a(t):o(t))})})})}},116:function(e,t,r){e.exports=r(0)(0)},117:function(e,t,r){e.exports={default:r(148),__esModule:!0}},118:function(e,t,r){e.exports=r(0)(33)},119:function(e,t,r){e.exports=r(0)(34)},121:function(e,t,r){e.exports=r(0)(573)},126:function(e,t,r){e.exports=r(0)(43)},128:function(e,t,r){e.exports=r(0)(253)},129:function(e,t,r){"use strict";t.__esModule=!0;var n=r(141),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,o.default)(e)}},132:function(e,t,r){e.exports=r(0)(242)},133:function(e,t,r){"use strict";(function(e){function n(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=a.prototype):(null===e&&(e=new a(t)),e.length=t),e}function a(e,t,r){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return i(this,e,t,r)}function i(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?f(e,t,r,n):"string"==typeof t?d(e,t,r):p(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,r,n){return s(t),t<=0?o(e,t):void 0!==r?"string"==typeof n?o(e,t).fill(r,n):o(e,t).fill(r):o(e,t)}function c(e,t){if(s(t),e=o(e,t<0?0:0|_(t)),!a.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function d(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!a.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|w(t,r);e=o(e,n);var i=e.write(t,r);return i!==n&&(e=e.slice(0,i)),e}function l(e,t){var r=t.length<0?0:0|_(t.length);e=o(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function f(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),a.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=a.prototype):e=l(e,t),e}function p(e,t){if(a.isBuffer(t)){var r=0|_(t.length);return e=o(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||X(t.length)?o(e,0):l(e,t);if("Buffer"===t.type&&Q(t.data))return l(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function _(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),a.alloc(+e)}function w(e,t){if(a.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return j(e).length;default:if(n)return K(e).length;t=(""+t).toLowerCase(),n=!0}}function E(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return O(this,t,r);case"ascii":return A(this,t,r);case"latin1":case"binary":return b(this,t,r);case"base64":return R(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function I(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:h(e,t,r,n,o);if("number"==typeof t)return t&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):h(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function h(e,t,r,n,o){function a(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}var i=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;i=2,s/=2,u/=2,r/=2}var c;if(o){var d=-1;for(c=r;c<s;c++)if(a(e,c)===a(t,-1===d?0:c-d)){if(-1===d&&(d=c),c-d+1===u)return d*i}else-1!==d&&(c-=c-d),d=-1}else for(r+u>s&&(r=s-u),c=r;c>=0;c--){for(var l=!0,f=0;f<u;f++)if(a(e,c+f)!==a(t,f)){l=!1;break}if(l)return c}return-1}function m(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");n>a/2&&(n=a/2);for(var i=0;i<n;++i){var s=parseInt(t.substr(2*i,2),16);if(isNaN(s))return i;e[r+i]=s}return i}function L(e,t,r,n){return $(K(t,e.length-r),e,r,n)}function C(e,t,r,n){return $(Y(t),e,r,n)}function T(e,t,r,n){return C(e,t,r,n)}function S(e,t,r,n){return $(j(t),e,r,n)}function N(e,t,r,n){return $(q(t,e.length-r),e,r,n)}function R(e,t,r){return 0===t&&r===e.length?z.fromByteArray(e):z.fromByteArray(e.slice(t,r))}function O(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var a=e[o],i=null,s=a>239?4:a>223?3:a>191?2:1;if(o+s<=r){var u,c,d,l;switch(s){case 1:a<128&&(i=a);break;case 2:u=e[o+1],128==(192&u)&&(l=(31&a)<<6|63&u)>127&&(i=l);break;case 3:u=e[o+1],c=e[o+2],128==(192&u)&&128==(192&c)&&(l=(15&a)<<12|(63&u)<<6|63&c)>2047&&(l<55296||l>57343)&&(i=l);break;case 4:u=e[o+1],c=e[o+2],d=e[o+3],128==(192&u)&&128==(192&c)&&128==(192&d)&&(l=(15&a)<<18|(63&u)<<12|(63&c)<<6|63&d)>65535&&l<1114112&&(i=l)}}null===i?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),o+=s}return y(n)}function y(e){var t=e.length;if(t<=Z)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Z));return r}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function b(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function P(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",a=t;a<r;++a)o+=V(e[a]);return o}function x(e,t,r){for(var n=e.slice(t,r),o="",a=0;a<n.length;a+=2)o+=String.fromCharCode(n[a]+256*n[a+1]);return o}function k(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,o,i){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function U(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,a=Math.min(e.length-r,2);o<a;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function D(e,t,r,n){t<0&&(t=4294967295+t+1);for(var o=0,a=Math.min(e.length-r,4);o<a;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function G(e,t,r,n,o,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,n,o){return o||G(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(e,t,r,n,23,4),r+4}function B(e,t,r,n,o){return o||G(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(e,t,r,n,52,8),r+8}function W(e){if(e=H(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function H(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function K(e,t){t=t||1/0;for(var r,n=e.length,o=null,a=[],i=0;i<n;++i){if((r=e.charCodeAt(i))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(i+1===n){(t-=3)>-1&&a.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&a.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function Y(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function q(e,t){for(var r,n,o,a=[],i=0;i<e.length&&!((t-=2)<0);++i)r=e.charCodeAt(i),n=r>>8,o=r%256,a.push(o),a.push(n);return a}function j(e){return z.toByteArray(W(e))}function $(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function X(e){return e!==e}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var z=r(236),J=r(237),Q=r(205);t.Buffer=a,t.SlowBuffer=g,t.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=n(),a.poolSize=8192,a._augment=function(e){return e.__proto__=a.prototype,e},a.from=function(e,t,r){return i(null,e,t,r)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(e,t,r){return u(null,e,t,r)},a.allocUnsafe=function(e){return c(null,e)},a.allocUnsafeSlow=function(e){return c(null,e)},a.isBuffer=function(e){return!(null==e||!e._isBuffer)},a.compare=function(e,t){if(!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=a.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var i=e[r];if(!a.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},a.byteLength=w,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},a.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):E.apply(this,arguments)},a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},a.prototype.compare=function(e,t,r,n,o){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,o>>>=0,this===e)return 0;for(var i=o-n,s=r-t,u=Math.min(i,s),c=this.slice(n,o),d=e.slice(t,r),l=0;l<u;++l)if(c[l]!==d[l]){i=c[l],s=d[l];break}return i<s?-1:s<i?1:0},a.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return I(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return I(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return m(this,e,t,r);case"utf8":case"utf-8":return L(this,e,t,r);case"ascii":return C(this,e,t,r);case"latin1":case"binary":return T(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;a.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n;if(a.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=a.prototype;else{var o=t-e;n=new a(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},a.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||k(e,t,this.length);for(var n=this[e],o=1,a=0;++a<t&&(o*=256);)n+=this[e+a]*o;return n},a.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||k(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},a.prototype.readUInt8=function(e,t){return t||k(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return t||k(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return t||k(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return t||k(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return t||k(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||k(e,t,this.length);for(var n=this[e],o=1,a=0;++a<t&&(o*=256);)n+=this[e+a]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||k(e,t,this.length);for(var n=t,o=1,a=this[e+--n];n>0&&(o*=256);)a+=this[e+--n]*o;return o*=128,a>=o&&(a-=Math.pow(2,8*t)),a},a.prototype.readInt8=function(e,t){return t||k(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){t||k(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){t||k(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return t||k(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return t||k(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return t||k(e,4,this.length),J.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return t||k(e,4,this.length),J.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return t||k(e,8,this.length),J.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return t||k(e,8,this.length),J.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){M(this,e,t,r,Math.pow(2,8*r)-1,0)}var o=1,a=0;for(this[t]=255&e;++a<r&&(o*=256);)this[t+a]=e/o&255;return t+r},a.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){M(this,e,t,r,Math.pow(2,8*r)-1,0)}var o=r-1,a=1;for(this[t+o]=255&e;--o>=0&&(a*=256);)this[t+o]=e/a&255;return t+r},a.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,255,0),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},a.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);M(this,e,t,r,o-1,-o)}var a=0,i=1,s=0;for(this[t]=255&e;++a<r&&(i*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/i>>0)-s&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);M(this,e,t,r,o-1,-o)}var a=r-1,i=1,s=0;for(this[t+a]=255&e;--a>=0&&(i*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/i>>0)-s&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,127,-128),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},a.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o,i=n-r;if(this===e&&r<t&&t<n)for(o=i-1;o>=0;--o)e[o+t]=this[o+r];else if(i<1e3||!a.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var i;if("number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var s=a.isBuffer(e)?e:K(new a(e,n).toString()),u=s.length;for(i=0;i<r-t;++i)this[i+t]=s[i%u]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,r(139))},134:function(e,t,r){e.exports={default:r(157),__esModule:!0}},136:function(e,t,r){var n=r(10),o=r(8),a=r(137);e.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],i={};i[e]=t(r),n(n.S+n.F*a(function(){r(1)}),"Object",i)}},137:function(e,t,r){e.exports=r(0)(60)},139:function(e,t,r){e.exports=r(0)(67)},141:function(e,t,r){e.exports={default:r(165),__esModule:!0}},143:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(177),a=n(o),i=r(134),s=n(i);t.default=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=(0,s.default)(e);!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if((0,a.default)(Object(t)))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},144:function(e,t,r){e.exports=r(0)(134)},148:function(e,t,r){r(149),e.exports=r(8).Object.getPrototypeOf},149:function(e,t,r){var n=r(132),o=r(150);r(136)("getPrototypeOf",function(){return function(e){return o(n(e))}})},150:function(e,t,r){e.exports=r(0)(596)},157:function(e,t,r){r(23),r(22),e.exports=r(158)},158:function(e,t,r){var n=r(9),o=r(26);e.exports=r(8).getIterator=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},165:function(e,t,r){r(22),r(166),e.exports=r(8).Array.from},166:function(e,t,r){"use strict";var n=r(11),o=r(10),a=r(132),i=r(31),s=r(32),u=r(27),c=r(167),d=r(26);o(o.S+o.F*!r(33)(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,o,l,f=a(e),p="function"==typeof this?this:Array,_=arguments.length,g=_>1?arguments[1]:void 0,w=void 0!==g,E=0,v=d(f);if(w&&(g=n(g,_>2?arguments[2]:void 0,2)),void 0==v||p==Array&&s(v))for(t=u(f.length),r=new p(t);t>E;E++)c(r,E,w?g(f[E],E):f[E]);else for(l=v.call(f),r=new p;!(o=l.next()).done;E++)c(r,E,w?i(l,g,[o.value,E],!0):o.value);return r.length=E,r}})},167:function(e,t,r){"use strict";var n=r(25),o=r(168);e.exports=function(e,t,r){t in e?n.f(e,t,o(0,r)):e[t]=r}},168:function(e,t,r){e.exports=r(0)(80)},1764:function(e,t,r){"use strict"},1765:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=r(117),c=n(u),d=r(4),l=n(d),f=r(118),p=n(f),_=r(119),g=n(_),w=function(e){function t(){var e,r,n,o,i=this;(0,l.default)(this,t);for(var u=arguments.length,d=Array(u),f=0;f<u;f++)d[f]=arguments[f];return r=n=(0,p.default)(this,(e=t.__proto__||(0,c.default)(t)).call.apply(e,[this].concat(d))),n.loginToUportal=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.refreshTokenCallback=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setLoginProxy=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.uportalAllonline=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),o=r,(0,p.default)(n,o)}return(0,g.default)(t,e),t}(coreCommon.Interface);t.default=w},1766:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=r(117),c=n(u),d=r(4),l=n(d),f=r(118),p=n(f),_=r(119),g=n(_),w=function(e){function t(){var e,r,n,o,i=this;(0,l.default)(this,t);for(var u=arguments.length,d=Array(u),f=0;f<u;f++)d[f]=arguments[f];return r=n=(0,p.default)(this,(e=t.__proto__||(0,c.default)(t)).call.apply(e,[this].concat(d))),n.requestIDVerificationCode=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.requestTenantUserList=function(){var e=(0,s.default)(a.default.mark(function e(t){t.phoneNumber,t.verificationCode;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.ssoLogin=function(){var e=(0,s.default)(a.default.mark(function e(t){t.loginName,t.password,t.tenantid;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.startRefreshMiddleEndToken=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.stopRefreshMiddleEndToken=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),o=r,(0,p.default)(n,o)}return(0,g.default)(t,e),t}(coreCommon.Interface);t.default=w},1767:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(1),a=n(o),i=r(2),s=n(i),u=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.event,e.next="eserver"===e.t0?3:"total"===e.t0?6:10;break;case 3:return window.CLIENTCONFIG.ISMOBILE&&w(),E(),e.abrupt("break",11);case 6:return(0,l.getLoginModel)().useIM&&window.CLIENTCONFIG.ISMOBILE||w(),e.next=9,(0,f.loadMyInfo)(coreAccount.getLoginModel().account);case 9:case 10:return e.abrupt("break",11);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,s.default)(a.default.mark(function e(){var t,r,n,o;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=coreAccount.getLoginModel(),!window.CLIENTCONFIG.ENABLE_IT_MEETING||!window.sipUseByOther){e.next=6;break}window.sipUseByOther=!1,g.info("[ initSipService ] cur user sip kick by other mobile."),e.next=20;break;case 6:if(!t.useSip||t.isMultiDeviceLogined&&t.isMobile){e.next=17;break}if(t.isResume){e.next=13;break}return g.info("[ initSipService ]",handlePhoneNumber(t.account)),e.next=11,(0,p.sipLoginAtomic)(!0).then(function(){g.info("[ initSipService ] ok! ",handlePhoneNumber(t.account)),window.CLIENTCONFIG.ENABLE_IT_MEETING||(window.isHubEnv?(coreConf.initTupPairServer(),window.maxhubShareAppParam=null):window.CLIENTCONFIG.ISBIGWIN||coreConf.initTupPairClient())});case 11:e.next=15;break;case 13:return e.next=15,(0,_.sipResume)();case 15:e.next=20;break;case 17:g.info("[ initSipService ] end login:"),t.setLoginStatus(!1,!0),coreCommon.dispatchModuleEvent("sipMultiDeviceLogined");case 20:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=39;break}if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=29;break}return e.next=24,window.getMeetingDomain();case 24:return r=e.sent,e.next=27,window.parserIPAddress(r);case 27:n=e.sent,n?coreDb.saveLoginSetting({key:r,value:n}):g.info("get host name ip fail");case 29:return coreConf.registerConfEventAtomic.wait(),t.useMetting&&coreConf.initializeDataConf(),e.next=33,coreConf.initConfctrl();case 33:if(o=$getState().login.sipLoginOnly,o||window.CLIENTCONFIG.ISBIGWIN||coreConf.getVRMList(),isNullOrEmpty(window.handleJoinTempConfNoNameURL)){e.next=39;break}return e.next=38,window.handleJoinTempConfNoName(window.handleJoinTempConfNoNameURL);case 38:window.handleJoinTempConfNoNameURL=null;case 39:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),d=function(){var e=(0,s.default)(a.default.mark(function e(){var t,r=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=coreAccount.getLoginModel(),!t.useEab){e.next=4;break}return g.info("[ prepareEabService ]",handlePhoneNumber(t.account)),e.abrupt("return",(0,f.checkLocalHasMyinfo)().then(function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("[ prepareEabService ] ok! local has last myinfo copy:",t),e.abrupt("return",0);case 2:case"end":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),l=r(183),f=r(629),p=r(795),_=r(354),g=window.Logger("account")("moduleMessager");coreCommon.registeModuleListener("login",u);var w=function(){return d().then(c)},E=function(){var e=(0,s.default)(a.default.mark(function e(){var t,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("start loadEserverSignature upon eserver login event"),t=coreAccount.getLoginModel(),r=t.isSupportAS,r){e.next=4;break}return e.abrupt("return",(0,f.loadEserverSignature)(coreAccount.getLoginModel().account));case 4:g.info("isSupportAS is true, do not load sig-nature from eserver");case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()},1768:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.verification=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=r(117),c=n(u),d=r(4),l=n(d),f=r(118),p=n(f),_=r(119),g=n(_),w=window.Logger("login")("IDVerification"),E=function(e){function t(){var e,r,n,o,i=this;(0,l.default)(this,t);for(var u=arguments.length,d=Array(u),f=0;f<u;f++)d[f]=arguments[f];return r=n=(0,p.default)(this,(e=t.__proto__||(0,c.default)(t)).call.apply(e,[this].concat(d))),n.dealWithVerificationInfo=function(){var e=(0,s.default)(a.default.mark(function e(t){var r,n,o,s,u,c,d,l,f;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(w.info("The user lists length",t.length),!(t.length<=0)){e.next=3;break}return e.abrupt("return");case 3:r=coreAccount.getLoginModel(),n=r.loginRecordList,n=n.slice(0),o=0;case 6:if(!(o<n.length)){e.next=13;break}return s=n[o].account,e.next=10,coreAccount.deleteLoginInfo(s);case 10:o++,e.next=6;break;case 13:u=[],c=[],d=0;case 15:if(!(d<t.length)){e.next=25;break}return l=t[d],f={account:l.loginName,display_account:l.loginName,tenantcn:l.tenantCn,tenanten:l.tenantEn,tenantid:l.tenantId,thirdcertype:l.thirdCerType,time_stamp:(new Date).getTime()},u.push(f),c.push(f.display_account),e.next=22,coreDb.saveLoginRecord(f);case 22:d++,e.next=15;break;case 25:coreAccount.showLoginInfo({loginInfo:u[0],loginHistoryList:c,loginRecordList:u});case 26:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.startCountdown=function(){var e=(0,s.default)(a.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.callback;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.currentCount=t,n.callback=o,n.timer&&clearInterval(n.timer),n.timer=setInterval(function(){n.currentCount>0?(n.currentCount--,n.callback&&n.callback(n.currentCount)):(clearInterval(n.timer),n.timer=null)},r);case 4:case"end":return e.stop()}},e,i)}));return function(){return e.apply(this,arguments)}}(),n.setCountdownCallback=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.callback=t,e.abrupt("return",n.currentCount);case 2:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.resetCountdown=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.currentCount=0,n.callback=null,n.timer&&clearInterval(n.timer);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),o=r,(0,p.default)(n,o)}return(0,g.default)(t,e),t}(coreCommon.Interface);t.verification=new E},1769:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.LoginImpl=t.getLoginApi=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=r(117),c=n(u),d=r(4),l=n(d),f=r(118),p=n(f),_=r(119),g=n(_),w=r(1770),E=n(w),v=r(183),I=r(711),h=r(351),m=r(353),L=r(709),C=r(283),T=r(352),S=r(354),N=r(629),R=r(715),O=r(716),y=r(796),A=r(408),b=r(793),P=r(353),x=r(409),k=r(992),M=r(712),U=r(799),D=r(714),G=r(629),F=r(800),B=r(801),W=void 0,H=(t.getLoginApi=function(){return isNullOrEmpty(W)&&(W=new H),W},t.LoginImpl=function(e){function t(){var e,r,n,o,i=this;(0,l.default)(this,t);for(var u=arguments.length,d=Array(u),f=0;f<u;f++)d[f]=arguments[f];return r=n=(0,p.default)(this,(e=t.__proto__||(0,c.default)(t)).call.apply(e,[this].concat(d))),n.initCallLog=(0,s.default)(a.default.mark(function e(){var t,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ISBIGWIN){e.next=7;break}return e.next=3,new coreTup.HWTupCall;case 3:return t=e.sent,r={log_path:window.LOG_PATH,enable_json_log:window.CLIENTCONFIG.TUP_ENABLE_JSON_LOG||0},e.next=7,t.config(r);case 7:case"end":return e.stop()}},e,i)})),n.getLoginModel=function(){return(0,v.getLoginModel)()},n.getMyInfo=function(){return(0,v.getMyInfo)()},n.getLocalDNSIp=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.domain;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.getLocalDNSIp)(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.getNickName=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.getNickName)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.noLoginJoinConference=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.noLoginJoinConference)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.login=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.isResume,n=void 0!==r&&r,o=t.isTempLogin,s=void 0!==o&&o,u=t.desc,c=void 0===u?"":u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,L.login)(n,s,c);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.sipResume=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.forceInitRetryTime,n=void 0===r||r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,S.sipResume)(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.deleteLoginInfo=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.deleteLoginInfo)(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.showLoginInfo=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.loginInfo,n=t.loginHistoryList,o=t.loginRecordList;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.showLoginInfo)(r,n,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.checkUpgrade=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.isFirstIn,n=void 0!==r&&r,o=t.token,s=void 0===o?"":o,u=t.userAccount,c=void 0===u?"":u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,T.checkUpgrade)(n,s,c);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.publishStatus=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.status,n=t.desc,o=void 0===n?"":n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,N.publishStatus)(r,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.registerResumeEvent=function(){return(0,S.registerResumeEvent)()},n.clearResumeService=function(){return(0,S.clearResumeService)()},n.reStartUpgrade=function(){return(0,T.reStartUpgrade)()},n.checkAndEndCall=function(){return(0,R.checkAndEndCall)()},n.setOffline=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.cancelAutoLogin,n=void 0!==r&&r,o=t.shouldUninitDb,s=void 0!==o&&o,u=t.isShowAlert,c=void 0===u||u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,O.setOffline)(n,s,c);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.changeAutoLogin=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.changeAutoLogin)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.clearState=function(){return(0,O.clearState)()},n.meetinghwSipEnableToLogout=function(){return(0,S.meetinghwSipEnableToLogout)()},n.resetSipResumeFlag=function(){return(0,S.resetSipResumeFlag)()},n.actionRefreshToken=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,T.actionRefreshToken)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.initLoginInfo=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,L.initLoginInfo)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.recoverAppCache=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.recoverAppCache)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.resume=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.reloadTup,n=void 0!==r&&r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,S.resume)(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.stopSipRefresh=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.stopSipRefresh)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.startSipRefresh=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.startSipRefresh)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.updateCurUser=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.name;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,N.updateCurUser)(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.verificationCertificateLogic=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.url;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.verificationCertificateLogic)(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.initImportCertificate=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.initImportCertificate)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.setInitSelectCertificateLogic=function(e,t){return(0,C.setInitSelectCertificateLogic)(e,t)},n.dbInitCertificateLogic=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.dbInitCertificateLogic)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.recordPrivacy=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.oprEvent,n=t.privacyver,o=t.chrtype;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.recordPrivacy)(r,n,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.sipserverDeregister=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.sipserverDeregister)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.clearnsipinfo=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.clearnsipinfo)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.stopResume=function(){return(0,S.stopResume)()},n.logout=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.isBackLogin,n=void 0===r||r,o=t.isKickout,s=void 0!==o&&o,u=t.isClearLoginRecord,c=void 0===u||u,d=t.teModeMark,l=void 0!==d&&d;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,O.logout)(n,s,c,l);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.queryMediaXaddrFromServer=function(e){var t=e.uportalService,r=e.is_cms_addr;return(0,T.queryMediaXaddrFromServer)(t,r)},n.registerLoginEvent=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.registerLoginEvent)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.getResumeEnable=function(){return(0,S.getResumeEnable)()},n.updateTempSipNick=function(e){var t=e.name;return(0,A.updateTempSipNick)(t)},n.endCurrentCall=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,R.endCurrentCall)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.deRegisterService=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.shouldUninitDb,n=void 0===r||r,o=t.teModeMark,s=void 0!==o&&o;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,O.deRegisterService)(n,s);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.get=function(e){var t=e.key,r=e.isPublic;return(0,b.get)(t,r)},n.set=function(e){var t=e.key,r=e.value,n=e.isPublic;return(0,b.set)(t,r,n)},n.remove=function(e){var t=e.key,r=e.isPublic;return(0,b.remove)(t,r)},n.doLogin=function(){return(0,P.doLogin)()},n.setIsCACertCheckSupport=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,C.setIsCACertCheckSupport)(t));case 1:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.updateTempSipAccount=function(e){return(0,A.updateTempSipAccount)(e)},n.updateTempSipPwd=function(e){var t=e.data;return(0,A.updateTempSipPwd)(t)},n.setServerAddress=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.serverAddress,n=t.serverPort,o=t.middleEndAddress;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.setServerAddress)(r,n,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.buildStgTunnel=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.stgUri,n=t.stgAccount,o=t.stgPassword;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,T.buildStgTunnel)({stgUri:r,stgAccount:n,stgPassword:o});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.initVideoHardCodeParam=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.initVideoHardCodeParam)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.configBFCPForTLS=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.bForceTLSMode;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.configBFCPForTLS)(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.configRTP=function(){return(0,x.configRTP)()},n.initVideoSettingParam=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.initVideoSettingParam)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.configBFCP=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.configBFCP)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.doSipResumeAndEserverDetect=function(e){var t=e.message;return(0,S.doSipResumeAndEserverDetect)(t)},n.refreshIsMultiDeviceLogined=function(e){var t=e.bMultiDeviceLogined;return(0,k.refreshIsMultiDeviceLogined)(t)},n.handleMultiDeviceMsg=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,k.handleMultiDeviceMsg)(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setLocalStatus=function(e){var t=e.status,r=e.desc,n=void 0===r?"":r;return(0,N.setLocalStatus)(t,n)},n.getOAuthTicket=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,T.getOAuthTicket)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.unRegisterPush=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.isOperate;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,T.unRegisterPush)(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.configMKI=function(){return(0,x.configMKI)()},n.configSessionTimer=function(){return(0,x.configSessionTimer)()},n.configBandwidthLimit=function(){return(0,x.configBandwidthLimit)()},n.hideProgressBarModal=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,M.hideProgressBarModal)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.clickConfirmUpdate=function(){return(0,M.clickConfirmUpdate)()},n.inputValueChange=function(e){var t=e.type,r=e.event;return(0,U.inputValueChange)(t,r)},n.getErrorTips=function(e){var t=e.server,r=e.errorCode;return(0,D.getErrorTips)(t,r)},n.handleKickPcSuc=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,k.handleKickPcSuc)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.saveNickName=function(e){var t=e.data;return(0,A.saveNickName)(t)},n.iosCursorDeal=function(e){var t=e.event;return(0,G.iosCursorDeal)(t)},n.firstTimeLoginChangePassword=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.account,n=t.oldPassword,o=t.newPassword,s=t.serverAddress;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,T.firstTimeLoginChangePassword)(r,n,o,s));case 1:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setMSelectItLogic=function(e){var t=e.selectProve;return(0,C.setMSelectItLogic)(t)},n.clearImptZipUrlDataLogic=function(){return(0,C.clearImptZipUrlDataLogic)()},n.mobileImptProveLogic=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.pwd,n=t.mProveUrl,o=t.mkeysUrl;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.mobileImptProveLogic)(r,n,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setLoginInfo=function(e){return(0,C.setLoginInfo)(e)},n.openInAppBrowserMobile=function(e){var t=e.url,r=void 0===t?"":t,n=e.opts,o=void 0===n?"register":n;return(0,C.openInAppBrowserMobile)(r,o)},n.changeLoginInfo=function(e){return(0,C.changeLoginInfo)(e)},n.setTempMediaxInfo=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.setTempMediaxInfo)(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setProxyInfo=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.setProxyInfo)(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.selectAccount=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.selectAccount)(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.ipLogin=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,L.ipLogin)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.updateTempSipGetState=function(e){return(0,A.updateTempSipGetState)(e)},n.dealUpdateVersionClickEx=function(){return(0,M.dealUpdateVersionClickEx)()},n.clearBarPageSet=function(){return(0,M.clearBarPageSet)()},n.changeLoginPassword=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.account,n=t.oldPass,o=t.newPass,s=t.serverAddress;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,T.changeLoginPassword)(r,n,o,s);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.checkBeforeLogout=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.type,n=t.isLogout,o=void 0===n||n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,R.checkBeforeLogout)(r,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.SaveSigInfoAndQuit=function(e){return(0,F.SaveSigInfoAndQuit)(e)},n.initNetDetect=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,B.initNetDetect)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),n.getCaptchaAndSetUi=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.getCaptchaAndSetUi)(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setImportCertificate=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.setImportCertificate)(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.hideServerAddress=function(){return(0,C.hideServerAddress)()},n.getCloseAppWays=function(){var e=(0,s.default)(a.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,N.getCloseAppWays)(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(){return e.apply(this,arguments)}}(),n.setCertificateCheckLogic=function(e){return(0,C.setCertificateCheckLogic)(e)},n.getVerifyCodeAndSetUi=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.user,n=t.token;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.getVerifyCodeAndSetUi)(r,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.sendCaptchaResultAndSetUi=function(){var e=(0,s.default)(a.default.mark(function e(t){var r=t.user,n=t.token,o=t.pointX,s=t.slideTime,u=t.shadowImage,c=t.cutImage,d=t.oldPointY;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.sendCaptchaResultAndSetUi)(r,n,o,s,u,c,d);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.updateTempMediaxAddress=function(e){return(0,A.updateTempMediaxAddress)(e)},n.updateTempMediaxPort=function(e){return(0,A.updateTempMediaxPort)(e)},n.valueChange=function(e){var t=e.type,r=e.value;return(0,U.valueChange)(t,r)},n.addKeyDownListener=function(e){return(0,U.addKeyDownListener)(e)},n.isAccountAutoLogin=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.isAccountAutoLogin)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,i)})),o=r,(0,p.default)(n,o)}return(0,g.default)(t,e),t}(E.default))},177:function(e,t,r){e.exports={default:r(178),__esModule:!0}},1770:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=r(117),c=n(u),d=r(4),l=n(d),f=r(118),p=n(f),_=r(119),g=n(_),w=function(e){function t(){var e,r,n,o,i=this;(0,l.default)(this,t);for(var u=arguments.length,d=Array(u),f=0;f<u;f++)d[f]=arguments[f];return r=n=(0,p.default)(this,(e=t.__proto__||(0,c.default)(t)).call.apply(e,[this].concat(d))),n.initCallLog=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.getLoginModel=function(){},n.getMyInfo=function(){},n.getLocalDNSIp=function(){var e=(0,s.default)(a.default.mark(function e(t){t.domain;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.getNickName=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.noLoginJoinConference=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.login=function(){var e=(0,s.default)(a.default.mark(function e(t){t.isResume,t.isTempLogin,t.desc;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.sipResume=function(){var e=(0,s.default)(a.default.mark(function e(t){t.forceInitRetryTime;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.deleteLoginInfo=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.showLoginInfo=function(){var e=(0,s.default)(a.default.mark(function e(t){t.loginInfo,t.loginHistoryList,t.loginRecordList;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.checkUpgrade=function(){var e=(0,s.default)(a.default.mark(function e(t){t.isFirstIn,t.token,t.userAccount;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.publishStatus=function(){var e=(0,s.default)(a.default.mark(function e(t){t.status,t.desc;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.registerResumeEvent=function(){},n.clearResumeService=function(){},n.reStartUpgrade=function(){},n.checkAndEndCall=function(){},n.setOffline=function(){var e=(0,s.default)(a.default.mark(function e(t){t.cancelAutoLogin,t.shouldUninitDb,t.isShowAlert;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.changeAutoLogin=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.clearState=function(){},n.meetinghwSipEnableToLogout=function(){},n.resetSipResumeFlag=function(){},n.actionRefreshToken=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.initLoginInfo=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.recoverAppCache=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.resume=function(){var e=(0,s.default)(a.default.mark(function e(t){t.reloadTup;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.stopSipRefresh=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.startSipRefresh=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.updateCurUser=function(){var e=(0,s.default)(a.default.mark(function e(t){t.name;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.verificationCertificateLogic=function(){var e=(0,s.default)(a.default.mark(function e(t){t.url;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.initImportCertificate=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.setInitSelectCertificateLogic=function(e,t){},n.dbInitCertificateLogic=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.recordPrivacy=function(){var e=(0,s.default)(a.default.mark(function e(t){t.oprEvent,t.privacyver,t.chrtype;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.sipserverDeregister=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.clearnsipinfo=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.stopResume=function(){},n.logout=function(){var e=(0,s.default)(a.default.mark(function e(t){t.isBackLogin,t.isKickout,t.isClearLoginRecord,t.teModeMark;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.queryMediaXaddrFromServer=function(e){e.uportalService,e.is_cms_addr},n.registerLoginEvent=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.getResumeEnable=function(){},n.updateTempSipNick=function(e){e.name},n.endCurrentCall=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.deRegisterService=function(){var e=(0,s.default)(a.default.mark(function e(t){t.shouldUninitDb,t.teModeMark;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.get=function(e){e.key,e.isPublic},n.set=function(e){e.key,e.value,e.isPublic},n.remove=function(e){e.key,e.isPublic},n.doLogin=function(){},n.setIsCACertCheckSupport=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.updateTempSipAccount=function(e){},n.updateTempSipPwd=function(e){},n.setServerAddress=function(){var e=(0,s.default)(a.default.mark(function e(t){t.serverAddress,t.serverPort,t.middleEndAddress;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.buildStgTunnel=function(){var e=(0,s.default)(a.default.mark(function e(t){t.stgUri,t.stgAccount,t.stgPassword;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.initVideoHardCodeParam=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.configBFCPForTLS=function(){var e=(0,s.default)(a.default.mark(function e(t){t.bForceTLSMode;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.configRTP=function(){},n.initVideoSettingParam=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.configBFCP=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.doSipResumeAndEserverDetect=function(e){e.message},n.refreshIsMultiDeviceLogined=function(e){e.bMultiDeviceLogined},n.handleMultiDeviceMsg=function(){var e=(0,s.default)(a.default.mark(function e(t){t.data;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setLocalStatus=function(e){e.status,e.desc},n.getOAuthTicket=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.unRegisterPush=function(){var e=(0,s.default)(a.default.mark(function e(t){t.isOperate;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.configMKI=function(){},n.configSessionTimer=function(){},n.configBandwidthLimit=function(){},n.hideProgressBarModal=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.clickConfirmUpdate=function(){},n.inputValueChange=function(e){e.type,e.event},n.getErrorTips=function(e){e.server,e.errorCode},n.handleKickPcSuc=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.saveNickName=function(e){e.data},n.iosCursorDeal=function(e){e.event},n.firstTimeLoginChangePassword=function(){var e=(0,s.default)(a.default.mark(function e(t){t.account,t.oldPassword,t.newPassword,t.serverAddress;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setMSelectItLogic=function(e){e.selectProve},n.clearImptZipUrlDataLogic=function(){},n.mobileImptProveLogic=function(){var e=(0,s.default)(a.default.mark(function e(t){t.pwd,t.mProveUrl,t.mkeysUrl;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setLoginInfo=function(e){},n.openInAppBrowserMobile=function(e){e.url,e.opts},n.changeLoginInfo=function(e){},n.setTempMediaxInfo=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setProxyInfo=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.selectAccount=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.ipLogin=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.updateTempSipGetState=function(e){},n.dealUpdateVersionClickEx=function(){},n.clearBarPageSet=function(){},n.changeLoginPassword=function(){var e=(0,s.default)(a.default.mark(function e(t){t.account,t.oldPass,t.newPass,t.serverAddress;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.checkBeforeLogout=function(){var e=(0,s.default)(a.default.mark(function e(t){t.type,t.isLogout;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.SaveSigInfoAndQuit=function(e){},n.initNetDetect=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),n.getCaptchaAndSetUi=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.setImportCertificate=function(){var e=(0,s.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.hideServerAddress=function(){},n.getCloseAppWays=function(){var e=(0,s.default)(a.default.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(){return e.apply(this,arguments)}}(),n.setCertificateCheckLogic=function(e){},n.getVerifyCodeAndSetUi=function(){var e=(0,s.default)(a.default.mark(function e(t){t.user,t.token;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.sendCaptchaResultAndSetUi=function(){var e=(0,s.default)(a.default.mark(function e(t){t.user,t.token,t.pointX,t.slideTime,t.shadowImage,t.cutImage,t.oldPointY;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.updateTempMediaxAddress=function(e){},n.updateTempMediaxPort=function(e){},n.valueChange=function(e){e.type,e.value},n.addKeyDownListener=function(e){},n.isAccountAutoLogin=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),o=r,(0,p.default)(n,o)}return(0,g.default)(t,e),t}(coreCommon.Interface);t.default=w},178:function(e,t,r){r(23),r(22),e.exports=r(179)},179:function(e,t,r){var n=r(16),o=r(6)("iterator"),a=r(17);e.exports=r(8).isIterable=function(e){var t=Object(e);return void 0!==t[o]||"@@iterator"in t||a.hasOwnProperty(n(t))}},183:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.resetMyInfo=t.getMyInfo=t.UErrorCode=t.LoginInfo=t.LoginError=t.resetLoginModel=t.getLoginModel=t.ErrorType=t.EAErrorCode=t.registerLoginEvent=void 0;var o=r(309),a=n(o),i=r(794),s=n(i);t.registerLoginEvent=a.UErrorCode,t.EAErrorCode=a.EAErrorCode,t.ErrorType=a.ErrorType,t.getLoginModel=a.getLoginModel,t.resetLoginModel=a.resetLoginModel,t.LoginError=a.LoginError,t.LoginInfo=a.LoginInfo,t.UErrorCode=a.UErrorCode,t.getMyInfo=s.getMyInfo,t.resetMyInfo=s.resetMyInfo},205:function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},236:function(e,t,r){"use strict";function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function o(e){var t=n(e),r=t[0],o=t[1];return 3*(r+o)/4-o}function a(e,t,r){return 3*(t+r)/4-r}function i(e){for(var t,r=n(e),o=r[0],i=r[1],s=new f(a(e,o,i)),u=0,c=i>0?o-4:o,d=0;d<c;d+=4)t=l[e.charCodeAt(d)]<<18|l[e.charCodeAt(d+1)]<<12|l[e.charCodeAt(d+2)]<<6|l[e.charCodeAt(d+3)],s[u++]=t>>16&255,s[u++]=t>>8&255,s[u++]=255&t;return 2===i&&(t=l[e.charCodeAt(d)]<<2|l[e.charCodeAt(d+1)]>>4,s[u++]=255&t),1===i&&(t=l[e.charCodeAt(d)]<<10|l[e.charCodeAt(d+1)]<<4|l[e.charCodeAt(d+2)]>>2,s[u++]=t>>8&255,s[u++]=255&t),s}function s(e){return d[e>>18&63]+d[e>>12&63]+d[e>>6&63]+d[63&e]}function u(e,t,r){for(var n,o=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(s(n));return o.join("")}function c(e){for(var t,r=e.length,n=r%3,o=[],a=0,i=r-n;a<i;a+=16383)o.push(u(e,a,a+16383>i?i:a+16383));return 1===n?(t=e[r-1],o.push(d[t>>2]+d[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],o.push(d[t>>10]+d[t>>4&63]+d[t<<2&63]+"=")),o.join("")}t.byteLength=o,t.toByteArray=i,t.fromByteArray=c;for(var d=[],l=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_=0,g=p.length;_<g;++_)d[_]=p[_],l[p.charCodeAt(_)]=_;l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},237:function(e,t){t.read=function(e,t,r,n,o){var a,i,s=8*o-n-1,u=(1<<s)-1,c=u>>1,d=-7,l=r?o-1:0,f=r?-1:1,p=e[t+l];for(l+=f,a=p&(1<<-d)-1,p>>=-d,d+=s;d>0;a=256*a+e[t+l],l+=f,d-=8);for(i=a&(1<<-d)-1,a>>=-d,d+=n;d>0;i=256*i+e[t+l],l+=f,d-=8);if(0===a)a=1-c;else{if(a===u)return i?NaN:1/0*(p?-1:1);i+=Math.pow(2,n),a-=c}return(p?-1:1)*i*Math.pow(2,a-n)},t.write=function(e,t,r,n,o,a){var i,s,u,c=8*a-o-1,d=(1<<c)-1,l=d>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:a-1,_=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,i=d):(i=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-i))<1&&(i--,u*=2),t+=i+l>=1?f/u:f*Math.pow(2,1-l),t*u>=2&&(i++,u/=2),i+l>=d?(s=0,i=d):i+l>=1?(s=(t*u-1)*Math.pow(2,o),i+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,o),i=0));o>=8;e[r+p]=255&s,p+=_,s/=256,o-=8);for(i=i<<o|s,c+=o;c>0;e[r+p]=255&i,p+=_,i/=256,c-=8);e[r+p-_]|=128*g}},283:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){window.InAppBrowserRef.executeScript({code:'document.body.style.overflow="hidden"'}),/.*inappbrowserref_close_url.*/.test(e.url)&&(m.info("openInAppBrowserMobile close_url"),window.InAppBrowserRef.close(),window.InAppBrowserRef.removeEventListener("loadstop",s),window.InAppBrowserRef.removeEventListener("loaderror",i)),/.*inappbrowserref_success_url.*/.test(e.url)&&(window.InAppBrowserRef.close(),window.alertRegisterSuccess("REGISTER_TITLE"),m.info("register account success"),window.InAppBrowserRef.close(),window.InAppBrowserRef.removeEventListener("loadstop",s),window.InAppBrowserRef.removeEventListener("loaderror",i))}function a(e){window.InAppBrowserRef.executeScript({code:'document.body.style.overflow="hidden"'}),/.*inappbrowserref_close_url.*/.test(e.url)&&(m.info("openInAppBrowserMobile close_url"),window.InAppBrowserRef.close(),window.InAppBrowserRef.removeEventListener("loadstop",s),window.InAppBrowserRef.removeEventListener("loaderror",i)),/.*inappbrowserref_success_url.*/.test(e.url)&&(window.InAppBrowserRef.close(),window.ToastNew(language.CHANGE_PASSWORD_SUCCESS_FIRST,2),m.info("change [password] success"),window.InAppBrowserRef.close(),window.InAppBrowserRef.removeEventListener("loadstop",s),window.InAppBrowserRef.removeEventListener("loaderror",i))}function i(){S({loadPwd:!1}),alert(language.LOGIN_RESUME_NETWORK_ERROR),m.info("openInAppBrowserMobile loaderror"),window.InAppBrowserRef.removeEventListener("loadstop",s),window.InAppBrowserRef.removeEventListener("loaderror",i),window.InAppBrowserRef.close()}function s(){window.InAppBrowserRef.show(),window.setTimeout(function(){return S({loadPwd:!1})},500),clearTimeout(window.openBrowerTimer)}Object.defineProperty(t,"__esModule",{value:!0}),t.initPcFirstPage=t.isAccountAutoLogin=t.isInLoginRecordList=t.initMImportCertificate=t.clearImptZipUrlDataLogic=t.cancelImpSelectDone=t.mobileImptProveLogic=t.setMSelectItLogic=t.setMProveNameAndSelectItLogic=t.setMSaveZipUrlLogic=t.setMProveAndKeyLogic=t.probeImportCertificateLogic=t.loginforverificationCertificateLogic=t.dbInitCertificateLogic=t.verificationCertificateLogic=t.setInitSelectCertificateLogic=t.initImportCertificate=t.setImportCertificate=t.setCertificateCheckLogic=t.saveSelectCertificateNameLogic=t.saveBeforeLogic=t.saveImportCertificateLogic=t.clearSelectCertificateOrkeysLogic=t.updateKeysUrlLogic=t.updateCertificateUrlLogic=t.uploadCertificateFile=t.hideImportCertificateModal=t.showImportCertificateContact=t.changeAutoLogin=t.deleteLoginPwd=t.deleteLoginInfo=t.setProxyInfo=t.setTempProxyInfo=t.setTempMediaxInfo=t.setServerAddress=t.setIsCACertCheckSupport=t.changeLoginInfo=t.renewFolderState=t.deleteLoginPWD=t.setLoginInfo=t.settingPageSetLoginRecord=t.setLoginRecord=t.openInAppBrowserMobile=t.cannotLoginMobile=t.cannotLogin=t.selectAccount=t.loadLoginSetting=t.initLoginStateFromConsole=t.showLoginInfo=t.loadLoginRecordList=t.hideServerAddress=t.showServerAddress=void 0;var u=r(134),c=n(u),d=r(121),l=n(d),f=r(1),p=n(f),_=r(3),g=n(_),w=r(2),E=n(w),v=r(116),I=(n(v),r(353)),h=r(710),m=window.Logger("logic")("loginset"),L=(t.showServerAddress=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];m.info("userClick setAddressAndPort menu"),$dispatch(coreUi.showModal(e,t))},t.hideServerAddress=function(){window.Logger("Click")("ServerAddress").info("userClick cancel ServerAddress setting"),k(),window.goRoute("login")},t.loadLoginRecordList=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE||!window.isLoadLoginRecord){e.next=3;break}return!0===window.ifLogOut&&!0===window.isConfLogOut&&N(),e.abrupt("return",g.default.resolve(!1));case 3:return e.next=5,coreDb.queryAllLoginRecord();case 5:if(t=e.sent,0!==t.length){e.next=8;break}return e.abrupt("return");case 8:return r=[],t.forEach(function(e){var t=e.display_account;r.push(t)}),n=t[0].isAutoLogin,e.next=13,L(t[0],r,t);case 13:return window.isLoadLoginRecord=!0,e.abrupt("return",n);case 15:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.showLoginInfo=function(){var e=(0,E.default)(p.default.mark(function e(t,r,n){var o,a,i,s,u,c,d,f,_,g,w;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,I.getLoginModel)(),a=t.display_account,i=t.account,s=t.tenantid,u=t.encryptPassword,c=t.strUserRandom,d=t.isRememberPassWord,f=t.isAutoLogin,e.next=4,coreSecurity.decrypt(u,c);case 4:return _=e.sent,o.password=_,g={displayAccount:a,account:i,tenantid:s,isRememberPassword:d,isAutoLogin:f,strUserRandom:c,encryptPassword:u},r&&(g.loginHistoryList=r),n&&(g.loginRecordList=n),w=isNullOrEmpty(_),(0,l.default)(g,{showPwd:w}),e.next=13,S(g);case 13:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()),C=t.initLoginStateFromConsole=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r,n,o,a,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCommon.getConsoleUrlVars();case 2:if(t=e.sent,isNullOrEmpty(t)){e.next=12;break}if(r=t.page,isNullOrEmpty(r)||"login"!==r){e.next=12;break}return n=t.account,o=t.serverAddress,a=parseInt(t.serverPort),i={displayAccount:n,serverAddress:o,serverPort:a},(0,I.getLoginModel)().set(i),e.abrupt("return",{serverAddress:o,serverPort:a});case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),T=(t.loadLoginSetting=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r,n,o,a,i,s,u,c,d,l,f,_,g,w,E,v,I,h,L,T,N,R,O,y,A,b,P,x,k,M,U,D,G;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,r=void 0,n=void 0,o=void 0,a=void 0,i=void 0,e.next=3,C();case 3:return s=e.sent,e.next=6,coreCommon.getSystemProxySetting();case 6:if(u=e.sent,isNullOrEmpty(s)){e.next=13;break}t=s.serverAddress,r=s.middleEndAddress||window.SERVERCONFIG.MIDDLE_END_ADDRESS,n=s.serverPort,e.next=64;break;case 13:return e.next=15,coreDb.queryAllLoginSetting();case 15:if(c=e.sent,d=c.find(function(e){return"serverAddress"===e.key}),l=c.find(function(e){return"middleEndAddress"===e.key}),f=c.find(function(e){return"serverPort"===e.key}),t=d?d.value:window.SERVERCONFIG.LOGIN_ADDRESS,r=l?l.value:window.SERVERCONFIG.MIDDLE_END_ADDRESS,n=d?f.value:window.SERVERCONFIG.LOGIN_PORT,_=c.find(function(e){return"tempMediaxAddress"===e.key}),g=c.find(function(e){return"tempMediaxPort"===e.key}),o=_?_.value:window.CLIENTCONFIG.TEMP_MEDIAX_ADDRESS,a=g?g.value:window.CLIENTCONFIG.TEMP_MEDIAX_PORT,w=c.find(function(e){return"lastDeployMode"===e.key}),i=w?parseInt(w.value):0,S({serverAddress:t,middleEndAddress:r,serverPort:n,tempMediaxAddress:o,tempMediaxPort:a,lastDeployMode:i}),E=void 0,v=void 0,I=void 0,h=void 0,L=void 0,T=void 0,N=void 0,R=void 0,O=c.find(function(e){return"isSupportProxy"===e.key}),y=c.find(function(e){return"isUseSysProxy"===e.key}),A=c.find(function(e){return"proxyAddress"===e.key}),b=c.find(function(e){return"proxyPort"===e.key}),P=c.find(function(e){return"proxyAccount"===e.key}),x=c.find(function(e){return"proxyPassword"===e.key}),k=c.find(function(e){return"prxoyRandom"===e.key}),E=O?O.value:"0",v=y?y.value:"0",I=A?A.value:"",h=b?b.value:"",L=P?P.value:"",T=x?x.value:"",N=k?k.value:"",M=c.find(function(e){return"isSupportCACertCheck"===e.key}),U=M?M.value:"1",m.info("loadLoginSetting [decrypt]"),""===T){e.next=52;break}return D=coreSecurity.PasswordManager.setCipherPassword("proxyPassword",T,N),e.next=51,D.decryptPassword();case 51:T=e.sent;case 52:if(m.info("loadLoginSetting end [decrypt]"),m.info("systemProxySetting111: "),m.info("isUseSysProxyValue: ",v),"1"!==E||"1"!==v||isNullOrEmpty(u)){e.next=63;break}return I=u.proxyServer,h=u.proxyPort,E="1",v="1",G=[{key:"proxyAddress",value:I},{key:"proxyPort",value:h},{key:"isSupportProxy",value:E},{key:"isUseSysProxy",value:v}],e.next=63,coreDb.saveLoginSetting(G);case 63:S({isSupportProxy:"1"===E,isUseSysProxy:"1"===v,proxyAddress:I,proxyPort:h,sysProxyAddress:isNullOrEmpty(u)?"":u.proxyServer,sysProxyPort:isNullOrEmpty(u)?"":u.proxyPort,proxyAccount:L,isSupportCACertCheck:"1"===U});case 64:window.SERVERCONFIG.MIDDLE_END_ADDRESS=r,window.SERVERCONFIG.LOGIN_ADDRESS=t,window.SERVERCONFIG.LOGIN_PORT=n,window.CLIENTCONFIG.TEMP_MEDIAX_ADDRESS=o,window.CLIENTCONFIG.TEMP_MEDIAX_PORT=a,window.SERVERCONFIG.HWUC=0;case 70:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.selectAccount=function(){var e=(0,E.default)(p.default.mark(function e(t){var r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryLoginRecord({display_account:t});case 2:return r=e.sent,e.next=5,L(r);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.cannotLogin=function(e){m.info("login click forgetbutton ,open uportal from browser.");var t=1036===window.langcode?"fr_FR":1033===window.langcode?"en_US":"zh_CN",r="https://"+e+"/portal/forgetPassword.sraction?language="+t;appService.openUrl(r)},t.cannotLoginMobile=function(e){if(m.info("login click forgetbutton ,open uportal from browser.",e.substr(0,5)+"******"+e.substr(-2)),window.offline)m.info("open browser error,network is unreachable"),alert(language.LOGIN_RESUME_NETWORK_ERROR,"PROMPT");else{var t=e.split(":"),r="",n=coreCommon.sha512(t[0].toLowerCase());if(n===constant.SERVER_ADDRESS_SHA512.ACLOUDEC||n===constant.SERVER_ADDRESS_SHA512.AHMEETING||n===constant.SERVER_ADDRESS_SHA512.BCLOUDEC||n===constant.SERVER_ADDRESS_SHA512.CLOUDEC){var o=t[0].substr(0,1),a=t[0].substr(t[0].indexOf(".")+1);r="b"===o?"https://bmeetingshow."+a+"/password.html":"a"===o?"https://ameetingshow."+a+"/password.html":"https://meetingshow."+a+"/password.html"}else r="1036"===window.langcode?"https://"+e+"/uPortal/portal/forgetPassword.sraction?language=fr_FR":"2052"===window.langcode?"https://"+e+"/uPortal/portal/forgetPassword.sraction?language=zh_CN":"https://"+e+"/uPortal/portal/forgetPassword.sraction?language=en_US";m.info("url="+r.substr(0,20)),window.InAppBrowserRef=cordova.InAppBrowser.open(r,"_blank","location=no,useWideViewPort=no,toolbar=no"),window.InAppBrowserRef.addEventListener("loadstart",function(e){window.InAppBrowserRef.executeScript({code:'document.body.style.overflow="hidden"'}),/.*inappbrowserref_close_url.*/.test(e.url)&&(m.info("change [password] close_url"),(0,I.getLoginModel)().loadPwd=!1,window.InAppBrowserRef.close(),window.InAppBrowserRef.removeEventListener("loadstart"),window.InAppBrowserRef.removeEventListener("loaderror")),/.*inappbrowserref_success_url.*/.test(e.url)&&(window.InAppBrowserRef.close(),window.ToastNew(language.CHANGE_PASSWORD_SUCCESS_FIRST,2),m.info("change [password] success"),window.InAppBrowserRef.close(),window.InAppBrowserRef.removeEventListener("loadstart"),window.InAppBrowserRef.removeEventListener("loaderror"))}),window.InAppBrowserRef.addEventListener("loaderror",function(){m.info("change [password] loaderror"),window.InAppBrowserRef.close(),window.InAppBrowserRef.removeEventListener("loadstart"),window.InAppBrowserRef.removeEventListener("loaderror")})}setTimeout(function(){(0,I.getLoginModel)().loadPwd=!1},2e3),m.info("open uportal from browser over")},t.openInAppBrowserMobile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"register";void 0!==window.openBrowerTimer&&clearTimeout(window.openBrowerTimer),window.openBrowerTimer=setTimeout(function(){S({loadPwd:!1}),window.InAppBrowserRef&&window.InAppBrowserRef.close(),alert(language.LOGIN_RESUME_NETWORK_ERROR)},1e4),m.info("openInAppBrowserMobile url="+e.substr(0,20)),window.offline?(m.info("openInAppBrowserMobile,network is unreachable"),alert(language.LOGIN_RESUME_NETWORK_ERROR)):(window.InAppBrowserRef=cordova.InAppBrowser.open(e,"_blank","location=no,zoom=no,useWideViewPort=no,toolbar=no,hidden=yes"),"register"===t?window.InAppBrowserRef.addEventListener("loadstart",o):"fogetPassword"===t&&window.InAppBrowserRef.addEventListener("loadstart",a),window.InAppBrowserRef.addEventListener("loadstop",s),window.InAppBrowserRef.addEventListener("loaderror",i)),m.info("openInAppBrowserMobile over")},t.setLoginRecord=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r,n,o,a,i,s,u,c,d,f,_,g,w,E,v,h,m;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,I.getLoginModel)(),r=t.displayAccount,n=t.account,o=t.tenantid,a=t.isRememberPassword,i=t.isAutoLogin,s=t.serverAddress,u=t.serverPort,c=t.deployMode,d=t.loginRecordList,e.next=3,coreSecurity.PasswordManager.getPassword("password");case 3:if(f=e.sent,_=void 0,g=void 0,!(a=a||window.CLIENTCONFIG.ISMOBILE)){e.next=12;break}return e.next=9,coreSecurity.saveUserWithCrypt({strUserPwd:f,strAccount:n});case 9:w=e.sent,_=w.res,g=w.realRandom;case 12:return E={},d.forEach(function(e){e.tenantid!==o||isNullOrEmpty(o)||(E=e)}),v={display_account:r,account:n,tenantcn:E.tenantcn||"",tenanten:E.tenanten||"",tenantid:o,thirdcertype:E.thirdcertype||!1,encryptPassword:a?_:"",strUserRandom:a?g:"",isRememberPassWord:a,isAutoLogin:i,time_stamp:(new Date).getTime()},e.next=17,coreDb.queryLoginRecord({account:n});case 17:if(h=e.sent,isNullOrEmpty(E.account)||E.account===n){e.next=21;break}return e.next=21,coreDb.deleteLoginRecord({account:E.account});case 21:return e.next=23,coreDb.saveLoginRecord((0,l.default)(h,v));case 23:return m=[{key:"serverAddress",value:s},{key:"serverPort",value:u},{key:"lastDeployMode",value:c}],e.next=26,coreDb.saveLoginSetting(m);case 26:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}());t.settingPageSetLoginRecord=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r,n,o,a,i,s,u,c,d;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,I.getLoginModel)(),r=t.account,n=t.isRememberPassword,o=t.isAutoLogin,e.next=3,coreSecurity.PasswordManager.getPassword("password");case 3:if(a=e.sent,i=void 0,s=void 0,!n){e.next=11;break}return e.next=8,coreSecurity.saveUserWithCrypt({strUserPwd:a,strAccount:r});case 8:u=e.sent,i=u.res,s=u.realRandom;case 11:return c={encryptPassword:n?i:"",strUserRandom:n?s:"",isRememberPassWord:n,isAutoLogin:o,time_stamp:(new Date).getTime()},e.next=14,coreDb.queryLoginRecord({account:r});case 14:return d=e.sent,e.next=17,coreDb.saveLoginRecord((0,l.default)(d,c));case 17:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();window.saveLoginRecord=function(){T(),window.stroage.setFastLogin(!0)};var S=t.setLoginInfo=function(e){(0,I.getLoginModel)().set(e)};t.deleteLoginPWD=function(e){e={password:""},(0,I.getLoginModel)().set(e)},t.renewFolderState=function(e){(0,I.getLoginModel)().set(e)},t.changeLoginInfo=function(e){var t=(0,I.getLoginModel)(),r=e,n=r.displayAccount,o=r.isAutoLogin,a=r.isRememberPassword,i=(0,I.getLoginModel)(),s=i.displayAccount,u=i.loginHistoryList,c=i.isRememberPassword,d=(0,I.getLoginModel)(),f=d.showPwd;if(void 0===n&&!1===f&&void 0===o&&void 0===a&&(""===t.password||""===s&&""!==e.password)){(0,l.default)(e,{showPwd:!0})}if(void 0!==n&&n!==s){if(u.findIndex(function(e){return e===n})>-1)return e={displayAccount:n,account:window.SERVERCONFIG.HWUC?n.toLowerCase():n},void S(e);e={displayAccount:n,account:window.SERVERCONFIG.HWUC?n.toLowerCase():n,password:"",isRememberPassword:"",isAutoLogin:"",showPwd:""!==n},t.password=""}else o?e.isRememberPassword=!0:a||void 0===a||c===a||(e.isAutoLogin=!1);delete e.password,S(e)},t.setIsCACertCheckSupport=function(){var e=(0,E.default)(p.default.mark(function e(t){var r,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.isSupportCACertCheck,n=[{key:"isSupportCACertCheck",value:r?"1":"0"}],e.next=4,coreDb.bulkPutLoginSetting(n,"key");case 4:S({isSupportCACertCheck:r});case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();window.updateSystemProxy=function(e){if(!isNullOrEmpty(e)){var t=void 0;t="mac"===window.CLIENTCONFIG.PLATFORM?e.split("\n"):e.split(":");var r=void 0,n=void 0;isNullOrEmpty(t)||(t.length>=2?(r=t[0],n=t[1]):1===t.length?(r=t[1],n=""):(r="",n=""),S({sysProxyAddress:r,sysProxyPort:n}))}};var N=(t.setServerAddress=function(){var e=(0,E.default)(p.default.mark(function e(t,r,n){var o,a,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,I.getLoginModel)(),o.serverAddress===t&&o.serverPort===r&&o.middleEndAddress===n||(m.info("entity.isReqAddrChanged in"),o.isReqAddrChanged=!0),a=[],i={},isNullOrEmpty(t)||(a.push({key:"serverAddress",value:t}),i.serverAddress=t),isNullOrEmpty(r)||(a.push({key:"serverPort",value:r}),i.serverPort=r),isNullOrEmpty(n)||(a.push({key:"middleEndAddress",value:n}),i.middleEndAddress=n),e.next=9,coreDb.bulkPutLoginSetting(a,"key");case 9:S(i),window.SERVERCONFIG.MIDDLE_END_ADDRESS=n||window.SERVERCONFIG.MIDDLE_END_ADDRESS,window.SERVERCONFIG.LOGIN_ADDRESS=t,window.SERVERCONFIG.LOGIN_PORT=r,window.SERVERCONFIG.HWUC=0,coreCommon.sha512(t)===constant.SERVER_ADDRESS_SHA512.HWUC?window.SERVERCONFIG.HWUC=1:window.SERVERCONFIG.HWUC=0;case 15:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),t.setTempMediaxInfo=function(){var e=(0,E.default)(p.default.mark(function e(t){var r,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.tempMediaxAddress,n=t.tempMediaxPort,S({tempMediaxAddress:r,tempMediaxPort:n}),window.CLIENTCONFIG.TEMP_MEDIAX_ADDRESS=r,window.CLIENTCONFIG.TEMP_MEDIAX_PORT=n,coreConf.saveTempMediaxInfo();case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setTempProxyInfo=function(){var e=(0,E.default)(p.default.mark(function e(t){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:S({proxyAddress:t.proxyAddress,proxyPort:t.proxyPort});case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setProxyInfo=function(){var e=(0,E.default)(p.default.mark(function e(t){var r,n,o,a,i,s,u,c,d,l;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.isSupportProxy,n=t.isUseSysProxy,o=t.proxyAddress,a=t.proxyPort,i=t.proxyAccount,s=t.proxyPassword,e.next=3,coreSecurity.PasswordManager.getPassword("proxyPassword");case 3:return u=e.sent,e.next=6,coreSecurity.PasswordManager.setPassword("proxyPassword",s);case 6:return c=e.sent,d=(0,I.getLoginModel)(),d.isSupportProxy===r&&d.proxyAddress===o&&d.proxyPort===a&&d.proxyAccount===i&&u===s||(m.info("entity.isReqAddrChanged in here"),d.isReqAddrChanged=!0),l=[{key:"isSupportProxy",value:r?"1":"0"},{key:"isUseSysProxy",value:n?"1":"0"},{key:"proxyAddress",value:o},{key:"proxyPort",value:a},{key:"proxyAccount",value:i},{key:"proxyPassword",value:c.cipher},{key:"prxoyRandom",value:c.salt}],e.next=12,coreDb.bulkPutLoginSetting(l,"key");case 12:S({isSupportProxy:r,isUseSysProxy:n,proxyAddress:o,proxyPort:a,proxyAccount:i});case 13:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.deleteLoginInfo=function(){var e=(0,E.default)(p.default.mark(function e(t){var r,n,o,a,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.deleteLoginRecord({account:t});case 2:if(r=(0,I.getLoginModel)(),n=r.account,o=r.loginHistoryList,a=r.loginRecordList,i=o.findIndex(function(e){return e===t}),o.splice(i,1),i=a.findIndex(function(e){return e.account===t}),a.splice(i,1),n!==t){e.next=10;break}return e.next=10,S({tenantid:"",displayAccount:"",account:"",password:"",isRememberPassword:"",isAutoLogin:""});case 10:return e.next=12,coreDb.uninitSQliteDB();case 12:return coreDb.initPublicDbAtomic.reset(),e.next=15,appService.deleteUserDir(t);case 15:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.deleteLoginPwd=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r,n,o,a,i,s,u,c,d,f,_,g,w,E;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryAllLoginRecord();case 2:if(t=e.sent,m.info("删除记录"),0!==t.length){e.next=6;break}return e.abrupt("return");case 6:return r=[],t.forEach(function(e){var t=e.display_account;r.push(t)}),n=t[0],o=n.display_account,a=n.account,i=n.tenantid,s="",u=!1,c=!1,d={display_account:o,account:a,tenantid:i,encryptPassword:"",strUserRandom:"",isRememberPassWord:u,isAutoLogin:c,time_stamp:(new Date).getTime()},e.next=15,coreDb.queryLoginRecord({account:a});case 15:return f=e.sent,e.next=18,coreDb.saveLoginRecord((0,l.default)(f,d));case 18:return e.next=20,coreDb.queryAllLoginRecord();case 20:if(_=e.sent,0!==_.length){e.next=23;break}return e.abrupt("return");case 23:return g=[],_.forEach(function(e){var t=e.display_account;g.push(t)}),w={displayAccount:o,account:a,password:s,loginHistoryList:g,isRememberPassword:u,isAutoLogin:c},window.ifLogOut=!1,E=(0,I.getLoginModel)(),E.password="",e.next=31,S(w);case 31:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),R=(t.changeAutoLogin=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r,n,o,a,i,s,u,c,d,f,_,g,w,E,v;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryAllLoginRecord();case 2:if(t=e.sent,0!==t.length){e.next=5;break}return e.abrupt("return");case 5:return r=[],t.forEach(function(e){var t=e.display_account;r.push(t)}),n=t[0],o=n.display_account,a=n.account,i=n.tenantid,s=n.encryptPassword,u=n.strUserRandom,c=n.isRememberPassWord,d=n.isAutoLogin,m.info("取消自动登录"),f=!1,_={display_account:o,account:a,tenantid:i,encryptPassword:"",strUserRandom:u,isRememberPassWord:!1,isAutoLogin:f,time_stamp:(new Date).getTime()},e.next=13,coreDb.queryLoginRecord({account:a});case 13:return g=e.sent,e.next=16,coreDb.saveLoginRecord((0,l.default)(g,_));case 16:return e.next=18,coreDb.queryAllLoginRecord();case 18:if(w=e.sent,0!==w.length){e.next=21;break}return e.abrupt("return");case 21:return E=[],w.forEach(function(e){var t=e.display_account;E.push(t)}),v={displayAccount:o,account:a,password:"",loginHistoryList:E,isRememberPassword:c,isAutoLogin:f,status:void 0},window.ifLogOut=!1,coreSecurity.PasswordManager.setPassword("password",""),e.next=28,S(v);case 28:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.showImportCertificateContact=function(){var e=(0,E.default)(p.default.mark(function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:m.info("userClick showImportCertificateContact menu"),$dispatch(coreUi.showModal(t,r));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.hideImportCertificateModal=function(){var e=(0,E.default)(p.default.mark(function e(){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:m.info("userClick hideImportCertificateModal menu"),coreUi.hideModal();case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),O=(t.uploadCertificateFile=function(e){m.info("uploadCertificateFile 选择证书上传");var t={};t.properties=["openFile"];try{window.electron.remote.dialog.showOpenDialog(t,function(t){if(!isNullOrEmpty(t)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=(0,c.default)(t);!(n=(i=s.next()).done);n=!0){var u=i.value;r.push(u)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}e===constant.IMPORT_CERTIFICATE_TYPE.CERTIFICATE_TYPE?O(1===r.length&&r[0]||[]):e===constant.IMPORT_CERTIFICATE_TYPE.KEYS_TYPE&&y(1===r.length&&r[0]||[])}})}catch(e){m.error("uploadCertificateFile",e.toString())}},t.updateCertificateUrlLogic=function(e){(0,I.getLoginModel)().certificateUrl=e}),y=t.updateKeysUrlLogic=function(e){(0,I.getLoginModel)().keysUrl=e},A=t.clearSelectCertificateOrkeysLogic=function(){(0,I.getLoginModel)().certificateUrl="",(0,I.getLoginModel)().keysUrl=""},b=(t.saveImportCertificateLogic=function(){var e=(0,E.default)(p.default.mark(function e(t,r,n){var o,a,i,s,u,c,d,l,f,_,g,w,E;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m.info("saveImportCertificateLogic 导入证书"),e.prev=1,o=window.fs,a=window.path,i="",s="",u="",c="",a&&(i=a.win32.basename(t),s=a.win32.basename(r)),""!==i&&""!==s){e.next=9;break}return alert(language.CERTIFICATE_NAME_OR_KEY_NAME_CANNOT_BE_NULL),e.abrupt("return",!1);case 9:if(u=a.extname(i),c=a.extname(s),".pem"===u&&".pem"===c){e.next=14;break}return alert(language.ILLEGAL_CERTIFICATE_FORMAT_PLEASE_RESELECT),e.abrupt("return",!1);case 14:return e.next=16,U(t);case 16:if(d=e.sent){e.next=20;break}return alert(language.INCORRECT_OR_INVALID_CERTIFICATE),e.abrupt("return",!1);case 20:if(!o){e.next=34;break}return l=APP_DATA_PATH+"/ImpBfcpTLS",f=l+"/"+i,_=l+"/"+s,g=l+"/p4bfcp.txt",o.existsSync(l)?(w=o.readdirSync(l),w.forEach(function(e){o.unlinkSync(l+"/"+e)})):o.mkdirSync(l),e.next=28,b(t,f);case 28:return e.next=30,b(r,_);case 30:return e.next=32,coreSecurity.encryptKMC(n);case 32:E=e.sent,0===E.result&&o.writeFile(g,E.param.CiperText,function(e){if(e)throw e});case 34:return e.abrupt("return",!0);case 37:e.prev=37,e.t0=e.catch(1),m.error("saveImportCertificateLogic",e.t0.toString());case 40:case"end":return e.stop()}},e,void 0,[[1,37]])}));return function(t,r,n){return e.apply(this,arguments)}}(),function(){var e=(0,E.default)(p.default.mark(function e(t,r){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:m.info("readeContentToWriteFile 开始读写");try{fs.readFile(t,function(e,t){if(e)throw e;fs.writeFile(r,t,function(e){if(e)throw e})})}catch(e){m.error("readeContentToWriteFile",e.toString())}case 2:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}()),P=(t.saveBeforeLogic=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r,n,o,a,i,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=arguments[2];return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t=window.fs,r=window.path,n="",o="",a="p4bfcp.txt",r&&(n=r.win32.basename(s),o=r.win32.basename(u)),t&&(i=APP_DATA_PATH+"/ImpBfcpTLS",t.readdir(i,function(e,t){t.includes(n)&&t.includes(o)&&t.includes(a)?window.alert(language.IMPORT_DEVICE_CERTIFICATE_SUCCESSFULLY).then(function(e){e.ret&&(A(),c.value="",R(),P(n),x(!1))}):window.alert(language.FAILED_IMPORT_DEVICE_CERTIFICATE_PLEASE_RE_IMPORT).then(function(e){e.ret&&(A(),c.value="")})}))}catch(e){m.error("saveBeforeLogic",e.toString())}case 1:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.saveSelectCertificateNameLogic=function(e){m.info("saveSelectCertificateNameLogic",e),(0,I.getLoginModel)().certificateName=e}),x=t.setCertificateCheckLogic=function(e){m.info("setCertificateCheckLogic",e),(0,I.getLoginModel)().selectCertificate=e},k=(t.setImportCertificate=function(){var e=(0,E.default)(p.default.mark(function e(t){var r,n,o,a,i,s,u,c;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.info("setImportCertificate"),r=t.selectCertificate,n=t.certificateName,e.next=4,coreDb.queryLoginSetting({key:"importCertificate"});case 4:return o=e.sent,e.next=7,coreDb.queryLoginSetting({key:"certificateName"});case 7:if(a=e.sent,"{}"===o&&(o=null),"{}"===a&&(a=null),isNullOrEmpty(o)||isNullOrEmpty(a)){e.next=24;break}if(a.value===n){e.next=16;break}return i=[{key:"certificateName",value:n}],e.next=15,coreDb.saveLoginSetting(i);case 15:P(n);case 16:if((s="true"===o.value)===r){e.next=22;break}return u=[{key:"importCertificate",value:r}],e.next=21,coreDb.saveLoginSetting(u);case 21:x(r);case 22:e.next=28;break;case 24:return c=[{key:"importCertificate",value:r},{key:"certificateName",value:n}],e.next=27,coreDb.saveLoginSetting(c);case 27:M(r,n);case 28:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.initImportCertificate=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.info("initImportCertificate"),e.prev=1,e.next=4,coreDb.queryLoginSetting({key:"importCertificate"});case 4:return t=e.sent,e.next=7,coreDb.queryLoginSetting({key:"certificateName"});case 7:r=e.sent,m.debug("initImportCertificate",t,r),"{}"===t&&(t=null),"{}"===r&&(r=null),m.debug("new initImportCertificate",t,r),isNullOrEmpty(t)||isNullOrEmpty(r)||""!==r.value&&M("true"===t.value,r.value),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),m.error("initImportCertificate",e.t0.toString());case 18:case"end":return e.stop()}},e,void 0,[[1,15]])}));return function(){return e.apply(this,arguments)}}()),M=t.setInitSelectCertificateLogic=function(e,t){m.info("setInitSelectCertificateLogic"),(0,I.getLoginModel)().selectCertificate=e,(0,I.getLoginModel)().certificateName=t},U=t.verificationCertificateLogic=function(){var e=(0,E.default)(p.default.mark(function e(t){var r,n,o,a,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.info("verificationCertificateLogic"),e.prev=1,e.next=4,(0,h.verifyCertificate)(t);case 4:if(r=e.sent,0===r.result){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,(0,h.checkCertificateOverdue)(t);case 11:if(n=e.sent,o=n.param&&n.param.expire_time,a=o.ulUTCSec+"000",i=(new Date).getTime,!(0===n.result&&i-a>0)){e.next=17;break}return e.abrupt("return",!1);case 17:return e.abrupt("return",!0);case 20:e.prev=20,e.t0=e.catch(1),m.error("verificationCertificateLogic",e.t0.toString());case 23:case"end":return e.stop()}},e,void 0,[[1,20]])}));return function(t){return e.apply(this,arguments)}}(),D=t.dbInitCertificateLogic=function(){var e=(0,E.default)(p.default.mark(function e(){var t;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.info("dbInitCertificateLogic"),t=[{key:"importCertificate",value:""},{key:"certificateName",value:""}],e.next=4,coreDb.saveLoginSetting(t);case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();t.loginforverificationCertificateLogic=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r,n,o,a,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m.info("loginforverificationCertificateLogic"),e.prev=1,t=window.fs,r=!0,!t){e.next=22;break}if(n=APP_DATA_PATH+"/ImpBfcpTLS",o=n+"/server.pem",t.existsSync(n)){e.next=12;break}m.debug("用户文档下没有了设备证书目录"),r=!1,e.next=22;break;case 12:if(a=t.readdirSync(n),!(a.includes("server.pem")&&a.includes("server_key.pem")&&a.includes("p4bfcp.txt"))){e.next=20;break}return e.next=16,U(o);case 16:i=e.sent,i||(m.debug("导入的证书不正确或者证书已经失效，自动使用默认证书"),M(!0,""),r=!1,a.forEach(function(e){t.unlinkSync(n+"/"+e)}),t.rmdirSync(n),D()),e.next=22;break;case 20:m.debug("ImpBfcpTLS目录下没有文件"),r=!1;case 22:return e.abrupt("return",r);case 25:e.prev=25,e.t0=e.catch(1),m.error("loginforverificationCertificateLogic",e.t0.toString());case 28:case"end":return e.stop()}},e,void 0,[[1,25]])}));return function(){return e.apply(this,arguments)}}();window.handleJoinImpVcName=function(e){if(!window.isOffline)return void alert(language.IN_CASE_ONLINE_YOU_CANNOT_IMPORT_CERTIFICATE);isNullOrEmpty(e)?window.ToastNew(language.FAILED_TO_IMPORT_THE_CERTIFICATE,2):(window.goRoute("loginCtn"),V(),window.confirm(language.DOES_THE_DETECTION_ATTACHMENT_HAVE_CERTIFICATE).then(function(t){if(t.ret){window.MLoad(language.DURING_THE_SURVEY_PLEASE_WAIT,!0,"probeLoad");var r=null;clearTimeout(r),r=setTimeout(function(){appService.unzipOfZipPackage(e)},2e3)}}))},window.setProbeZipPackageResult=function(e){G(e)};var G=function(e){switch(window.removeMLoad(),e.resultCode){case constant.PROBE_COMPRESSED_PACKAGE.PROBE_NOT_EXIST:alert(language.IMPORTED_FILE_DOES_NOT_EXIST);break;case constant.PROBE_COMPRESSED_PACKAGE.PROBE_NO_CERTIFICATE_EXIST:alert(language.CERTIFICATE_DOES_NOT_EXIST);break;case constant.PROBE_COMPRESSED_PACKAGE.PROBE_CERTIFICATE_EXIST:F(e);break;default:window.ToastNew(language.PROBE_FAILED,2)}},F=t.probeImportCertificateLogic=function(e){new g.default(function(t){window.MLoad(language.SUCCESSFUL_DETECTION_IMPORT,!0,"probeLoad"),B(e.serverPem,e.serverKeyPem),W(e.zipUrl),t("OK")}).then(function(e){if("OK"===e){new g.default(function(e){window.MLoad(language.AUTOMATIC_MATCHING_COMPLETED,!1,"probeLoad"),e("Y")}).then(function(e){if("Y"===e){var t=null;clearTimeout(t),t=setTimeout(function(){window.goRoute("mLoginMoreSet"),window.goRoute("mImportCertificate"),window.goRoute("mSelectImpCertPage"),window.removeMLoad()},1e3)}})}})},B=t.setMProveAndKeyLogic=function(e,t){m.info("setMProveAndKeyLogic"),(0,I.getLoginModel)().mProveUrl=e,(0,I.getLoginModel)().mkeysUrl=t},W=t.setMSaveZipUrlLogic=function(e){m.info("setMSaveZipUrlLogic"),(0,I.getLoginModel)().mZipUrl=e},H=t.setMProveNameAndSelectItLogic=function(e,t){m.info("setMProveNameAndSelectItLogic"),(0,I.getLoginModel)().mProveName=e,(0,I.getLoginModel)().mSelectProve=t};t.setMSelectItLogic=function(e){m.info("setMSelectItLogic"),(0,I.getLoginModel)().mSelectProve=e},t.mobileImptProveLogic=function(){var e=(0,E.default)(p.default.mark(function e(t,r,n){var o,a,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreSecurity.encryptKMC(t);case 2:o=e.sent,0===o.result&&(a=(0,I.getLoginModel)(),i=a.mZipUrl,appService.mImptProve(o.param.CiperText,r,n,i));case 4:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}();window.sendSetInitialValueToProbeResult=function(){var e=(0,E.default)(p.default.mark(function e(t){var r,n,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(isNullOrEmpty(t)||""===t.serverPem){e.next=8;break}return r=window.EXEC_PATH+"/"+t.imptPath,n=r+"/"+t.serverPem,e.next=5,U(n);case 5:o=e.sent,m.info("sendSetInitialValueToProbeResult 证书校验: ",o),o?H(t.serverPem,!1):m.info(language.INCORRECT_OR_INVALID_CERTIFICATE);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),window.sendIsImportSuccessfulResult=function(e){if("200"===e.imptResultCode&&""!==e.serverName){m.info("导入证书成功"),window.MLoad(language.IMPORT_CERTIFICATE_SUCCESSFULLY,!1,"probeLoad");var t=null;clearTimeout(t),t=setTimeout(function(){window.history.back(),H(e.serverName,!1),window.removeMLoad()},1e3)}else alert(language.IMPORT_FAILED_PLEASE_TRY_AGAIN)};var V=(t.cancelImpSelectDone=function(){m.info("userClick  back btn"),window.goRoute("mImportCertificate")},t.clearImptZipUrlDataLogic=function(){B("",""),W("")});t.initMImportCertificate=function(){var e=(0,I.getLoginModel)(),t=e.mSelectProve;appService.logoutAndFreeLoginInitProve(t)};window.actionLogoutAndFreeloginHandler=function(){var e=(0,E.default)(p.default.mark(function e(t){var r,n,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(isNullOrEmpty(t)||""===t.serverPem){e.next=8;break}return r=window.EXEC_PATH+"/"+t.imptPath,n=r+"/"+t.serverPem,e.next=5,U(n);case 5:o=e.sent,m.info("sendSetInitialValueToProbeResult 证书校验: ",o),o?H(t.serverPem,!1):m.info("证书不正确或证书已经失效");case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),window.unzipOfZipPackageResult=function(e,t,r,n){G({serverPem:e||"",serverKeyPem:t||"",resultCode:r||"0",zipUrl:""})},window.mImptProveResult=function(e,t){if("200"===t&&""!==e){m.info("导入证书成功"),window.MLoad(language.IMPORT_CERTIFICATE_SUCCESSFULLY,!1,"probeLoad");var r=null;clearTimeout(r),r=setTimeout(function(){window.history.back(),H(e,!1),window.removeMLoad()},1e3)}else alert(language.IMPORT_FAILED_PLEASE_TRY_AGAIN)},window.initJudgeDirExistProveResult=function(){var e=(0,E.default)(p.default.mark(function e(t,r,n){var o,a,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""===t){e.next=8;break}return o=window.EXEC_PATH+"/"+r,a=o+"/"+t,e.next=5,U(a);case 5:i=e.sent,m.info("sendSetInitialValueToProbeResult 证书校验: ",i),i?H(t,!1):m.info(language.INCORRECT_OR_INVALID_CERTIFICATE);case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}();var K=(t.isInLoginRecordList=function(){var e=(0,E.default)(p.default.mark(function e(t){var r,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryAllLoginRecord();case 2:r=e.sent,n=r.some(function(e){return e.account===t}),(0,I.getLoginModel)().whetherInLoginRecordList=n;case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.isAccountAutoLogin=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryAllLoginRecord();case 2:if(t=e.sent,0!==t.length){e.next=5;break}return e.abrupt("return",!1);case 5:return r=t[0].isAutoLogin,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}());t.initPcFirstPage=function(){var e=(0,E.default)(p.default.mark(function e(){var t,r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.CLIENTCONFIG.PRIVACY_VERSION_VALUE,r=!1,window.CLIENTCONFIG.ISBIGWIN){e.next=9;break}return e.next=5,coreDb.queryLoginSetting({key:"isFirstInstall"});case 5:return t=e.sent,e.next=8,K();case 8:r=e.sent;case 9:if("2052"===window.langcode&&(window.document.title=window.CLIENTCONFIG.NEW_APP_CHINEASE_NAME),!window.isHubEnv){e.next=17;break}delegate(function(){coreAccount.getMyInfo().languageCode=window.langcode},"updateLanguage"),window.goRoute("maxhubLogin"),coreCommon.verificationCertificate(),coreConf.NotifyAppStared(0),e.next=38;break;case 17:if(!window.isPluginEnv){e.next=23;break}return e.next=20,coreCommon.initLogin(!1);case 20:m.info("init plugin first page"),e.next=38;break;case 23:if(void 0!==t.value&&window.CLIENTCONFIG.PRIVACY_VERSION_VALUE===t.value){e.next=33;break}return m.info("First install or privacy statement updated"),appService.showMainWindow(!1),e.next=28,appService.initLoginTray();case 28:return e.next=30,window.setLoginSize();case 30:window.CLIENTCONFIG.ISBIGWIN?window.goRoute("login"):(window.goRoute("firstLoginPrivacy"),appService.showMainWindow(!0)),e.next=38;break;case 33:if(window.CLIENTCONFIG.ISBIGWIN){e.next=36;break}return e.next=36,window.setLoginSize();case 36:window.goRoute("login"),coreCommon.verificationCertificate();case 38:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()},309:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return e?$getState().login[e]:$getState().login}function a(e){return m.default.reject(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.LoginInfo=t.resetLoginModel=t.getLoginModel=t.ErrorType=t.ErrorCode=t.EAErrorCode=t.UErrorCode=void 0;var i=r(1),s=n(i),u=r(2),c=n(u),d=r(117),l=n(d),f=r(4),p=n(f),_=r(5),g=n(_),w=r(118),E=n(w),v=r(119),I=n(v),h=r(3),m=n(h);t.LoginError=a;var L=(t.UErrorCode=constant.UPORTAL_LOGIN_ERROR,t.EAErrorCode=constant.EADDR_LOGIN_ERROR,t.ErrorCode=constant.LOGIN_COMMON_ERROR,t.ErrorType=constant.LOGIN_ERROR_TYPE,window.Logger("logic")("login/model/login")),C=void 0,T=(t.getLoginModel=function(){return C||(C=new S(T)),C},t.resetLoginModel=function(){C=null},{shouldExitApp:"true",displayAccount:"",account:"",tenantid:"",verificationNumber:"",verificationCode:"",loadPwd:!1,folder:!0,showPwd:!1,showLangSet:!1,isSaveLangChange:!1,oldLangCode:"",isSaveAddress:!1,middleEndAddress:"",serverAddress:"",serverPort:"",serverUportalAddress:"",serverUportalPort:"",uportalLoginState:0,sipRegisterState:0,authToken:"",isRememberPassword:window.CLIENTCONFIG.ISMOBILE,isAutoLogin:!1,loginHistoryList:[],loginRecordList:[],isLoading:!1,loginDisable:!1,logoutDisable:!1,isCapslock:!1,isOffline:!1,passwordType:"",eabUri:"",groupServer:"",sipUri:"",svnUri:"",currentNum:0,mainSiteSum:0,httpsProxyAll:"",httpsProxy:"",stgUri:"",stgAccount:"",sipStgUri:"",eserverStgUri:"",sipAccount:"",sipImpi:"",sipPassword:"",sipPasswordType:0,sipOutgoingAccCode:null,sipServerAddress:"",sipServerPort:0,isFreeUser:0,sipDomain:"",sipServerBackup1:"",sipServerPortBackup1:0,sipServerLocal:"",sipServerPortLocal:0,eServerAddressAll:"",eServerAddress:"",eServerPort:0,socketMode:0,isInUportalLogin:!1,isInInitPrivateDB:!1,isInDetectFireWall:!1,isInLoadConfigFromDB:!1,isInEserverLogin:!1,isInSipLogin:!1,maaProxyAddress:"",maaProxyPort:0,maaProxyUrlAll:"",umHttpServerUri:"",umHttpsServerUri:"",stgUriUsed:"",shouldBuildStg:!1,isBuildStgSuc:!1,isGetFirewallRes:!1,fireWallMode:3,appstate:constant.APP_STATE.DISCONNECTED,funcType:0,deployMode:0,lastDeployMode:0,tmsServer:"",tmsAccount:"",tmsPwd:"",sipLoginOnly:!1,sipLoginissiptls:0,sipLoginissrtp:1,pushgwUri:"",sipOnlyType:0,isMultiDeviceLogined:!1,switchAccount:{},tempsipinfo:{},tempConfInfo:{},tempsipserverAddress:"",tempsipserverPort:"",tempMediaxAddress:"",tempMediaxPort:"",tempNoNameMediaxAddress:"",tempNoNameMediaxPort:"",tempSipAccount:"",tempSipNick:"",tempsipPassword:"",tempsipGetState:0,sipOnlyurlInfo:{},isSupportCACertCheck:!0,sipTransMode:0,sipWhiteList:null,srtpMode:0,smcUri:"",certificateUrl:"",keysUrl:"",certificateName:"",selectCertificate:!0,mProveUrl:"",mkeysUrl:"",mProveName:"",mSelectProve:!0,mZipUrl:"",isIwb:!1,maxhubLoginError:{},euaServer:"",whetherInLoginRecordList:!1,showPullRecordList:!1,isCloudec:!1,isOAuth:!1,OAuthUrl:"",OAuthAccountUrl:"",changeItPasswordUrl:"",FrogetPwdUrl:"",FrogetPwdUrlPort:0,isFrogetRedriect:!1,forgetPwdAccount:"",sysProxyAddress:"",sysProxyPort:0,isSupportProxy:!1,isUseSysProxy:!1,proxyAddress:"",proxyPort:"",proxyAccount:"",proxyPassword:"",real_user_account:"",itOAuthUrl:"",itSignedUrl:"",itUploadHeadImgUrl:"",isPortalUpgrade:!1,isWaitUpgrade:!1,isPortalAfterCallUpgrade:!1,progressPercent:-1,isUpdateError:!1,whatsNewCHN:"",whatsNewENG:"",showContentType:0,isForceUpdate:!1,downloadVersion:"",downloadUrl:"",isReqAddrChanged:!1,isSupportAS:!1,show_account:"",curPortalState:0,manMachineCode:{},isUserClickUploadComplaints:!1,ctdServerUri:"",confctrlUri:""}),S=t.LoginInfo=function(e){function t(e){var r=this;(0,p.default)(this,t);var n=(0,E.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e));return n.useSip=!0,n.useEsight=!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING,n.checkSipState=(0,c.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!coreAccount.getLoginModel().isSipRegSuc()){e.next=2;break}return e.abrupt("return");case 2:return L.info("checkSipState: sip is not registered."),$dispatch(coreUi.updateLoginInfo({prepareSipForCallOrConf:!0})),e.abrupt("return",new m.default(function(e){var t=5,r=setInterval(function(){(t<1||coreAccount.getLoginModel().isSipRegSuc())&&($dispatch(coreUi.updateLoginInfo({prepareSipForCallOrConf:!1})),clearInterval(r),e()),t-=1,L.info("checkSipState: retry: "+(5-t))},1e3)}));case 5:case"end":return e.stop()}},e,r)})),n}return(0,I.default)(t,e),(0,g.default)(t,[{key:"notifyChanged",value:function(e){coreCommon.dispatchModuleEvent("login_model",e)}},{key:"isSipRegSuc",value:function(){return this.sipRegisterState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED}},{key:"setLoginStatus",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1];L.info("[ setLoginStatus ] flag:",e,", result:",t,", isResume:",this.isResume);var r=void 0;e?r=this.isResume?constant.APP_STATE.RECONNECTING:constant.APP_STATE.CONNECTING:!0===t?r=constant.APP_STATE.ONLINE:!1===t&&(r=this.isResume?constant.APP_STATE.RECONNECTING:constant.APP_STATE.CONNECT_FAILED),this.set({loginDisable:e,appstate:r})}},{key:"setAppState",value:function(e){L.info("[ appstate ]",e),this.appstate=e}},{key:"getstate",value:function(e){return e?$getState().login[e]:$getState().login}},{key:"clearInLoginState",value:function(){this.set({isInUportalLogin:!1,isInInitPrivateDB:!1,isInDetectFireWall:!1,isInLoadConfigFromDB:!1,isInEserverLogin:!1,isInSipLogin:!1})}},{key:"update",value:function(e){this.dispatch(e)}},{key:"clearPassword",value:function(){this.password="",this.proxyPassword="",this.sipPassword=""}},{key:"loginType",get:function(){return window.SERVERCONFIG.HWUC},set:function(e){window.SERVERCONFIG.HWUC=e}},{key:"isMobile",get:function(){return window.CLIENTCONFIG.ISMOBILE},set:function(e){window.CLIENTCONFIG.ISMOBILE=e}},{key:"isHWUC",get:function(){return window.SERVERCONFIG.HWUC===constant.LOGIN_TYPE.HWUC},set:function(e){}},{key:"useIM",get:function(){return!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&window.CLIENTCONFIG.USE_IM},set:function(e){window.CLIENTCONFIG.USE_IM=e}},{key:"useMetting",get:function(){return window.CLIENTCONFIG.USE_MEETING},set:function(e){window.CLIENTCONFIG.USE_MEETING=e}},{key:"isCloudEcEnv",get:function(){var e=o("serverAddress"),t=coreCommon.sha512(e);return t===constant.SERVER_ADDRESS_SHA512.CLOUDEC||t===constant.SERVER_ADDRESS_SHA512.ACLOUDEC||t===constant.SERVER_ADDRESS_SHA512.AHMEETING||t===constant.SERVER_ADDRESS_SHA512.BCLOUDEC},set:function(e){}},{key:"useEab",get:function(){return window.SERVERCONFIG.HWUC!==constant.LOGIN_TYPE.HWUC&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&!window.CLIENTCONFIG.ISBIGWIN&&!coreAccount.getLoginModel().sipLoginOnly},set:function(e){}},{key:"asAddress",get:function(){return $getState().conf.asAddress}},{key:"OAuthClinetID",get:function(){return window.CLIENTCONFIG.IT_WELINK_CLIENT_ID},set:function(e){window.CLIENTCONFIG.IT_WELINK_CLIENT_ID=e}},{key:"defaultRoute",get:function(){if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING)return"callMain";var e="Workplace"===window.CLIENTCONFIG.NEW_APP_NAME;return $getState().menu.menuList&&$getState().menu.menuList instanceof Array&&$getState().menu.menuList[0]?!e&&$getState().menu.menuList.includes(window.navMobileConfiglist[1].route)?"main/"+window.navMobileConfiglist[1].route:"main/"+$getState().menu.menuList[0]:window.CLIENTCONFIG.MOBILE_MENU_LIST&&window.CLIENTCONFIG.MOBILE_MENU_LIST instanceof Array&&window.CLIENTCONFIG.MOBILE_MENU_LIST[0]?!e&&window.CLIENTCONFIG.MOBILE_MENU_LIST.includes(window.navMobileConfiglist[1].route)?"main/"+window.navMobileConfiglist[1].route:"main/"+window.CLIENTCONFIG.MOBILE_MENU_LIST[0]:e?"main/"+window.navMobileConfiglist[0].route:"main/"+window.navMobileConfiglist[1].route},set:function(e){}}]),t}(coreCommon.ModuleCache)},310:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.registerSipResultCallback=t.sipResume=t.resume=t.registerResumeEvent=t.getResumeFlag=t.clearResumeService=t.logout=t.setOffline=t.doLogout=t.enableAutoLogin=t.login=t.ipLogin=t.initLoginInfo=t.checkForceSwtichAccount=t.recoverAppCache=t.storeAppCache=void 0;var o=r(796),a=n(o),i=r(709),s=n(i),u=r(716),c=n(u),d=r(354),l=n(d);t.storeAppCache=a.storeAppCache,t.recoverAppCache=a.recoverAppCache,t.checkForceSwtichAccount=s.checkForceSwtichAccount,t.initLoginInfo=s.initLoginInfo,t.ipLogin=s.ipLogin,t.login=s.login,t.enableAutoLogin=s.enableAutoLogin,t.doLogout=c.doLogout,t.setOffline=c.setOffline,t.logout=c.logout,t.clearResumeService=l.clearResumeService,t.getResumeFlag=l.getResumeFlag,t.registerResumeEvent=l.registerResumeEvent,t.resume=l.resume,t.sipResume=l.sipResume,t.registerSipResultCallback=l.registerSipResultCallback},351:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNickName=t.resumeAllSipService=t.checkDetectFireWall=t.detectFireWall=t.configSipIp=t.stopSipRefresh=t.startSipRefresh=t.dealPcLogout=t.dealPcLogin=t.ipCallConfig=t.stopLocalServer=t.reLoginSipserver=t.unEnableBFCP=t.sipserverDeregister=t.clearnsipinfo=t.stgBuildforNoName=t.handletempsipconfinfo=t.registerLoginEvent=void 0;var n=r(408),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.registerLoginEvent=o.registerLoginEvent,t.handletempsipconfinfo=o.handletempsipconfinfo,t.stgBuildforNoName=o.stgBuildforNoName,t.clearnsipinfo=o.clearnsipinfo,t.sipserverDeregister=o.sipserverDeregister,t.unEnableBFCP=o.unEnableBFCP,t.reLoginSipserver=o.reLoginSipserver,t.stopLocalServer=o.stopLocalServer,t.ipCallConfig=o.ipCallConfig,t.dealPcLogin=o.dealPcLogin,t.dealPcLogout=o.dealPcLogout,t.startSipRefresh=o.startSipRefresh,t.stopSipRefresh=o.stopSipRefresh,t.configSipIp=o.configSipIp,t.detectFireWall=o.detectFireWall,t.checkDetectFireWall=o.checkDetectFireWall,t.resumeAllSipService=o.resumeAllSipService,t.getNickName=o.getNickName},352:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.unRegisterPush=t.registerPush=t.reStartUpgrade=t.downloadUpgradeFile=t.queryVersionInfo=t.checkUpgrade=t.resumeUportalService=t.getOAuthTicket=t.actionGetUploadInfo=t.uportalLogout=t.clearLocalDNSIp=t.frogetPassword=t.verifyVerificationCode=t.getVerifyCode=t.sendCaptchaResult=t.getCaptcha=t.requestVerificationCode=t.queryUserAccount=t.recordPrivacy=t.queryMediaXaddrFromServer=t.setLoginProxy=t.resetLoginInfo=t.refreshTokenCallback=t.changeLoginPassword=t.actionRefreshToken=t.startLoginDownLoadCaCert=t.startPortDetect=t.startFireWallDetect=t.fireWallDetect=t.updateStgAuthInfo=t.updateStgInfo=t.updateFireWallAndSipInfo=t.stgTunnelDisconnected=t.destroyStgTunnel=t.buildStgTunnel=t.checkIsFirstLogin=t.firstTimeLoginChangePassword=t.firstLoginChangePassword=t.setFistLoginInfo=void 0;var o=r(628),a=n(o),i=r(797),s=n(i),u=r(711),c=n(u),d=r(996),l=n(d),f=r(803),p=n(f),_=r(712),g=n(_),w=r(713),E=n(w),v=r(802);t.setFistLoginInfo=s.setFistLoginInfo,t.firstLoginChangePassword=s.firstLoginChangePassword,t.firstTimeLoginChangePassword=s.firstTimeLoginChangePassword,t.checkIsFirstLogin=s.checkIsFirstLogin,t.buildStgTunnel=a.buildStgTunnel,t.destroyStgTunnel=a.destroyStgTunnel,t.stgTunnelDisconnected=a.stgTunnelDisconnected,t.updateFireWallAndSipInfo=a.updateFireWallAndSipInfo,t.updateStgInfo=a.updateStgInfo,t.updateStgAuthInfo=a.updateStgAuthInfo,t.fireWallDetect=a.fireWallDetect,t.startFireWallDetect=a.startFireWallDetect,t.startPortDetect=a.startPortDetect,t.startLoginDownLoadCaCert=l.startLoginDownLoadCaCert,t.actionRefreshToken=c.actionRefreshToken,t.changeLoginPassword=c.changeLoginPassword,t.refreshTokenCallback=c.refreshTokenCallback,t.resetLoginInfo=c.resetLoginInfo,t.setLoginProxy=(0,v.getUportalApi)().setLoginProxy,t.queryMediaXaddrFromServer=c.queryMediaXaddrFromServer,t.recordPrivacy=c.recordPrivacy,t.queryUserAccount=c.queryUserAccount,t.requestVerificationCode=c.requestVerificationCode,t.getCaptcha=c.getCaptcha,t.sendCaptchaResult=c.sendCaptchaResult,t.getVerifyCode=c.getVerifyCode,t.verifyVerificationCode=c.verifyVerificationCode,t.frogetPassword=c.frogetPassword,t.clearLocalDNSIp=c.clearLocalDNSIp,t.uportalLogout=c.uportalLogout,t.actionGetUploadInfo=c.actionGetUploadInfo,t.getOAuthTicket=p.getOAuthTicket,t.resumeUportalService=c.resumeUportalService,t.checkUpgrade=g.checkUpgrade,t.queryVersionInfo=g.queryVersionInfo,t.downloadUpgradeFile=g.downloadUpgradeFile,t.reStartUpgrade=g.reStartUpgrade,t.registerPush=E.registerPush,t.unRegisterPush=E.unRegisterPush},353:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.deleteLoginInfo=t.selectAccount=t.inputValueChange=t.valueChange=t.forgetPwd=t.miniApp=t.removeKeyDownListener=t.addKeyDownListener=t.noLoginJoinConference=t.showSettingMenu=t.doLogin=t.checkLoginInfo=t.getLoginModel=t.recoverAppCache=t.storeAppCache=t.getResumeFlag=t.sipResume=t.setOffline=t.resume=t.registerResumeEvent=t.logout=t.login=t.ipLogin=t.initLoginInfo=t.doLogout=t.clearResumeService=t.checkForceSwtichAccount=void 0;var o=r(310),a=n(o),i=r(183),s=n(i),u=r(798),c=n(u),d=r(799),l=n(d),f=r(283),p=n(f);t.checkForceSwtichAccount=a.checkForceSwtichAccount,t.clearResumeService=a.clearResumeService,t.doLogout=a.doLogout,t.initLoginInfo=a.initLoginInfo,t.ipLogin=a.ipLogin,t.login=a.login,t.logout=a.logout,t.registerResumeEvent=a.registerResumeEvent,t.resume=a.resume,t.setOffline=a.setOffline,t.sipResume=a.sipResume,t.getResumeFlag=a.getResumeFlag,t.storeAppCache=a.storeAppCache,t.recoverAppCache=a.recoverAppCache,t.getLoginModel=s.getLoginModel,t.checkLoginInfo=c.checkLoginInfo,t.doLogin=l.doLogin,t.showSettingMenu=l.showSettingMenu,t.noLoginJoinConference=l.noLoginJoinConference,t.addKeyDownListener=l.addKeyDownListener,t.removeKeyDownListener=l.removeKeyDownListener,t.miniApp=l.miniApp,t.forgetPwd=l.forgetPwd,t.valueChange=l.valueChange,t.inputValueChange=l.inputValueChange,t.selectAccount=p.selectAccount,t.deleteLoginInfo=p.deleteLoginInfo},354:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){S.info(e),window.console.warn(e)}function a(e){$getState().call.callStatus;switch(e.netType){case constant.NETWORK_TYPE.TYPE_NONE:o("[ mobileNetworkChange -> offline ]"),p(constant.APP_STATE.NETWORK_ERROR),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(S.info(" xhx_se change local qos level setMicValue Zero"),$dispatch(coreUi.changeCallLocalQoslevel(0)),b());break;case constant.NETWORK_TYPE.TYPE_WIFI:case constant.NETWORK_TYPE.TYPE_2G:case constant.NETWORK_TYPE.TYPE_3G:case constant.NETWORK_TYPE.TYPE_4G:if(o("[ mobileNetworkChange -> online ]"),e.newIp&&"0.0.0.0"!==e.newIp&&q!==e.newIp){p(constant.APP_STATE.RECONNECTING);(0,L.getLoginModel)().sipLoginOnly?(o("[ mobileNetworkChange -> sipLoginOnly sipResume ]",e),K()):(o("[ mobileNetworkChange -> sipLoginOnly resume ]",e),A()),q=e.newIp}else{if(!e.newIp||"0.0.0.0"===e.newIp){o("[ mobileNetworkChange -> offline ]",e),p(constant.APP_STATE.NETWORK_ERROR);break}j(e),q=e.newIp;var t=coreAccount.getLoginModel().isSipRegSuc(),r=$getState().conf.confHandle,n=void 0===r||""===r,a=$getState().call.callStatus,i=!("VIDEO_CONNECTED"===a||"VIDEO_OUT"===a||"CALL_OUT"===a||"CALL_CONNECTED"===a);t&&i&&n&&(0,C.reConfigVideoAndDataSetting)()}}}function i(){p(constant.APP_STATE.RECONNECTING),(0,L.getLoginModel)().sipLoginOnly?(o("[ pc networkchange -> sipLoginOnly sipResume ]"),K()):(o("[ pc networkchange -> resume ]"),A())}function s(){if(window.updateLocalIp(),o("[ pcSuspend ]"),navigator.onLine){p(constant.APP_STATE.RECONNECTING);(0,L.getLoginModel)().sipLoginOnly?(o("[ pcSuspend online -> sipLoginOnly sipResume ]"),K()):(o("[ pcSuspend online ->  resume ]  resume ip: ",window.localIp),A())}else p(constant.APP_STATE.NETWORK_ERROR),o("[ pcSuspend offline ->  waiting onLine ]"),window.CLIENTCONFIG.USE_IM&&d().then(u)}function u(){window.updateLocalIp().then(function(e){(0,L.getLoginModel)().sipLoginOnly?(o("[ pcSuspend online -> sipLoginOnly sipResume ]"),K()):(o("[ online -> resume ] resume ip: "),A())})}function c(){o("[ pc offline ]"),p(constant.APP_STATE.NETWORK_ERROR),o("[ offline ->  waiting online ]"),d().then(u)}function d(){var e=PromiseObject(),t=function t(r){o("[ online -> then ]"),window.removeEventListener("online",t),e.resolve(r)};return window.addEventListener("online",t),e}function l(e){e.registerState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERING&&P?(o("[ sipRegisterNotify ] registering"),(0,L.getLoginModel)().useIM||p(constant.APP_STATE.RECONNECTING)):e.registerState===constant.SIP_REGISTER_STATE.SIP_REGISTER_UNREGISTER||e.registerState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED&&0!==e.reasonCode?(o("[ sipRegisterNotify ] unregister"),coreConf.isInReCall()||(o("[ sipRegisterNotify ] => sipresume in sipRegisterNotify",e.reasonCode),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&0===e.reasonCode||K(!1))):e.registerState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED&&0===e.reasonCode&&(o("[ sipRegisterNotify ] registered"),(0,L.getLoginModel)().useIM||p(constant.APP_STATE.ONLINE))}function f(){(0,L.getLoginModel)().sipRegisterState=constant.SIP_REGISTER_STATE.SIP_REGISTER_UNREGISTER,(0,h.stopLocalServer)(),K()}function p(e){e===constant.APP_STATE.ONLINE?(S.info("setAppResumeState, set isOffline false"),window.isOffline=!1,window.dispatchEvent(new Event("CloudLinkonline")),(0,L.getLoginModel)().setAppState(e),o("[ setAppResumeState ] Enable all service")):(S.info("setAppResumeState, set isOffline true"),window.isOffline=!0,window.dispatchEvent(new Event("CloudLinkoffline")),(0,L.getLoginModel)().setAppState(e),o("[ setAppResumeState ] Disable all service"),window.CLIENTCONFIG.USE_IM&&(o("publish [ offline ] status"),coreIm.setEServerOffline()),(0,L.getLoginModel)().sipRegisterState=constant.SIP_REGISTER_STATE.SIP_REGISTER_UNREGISTER),e!==constant.APP_STATE.NETWORK_ERROR||window.CLIENTCONFIG.USE_IM?!window.CLIENTCONFIG.ISMOBILE&&window.ToastNew(language.THE_NETWORK_IS_ABNORMAL,!1):!window.CLIENTCONFIG.ISMOBILE&&window.ToastNew(language.THE_NETWORK_IS_ABNORMAL,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.registerSipResultCallback=t.doSipResumeAndEserverDetect=t.clearResumeService=t.registerResumeEvent=t.sipResume=t.resetSipResumeFlag=t.meetinghwSipEnableToLogout=t.cleraQosMediaInfo=t.stopResume=t.resume=t.getResumeEnable=t.getResumeFlag=void 0;var _=r(3),g=n(_),w=r(1),E=n(w),v=r(2),I=n(v);t.setAppResumeState=p;var h=r(351),m=r(709),L=r(183),C=r(409),T=r(628),S=window.Logger("logic")("resume"),N=(t.getResumeFlag=function(){return R},t.getResumeEnable=function(){return N},!1),R=!1,O=void 0,y=void 0,A=t.resume=function(){var e=(0,I.default)(E.default.mark(function e(){var t,r,n,a,i,s,u,c,d=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return E.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o("enter resume, try to resume, reloadTup: ",d),window.CLIENTCONFIG.ENABLE_IT_MEETING,!0){e.next=4;break}e.next=7;break;case 4:if(N){e.next=7;break}return o("[ resume current is logout or kickout, no resume ]"),e.abrupt("return");case 7:if(window.dispatchEvent(new Event("CloudLinkresume")),!(t=(0,L.getLoginModel)().loginDisable)){e.next=17;break}return o("new resume, wating for last resumePromise"),e.next=13,y;case 13:if(!((r=e.sent)&&r.result||!1===window.isOffline)){e.next=17;break}return p(constant.APP_STATE.ONLINE),e.abrupt("return",R=!1);case 17:O&&O.end&&O.end(),R=!0,p(constant.APP_STATE.RECONNECTING),n=function(e){return o("resuming, retry times [ "+e+" ]"),y=(0,m.login)(!0)},a=3e4,i=10,s=function(e){return e&&e.result||!1===window.isOffline},u=function(){p(constant.APP_STATE.ONLINE),R=!1},c=function(){S.error("resume failed, try again..."),p(constant.APP_STATE.RECONNECT_FAILED),setTimeout(A,1e4),R=!1};try{O=makeSure(n,s,a,i,u,c),O()}catch(e){o("resume exception : "+e.toString()),R=!1}case 27:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),b=(t.stopResume=function(){S.info("stopResume"),O&&O.end instanceof Function&&O.end()},t.cleraQosMediaInfo=function(){var e={audio:{send:{encodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"},recv:{decodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"}},video:{send:{encodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"},recv:{decodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"}},bfcp:{send:{encodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"},recv:{decodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"}}};$dispatch(coreUi.changeCallMediaInfo(e))}),P=!1,x=0,k=10,M=1e3,U=1e4,D=!1,G=!1,F=!1,B=null,W=null,H=0;window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(k=15,U=2e3,M=0);var V=t.meetinghwSipEnableToLogout=function(){S.info("[IT-Meeting] meetinghwSipEnableToLogout"),window.itWeLinkNotifyCallEnded(0,language.EADDR_FAIL_CONNECT),$getState().conf.confSubject?coreConf.actionLeaveConf():(window.switchToBackMode(),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT))},K=(t.resetSipResumeFlag=function(){P=!1},t.sipResume=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=function(){var e=(0,I.default)(E.default.mark(function e(){return E.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(x=0,P=!1,window.CLIENTCONFIG.USE_IM||p(constant.APP_STATE.ONLINE),!window.CLIENTCONFIG.ENABLE_IT_MEETING||window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=6;break}return e.next=6,coreConf.initConfctrl();case 6:o("[ sipResume success ]"),i.resolve();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),r=function(){return N?(G=!1,x>=k?D?(x=0,o("[ retrytime reset due to max times tried ]"),o("[ sipResume stoped, max times tried ]"),P=!1,window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&!coreConf.isInReCall()&&(window.itWeLinkNotifyCallEnded(0,language.EADDR_FAIL_CONNECT),window.switchToBackMode(),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT)),(0,L.getLoginModel)().useIM||p(constant.APP_STATE.RECONNECT_FAILED),void i.reject("max times tried")):(x=0,o("[ retrytime reset due to disaster tolerance ]"),M=1e3,D=!0,P=!1,void(0,m.login)(!0)):(o("[ sipResume failed, will retry again... ]"),void a())):(o("[ resume failed, but resume is unEnable, break resume ]"),void(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&V()))},n=function(e){return F=!0,new g.default(function(t,r){var n=e/500,a=0;o("check sip state:"+(0,L.getLoginModel)().sipRegisterState+", check count: "+n),W=setInterval(function(){a++,a>n?(a=0,clearInterval(W),F=!1,o("check sip state end:"+(0,L.getLoginModel)().sipRegisterState),r()):(o("check sip state:"+(0,L.getLoginModel)().sipRegisterState),(0,L.getLoginModel)().sipRegisterState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED?(a=0,clearInterval(W),F=!1,t()):(0,L.getLoginModel)().sipRegisterState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERING&&(a=0))},500)})},a=function e(){if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){if(!N)return;if(!window.localIp||"0.0.0.0"===window.localIp)return o("[ sipResume stoped, is none network ]"),H=0,window.meetingWHGetLocalIp(),void setTimeout(function(){e()},500);if(window.localIp&&"0.0.0.0"!==window.localIp&&1!==H)return o("[ after one second to doSipResume ]"),void setTimeout(function(){H=1,e()},1e3)}return window.localIp&&"0.0.0.0"===window.localIp?(o("[ sipResume stoped, is none network ]"),p(constant.APP_STATE.NETWORK_ERROR),void(P=!1)):(0,L.getLoginModel)().sipRegisterState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED?(x=0,o("[ retrytime reset due to already registered ]"),o("[ sipResume stoped, already registered ]"),void(P=!1)):(0,L.getLoginModel)().sipRegisterState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERING?(x=0,o("[ retrytime reset due to registering ]"),o("[ sipResume stoped, registering ]"),void(P=!1)):window.resumeFromShut&&window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.isOffline?(p(constant.APP_STATE.ONLINE),window.resumeFromShut=!1,void(P=!1)):/^login/.test(window.getRoute())?(x=0,o("[ retrytime reset due to in the login page ]"),o("[ sipResume stoped, user logout ]"),void(P=!1)):(P=!0,o("[ doSipResume ]"),x++,o("sipResume retrytime "+x),void(0,T.checkStgReConnect)().then(h.reLoginSipserver).then(function(e){return e.result?n(U).then(t):g.default.reject(e)}).catch(function(e){S.error("sipResume Error",e),o("sipResume retrytime "+x),G=!0,B=setTimeout(r,Math.abs(x*M))}))};if(o("[ sipResume ]"),!N)return o("[ sipResume current is logout or kickout, no resume ]"),void(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&V());if(e?(x=0,o("[ retrytime reset due to forceInitRetryTime ]"),(0,L.getLoginModel)().sipRegisterState=constant.SIP_REGISTER_STATE.SIP_REGISTER_UNREGISTER):o("[ exec due to SipRegResultNotify => TUP send (data.notify=98305) message ]"),P){if(o("[ currentInErrorSetTimeoutFlag ] "+G),o("[ currentInSipResultCheck ] "+F),!G)return o("[ sipResume is excuting, no need to do again ]");G=!1,clearTimeout(B)}var i=PromiseObject();return o("[ sipResume start ]"),P=!0,window.CLIENTCONFIG.USE_IM||p(constant.APP_STATE.RECONNECTING),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?(H=0,window.meetingWHGetLocalIp(),setTimeout(function(){S.info("[IT-Meeting] meetinghw to do sipserverDeregister"),(0,h.sipserverDeregister)(),S.info("[IT-Meeting] meetinghw to do doSipResume"),a()},1e3)):a(),(0,L.getLoginModel)().useIM?void 0:i});window.sipResume=K;var Y=(t.registerResumeEvent=function(){Y(),N=!0,o("[ RegisterResumeEvent ]"),window.CLIENTCONFIG.ISMOBILE?window.addEventListener("networkchange",a):(window.electron.ipcRenderer.addListener("suspend",s),window.addEventListener("offline",c),window.addEventListener("networkchange",i)),window.addEventListener("stgTunnelDisconnected",f)},t.clearResumeService=function(){o("[ ClearResumeService ]"),R=!1,N=!1,window.CLIENTCONFIG.ISMOBILE?window.removeEventListener("networkchange",a):(window.electron.ipcRenderer.removeListener("suspend",s),window.removeEventListener("offline",c),window.removeEventListener("networkchange",i)),window.removeEventListener("stgTunnelDisconnected",f)}),q=null,j=t.doSipResumeAndEserverDetect=function(e){o("[ doSipResumeAndEserverDetect -> sipResume ]",e),K(),(0,L.getLoginModel)().useIM&&N&&(o("[ doSipResumeAndEserverDetect -> eServerDetect ]",e),coreIm.checkEServerIsOnline())};t.registerSipResultCallback=function(){window.removeEventListener("sipRegResultEvent",l),window.addEventListener("sipRegResultEvent",l)};window.handleResumeLogin=(0,I.default)(E.default.mark(function e(){var t;return E.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=window.getRoute(),"main/conference"===t&&(window.noactivity=!1,window.showPageLoading(!1),"function"==typeof window.resumeGetConfInterval&&window.resumeGetConfInterval()),""===t&&window.goRoute("main/conference");case 3:case"end":return e.stop()}},e,void 0)})),window.resume=A},408:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.updateTempMediaxPort=t.updateTempMediaxAddress=t.updateTempSipGetState=t.updateTempSipPwd=t.getNickName=t.saveNickName=t.updateTempSipNick=t.updateTempSipAccount=t.updateTempSipPort=t.updateTempSipServer=t.buildStg=t.clearFireWallStore=t.saveFireWall=t.updateFirewallMode=t.detectFireWall=t.checkDetectFireWall=t.resumeAllSipService=t.stopSipRefresh=t.startSipRefresh=t.dealPcLogout=t.dealPcLogin=t.configSipIp=t.ipCallConfig=t.stopLocalServer=t.reLoginSipserver=t.unEnableBFCP=t.sipserverDeregister=t.clearnsipinfo=t.stgBuildforNoName=t.getStgInfo=t.handleSipOnlyJoinConf=t.handleAccountJoinConf=t.handletempsipconfinfo=t.prepareHandletempsipconfinfo=t.registerLoginEvent=void 0;var o=r(67),a=n(o),i=r(126),s=n(i),u=r(1),c=n(u),d=r(2),l=n(d),f=(t.resumeAllSipService=function(){var e=(0,l.default)(c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:t=e.sent,coreCall.registerCallEvent(),coreCall.registerVideoEvent(),coreConf.registerConfEventAtomic.wait(),coreConf.initializeDataConf();case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.checkDetectFireWall=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.updateLocalIp();case 2:return t=e.sent,C.info(" start checkDetectFireWall "),e.next=6,coreDb.queryLoginSetting({key:"firewall"});case 6:if(r=e.sent,isNullOrEmpty(r)||!r.hasOwnProperty("key")||!r.hasOwnProperty("value")||isNullOrEmpty(r.key)||isNullOrEmpty(r.value)){e.next=22;break}if(n=JSON.parse(r.value),t!==n.ip){e.next=17;break}return C.info("detectFireWall local has store for ip :"+handleIp(t)),coreConf.setFireWallModeType(n.fireWallMode),T=n.fireWallMode,e.next=15,p(n.fireWallMode);case 15:e.next=20;break;case 17:return C.info("detectFireWall local has no store for ip :"+handleIp(t)),e.next=20,f(t);case 20:e.next=25;break;case 22:return C.info("detectFireWall local has no store for ip :"+handleIp(t)),e.next=25,f(t);case 25:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.detectFireWall=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,o,a,i,s,u,d,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(l)){e.next=4;break}return e.next=3,window.updateLocalIp();case 3:l=e.sent;case 4:if(t=(0,h.getLoginModel)(),r=t.svnUri,n=t.useIM,o=t.stgUri,a=t.isMultiDeviceLogined,i=t.isMobile,void 0===o||""===o||";"===o||";;"===o||window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=27;break}if(s=void 0,u=(0,h.getLoginModel)(),d=u.isSupportProxy,!d){e.next=13;break}s={fire_wall_mode:0,result:0},e.next=16;break;case 13:return e.next=15,(0,v.startFireWallDetect)(r);case 15:s=e.sent;case 16:if(C.info("detectFireWall isSupportProxy:",d),!s||void 0===s.fire_wall_mode){e.next=24;break}return e.next=20,p(s.fire_wall_mode);case 20:return e.next=22,_(l,s.fire_wall_mode);case 22:e.next=25;break;case 24:C.error("firewall detect failed");case 25:e.next=30;break;case 27:C.info("reSetFireWallModeType"),coreConf.reSetFireWallModeType(),(0,v.updateFireWallAndSipInfo)(3);case 30:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()),p=t.updateFirewallMode=function(){var e=(0,l.default)(c.default.mark(function e(t){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreConf.setFireWallModeType(t),T=t,constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP!==t){e.next=5;break}return e.next=5,P();case 5:(0,v.updateFireWallAndSipInfo)(t);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),_=t.saveFireWall=function(){var e=(0,l.default)(c.default.mark(function e(t,r){var n,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={ip:t,fireWallMode:r},o=(0,a.default)(n),C.info("detectFireWall save "+(0,a.default)({ip:handleIp(t),fireWallMode:r})),coreDb.saveLoginSetting({key:"firewall",value:o});case 4:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),g=(t.clearFireWallStore=function(){var e=(0,l.default)(c.default.mark(function e(){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:C.info("fireWall: clear local store"),coreDb.saveLoginSetting({key:"firewall",value:""});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.buildStg=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,o,a,i,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,h.getLoginModel)(),r=t.useIM,n=t.fireWallMode,r){e.next=17;break}if(constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP!==n&&constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_HTTP_AND_SVN!==n){e.next=16;break}return o=t.stgUri,a=t.stgAccount,e.next=7,coreSecurity.PasswordManager.getPassword("stgPassword");case 7:return i=e.sent,C.info("TE mode need buildStgTunnel， building"),e.next=11,(0,v.buildStgTunnel)({stgUri:o,stgAccount:a,stgPassword:i});case 11:if(u=e.sent,u.result){e.next=14;break}return e.abrupt("return",(0,h.LoginError)((0,s.default)({},u,{result:!1,errorCode:h.UErrorCode.LOGIN_ERR_STG_TUNNEL_BUILD_ERROR,errorType:h.ErrorType.uportal})));case 14:e.next=17;break;case 16:C.info("firewall result is ok, no need to buildStgTunnel");case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),r(993)),w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(g),E=r(795),v=r(352),I=r(714),h=(r(711),r(309)),m=r(310),L=(r(183),r(409)),C=window.Logger("logic")("login/sipServer"),T=2,S=(t.registerLoginEvent=function(){var e=(0,l.default)(c.default.mark(function e(){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:w.setloginNotifyFunc(),C.info("registerLoginEvent, Observer subscribe TempSipConfInfo"),coreCommon.Observer.subscribe("TempSipConfInfo",N);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.prepareHandletempsipconfinfo=function(e){return 34===e.param.result?(window.ToastNew(language.GET_SIP_FAILED_INVALIDE_CONF,2),0):36===e.param.result?(window.ToastNew(language.GET_SIP_FAILED_CONF_ENDED,2),0):37===e.param.result?(window.ToastNew(language.GET_SIP_FAILED_INPUT_TOO_MUCH_ERROR_PWD,2),0):35===e.param.result?(U(""),0):2===e.param.result?(U(""),0):3===e.param.result?(window.ToastNew(language.CALL_CALLING_FAILED,2),0):7===e.param.result?(window.ToastNew(language.CALL_CALLING_FAILED,2),0):33===e.param.result?(window.ToastNew(language.CALL_FAILED_OFFLINE,2),0):40===e.param.result?(window.ToastNew(language.THE_MEETING_HAS_NOT_YET_STARTED,2),0):39===e.param.result?(window.ToastNew(language.THE_MEETING_HAS_BEEN_LOCKED_DOWN,2),0):32===e.param.result?(window.ToastNew(language.CA_CERT_IS_NOT_TRUSTED_CONNECT_FAILED,2),0):0!==e.param.result?(window.ToastNew(language.CALL_CALLING_FAILED,2),0):1}),N=t.handletempsipconfinfo=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,o,a,i,s,u,d,f;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(C.info("handletempsipconfinfo",t.param.result),0===t.param.result){e.next=19;break}if($dispatch(coreUi.changeEnterConfState(!1)),$dispatch(coreUi.changeEnterConfNotifyMsg("")),t.param.result!==constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_TIMEOUT){e.next=19;break}if(C.info("handletempsipconfinfo timeout,clear dns ip"),!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=18;break}return e.next=9,window.getMeetingDomain();case 9:return r=e.sent,n="",e.next=13,coreDb.queryLoginSetting({key:r});case 13:o=e.sent,o&&o.value&&(n=o.value),n&&(coreDb.saveLoginSetting({key:r,value:""}),coreConf.gettempuserinfo()),e.next=19;break;case 18:(0,v.clearLocalDNSIp)((0,h.getLoginModel)().urlOfGetSipInfo);case 19:if(D(t.param.result),0!==S(t)){e.next=23;break}return U(""),e.abrupt("return");case 23:if(!(t.param.tempuser_info_result.length<=1)){e.next=26;break}return alert(language.GET_SIP_NOTHING),e.abrupt("return");case 26:if(a=(0,h.getLoginModel)().sipOnlyType,i=t.param.tempuser_info_result,s=i.conf_id.length,u=(0,h.getLoginModel)().isSupportAS,constant.SIP_ONLY_TYPE.SIP_ONLY_TYPE_HAS_SIP!==a&&!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=48;break}if(!(s!==constant.MEDIA_X_ID_LENGTH&&!u||s===constant.MEDIA_X_ID_LENGTH&&u)){e.next=34;break}return window.confirm(language.CONF_NOT_IN_SAME_DEPARTMENT_AUTO).then(function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ret){e.next=18;break}return e.next=3,delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT);case 3:if(!window.CLIENTCONFIG.ISMOBILE){e.next=13;break}return r={tempSipAccount:i.conf_id},(0,h.getLoginModel)().set(r),e.next=8,M();case 8:return e.next=10,coreConf.getConfInfoFromDb();case 10:window.goRoute("noLoginJoinConference"),e.next=16;break;case 13:n={tempSipAccount:i.conf_id},(0,h.getLoginModel)().set(n),coreAccount.noLoginJoinConference();case 16:e.next=19;break;case 18:$dispatch(coreUi.changeEnterConfState(!1));case 19:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return");case 34:return $dispatch(coreUi.changeConfAcsNum(i.access_code)),$dispatch(coreUi.changeConfAcsId(i.conf_id)),e.next=38,coreConf.toggleChangeConfAcsPas(i.conf_pwd);case 38:return $dispatch(coreUi.changeEnterConfState(!1)),$dispatch(coreUi.changeEnterConfNotifyMsg("")),d={tempConfInfo:{chairman_pwd:i.chairman_pwd,user_role:i.user_role}},(0,h.getLoginModel)().set(d),coreConf.toggleChangeConfAcsState(constant.JOIN_CONF_PASSWORD_INPUT_STATE.HAS_INPUT),window.CLIENTCONFIG.ISMOBILE?$dispatch(coreUi.changeCurConfPage("mEnterConfPage")):$dispatch(coreUi.changeCurConfPage("Join")),coreConf.oneKeyEnterConf(i.access_code,i.conf_id,i.conf_pwd,!0),e.abrupt("return");case 48:f=i.account_info,isNullOrEmpty(f.account)?O(i):R(i);case 50:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),R=t.handleAccountJoinConf=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,o,a,i,s,u,d;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.account_info,n={conf_id:t.conf_id,access_code:t.access_code,conf_pwd:t.conf_pwd,user_role:t.user_role,chairman_pwd:t.chairman_pwd},o={tempConfInfo:n,sipLoginOnly:!0},(0,h.getLoginModel)().set(o),a=$getState(),i=a.login,s=i.serverAddress,u=i.serverPort,d=r.access_url,isNullOrEmpty(r.second_access_url)||(isNullOrEmpty(d)?d=r.second_access_url:d+=","+r.second_access_url),isNullOrEmpty(d)&&(d=s),$dispatch(coreUi.changeConfTempAcsAccount(r.account)),e.next=11,coreSecurity.PasswordManager.setPassword("password",r.password);case 11:return $dispatch(coreUi.changeTempAcsUportalAddress(d)),$dispatch(coreUi.changetempAcsUportalPort(u)),$dispatch(coreUi.changeEnterConfState(!0)),$dispatch(coreUi.changeEnterConfNotifyMsg(language.ENTER_CONF_TEMP_ACS_ENTING)),e.next=17,coreAccount.login({isResume:!1,isTempLogin:!0});case 17:$dispatch(coreUi.changeEnterConfState(!1)),$dispatch(coreUi.changeEnterConfNotifyMsg(""));case 19:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),O=t.handleSipOnlyJoinConf=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,o,a,i,s,u,d,l,f,p,_;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=!0,e.next=3,y(t.site_info);case 3:if(n=e.sent,o={conf_id:t.conf_id,access_code:t.access_code,conf_pwd:t.conf_pwd},"supportRest"===t.site_info[0].tms_account&&(r=!1),window.CLIENTCONFIG.ISBIGWIN&&(r=!0),a={sipAccount:t.sip_account,sipDomain:t.sip_domain,sipImpi:t.sip_impi,sipPasswordType:t.password_type,sipServerAddress:t.site_info[0].access_server[0].sip_uri.split(":")[0],sipServerPort:parseInt(t.site_info[0].access_server[0].sip_uri.split(":")[1]),sipTlsServerAddress:isNullOrEmpty(t.site_info[0].access_server[0].sip_tls_uri)?"":t.site_info[0].access_server[0].sip_tls_uri.split(":")[0],sipTlsPort:isNullOrEmpty(t.site_info[0].access_server[0].sip_tls_uri)?"0":parseInt(t.site_info[0].access_server[0].sip_tls_uri.split(":")[1]),sipStgUri:t.site_info[0].access_server[0].stg_info.sip_stg_uri,sipUri:t.site_info[0].access_server[0].sip_uri,svnUri:n.svnUri,stgUri:n.stgUri,stgAccount:n.stgAccount,tempsipinfo:t,tempConfInfo:o,sipLoginOnly:!0,deployMode:3,sipLoginissiptls:t.site_info[0].access_server[0].is_siptls,sipLoginissrtp:t.site_info[0].access_server[0].is_srtp},t.uportal_uri.indexOf(":")>=0?(a.tempsipserverAddress=t.uportal_uri.split(":")[0],a.tempsipserverPort=parseInt(t.uportal_uri.split(":")[1])):(a.tempsipserverAddress=t.uportal_uri,a.tempsipserverPort=8443),window.isSupportiDo=r,C.info("handletempsipconfinfo isSupportiDo: "+window.isSupportiDo),(0,h.getLoginModel)().set(a),e.t0=t.sip_password,!e.t0){e.next=16;break}return e.next=16,coreSecurity.PasswordManager.setPassword("sipPassword",t.sip_password);case 16:if(window.CLIENTCONFIG.ISMOBILE){e.next=62;break}if(i=n.svnUri,void 0===(s=n.stgUri)||""===s||";"===s||";;"===s||window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=57;break}return e.next=21,(0,v.startFireWallDetect)(i);case 21:if(!(u=e.sent)||void 0===u.fire_wall_mode){e.next=49;break}if(coreConf.setFireWallModeType(u.fire_wall_mode),T=u.fire_wall_mode,constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP!==u.fire_wall_mode){e.next=28;break}return e.next=28,P();case 28:if((0,v.updateFireWallAndSipInfo)(u.fire_wall_mode),constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP!==u.fire_wall_mode&&constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_HTTP_AND_SVN!==u.fire_wall_mode){e.next=46;break}return d=n.stgUri,l=n.stgAccount,e.next=33,coreSecurity.PasswordManager.getPassword("stgPassword");case 33:return f=e.sent,C.info("TE mode need buildStgTunnel， building"),e.next=37,(0,v.buildStgTunnel)({stgUri:d,stgAccount:l,stgPassword:f});case 37:if(p=e.sent,p.result){e.next=44;break}return A(),alert(language.CALL_CALLING_FAILED),$dispatch(coreUi.changeEnterConfState(!1)),$dispatch(coreUi.changeEnterConfNotifyMsg("")),e.abrupt("return");case 44:e.next=47;break;case 46:C.info("firewall result is ok, no need to buildStgTunnel");case 47:e.next=55;break;case 49:return C.error("firewall detect failed"),A(),alert(language.CALL_CALLING_FAILED),$dispatch(coreUi.changeEnterConfState(!1)),$dispatch(coreUi.changeEnterConfNotifyMsg("")),e.abrupt("return");case 55:e.next=60;break;case 57:C.info("reSetFireWallModeType"),coreConf.reSetFireWallModeType(),(0,v.updateFireWallAndSipInfo)(3);case 60:e.next=63;break;case 62:C.info("handleSipOnlyJoinConf mobile no need to fireWallDetect");case 63:return _={result:!1},e.prev=64,e.next=67,(0,E.loginToSipServer)();case 67:_=e.sent,e.next=73;break;case 70:e.prev=70,e.t1=e.catch(64),C.error("handleSipOnlyJoinConf loginToSipServer try catch error = "+e.t1);case 73:_&&!1===_.result&&($dispatch(coreUi.changeEnterConfState(!1)),$dispatch(coreUi.changeEnterConfNotifyMsg("")),window.ToastNew(language.ENTER_CONF_FAIL,2),C.info("handleSipOnlyJoinConf loginToSipServer fail exit sipLoginOnly"));case 74:case"end":return e.stop()}},e,void 0,[[64,70]])}));return function(t){return e.apply(this,arguments)}}(),y=t.getStgInfo=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,o,a,i,s,u,d,l,f,p,_,g,w,E;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r="",n="",o="",a="",i="",s="",u="",d="",l="",!t||!t[0]){e.next=25;break}f=t[0],p=f.num_of_server,_=f.access_server,g=p-1;case 4:if(!(g>=0)){e.next=20;break}if(_&&_[g]){e.next=7;break}return e.abrupt("continue",17);case 7:r+=_[g].sip_uri,n+=_[g].svn_uri,i+=_[g].stg_info.stg_uri,d+=_[g].stg_info.sip_stg_uri,l+=_[g].stg_info.eserver_stg_uri,s=_[0].stg_info.account,u=_[0].stg_info.password,a||(a=_[g].eserver_uri,o=_[g].httpsproxy_uri),o||(o=_[g].httpsproxy_uri),0!==g&&(r+=";",n+=";",i+=";",d+=";",l+=";");case 17:g--,e.next=4;break;case 20:if(w={sipUri:r,svnUri:n,httpsProxy:o,eserverUri:a,stgUri:i,stgAccount:s,stgPassword:u,sipStgUri:d,eserverStgUri:l},e.t0=u,!e.t0){e.next=25;break}return e.next=25,coreSecurity.PasswordManager.setPassword("stgPassword",u);case 25:return E={sipUri:r,svnUri:n,httpsProxy:o,eserverUri:a,stgUri:i,stgAccount:s,stgPassword:u,sipStgUri:d,eserverStgUri:l},e.abrupt("return",E);case 27:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),A=(t.stgBuildforNoName=function(){var e=(0,l.default)(c.default.mark(function e(t,r,n){var o,a,i,u,d=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(0,h.getLoginModel)(),a=(new Date).getTime(),i=void 0,void 0===t||""===t||";"===t||";;"===t){e.next=6;break}return e.next=6,(0,v.startFireWallDetect)(o.svnUri);case 6:if(constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP!==T){e.next=14;break}if(void 0===t||""===t||";"===t||";;"===t){e.next=14;break}return e.next=10,(0,v.buildStgTunnel)({stgUri:t,stgAccount:r,stgPassword:n});case 10:if(u=e.sent,u.result){e.next=14;break}return(0,I.handleUportalLoginFailed)((0,s.default)({},u,{isResume:d})),e.abrupt("return",{result:!1});case 14:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),t.clearnsipinfo=function(){var e=(0,l.default)(c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C.info("clearsipinfo"),t={sipAccount:"",sipDomain:"",sipImpi:"",sipPassword:"",sipPasswordType:"",sipServerAddress:"",sipServerPort:"",sipStgUri:"",sipUri:"",tempsipinfo:"",tempConfInfo:"",sipLoginOnly:!1,deployMode:"",tempsipserverAddress:"",tempsipserverPort:"",tempSipAccount:"",tempsipPassword:"",sipLoginissiptls:0,sipLoginissrtp:1,tempSipNick:""},(0,h.getLoginModel)().set(t),C.info("clearsipinfo finished"),e.next=6,coreSecurity.PasswordManager.setPassword("sipPassword","");case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),b=t.sipserverDeregister=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,h.getLoginModel)(),r=t.sipImpi,C.info("sipserverDeregister"),e.next=4,new coreTup.HWTupCall;case 4:if(n=e.sent,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=10;break}return e.next=8,n.deRegisterForAccount(0);case 8:e.next=12;break;case 10:return e.next=12,n.deRegister(r);case 12:window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(window.setSipState("0"),o=!!window.pcLoginState(),(0,h.getLoginModel)().isMultiDeviceLogined=o,C.info("isMultiDeviceLogined = "+o)),$dispatch(coreUi.changeDoSipReg(!1));case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),P=(t.unEnableBFCP=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C.info("[ unEnableBFCP ]"),t={media:{enable_bfcp:0}},e.next=4,new coreTup.HWTupCall;case 4:return r=e.sent,e.next=7,r.config(t);case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.reLoginSipserver=function(e){return C.info("[ reLoginSipserver ]"),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?(0,E.loginToSipServer)():b().then(E.loginToSipServer)},t.stopLocalServer=function(){var e=(0,l.default)(c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C.info("stop local server."),e.next=3,new coreTup.HWTupCall;case 3:return t=e.sent,e.next=6,t.stopLocalServer();case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}());t.ipCallConfig=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.skipLogin){e.next=2;break}return e.abrupt("return");case 2:return t=(0,L.configIPCallServer)(),e.next=5,new coreTup.HWTupCall;case 5:return r=e.sent,e.next=8,r.config(t);case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.configSipIp=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C.info("configSipIp"),e.next=3,(0,L.sipIpConfig)();case 3:return t=e.sent,e.next=6,new coreTup.HWTupCall;case 6:return r=e.sent,e.next=9,r.config(t);case 9:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.dealPcLogin=function(){C.info("multi devices, deal pc login "),k().then(function(e){0===e.result&&(C.info("stop sip refresh success"),b())}),coreCommon.dispatchModuleEvent("sipOtherPCLogin"),coreConf.endPairWithPeripherals(language.PAIR_CLOSED)};window.onlyInitHme=(0,l.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,r=(0,L.configHMELog)(),C.info("sip server login configHmeInfo=",r),e.next=7,t.setHMELog(r);case 7:case"end":return e.stop()}},e,void 0)})),window.onlyDoSipRegister=(0,l.default)(c.default.mark(function e(){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(C.info("only do sip register."),!window.dontUnregister){e.next=10;break}if(C.info("sim call finish resume sip service."),!window.isOffline){e.next=8;break}return e.next=6,b();case 6:e.next=10;break;case 8:return C.info("sim call finish resume sip service."),e.abrupt("return");case 10:return e.next=12,(0,E.loginToRegSipServer)();case 12:C.info("relogin sipserverLogin end");case 13:case"end":return e.stop()}},e,void 0)}));var x=(t.dealPcLogout=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),r=t.call,n=r.saveCalleeInfo,o=r.isDoSipReg,C.info("multi devices, deal pc logout ","isDoSipReg:"+o),window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING,!0){e.next=6;break}return e.next=5,x();case 5:return e.abrupt("return");case 6:return(0,m.sipResume)(),isNullOrEmpty(n)&&window.ToastNew(language.MULTIDEVICE_PC_QUIT,3),e.next=10,coreConf.confctrlInit();case 10:return e.abrupt("return",o);case 11:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.startSipRefresh=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C.info("start sip refresh."),t=(0,h.getLoginModel)().sipImpi,e.next=4,new coreTup.HWTupCall;case 4:if(r=e.sent,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=7;break}return e.abrupt("return",r.refreshRegisterForAccount(0));case 7:return e.abrupt("return",r.startRefreshRegister(t));case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),k=t.stopSipRefresh=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return C.info("stop sip refresh."),t=(0,h.getLoginModel)().sipImpi,e.next=4,new coreTup.HWTupCall;case 4:if(r=e.sent,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=7;break}return e.abrupt("return",r.stopReForAccount(0));case 7:return e.abrupt("return",r.stopRefreshRegister(t));case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),M=(t.updateTempSipServer=function(e){(0,h.getLoginModel)().tempsipserverAddress=e},t.updateTempSipPort=function(e){(0,h.getLoginModel)().tempsipserverPort=e},t.updateTempSipAccount=function(e){(0,h.getLoginModel)().tempSipAccount=e},t.updateTempSipNick=function(e){(0,h.getLoginModel)().tempSipNick=e},t.saveNickName=function(e){var t={key:"noLoginNickName",value:e};coreDb.saveLoginSetting(t)},t.getNickName=function(){var e=(0,l.default)(c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryLoginSetting({key:"noLoginNickName"});case 2:t=e.sent,isNullOrEmpty(t)||isNullOrEmpty(t.key)||isNullOrEmpty(t.value)?(0,h.getLoginModel)().tempSipNick="":(0,h.getLoginModel)().tempSipNick=t.value;case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),U=t.updateTempSipPwd=function(e){(0,h.getLoginModel)().tempsipPassword=e},D=t.updateTempSipGetState=function(e){(0,h.getLoginModel)().tempsipGetState=e};t.updateTempMediaxAddress=function(e){(0,h.getLoginModel)().tempMediaxAddress=e},t.updateTempMediaxPort=function(e){(0,h.getLoginModel)().tempMediaxPort=e}},409:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.serGroupPickupCfg=t.serPointPickupCfg=t.restoreMAAConfControl=t.reConfigVideoAndDataSetting=t.initVideoSettingParam=t.initVideoHardCodeParam=t.configBFCPForTLS=t.configBandwidthLimit=t.configSessionTimer=t.configBFCP=t.configVideo=t.configRTP=t.configMKI=t.configRejectCallType=t.configCall=t.sipIpConfig=t.configSip=t.configIPCallServer=t.configHMELog=void 0;var o=r(3),a=(n(o),r(121)),i=n(a),s=r(1),u=n(s),c=r(2),d=n(c),l=r(67),f=n(l),p=r(183),_=r(283),g=window.Logger("logic")("common/sipCallConfig"),w=window.CLIENTCONFIG,E=(t.configHMELog=function(){var e=10;1===window.CLIENTCONFIG.IS_HME_DEBUG&&(e=200),window.hmeLogSizeMb&&(e=window.hmeLogSizeMb);var t={audio_log_level:3,audio_max_size:10,video_log_level:3,video_max_size:e};return g.info("HMEConfig =",(0,f.default)(t)),t},t.configIPCallServer=function(){return{log_path:window.LOG_PATH,network:{local_ipv4:window.localIp,user_agent:"WeLink-Mobile"},audio:{audio_codec:"112,9,8,0,98,18",dtmf_mode:1,net_ate_level:2,audio_rfc2198:{switch:1,red_pt:121,red_level:3}},sip:{user_type:1,tls_rootcertpath:"",tls_server_certpath:"",tls_anonymous_enable:0,trans_mode:0}}},t.configSip=function(){var e=(0,d.default)(u.default.mark(function e(){var t,r,n,o,a,i,s,c,d,l,f,_,v,I,h,m,L,C,T,S,N,R,O,y,A,b,P,x,k,M,U,D,G,F,B,W,H,V,K,Y,q,j,$,X,z,J=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,p.getLoginModel)(),r=t.sipServerAddress,n=t.sipServerPort,o=t.sipTlsServerAddress,a=t.sipTlsPort,i=t.sipTlsServerBackup1,s=t.sipTlsPortBackup1,c=t.sipTlsServerLocal,d=t.sipTlsPortLocal,l=t.sipServerBackup1,f=t.sipServerPortBackup1,_=t.sipServerLocal,v=t.sipServerPortLocal,I=t.sipPasswordType,h=t.sipOutgoingAccCode,m=t.fireWallMode,L=t.sipDomain,C=t.serverAddress,T=t.sipLoginissiptls,S=t.sipLoginOnly,N=t.tempSipNick,R=t.sipTransMode,O=t.isSupportCACertCheck,y=t.sipWhiteList,A=t.deployMode,g.info("config sip param",r,n,l,f,o,a,i,s,c,d,desensitive(I),h,m,L,C),b=$getState().conf,P=b.confTempAcsNick,x=b.confTempAcsAccount,k=constant.CALL_FIREWALL_MODE.CALL_E_FIREWALL_MODE_LINE,M=window.CLIENTCONFIG.ISMOBILE?constant.USER_AGENT.MOBILE:constant.USER_AGENT.PC,U=coreCommon.sha512(C),k=constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP===m?constant.CALL_FIREWALL_MODE.CALL_E_FIREWALL_MODE_STG:constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_HTTP_AND_SVN===m?constant.CALL_FIREWALL_MODE.CALL_E_FIREWALL_MODE_INNERSVN:constant.CALL_FIREWALL_MODE.CALL_E_FIREWALL_MODE_LINE,g.info("config sip stgModeForCall "+k+", 0:sbc,1:stg,2:svn,3:butt"),window.CLIENTCONFIG.USE_IM||(M=window.CLIENTCONFIG.ISMOBILE?"Huawei TE Mobile":"Huawei TE Desktop"),g.info("config sip deployMode "+A),A===constant.MEETING_NET_TYPE.SMC_MEETING&&(M="CloudLink SoftClient"),1===window.SERVERCONFIG.HWUC&&(L=r),g.info("serverAddress ="+C+", sipServerAddress ="+r+", sipDomain"+L+", isForTempLogin = "+J),D=!1,(U===constant.SERVER_ADDRESS_SHA512.CLOUDEC||J)&&(D=!0),S&&(D=1===T),G={account_pwd_type:parseInt(I)||0,account_label_name:isNullOrEmpty($getState().myInfo.name)?$getState().myInfo.account:$getState().myInfo.name},g.info("config sip account_label_name default "+isNullOrEmpty(G.account_label_name)+" "+isNullOrEmpty($getState().myInfo.name)+" "+isNullOrEmpty($getState().myInfo.account)),J&&(g.info("config sip account_label_name forTempLogin "),G={account_pwd_type:parseInt(I)||0,account_label_name:isNullOrEmpty(P)?x:P}),S&&!isNullOrEmpty(N)&&(g.info("config sip account_label_name sipLoginOnly "),G={account_pwd_type:parseInt(I)||0,account_label_name:N}),!isNullOrEmpty(G.account_label_name)||S){e.next=27;break}return g.info("config sip account_label_name from contactModule "),e.next=23,coreContact.getContactByAccount((0,p.getLoginModel)().account);case 23:F=e.sent,g.info("config sip account_label_name from contactModule success"),G.account_label_name=getContactName(F),g.info("config sip account_label_name from util function");case 27:if(B="",isNullOrEmpty(G.account_label_name)||(B=G.account_label_name.length<=2?G.account_label_name.substr(0,1)+"**":G.account_label_name.substr(0,1)+"**"+G.account_label_name.substr(-1)),g.info("esight config siptls is null,use uportal siptlsmode is "+T+",account_label_name = "+B),D=1===T,k===constant.CALL_FIREWALL_MODE.CALL_E_FIREWALL_MODE_STG&&(D=!1),W=0,window.CLIENTCONFIG.ENABLE_IT_MEETING&&(D=!0,W=1),0===R&&(O=!1),H=D?1:R||0,g.info("config sip trans_mode : "+H+" , 1: tls: 0: udp"),V="",K="",Y="",q="",j="",$="",a>0&&T&&k!==constant.CALL_FIREWALL_MODE.CALL_E_FIREWALL_MODE_STG?(V=o,K=a,Y=i,q=s,j=c,$=d):(V=r,K=D?5061:n||5060,Y=l,q=D?5061:f||5060,j=_,$=D?5061:n||5060),g.info("sipTlsServerAddress , sipLoginissiptls : "+T+" realSipServerAddress:"+V+" , realSipServerPort : "+K),!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=52;break}return g.info("[IT-Meeting] update local IP before sip register."),W=0,e.next=50,window.updateLocalIp();case 50:e.next=55;break;case 52:return g.info("config sip update local IP before sip register."),e.next=55,window.updateLocalIp();case 55:return g.info("config sip update local IP : "+handleIp(window.localIp)),e.next=58,E(V,K);case 58:return X=e.sent,z={log_path:window.LOG_PATH,network:{sip_svr_addr:L,sip_svr_port:K,backup1_addr:Y,backup1_port:parseInt(D?5061:q||5060),backup2_addr:j,backup2_port:parseInt(D?5061:$||5060),local_addr:_,local_port:D?5061:v||5060,local_ipv4:X,local_sip_port:parseInt(w["Device.ComCfg.Sip.LocalPort"]),user_agent:M,force_dereg_disconnect_tls:1,net_environment:1===window.SERVERCONFIG.HWUC?8:0,proxy_addr:V,proxy_port:parseInt(K),proxy_backup1_addr:Y,proxy_backup1_port:parseInt(q),proxy_backup2_addr:j,proxy_backup2_port:parseInt($)},account:G,call:{param_outgoingcode:h,cfg_firewall_mode:k,cfg_welink_symbol:window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?1:0,call_anonymous_enable:D?1:O?1:0,call_ipcall_enable:0,sip_keepalive_time:parseInt(w["Device.ComCfg.Sip.sipKeepaliveTime"]),bfcp_keepalive_time:parseInt(w["Device.ComCfg.Media.BfcpKeepaliveTime"])},sip:{audvie_mode:1,user_type:window.SERVERCONFIG.HWUC?0:1,trans_mode:H,tls_anonymous_enable:W,root_cert_path:window.EXEC_PATH+"\\",tls_version:7,regist_timeout:window.CLIENTCONFIG.ISBIGWIN?600:parseInt(w["Device.ComCfg.Sip.RegistExpires"]),white_list:y||"",white_list_count:y&&y.length>0?y.length:0,pai_priority:1,check_cseq:window.CLIENTCONFIG.ISBIGWIN?0:1},conf:{use_maa_confctrl:0,enable_ms_dataconf:1,ido_over_bfcp_version:parseInt(window.CLIENTCONFIG["Device.ComCfg.Conf.IsIdoBfcpRetransmission"])}},g.info("sip ido retransmission flag bit",parseInt(window.CLIENTCONFIG["Device.ComCfg.Conf.IsIdoBfcpRetransmission"])),e.abrupt("return",z);case 62:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(){var e=(0,d.default)(u.default.mark(function e(t,r){var n,o,a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.localIp,window.CLIENTCONFIG.ISMOBILE){e.next=9;break}return e.next=4,new coreTup.HwTupToolSdk;case 4:return o=e.sent,e.next=7,o.tupToolGetLocalIp(t,r,!1);case 7:a=e.sent,n=0===a.result&&""!==a.param.local_ip?a.param.local_ip:window.localIp;case 9:return g.info("checkLocalIpAddr: "+handleIp(n)),e.abrupt("return",n);case 11:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}()),v=(t.sipIpConfig=function(){var e=(0,d.default)(u.default.mark(function e(){var t;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={network:{local_ipv4:window.localIp}},e.abrupt("return",t);case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.configCall=function(){var e=Number($getState().setting.micAgc),t=parseInt(w["Device.ComCfg.Media.StreamAutomaticallyHangUp"]),r=window.CLIENTCONFIG.ISMOBILE?window.DEFAULT_CAMERA_IMG_PATH:window.VIDEO_DEFAULT_IMG+"default_camera.bmp",n=Number($getState().call.cameraNum),o={audio:{audio_codec:"112,9,8,0,98,18",dtmf_mode:1,net_ate_level:2,send_empty_audio_pkt:1,netate_redpt_switch:0,audio_pkt_red_num_in_stg:{opus_repeat_num:1,other_repeat_num:2},audio_rfc2198:{switch:1,red_pt:121,red_level:3},audio_anr:3,audio_aec:1,audio_agc:e,ilbcmode:20,audio_band_limit:{lowest_band_width:64,lowest_audio_codec:"112,98,18",lower_band_width:384,lower_audio_codec:"112,98,18,9,8,0"},audio_port_range:{min_port:10002,max_port:65528}},media:{video_preview_type:0===n?0:2,lowbandwidth_ability:1,loose_port_nego:1,chan_upd_dyn:1,video_default_image:0===n?r:"",enable_audio_bfcp:window.isSupportiDo?1:0},call:{stream_detect_enable:t,stream_detect_inrval:5}};return g.info("configCallInfo =",(0,f.default)(o)),o},t.configRejectCallType=function(){var e={sip:{reject_type:2}};return g.info("config[sip][reject_type] = ",e),e},t.configMKI=function(){var e=parseInt(w["Device.ComCfg.Media.EncryptCalloutUseMKI"]),t={media:{srtp_mki:e}};return g.info("configMKIInfo =",(0,f.default)(t)),t},t.configRTP=function(){var e=$getState().login,t=e.sipLoginissrtp,r=e.sipLoginOnly,n=e.srtpMode,o=n;o=""!==w["Device.ComCfg.Media.priorityRtp"]?parseInt(w["Device.ComCfg.Media.priorityRtp"]):1===t?1:0;var a=2;0===o&&(a=1),r&&(o=1===t?1:0);var i={media:{srtp_mode:o,rtp_priority:a,merge_srtp_rtp:1,support_ec_direction:1}};return g.info("configRTPInfo =",(0,f.default)(i)),i},t.configVideo=function(){var e=(0,d.default)(u.default.mark(function e(){var t,r,n,o,a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,L();case 3:return t.media=e.sent,r={},r.media=m(),n={},n.media=C(),o={},o.media=T(),a={media:{}},a.media=(0,i.default)({},t.media,r.media,n.media,o.media),g.info("configVideoInfo =",(0,f.default)(a)),e.abrupt("return",a);case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.configBFCP=function(){var e=(0,d.default)(u.default.mark(function e(){var t;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,I();case 3:return t.media=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),I=(t.configSessionTimer=function(){var e=parseInt(w["Device.ComCfg.Sip.enableSessionTimer"]),t=parseInt(w["Device.ComCfg.Sip.SessionTime"]),r={sip:{sessiontimer_enable:e,session_time:t}};return g.info("config[Session]TimerInfo =",desensitive(r)),r},t.configBandwidthLimit=function(){var e=parseInt(w["Device.ComCfg.Media.BandwidthLimit"]),t={media:{video_bitrate_limited:e}};return g.info("configBandwidthLimitInfo =",t),t},function(){var e=(0,d.default)(u.default.mark(function e(){var t,r,n,o,a,i,s,c,d,l,f,p;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=void 0,r=void 0,n=void 0,o=void 0,a=void 0,i=void 0,s=void 0,s=$getState().login,t=w.DATA_CONFIG_MEDIA_LEVEL,r=w.DATA_CONFIG_MEDIA_MAX_MBPS,n=w.DATA_CONFIG_MEDIA_MAX_BR,o=w.DATA_CONFIG_MEDIA_MAX_FS,a=4096,i=0,!window.CLIENTCONFIG.ISMOBILE){e.next=24;break}return e.next=11,new coreTup.HWTupCall;case 11:if(c=e.sent,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=19;break}return e.next=15,c.mediaGetHdaccelerate({hdaccelerate:{hdencoder:0,hddecoder:0}});case 15:d=e.sent,0===d.result?(g.info("[IT-Meeting] mediaGetHdaccelerate success, hdencoder = "+d.param.hdaccelerate.hdencoder),i=d.param.hdaccelerate.hdencoder):g.error("[IT-Meeting] mediaGetHdaccelerate failed, result = "+d.result),e.next=23;break;case 19:return e.next=21,c.mediaGetHdaccelerate({hd_accelerate:{hdencoder:0,hddecoder:0}});case 21:l=e.sent,0===l.result?(g.info("mediaGetHdaccelerate success, hdencoder = "+l.param.hd_accelerate.hdencoder),i=l.param.hd_accelerate.hdencoder):g.error("mediaGetHdaccelerate failed, result = "+l.result);case 23:a=S(i);case 24:return g.info("The default bandWidth is: "+a),f=void 0,window.CLIENTCONFIG.ISMOBILE?(a>=384?(t=22,r=27e3,n=w.DATA_CONFIG_MEDIA_MAX_BR,o=9e3):(t=20,r=10800,n=w.DATA_CONFIG_MEDIA_MAX_BR,o=3600),f={table_num:4,param_set:[{band_width:300,width:1280,height:720,max_frame_rate:3,min_frame_rate:1,max_bit_rate:300,min_bit_rate:32},{band_width:192,width:1280,height:720,max_frame_rate:3,min_frame_rate:1,max_bit_rate:192,min_bit_rate:32},{band_width:128,width:1280,height:720,max_frame_rate:3,min_frame_rate:1,max_bit_rate:128,min_bit_rate:32},{band_width:64,width:1280,height:720,max_frame_rate:3,min_frame_rate:1,max_bit_rate:64,min_bit_rate:32}]}):(t=31,r=9e4,n=w.DATA_CONFIG_MEDIA_MAX_BR,o=9e3,f={table_num:6,param_set:[{band_width:512,width:1920,height:1080,max_frame_rate:5,min_frame_rate:1,max_bit_rate:512,min_bit_rate:32},{band_width:384,width:1920,height:1080,max_frame_rate:3,min_frame_rate:1,max_bit_rate:384,min_bit_rate:32},{band_width:256,width:1920,height:1080,max_frame_rate:2,min_frame_rate:1,max_bit_rate:256,min_bit_rate:32},{band_width:192,width:1920,height:1080,max_frame_rate:1,min_frame_rate:1,max_bit_rate:192,min_bit_rate:32},{band_width:128,width:1920,height:1080,max_frame_rate:1,min_frame_rate:1,max_bit_rate:128,min_bit_rate:32},{band_width:64,width:1920,height:1080,max_frame_rate:1,min_frame_rate:1,max_bit_rate:64,min_bit_rate:32}]},window.CLIENTCONFIG.ISBIGWIN&&(t=40,r=246e3,n=w.DATA_CONFIG_MEDIA_MAX_BR,o=8192,f={table_num:8,param_set:[{band_width:1536,width:1920,height:1080,max_frame_rate:5,min_frame_rate:1,max_bit_rate:1536,min_bit_rate:32},{band_width:1152,width:1920,height:1080,max_frame_rate:5,min_frame_rate:1,max_bit_rate:1152,min_bit_rate:32},{band_width:512,width:1920,height:1080,max_frame_rate:5,min_frame_rate:1,max_bit_rate:512,min_bit_rate:32},{band_width:384,width:1920,height:1080,max_frame_rate:3,min_frame_rate:1,max_bit_rate:384,min_bit_rate:32},{band_width:256,width:1920,height:1080,max_frame_rate:2,min_frame_rate:1,max_bit_rate:256,min_bit_rate:32},{band_width:192,width:1920,height:1080,max_frame_rate:1,min_frame_rate:1,max_bit_rate:192,min_bit_rate:32},{band_width:128,width:1920,height:1080,max_frame_rate:1,min_frame_rate:1,max_bit_rate:128,min_bit_rate:32},{band_width:64,width:1920,height:1080,max_frame_rate:1,min_frame_rate:1,max_bit_rate:64,min_bit_rate:32}]})),p=512,p=a<384?a/2:a<512?192:a<768?256:a<1152?384:a<2048?512:a<2880?768:a<3840?1536:a<5760?1920:a/2,constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP===s.fireWallMode&&(window.CLIENTCONFIG.ISMOBILE?p=a>=384?192:a/2:a>=768&&a<1024?p=192:a>=1024&&a<=4096&&(p=256)),e.abrupt("return",h(s,t,o,r,p,f));case 31:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),h=function(e,t,r,n,o,a){var i=window.CLIENTCONFIG,s=parseInt(i["Device.ComCfg.Media.BFCPMode"]),u=coreCommon.sha512(e.serverAddress);2===s&&(s=1);var c=!1;u===constant.SERVER_ADDRESS_SHA512.CLOUDEC&&(c=!0);var d=constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP===e.fireWallMode,l=parseInt(i["Device.ComCfg.Media.DataNetRat"]),p=parseInt(i["Device.ComCfg.Media.DataKeyFrameIntervalNetRat"]);window.CLIENTCONFIG.ISMOBILE&&(l=5,p=0);var _=d?0:parseInt(i["Device.ComCfg.Media.DataHarq"]),w=c?0:parseInt(i["Device.ComCfg.Media.DataARS"]),E=c?0:parseInt(i["Device.ComCfg.Media.DataARSFrameSize"]),v=c?0:parseInt(i["Device.ComCfg.Media.DataARSFrameRate"]),I=c?0:parseInt(i["Device.ComCfg.Media.DataARSBitRate"]),h=c?0:parseInt(i["Device.ComCfg.Media.DataArsFec"]),m=c?0:parseInt(i["Device.ComCfg.Media.DataShaping"]),L=d?512:384,C={enable_bfcp:1,enable_data:1,aux_fir_response_interval:500,bfcp_param:{floor_ctrl:3,setup:3,trans_type:s},bfcp_port_range:{min_port:5070,max_port:5090,ulTlsPort:5071},data_framesize:{decode_framesize:16,framesize:3},data_framerate:{frame_rate:3,min_frame_rate:1},data_port_range:{min_port:10006,max_port:65532},data_level:{level:t,max_fs:r,max_mbps:n},data_datarate:{max_bw:o},tmmbr_threshold:{data_limit:L,min_data_bandwidth:64,min_video_bandwidth:64},data_codec:"106",data_arq:parseInt(i["Device.ComCfg.Media.DataArq"]),data_harq:_,data_errorcorrecting:i.DATA_CONFIG_MEDIA_DATA_ERRORCORRECTING,data_net_lossrate:l,data_keyframe_interval:p,data_ars:{ars:w,ars_ctrl_framesize:E,ars_ctrl_framerate:v,ars_ctrl_bitrate:I,ars_ctrl_fec:h,ars_data_shaping:m},data_h264_quality_level_table:{param_setnumber:4,quality_level_param_set:[{codec_name:"",pt:105,profile_idc:66,packet_mode:1,level_asymmetry:1,priority:3},{codec_name:"",pt:106,profile_idc:66,packet_mode:0,level_asymmetry:1,priority:4},{codec_name:"",pt:107,profile_idc:100,packet_mode:1,level_asymmetry:1,priority:1},{codec_name:"",pt:108,profile_idc:100,packet_mode:0,level_asymmetry:1,priority:2}]}};return C.data_resolution_table=a,g.info("media:BFCP参数 media =",(0,f.default)(C)),C},m=(t.configBFCPForTLS=function(){var e=(0,d.default)(u.default.mark(function e(t){var r,n,o,a,i,s,c,d,l,f,p,w,E,v,I,h,m,L,C,T,S,R,O,y,A,b,P;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreSecurity.decryptKMC(window.bfcpp);case 2:if(r=e.sent,n=r&&r.param&&r.param.PlainText||"",g.info("configBFCPForTLS mode : "+t+" path: "+window.EXEC_PATH),g.info("configBFCPForTLS bfcpTLSP decrytp: "+(""===n?"failed":"success")),o=window.EXEC_PATH+"/BfcpTLS/",a=window.EXEC_PATH+"/BfcpTLS/server.pem",i=window.EXEC_PATH+"/BfcpTLS/server_key.pem","win"!==window.CLIENTCONFIG.PLATFORM&&"bigwin"!==window.CLIENTCONFIG.PLATFORM||(o=window.EXEC_PATH+"\\BfcpTLS\\",a=window.EXEC_PATH+"\\BfcpTLS\\server.pem",i=window.EXEC_PATH+"\\BfcpTLS\\server_key.pem"),window.CLIENTCONFIG.ISMOBILE){e.next=53;break}return e.next=13,coreDb.queryLoginSetting({key:"importCertificate"});case 13:return s=e.sent,e.next=16,coreDb.queryLoginSetting({key:"certificateName"});case 16:return c=e.sent,"{}"===s&&(s=null),"{}"===c&&(c=null),g.info("_importCertificate : "+s+" _certificateName: "+c),e.next=22,(0,_.loginforverificationCertificateLogic)();case 22:if(d=e.sent,g.info("是否存在:"+d),!d||isNullOrEmpty(s)||isNullOrEmpty(c)){e.next=40;break}if("false"!==s.value||""===c.value){e.next=38;break}return l=N(),e.next=29,coreSecurity.decryptKMC(l);case 29:r=e.sent,n=r&&r.param&&r.param.PlainText||"",g.info("使用导入的证书"),g.info("configBFCPForTLS mode : "+t+" path: "+APP_DATA_PATH),g.info("configBFCPForTLS bfcpTLSP decrytp: "+(""===n?"failed":"success")),o=APP_DATA_PATH+"/ImpBfcpTLS/",a=APP_DATA_PATH+"/ImpBfcpTLS/server.pem",i=APP_DATA_PATH+"/ImpBfcpTLS/server_key.pem","win"!==window.CLIENTCONFIG.PLATFORM&&"bigwin"!==window.CLIENTCONFIG.PLATFORM||(o=APP_DATA_PATH+"\\ImpBfcpTLS\\",a=APP_DATA_PATH+"\\ImpBfcpTLS\\server.pem",i=APP_DATA_PATH+"\\ImpBfcpTLS\\server_key.pem");case 38:e.next=53;break;case 40:if("mac"!==window.CLIENTCONFIG.PLATFORM){e.next=53;break}if(f=window.path.join(window.APP_DATA_PATH,"deviceCertificate"),!fs.existsSync(f)||!fs.lstatSync(f).isDirectory()){e.next=53;break}if(p=window.path.join(f,"p4bfcp.txt"),w=window.path.join(f,"server.pem"),E=window.path.join(f,"server_key.pem"),!(fs.existsSync(p)&&fs.existsSync(w)&&fs.existsSync(E))){e.next=53;break}return v=fs.readFileSync(p).toString(),e.next=50,coreSecurity.decryptKMC(v);case 50:I=e.sent,h=I&&I.param&&I.param.PlainText||"",h&&(g.info("using refreshing device certificate"),n=h,o=f,a=w,i=E);case 53:if(!window.CLIENTCONFIG.ISMOBILE){e.next=83;break}if(g.info(" mobile 使用导入的证书"),m=$getState().login,L=m.mProveName,C=m.mSelectProve,C||""===L){e.next=83;break}return T=window.EXEC_PATH+"/impBfcpTLS",S=window.EXEC_PATH+"/impBfcpTLS/server.pem",e.next=61,(0,_.verificationCertificateLogic)(S);case 61:if(R=e.sent,g.info(" mobile login for is impt vc vcFlag: ",R),!R){e.next=83;break}g.info(" prove is ok "),O=void 0,e.next=72;break;case 69:O=e.sent,e.next=73;break;case 72:O=appService.mReadImptP4BFCP(T+"/p4bfcp.txt");case 73:return e.next=75,coreSecurity.decryptKMC(O);case 75:r=e.sent,n=r&&r.param&&r.param.PlainText||"",g.info("mobile 使用导入的证书"),g.info("configBFCPForTLS mode : "+t+" path: "+T),g.info("configBFCPForTLS bfcpTLSP decrytp: "+(""===n?"failed":"success")),o=window.EXEC_PATH+"/impBfcpTLS/",a=window.EXEC_PATH+"/impBfcpTLS/server.pem",i=window.EXEC_PATH+"/impBfcpTLS/server_key.pem";case 83:return y=t?1:0,A=6,b=0,P={bfcp_tls_param:{bfcp_tls_ctrl_mode:y,tls_version:A,tls_verify_mode:b,root_cert_path:o,srv_cert_file:a,srv_private_kfile:i,srv_private_kfile_pw:n,clt_cert_file:a,clt_private_kfile:i,clt_private_kfile_pw:n}},e.abrupt("return",P);case 88:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=window.CLIENTCONFIG,t=$getState().login,r=t.fireWallMode,n=t.serverAddress;coreCommon.sha512(n),constant.SERVER_ADDRESS_SHA512.CLOUDEC;var o=!1;constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP===r&&(o=!0);var a=parseInt(e["Device.ComCfg.Media.VideoNetRat"]),i=parseInt(e["Device.ComCfg.Media.VideoKeyFrameIntervalNetRat"]),s=o?0:parseInt(e["Device.ComCfg.Media.VideoHarq"]);window.CLIENTCONFIG.ISMOBILE&&(a=20,i=150);var u={video_errorcorrecting:e.VIDEO_CONFIG_MEDIA_VIDEO_ERRORCORRECTING,video_arq:parseInt(e["Device.ComCfg.Media.VideoArq"]),video_harq:s,ec_pkt_in_rtp:parseInt(e["Device.ComCfg.Media.EcPktInRtp"]),net_lossrate:a,keyframe_interval:i};return g.info(" media:视频抗丢包配置参数 media =",(0,f.default)(u)),u}),L=(t.initVideoHardCodeParam=function(){var e=(0,d.default)(u.default.mark(function e(){var t,r,n,o,a,i,s,c,d;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=void 0,r=void 0,t=0,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=14;break}if(!window.CLIENTCONFIG.ISMOBILE){e.next=12;break}return e.next=6,new coreTup.HWTupCall;case 6:return n=e.sent,e.next=9,n.mediaGetHdaccelerate({hdaccelerate:{hdencoder:0,hddecoder:0}});case 9:o=e.sent,0===o.result?(g.info("hard code mediaGetHdaccelerate success, hdencoder = "+o.param.hdaccelerate.hdencoder),t=o.param.hdaccelerate.hdencoder):g.error("hard code mediaGetHdaccelerate failed, result = "+o.result),r=S(t);case 12:e.next=23;break;case 14:if(!window.CLIENTCONFIG.ISMOBILE){e.next=23;break}return e.next=17,new coreTup.HWTupCall;case 17:return a=e.sent,e.next=20,a.mediaGetHdaccelerate({hd_accelerate:{hdencoder:0,hddecoder:0}});case 20:i=e.sent,0===i.result?(g.info("hard code mediaGetHdaccelerate success, hdencoder = "+i.param.hd_accelerate.hdencoder),t=i.param.hd_accelerate.hdencoder):g.error("hard code mediaGetHdaccelerate failed, result = "+i.result),r=S(t);case 23:return s={},c=0,window.CLIENTCONFIG.ISMOBILE&&1===t&&r>256&&(c=1),d=void 0!==window.isConfHardCode?parseInt(window.isConfHardCode,10):1,window.CLIENTCONFIG.ISMOBILE?s.video_hdaccelerate={hd_encoder:c,hd_decoder:0}:(s.video_hdaccelerate={hd_encoder:c,hd_decoder:d},g.info("media:is hddecoder:"+d)),g.info("media:is hdencoder:"+c),g.info("media: media =",(0,f.default)(s)),e.abrupt("return",s);case 31:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.initVideoSettingParam=function(){var e=(0,d.default)(u.default.mark(function e(){var t,r,n,o,a,i,s,c,d,l,p,_,w,E,v,I,h,m,L,C,T,N;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=void 0,r=void 0,n=void 0,o=void 0,a=void 0,i=void 0,s=void 0,c=coreCommon.sha512($getState().login.serverAddress),t=c===constant.SERVER_ADDRESS_SHA512.CLOUDEC,r=window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_LEVEL,n=window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_MAX_MBPS,o=window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_MAX_BR,a=window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_MAX_FS,i=4096,s=0,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=22;break}if(!window.CLIENTCONFIG.ISMOBILE){e.next=19;break}return e.next=13,new coreTup.HWTupCall;case 13:return d=e.sent,e.next=16,d.mediaGetHdaccelerate({hdaccelerate:{hdencoder:0,hddecoder:0}});case 16:l=e.sent,0===l.result?(g.info("[IT-Meeting] mediaGetHdaccelerate success, hdencoder = "+l.param.hdaccelerate.hdencoder),s=l.param.hdaccelerate.hdencoder):g.error("[IT-Meeting] mediaGetHdaccelerate failed, result = "+l.result),i=S(s);case 19:g.info("The default bandWidth is: "+i),e.next=32;break;case 22:if(!window.CLIENTCONFIG.ISMOBILE){e.next=31;break}return e.next=25,new coreTup.HWTupCall;case 25:return p=e.sent,e.next=28,p.mediaGetHdaccelerate({hd_accelerate:{hdencoder:0,hddecoder:0}});case 28:_=e.sent,0===_.result?(g.info("mediaGetHdaccelerate success, hdencoder = "+_.param.hd_accelerate.hdencoder),s=_.param.hd_accelerate.hdencoder):g.error("mediaGetHdaccelerate failed, result = "+_.result),i=S(s);case 31:g.info("The default bandWidth is: "+i);case 32:if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(i<1e3||window.netWorkType===constant.NETWORK_TYPE.TYPE_2G)&&(window.linkSmcIsVideo=!1,g.info("[IT-Meeting] bandwidth < 1000, join conference in audio",window.linkSmcIsVideo)),w=1500,constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP===$getState().login.fireWallMode&&(w=1280),!window.CLIENTCONFIG.ISMOBILE&&i>=1024&&constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP!==$getState().login.fireWallMode&&(r=40),!window.CLIENTCONFIG.ISWIN){e.next=46;break}return r=40,e.next=40,coreConf.registerNativeWndEvent();case 40:return e.next=42,coreConf.NativeInterface.notifyGetSystemInfo();case 42:return E=e.sent,e.next=45,coreConf.unregisterNativeWndEvent();case 45:E&&(window.cpu_core_num=E.cpu_core_num,window.cpu_proc_num=E.cpu_proc_num,window.cpu_freq_mhz=E.cpu_freq_mhz,2===window.cpu_core_num&&(2===window.cpu_proc_num||window.cpu_freq_mhz<2e3)?(r=21,n=18400,a=920):2===window.cpu_core_num&&4===window.cpu_proc_num&&(r=32),g.info("set decode level by cpu cores and cpu freq:",r));case 46:return window.CLIENTCONFIG.ISMOBILE&&(r=30,n=72e3,a=3600,(t||c===constant.SERVER_ADDRESS_SHA512.BCLOUDEC||window.CLIENTCONFIG.ENABLE_IT_MEETING)&&(r=21,n=18400,a=920)),v={video_level:{level:r,max_mbps:n,max_br:window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_MAX_BR,max_fs:a},sdp_ct:i,video_svc_enable:window.CLIENTCONFIG.USE_MEETING?1:0,data_video_svc_cap:{pktmode:2},video_mtu:w,video_datarate:{max_bw:i},clarity_fluency_enable:window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_CLARITY_FLUENCY_ENABLE,video_tatic:window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_VIDEO_TATIC,video_h264_force_single_pt:window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_H264_FORCE_SINGLE_PT,sec_version:{sec10:window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_SEC_VERSION,sec20:window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_SEC_VERSION,sec21:window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_SEC_VERSION,sec30:window.CLIENTCONFIG.VIDEO_CONFIG_MEDIA_SEC_VERSION},video_port_range:{min_port:10004,max_port:65530}},I=void 0,h=void 0,m=void 0,L=void 0,C=void 0,m=parseInt(window.CLIENTCONFIG["Device.ComCfg.Media.TmmbrControl"]),L=0,window.CLIENTCONFIG.ISMOBILE?(I={is_video_bw_include_audio:1,is_video_bw_subduct_aux:1,is_h264_hp_same_with_bp:1,is_video_bw_subduct_aux_recv:0},1===s&&i>256&&(L=1),h=L?{table_num:11,param_set:[{band_width:1984,width:1280,height:720,max_frame_rate:20,min_frame_rate:15,max_bit_rate:2304,min_bit_rate:896,adjust_bit_rate:2304},{band_width:1856,width:1280,height:720,max_frame_rate:20,min_frame_rate:15,max_bit_rate:2176,min_bit_rate:896,adjust_bit_rate:2176},{band_width:1472,width:1280,height:720,max_frame_rate:20,min_frame_rate:15,max_bit_rate:1792,min_bit_rate:896,adjust_bit_rate:1792},{band_width:1408,width:1280,height:720,max_frame_rate:20,min_frame_rate:15,max_bit_rate:1728,min_bit_rate:896,adjust_bit_rate:1728},{band_width:960,width:1280,height:720,max_frame_rate:20,min_frame_rate:15,max_bit_rate:1260,min_bit_rate:896,adjust_bit_rate:1433},{band_width:704,width:960,height:544,max_frame_rate:20,min_frame_rate:15,max_bit_rate:896,min_bit_rate:640,adjust_bit_rate:1280},{band_width:448,width:640,height:368,max_frame_rate:20,min_frame_rate:15,max_bit_rate:640,min_bit_rate:448,adjust_bit_rate:900},{band_width:320,width:480,height:272,max_frame_rate:20,min_frame_rate:15,max_bit_rate:448,min_bit_rate:320,adjust_bit_rate:640},{band_width:192,width:320,height:176,max_frame_rate:20,min_frame_rate:15,max_bit_rate:320,min_bit_rate:32,adjust_bit_rate:400},{band_width:128,width:320,height:176,max_frame_rate:20,min_frame_rate:15,max_bit_rate:192,min_bit_rate:32,adjust_bit_rate:200},{band_width:64,width:320,height:176,max_frame_rate:20,min_frame_rate:15,max_bit_rate:96,min_bit_rate:32,adjust_bit_rate:100}]}:{table_num:11,param_set:[{band_width:1984,width:640,height:360,max_frame_rate:20,min_frame_rate:15,max_bit_rate:2304,min_bit_rate:448,adjust_bit_rate:900},{band_width:1856,width:640,height:360,max_frame_rate:20,min_frame_rate:15,max_bit_rate:2176,min_bit_rate:448,adjust_bit_rate:900},{band_width:1472,width:640,height:360,max_frame_rate:20,min_frame_rate:15,max_bit_rate:1792,min_bit_rate:448,adjust_bit_rate:900},{band_width:1408,width:640,height:360,max_frame_rate:20,min_frame_rate:15,max_bit_rate:1728,min_bit_rate:448,adjust_bit_rate:900},{band_width:960,width:640,height:360,max_frame_rate:20,min_frame_rate:15,max_bit_rate:1260,min_bit_rate:448,adjust_bit_rate:900},{band_width:704,width:640,height:360,max_frame_rate:20,min_frame_rate:15,max_bit_rate:896,min_bit_rate:448,adjust_bit_rate:900},{band_width:448,width:640,height:360,max_frame_rate:20,min_frame_rate:15,max_bit_rate:640,min_bit_rate:448,adjust_bit_rate:900},{band_width:320,width:480,height:270,max_frame_rate:20,min_frame_rate:15,max_bit_rate:448,min_bit_rate:320,adjust_bit_rate:640},{band_width:192,width:320,height:180,max_frame_rate:20,min_frame_rate:15,max_bit_rate:320,min_bit_rate:192,adjust_bit_rate:400},{band_width:128,width:176,height:98,max_frame_rate:20,min_frame_rate:15,max_bit_rate:192,min_bit_rate:32,adjust_bit_rate:200},{band_width:64,width:176,height:98,max_frame_rate:20,min_frame_rate:15,max_bit_rate:96,min_bit_rate:32,adjust_bit_rate:100}]}):(I={is_video_bw_include_audio:1,is_video_bw_subduct_aux:1,is_h264_hp_same_with_bp:1,is_video_bw_subduct_aux_recv:0},h={table_num:11,param_set:[{band_width:1984,width:1280,height:720,max_frame_rate:30,min_frame_rate:22,max_bit_rate:2304,min_bit_rate:896,adjust_bit_rate:2304},{band_width:1856,width:1280,height:720,max_frame_rate:30,min_frame_rate:22,max_bit_rate:2176,min_bit_rate:896,adjust_bit_rate:2176},{band_width:1472,width:1280,height:720,max_frame_rate:30,min_frame_rate:22,max_bit_rate:1792,min_bit_rate:896,adjust_bit_rate:1792},{band_width:1408,width:1280,height:720,max_frame_rate:30,min_frame_rate:22,max_bit_rate:1728,min_bit_rate:896,adjust_bit_rate:1728},{band_width:960,width:1280,height:720,max_frame_rate:30,min_frame_rate:22,max_bit_rate:1280,min_bit_rate:896,adjust_bit_rate:1433},{band_width:704,width:960,height:540,max_frame_rate:30,min_frame_rate:22,max_bit_rate:896,min_bit_rate:640,adjust_bit_rate:900},{band_width:448,width:768,height:432,max_frame_rate:25,min_frame_rate:10,max_bit_rate:640,min_bit_rate:192,adjust_bit_rate:900},{band_width:320,width:768,height:432,max_frame_rate:25,min_frame_rate:10,max_bit_rate:512,min_bit_rate:192,adjust_bit_rate:640},{band_width:192,width:768,height:432,max_frame_rate:25,min_frame_rate:10,max_bit_rate:384,min_bit_rate:192,adjust_bit_rate:400},{band_width:128,width:512,height:288,max_frame_rate:15,min_frame_rate:10,max_bit_rate:192,min_bit_rate:96,adjust_bit_rate:200},{band_width:64,width:512,height:288,max_frame_rate:15,min_frame_rate:10,max_bit_rate:96,min_bit_rate:32,adjust_bit_rate:100}]},T=window.localStorage.getItem("svc_video_level_tbl_id"),isNullOrEmpty(T)&&(T=0),(T<0||T>=3)&&(T=0),C=constant.SvcResolutionPCTable[T],window.CLIENTCONFIG.ISWIN&&2===window.cpu_core_num&&2===window.cpu_proc_num&&(C=constant.SvcResolutionPCTable[constant.SVCResolutionLevel.STANDARD])),v.video_resolution_table=h,window.CLIENTCONFIG.ISBIGWIN||(v.svc_resolution_table=C),v.video_resolution_adj_num=4,v.fluid_control=m,v.bandwidth_calc_policy=I,N=void 0!==window.isConfHardCode?parseInt(window.isConfHardCode,10):1,v.video_hdaccelerate={hd_encoder:L,hd_decoder:N},window.CLIENTCONFIG.ISMOBILE?v.video_hdaccelerate={hd_encoder:L,hd_decoder:0}:(v.video_hdaccelerate={hd_encoder:L,hd_decoder:N},g.info("media:视频配置参数(设置降档表相关) media hard code:"+N)),g.info("media:视频配置参数(设置降档表相关) media =",(0,f.default)(v)),e.abrupt("return",v);case 62:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),C=function(){var e=window.CLIENTCONFIG,t=$getState().login,r=t.serverAddress,n=!1;coreCommon.sha512(r)===constant.SERVER_ADDRESS_SHA512.CLOUDEC&&(n=!0);var o=n?0:parseInt(e["Device.ComCfg.Media.VideoShaping"]),a={rtp_hdr_ext:1,video_ars:{ars:parseInt(e["Device.ComCfg.Media.VideoARS"]),ars_ctrl_framesize:parseInt(e["Device.ComCfg.Media.VideoARSFrameSize"]),ars_ctrl_framerate:parseInt(e["Device.ComCfg.Media.VideoARSFrameRate"]),ars_ctrl_bitrate:parseInt(e["Device.ComCfg.Media.VideoARSBitRate"]),ars_ctrl_fec:parseInt(e["Device.ComCfg.Media.VideoArsFec"]),ars_data_shaping:o}};return g.info("media:自动降速配置参数 media =",(0,f.default)(a)),a},T=function(){var e={h264_quality_level_table:{param_setnumber:4,quality_level_param_set:[{codec_name:"",pt:105,profile_idc:66,packet_mode:1,level_asymmetry:1,priority:3},{codec_name:"",pt:106,profile_idc:66,packet_mode:0,level_asymmetry:1,priority:4},{codec_name:"",pt:107,profile_idc:100,packet_mode:1,level_asymmetry:1,priority:1},{codec_name:"",pt:108,profile_idc:100,packet_mode:0,level_asymmetry:1,priority:2}]}};return g.info("media:BP/HP参数 media =",(0,f.default)(e)),e},S=(t.reConfigVideoAndDataSetting=function(){var e=(0,d.default)(u.default.mark(function e(){var t,r,n,o;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,L();case 3:return t.media=e.sent,e.next=6,new coreTup.HWTupCall;case 6:return r=e.sent,e.next=9,r.config(t);case 9:return e.next=11,v();case 11:return n=e.sent,e.next=14,r.config(n);case 14:"android"===window.CLIENTCONFIG.PLATFORM&&(o=void 0!==window.isConfHardCode?parseInt(window.isConfHardCode,10):1,g.info("android hard decoder enter 1",o),window.isHardDecodeToNative(o));case 15:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.restoreMAAConfControl=function(){var e=(0,d.default)(u.default.mark(function e(){var t,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=2;break}return e.abrupt("return");case 2:return g.info("restoreMAAConfControl"),t={conf:{use_maa_confctrl:1}},e.next=6,new coreTup.HWTupCall;case 6:r=e.sent,r.config(t);case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(e){var t=4096,r=window.netWorkType;return g.info("The current network type is: "+r+", bSupport Hdacc:"+e),r===constant.NETWORK_TYPE.TYPE_WIFI?t=parseInt(w["Device.ComCfg.Media.Mobile.WifiSoftCodedTotalBandwidth"]):r===constant.NETWORK_TYPE.TYPE_4G?t=parseInt(w["Device.ComCfg.Media.Mobile.4GTotalBandwidth"]):r===constant.NETWORK_TYPE.TYPE_3G&&(t=parseInt(w["Device.ComCfg.Media.Mobile.3GTotalBandwidth"])),t}),N=function(){g.info("getPFourbfcpLogic");try{var e=window.fs;if(e){var t=APP_DATA_PATH+"/ImpBfcpTLS",r=t+"/p4bfcp.txt";if(e.existsSync(r))return e.readFileSync(r).toString()}}catch(e){g.error("getPFourbfcpLogic",e.toString())}};t.serPointPickupCfg=function(){var e={service:{server_right:{type:7,active_accesscode:w["Device.ComCfg.Service.pointPickupActive"],deactive_accesscode:"",register:0,right:0}}};return g.info("serPointPickupCfg =",(0,f.default)(e)),e},t.serGroupPickupCfg=function(){var e={service:{server_right:{type:6,active_accesscode:w["Device.ComCfg.Service.groupPickupActive"],deactive_accesscode:"",register:0,right:0}}};return g.info("serGroupPickupCfg =",(0,f.default)(e)),e}},628:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.buildStg=t.startPortDetect=t.startFireWallDetect=t.checkStgReConnect=t.updateStgAuthInfo=t.portDetect=t.fireWallDetect=t.destroyStgTunnel=t.buildStgTunnel=t.updateFireWallAndSipInfo=t.updateStgInfo=t.stgTunnelDisconnected=void 0;var o=r(67),a=n(o),i=r(126),s=n(i),u=r(3),c=n(u),d=r(1),l=n(d),f=r(2),p=n(f),_=r(143),g=n(_),w=(t.startFireWallDetect=function(){var e=(0,p.default)(l.default.mark(function e(t){var r,n,o,a=this;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("[ startFireWallDetect ]  svnUri: "+t),r=(0,E.getLoginModel)(),e.next=4,new coreTup.HWUportal;case 4:return n=e.sent,o=new c.default(function(e,o){var i=function(){var t=(0,p.default)(l.default.mark(function t(n){var i;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=n.param,i&&0===i.result?(I.info("[ fireWallDetectResult ] success. The fireWall mode is  ",i.fire_wall_mode),r.fireWallDetectResult=i,e(i)):(I.error("[ fireWallDetectResult ] failed."),o((0,s.default)({},n,{result:!1,errorCode:E.UErrorCode.LOGIN_ERR_STG_TUNNEL_BUILD_ERROR,errorType:E.ErrorType.uportal})));case 2:case"end":return t.stop()}},t,a)}));return function(e){return t.apply(this,arguments)}}();n.setNotifyFunc(360463,i),C(t)}),e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.startPortDetect=function(){var e=(0,p.default)(l.default.mark(function e(t,r){var n,o,i,u=this;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("[ startPortDetect ] svnUri : "+t+", detectport"+r),n=(0,E.getLoginModel)(),e.next=4,new coreTup.HWUportal;case 4:return o=e.sent,i=new c.default(function(e,n){var i=function(){var t=(0,p.default)(l.default.mark(function t(r){var o;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:I.info("[ portDetectResult ]"),o=r.param,o?(I.info("portDetectResultdetect success. The fireWall mode is  "+(0,a.default)(o)),e(o)):(I.error("port detect failed."),n((0,s.default)({},r,{result:!1,errorCode:E.UErrorCode.LOGIN_ERR_STG_TUNNEL_BUILD_ERROR,errorType:E.ErrorType.uportal})));case 3:case"end":return t.stop()}},t,u)}));return function(e){return t.apply(this,arguments)}}();o.setNotifyFunc(360475,i),T(t,r)}),e.abrupt("return",i);case 7:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),t.buildStg=function(){var e=(0,p.default)(l.default.mark(function e(){var t,r,n,o,a,i,u,d,f,p,_;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,E.getLoginModel)(),r=t.stgUri,n=t.stgAccount,o=t.useIM,a=t.isCloudEcEnv,i=t.fireWallMode,u=t.maaProxyAddress,d=t.isSupportProxy,!t.isHWUC){e.next=4;break}return e.abrupt("return",c.default.resolve());case 4:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.ISBIGWIN){e.next=6;break}return e.abrupt("return",c.default.resolve());case 6:if(!coreCommon.isMobile()){e.next=10;break}return I.info("[ buildStg ] mobile can not buildStg"),u&&!d&&(I.info("[ buildStg ] mobile use tls"),t.socketMode=constant.IM_STG_MODE.USE_TLS),e.abrupt("return",c.default.resolve());case 10:if(f=!1,void 0===r||""===r||";"===r||";;"===r){e.next=33;break}if(I.info("[ buildStg ] uportal has stg stgUri; isCloudEcEnv:"+t.isCloudEcEnv),!d&&constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP!==i&&constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_HTTP_AND_SVN!==i){e.next=28;break}return e.next=16,coreSecurity.PasswordManager.getPassword("stgPassword");case 16:return p=e.sent,e.next=19,L({stgUri:r,stgAccount:n,stgPassword:p});case 19:if(_=e.sent,_.result){e.next=22;break}return e.abrupt("return",(0,E.LoginError)((0,s.default)({},_,{result:!1,errorCode:E.UErrorCode.LOGIN_ERR_STG_TUNNEL_BUILD_ERROR,errorType:E.ErrorType.uportal})));case 22:return f=!0,t.socketMode=f?constant.IM_STG_MODE.USE_STG:constant.IM_STG_MODE.NO_STG,u&&!d&&(t.socketMode=constant.IM_STG_MODE.USE_TLS),e.abrupt("return",_);case 28:t.socketMode=f?constant.IM_STG_MODE.USE_STG:constant.IM_STG_MODE.NO_STG,u&&!d&&(t.socketMode=constant.IM_STG_MODE.USE_TLS),I.info("[ buildStg ]no need to buildStg, only build stg for im mode or fireWallMode is 0 or 1; useIM:"+o+" fireWallMode:"+i);case 31:e.next=37;break;case 33:return I.info("[ buildStg ]no stgUri, no need to buildStg, isCloudEcEnv:"+t.isCloudEcEnv),t.socketMode=f?constant.IM_STG_MODE.USE_STG:constant.IM_STG_MODE.NO_STG,u&&!d&&(t.socketMode=constant.IM_STG_MODE.USE_TLS),e.abrupt("return");case 37:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()),E=r(309),v=r(351),I=window.Logger("login")("stg"),h=t.stgTunnelDisconnected=function(){I.info("stgTunnelDisconnected"),(0,E.getLoginModel)().set({isBuildStgSuc:!1}),window.dispatchEvent(new Event("stgTunnelDisconnected"))},m=t.updateStgInfo=function(e){I.info("[ updateStgInfo ]");var t=(0,E.getLoginModel)(),r=e.address,n=0===e.result,o=t.stgUri,a=t.eserverStgUri,i=0,s="";if(n){var u=a.split(";"),c=o.split(";"),d=c.length;if(r){for(var l=0;l<d;l++)if(-1!==c[l].indexOf(r)){s=u[l],i=l;break}}else s=u[0],i=0}var f=s.split(":"),p=(0,g.default)(f,2),_=p[0],w=p[1],v={stgUriUsed:r,currentNum:i,isBuildStgSuc:n,eServerAddress:_,eServerPort:parseInt(w)};return t.set(v),v},L=(t.updateFireWallAndSipInfo=function(e){I.info("[ updateFireWallAndSipInfo ]");var t=(0,E.getLoginModel)(),r=t.stgUri,n=(t.stgUriUsed,t.svnUri),o=t.sipStgUri,a=t.sipUri,i=r.split(";"),s=n.split(";"),u=o.split(";"),c=a.split(";"),d=(i.length,""),l="",f="",p="",_="",w=0;if(constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_ONLY_HTTP===e){var v=u.length;if(1===v){var h=u[0].split(":"),m=(0,g.default)(h,2);d=m[0],l=m[1]}if(2===v){var L=u[0].split(":"),C=(0,g.default)(L,2);d=C[0],l=C[1];var T=u[1].split(":"),S=(0,g.default)(T,2);f=S[0],p=S[1]}if(3===v){var N=u[0].split(":"),R=(0,g.default)(N,2);d=R[0],l=R[1];var O=u[1].split(":"),y=(0,g.default)(O,2);f=y[0],p=y[1];var A=u[2].split(":"),b=(0,g.default)(A,2);_=b[0],w=b[1]}}else if(constant.FIREWALL_MODE.LOGIN_E_FIREWALL_MODE_HTTP_AND_SVN===e){var P=s.length;if(1===P){var x=s[0].split(":"),k=(0,g.default)(x,2);d=k[0],l=k[1]}if(2===P){var M=s[0].split(":"),U=(0,g.default)(M,2);d=U[0],l=U[1];var D=s[1].split(":"),G=(0,g.default)(D,2);f=G[0],p=G[1]}if(3===P){var F=s[0].split(":"),B=(0,g.default)(F,2);d=B[0],l=B[1];var W=s[1].split(":"),H=(0,g.default)(W,2);f=H[0],p=H[1];var V=s[2].split(":"),K=(0,g.default)(V,2);_=K[0],w=K[1]}}else{var Y=c.length;if(1===Y){var q=c[0].split(":"),j=(0,g.default)(q,2);d=j[0],l=j[1]}if(2===Y){var $=c[0].split(":"),X=(0,g.default)($,2);d=X[0],l=X[1];var z=c[1].split(":"),J=(0,g.default)(z,2);f=J[0],p=J[1]}if(3===Y){var Q=c[0].split(":"),Z=(0,g.default)(Q,2);d=Z[0],l=Z[1];var ee=c[1].split(":"),te=(0,g.default)(ee,2);f=te[0],p=te[1];var re=c[2].split(":"),ne=(0,g.default)(re,2);_=ne[0],w=ne[1]}}var oe={sipServerAddress:d,sipServerPort:parseInt(l),sipServerBackup1:f,sipServerPortBackup1:p,sipServerLocal:_,sipServerPortLocal:w,fireWallMode:e,isGetFirewallRes:!0};t.set(oe)},t.buildStgTunnel=function(){var e=(0,p.default)(l.default.mark(function e(t){var r,n,o,a,i,s,u,c,d,f,p,_,w,L,C,T,S,N=t.stgUri,R=t.stgAccount,O=t.stgPassword;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(I.info("[ buildStgTunnel ]"),I.info("<account_login><5_build_stg>begin"),r=N.split(";"),n=r.length,o=new Array,a=0;a<n;a++)i=r[a].split(":"),s=(0,g.default)(i,2),u=s[0],c=s[1],d={server_uri:u,server_port:parseInt(c)},o.push(d);return f=window.EXEC_PATH,p={stg_num:n,stg_servers:o,user_name:R,password:O,ca_path:""},e.next=10,new coreTup.HWUportal;case 10:return _=e.sent,_.setNotifyFunc(360466,h),w=PromiseObject(),(0,E.getLoginModel)().shouldBuildStg=!0,e.next=16,_.buildStgTunnel(p,function(e){w.resolve(e)});case 16:return e.next=18,w;case 18:if(L=e.sent,C=L.param,T=(0,E.getLoginModel)(),0!==C.result){e.next=33;break}return e.next=24,(0,v.stopLocalServer)();case 24:return e.next=26,m(C);case 26:return S=e.sent,T.set({isBuildStgSuc:!0}),I.info("<account_login><5_build_stg>end ok"),I.info("buildStg build success."),e.abrupt("return",{result:!0,stgInfo:S});case 33:return T.set({isBuildStgSuc:!1}),I.info("<account_login><5_build_stg>end failed"),I.error("buildStg build fail."),e.abrupt("return",{result:!1,errorCode:E.UErrorCode.LOGIN_ERR_STG_TUNNEL_BUILD_ERROR});case 37:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),C=(t.destroyStgTunnel=function(){var e=(0,p.default)(l.default.mark(function e(){var t,r,n,o,a;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,E.getLoginModel)(),I.info("[ destroyStgTunnel ]"),e.next=4,new coreTup.HWUportal;case 4:return r=e.sent,n=PromiseObject(),r.destroyStgTunnel(function(e){n.resolve(e)}),e.next=9,n;case 9:if(o=e.sent,a=o.param,0!==a.result){e.next=17;break}return t.set({isBuildStgSuc:!1}),I.info("destroyStgTunnel success."),e.abrupt("return",{result:!0});case 17:I.error("destroyStgTunnel fail.");case 18:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.fireWallDetect=function(){var e=(0,p.default)(l.default.mark(function e(t){var r,n;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("[ fireWallDetect ]"),r=S(t,0),e.next=4,new coreTup.HWUportal;case 4:n=e.sent,n.fireWallDetect(r);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),T=t.portDetect=function(){var e=(0,p.default)(l.default.mark(function e(t,r){var n,o;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=S(t,r),e.next=3,new coreTup.HWUportal;case 3:o=e.sent,o.portDetect(n);case 5:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),S=function(e,t){for(var r=e.split(";"),n=r.length,o=new Array,a=0;a<n;a++){var i=r[a].split(":"),s=(0,g.default)(i,2),u=s[0],c=(s[1],{server_uri:u,server_port:t>0?t:0});o.push(c)}return{server_num:n,servers:o}};t.updateStgAuthInfo=function(){var e=(0,p.default)(l.default.mark(function e(t){var r,n,o=t.account,a=t.password;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={user_name:o,password:a},e.next=3,new coreTup.HWUportal;case 3:n=e.sent,n.updateStgAuthInfo(r);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.checkStgReConnect=function(){var e=(0,p.default)(l.default.mark(function e(){var t;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("checkStgReConnect "),t=(0,E.getLoginModel)(),t.isBuildStgSuc){e.next=13;break}return I.info("enter buildStg"),e.prev=4,e.next=7,w();case 7:e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(4),I.error("buildStg error"),"reconnect stg error";case 13:case"end":return e.stop()}},e,void 0,[[4,9]])}));return function(){return e.apply(this,arguments)}}()},629:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.iosCursorDeal=t.checkOffLineIsInCall=t.getIsReminder=t.getCloseType=t.getCloseAppWays=t.setLocalStatus=t.publishStatus=t.loadEserverSignature=t.loadMyInfo=t.updateCurUser=t.checkLocalHasMyinfo=t.checkStatusOptions=t.saveUserInfo=void 0;var o=r(128),a=n(o),i=r(67),s=n(i),u=r(126),c=n(u),d=r(129),l=n(d),f=r(1),p=n(f),_=r(2),g=n(_),w=r(310),E=r(353),v=r(800),I=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(v),h=r(183),m=window.Logger("logic")("main/myInfo"),L=(t.saveUserInfo=I.saveUserInfo,t.checkStatusOptions=I.checkStatusOptions,t.checkLocalHasMyinfo=function(){var e=(0,g.default)(p.default.mark(function e(){var t,r,n,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m.info("start checkLocalHasMyinfo"),!window.CLIENTCONFIG.ISBIGWIN){e.next=3;break}return e.abrupt("return",!1);case 3:return t=(0,E.getLoginModel)(),e.next=6,coreDb.queryLoginSetting({key:"myinfo"});case 6:if(r=e.sent,isNullOrEmpty(r)||!r.hasOwnProperty("key")||!r.hasOwnProperty("value")||isNullOrEmpty(r.key)||isNullOrEmpty(r.value)){e.next=15;break}if(n=r.value,isNullOrEmpty(n)){e.next=15;break}if(o=JSON.parse(n),isNullOrEmpty(o)||t.account!==o.compareAccount){e.next=15;break}return m.info(" checkLocalHasMyinfo : has local myinfo last copy"),(0,h.getMyInfo)().set(o),e.abrupt("return",!0);case 15:return m.info(" checkLocalHasMyinfo : no copy"),e.abrupt("return",!1);case 17:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.updateCurUser=function(){var e=(0,g.default)(p.default.mark(function e(t){var r,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,h.getMyInfo)(),t&&(n.name=t),(r=(0,h.getMyInfo)()).set.apply(r,(0,l.default)(n));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.loadMyInfo=function(){var e=(0,g.default)(p.default.mark(function e(t){var r,n,o,a,i,u,d,l,f,_,g,w,v,I;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,E.getLoginModel)(),m.info("loadMyInfo"),n=r.sipImpi,isNullOrEmpty(n)||-1!==(o=n.indexOf("@"))&&(n=n.slice(0,o)),!window.CLIENTCONFIG.ENABLE_IT_MEETING||window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=22;break}return a=window.getUserInfo(),i=window.getUportalRes(),u={},u.account=i.param.uportal_authorize_result.real_user_account,e.next=11,coreContact.getUserInfo(u.account);case 11:if(d=e.sent,l=d.param,!isNullOrEmpty(l)){e.next=20;break}return m.error("myinfo is null"),f=u.account.split("@")[0],(0,h.getMyInfo)().account=u.account,(0,h.getMyInfo)().name=f,(0,h.getMyInfo)().bind_no=n,e.abrupt("return");case 20:return(0,h.getMyInfo)().set((0,c.default)({},l)),e.abrupt("return");case 22:return e.next=24,coreContact.getUserInfo(t);case 24:if(_=e.sent,g=_.param,!isNullOrEmpty(g)){e.next=33;break}return m.error("myinfo is null"),w=r.displayAccount.split("@")[0],(0,h.getMyInfo)().account=t,(0,h.getMyInfo)().name=(0,h.getMyInfo)().name||w,(0,h.getMyInfo)().bind_no=n,e.abrupt("return");case 33:coreAccount.getLoginModel().isSupportAS&&(g.account=coreAccount.getLoginModel().account),g.dept_name_cn=g.dept_name_cn.replace(/\*/g,"-"),g.dept_name_en=g.dept_name_cn.replace(/\*/g,"-"),v=(0,c.default)({},g,{compareAccount:t}),I=(0,s.default)(v),coreDb.saveLoginSetting({key:"myinfo",value:I}),(0,h.getMyInfo)().set(v);case 40:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.loadEserverSignature=function(){var e=(0,g.default)(p.default.mark(function e(t){var r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.info("query eserver sig start"),e.next=3,coreContact.queryEserverSignature(t);case 3:if(r=e.sent,isNullOrEmpty(r)||1!==r.result){e.next=7;break}return m.info("query eserver sig-nature failed"),e.abrupt("return");case 7:(0,h.getMyInfo)().set(r);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),null),C=(t.publishStatus=function(){var e=(0,g.default)(p.default.mark(function e(t){var r,n,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=(0,E.getLoginModel)(),r.useIM){e.next=5;break}return m.info("publishStatus, now is te mode,not do publishStatus"),e.abrupt("return");case 5:if(n=window.CLIENTCONFIG.ISMOBILE?1:0,m.info("publishStatus,status:",t,"desc:",handlePhoneNumber(a)),t!==constant.ONLINE_STATUS.OFFLINE){e.next=22;break}return e.next=10,(0,w.setOffline)();case 10:if(!(o=e.sent)){e.next=19;break}return coreIm.dealOfflineFileSendOrReceiveFail(),(0,h.getMyInfo)().statusDesc="",(0,h.getMyInfo)().selectIndex=4,$dispatch(coreUi.cleanContactStatusMap()),e.abrupt("return",!0);case 19:return e.abrupt("return",!1);case 20:e.next=33;break;case 22:if(!window.isOffline){e.next=32;break}if(!r.loginDisable){e.next=26;break}return m.info("publishStatus, now loginDisable,not do login again"),e.abrupt("return",!1);case 26:return t===constant.ONLINE_STATUS.ONLINE&&((0,h.getMyInfo)().isOffToLine=!0),$dispatch(coreUi.updateUnreadSystemBulletin(0)),e.next=30,(0,w.login)(!1,!1,t,a);case 30:(0,h.getMyInfo)().isOffToLine=!1,I.checkStatusOptions();case 32:return e.abrupt("return",C(t,a,n));case 33:e.next=39;break;case 35:return e.prev=35,e.t0=e.catch(0),m.error("publishStatus",e.t0),e.abrupt("return",!1);case 39:case"end":return e.stop()}},e,void 0,[[0,35]])}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,g.default)(p.default.mark(function e(t,r,n){var o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!coreIm.checkEServerOnlineNoToast("publishStatus")){e.next=6;break}return e.next=3,T(t,r,n);case 3:return e.abrupt("return",e.sent);case 6:return coreIm.setUserLoginStatus({status:t,desc:r}),o=PromiseObject(),L&&(m.info("publishStatus remove pre _addedEServerLoginSuccessFunction"),window.removeEventListener("eServerLoginSuccess",L),L=null),L=function(){var e=(0,g.default)(p.default.mark(function e(){var a,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.info("publishStatus _addedEServerLoginSuccessFunction",(0,s.default)({status:t,desc:r})),window.removeEventListener("eServerLoginSuccess",L),L=null,a=coreIm.getUserLoginStatus(),e.next=6,T(a.status,a.desc,n);case 6:i=e.sent,o.resolve(i);case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),window.addEventListener("eServerLoginSuccess",L),m.info("publishStatus add eServerLoginSuccess callback",(0,s.default)({status:t,desc:r})),setTimeout(function(){return o.resolve(!1)},35e3),e.abrupt("return",o);case 14:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()),T=function(){var e=(0,g.default)(p.default.mark(function e(t,r,n){var o,i,u;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("number"!==Object.type(t)&&"string"!==Object.type(t)){e.next=14;break}return m.info("pushStatusToEServer",(0,s.default)({status:t,desc:r,client_type:n})),o=(0,E.getLoginModel)(),e.next=5,coreIm.publishStatusToServer({status:t,desc:r});case 5:if(!(i=e.sent)||0!==i.result){e.next=14;break}return u=o.account,o.status=t,$dispatch(coreUi.updataContactStatusMap((0,a.default)({},u,{status:t,desc:r,client_type:n}))),(0,h.getMyInfo)().status=t,(0,h.getMyInfo)().statusDesc=r,S(t),e.abrupt("return",!0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),S=function(e){coreSetting.checkAutoLeave(e),$getState().setting.shouldResetTray&&appService.initMainTray()};t.setLocalStatus=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=(0,E.getLoginModel)(),n=window.CLIENTCONFIG.ISMOBILE?1:0;m.info("changeLocalStatus:",e,"desc:",handlePhoneNumber(t));var o=r.account;$dispatch(coreUi.updataContactStatusMap((0,a.default)({},o,{status:e,desc:t,client_type:n}))),(0,h.getMyInfo)().status=e,(0,h.getMyInfo)().statusDesc=t,e===constant.ONLINE_STATUS.OFFLINE&&coreIm.dealOfflineFileSendOrReceiveFail()},t.getCloseAppWays=function(){var e=(0,g.default)(p.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:m.info("userClick  main page quit btn"),t?coreCommon.quickCloseApp():coreCommon.closeApp();case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getCloseType=function(){return window.localStorage.getItem("closeWays")},t.getIsReminder=function(){return window.localStorage.getItem("isReminder")},t.checkOffLineIsInCall=delegate(function(){try{m.info("click OffLint for checkAndEndCall");var e=$getState().call,t=e.showCallToolBar,r=e.callStatus;if(t||"VIDEO_CONNECTED"===r||"VIDEO_OUT"===r||"CALL_OUT"===r||"CALL_CONNECTED"===r){var n=language.COMMON_EXIT_THE_PROMPT;return window.CLIENTCONFIG.ISMOBILE||window.alert(n),!1}return!0}catch(e){return m.error("click OffLint for checkAndEndCall"),!1}},"CheckOffLineIsInCall"),t.iosCursorDeal=function(e){if("ios"===window.CLIENTCONFIG.PLATFORM&&0===e.target.value.length){var t=document.activeElement;"input"===t.nodeName.toLocaleLowerCase()&&setTimeout(function(){""===t.style.textShadow?t.style.textShadow="rgba(0, 0, 0, 0) 0 0 0":t.style.textShadow=""},20)}}},67:function(e,t,r){e.exports={default:r(68),__esModule:!0}},68:function(e,t,r){var n=r(8),o=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},709:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){B.info("[ checkHasProxyAndNoStgurl ]");var e=(0,b.getLoginModel)();return e.isSupportProxy&&!e.stgUri?(0,b.LoginError)({errorCode:P.UErrorCode.LOGIN_ERR_HAS_PROXY_NO_STG,errorType:constant.LOGIN_ERROR_TYPE.uportal}):p.default.resolve()}function a(){B.info("[ checkDuplicateLogin ]");var e=(0,b.getLoginModel)();return e.loginDisable&&!e.isTempLogin?(0,b.LoginError)({errorCode:"duplicateLogin",errorType:constant.LOGIN_ERROR_TYPE.common}):(e.setLoginStatus(!0),p.default.resolve(e))}function i(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];B.info("enableAutoLogin",e),window.CLIENTCONFIG.ISMOBILE?window.stroage.setFastLogin(e):remote.getGlobal("remoteVars").disable_auto_login=!e}function s(){(0,b.getLoginModel)().isInBuildStg=!0;var e=(0,y.buildStg)();return(0,b.getLoginModel)().isInBuildStg=!1,coreCommon.dispatchModuleEvent("login",{event:"buildStg",code:0}),e}function u(){var e=(0,b.getLoginModel)();return window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?void B.info("[IT-Meeting] no need to loadConfigFromDB"):(B.info("[ loadConfigFromDB ]"),e.isInLoadConfigFromDB=!0,(0,A.loadUserConfigFromDB)().then(function(){e.isInLoadConfigFromDB=!1,window.CLIENTCONFIG.ISBIGWIN?(coreSetting.saveChrUploadState(!0),B.info("big win or maxhub chr is AUTO!")):window.isHubEnv&&coreSetting.saveChrUploadState(!0),B.info("[ loadConfigFromDB ] ok! ",handlePhoneNumber(e.account))}))}function c(){var e=(0,b.getLoginModel)();return window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||e.isTempLogin?void B.info("[IT-Meeting] no need to initPrivateDB"):window.CLIENTCONFIG.ISBIGWIN?void B.info("[bigwin] no need to initPrivateDB"):(B.info("[ initPrivateDB ]"),e.isInInitPrivateDB=!0,coreDb.initSQLitePrivateDB(e.account).then(function(){e.isInInitPrivateDB=!1,B.info("[ initPrivateDB ] ok! ",handlePhoneNumber(e.account))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.checkShowPrivacy=t.ipLogin=t.checkForceSwtichAccount=t.initLoginInfo=t.reLogineServer=t.login=void 0;var d=r(67),l=n(d),f=r(3),p=n(f),_=r(1),g=n(_),w=r(2),E=n(w),v=function(){var e=(0,E.default)(g.default.mark(function e(){var t,r,n,o,a,i,s;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(B.info("[ initServices ]"),t=(0,b.getLoginModel)(),r=t.useIM,n=t.useSip,o=t.isMultiDeviceLogined,a=t.useEsight,i=t.isMobile,B.info("login success initServices: ",{useIM:r,useSip:n,isMultiDeviceLogined:o,isMobile:i,useEsight:a}),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(0,M.resetSipResumeFlag)(),!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||!window.noactivity){e.next=17;break}if(e.t0=window.CLIENTCONFIG.ISMOBILE,!e.t0){e.next=10;break}return e.next=9,window.isFloatWindow;case 9:e.t0=e.sent;case 10:if(!(s=e.t0)){e.next=15;break}B.info("the window is float "),e.next=17;break;case 15:return B.error("has no activity, login err!!!!!"),e.abrupt("return",(0,b.LoginError)({result:!1,errorCode:"webView has hide",errorType:constant.LOGIN_ERROR_TYPE.common}));case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,E.default)(g.default.mark(function e(){var t,r,n,o,a,s,u,c,d;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(B.info("[ prepareLogin ]"),B.info("<account_login><1_prepareLogin>begin"),window.mutiLanguage="FALSE",t=(0,b.getLoginModel)(),!t.isTempLogin){e.next=15;break}return B.info("prepareLogin: handle tempLogin info"),t.isTempLogin=!0,t.useIM=!1,window.CLIENTCONFIG.USE_IM=!1,r=$getState(),n=r.conf,o=n.confTempAcsAccount,a=n.confTempAcsUportalAddress,s=n.confTempAcsUportalPort,e.next=12,coreSecurity.PasswordManager.getPassword("password");case 12:u=e.sent,t.set({account:o,displayAccount:o,password:u,serverAddress:a,serverPort:s}),t.set({password:u});case 15:if(window.CLIENTCONFIG.ENABLE_IT_MEETING&&(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?(t.useIM=!1,window.CLIENTCONFIG.USE_IM=!1,t.set({serverAddress:window.getLinkSmcUportalAddress,serverPort:window.getLinkSmcUportalPort})):(c=window.getUserInfo(),d=window.CLIENTCONFIG.DEFAULT_UPORTAL_SERVER,window.getUportalServer()&&(d=window.getUportalServer()),t.useIM=!1,window.CLIENTCONFIG.USE_IM=!1,t.set({loginAccount:c.contactsId,password:"*******",serverAddress:d,serverPort:8443}))),window.CLIENTCONFIG.ISMOBILE||i(!1),B.info("[ prepareLogin ] ok! "),B.info("<account_login><1_prepareLogin>end ok"),!window.CLIENTCONFIG.ISMOBILE){e.next=23;break}return e.abrupt("return",window.getCurrentNetWorkType());case 23:return e.abrupt("return",p.default.resolve(0));case 24:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),h=function(){var e=(0,E.default)(g.default.mark(function e(){var t,r,n,o,a,i,s,u,c,d,l,f;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(B.info("[ checkLoginInfo ]"),B.info("<account_login><2_checkLoginInfo>begin"),!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=4;break}return e.abrupt("return");case 4:if(t=(0,b.getLoginModel)(),r=t.displayAccount,n=t.account,o=t.password,a=t.serverAddress,i=t.serverPort,s=t.isResume,u=t.isTempLogin,c=t.status,d=void 0,!s&&!c){e.next=12;break}return e.next=10,coreSecurity.PasswordManager.getPassword("password");case 10:d=e.sent,t.password=d;case 12:if(window.CLIENTCONFIG.ISBIGWIN||window.isPluginEnv){e.next=20;break}if(l=d||(0,b.getLoginModel)().password,r&&l){e.next=17;break}return B.info("<account_login><2_checkLoginInfo>end failed"),e.abrupt("return",(0,b.LoginError)({result:!1,errorCode:"LOGIN_ACCOUNT_OR_PASSWORD_EMPTY",errorType:constant.LOGIN_ERROR_TYPE.uportal,isResume:s}));case 17:if(-1===r.indexOf(" ")){e.next=20;break}return B.info("<account_login><2_checkLoginInfo>end failed"),e.abrupt("return",(0,b.LoginError)({result:!1,errorCode:"LOGIN_ACCOUNT_HAS_SPACE",errorType:constant.LOGIN_ERROR_TYPE.uportal,isResume:s}));case 20:if(coreUt.utConfigAccountInfo({configAccount:r}),a&&i){e.next=24;break}return B.info("<account_login><2_checkLoginInfo>end failed"),e.abrupt("return",(0,b.LoginError)({result:!1,errorCode:"LOGIN_ADDRESS_OR_PORT_EMPTY",errorType:constant.LOGIN_ERROR_TYPE.uportal,isResume:s}));case 24:if(t.isOAuth=!1,t.OAuthUrl="",t.serverPort=parseInt(i),e.t0=o,!e.t0){e.next=31;break}return e.next=31,coreSecurity.PasswordManager.setPassword("password",o);case 31:return e.next=33,coreHttp.initHttpTrans();case 33:if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||!window.noactivity){e.next=47;break}if(e.t1=window.CLIENTCONFIG.ISMOBILE,!e.t1){e.next=39;break}return e.next=38,window.isFloatWindow;case 38:e.t1=e.sent;case 39:if(!(f=e.t1)){e.next=44;break}B.info("the window is float "),e.next=47;break;case 44:return B.error("has no activity, login err!!!"),B.info("<account_login><2_checkLoginInfo>end failed"),e.abrupt("return",(0,b.LoginError)({result:!1,errorCode:"webView has hide",errorType:constant.LOGIN_ERROR_TYPE.common}));case 47:B.info("[ checkLoginInfo ] ok! "),B.info("<account_login><2_checkLoginInfo>end ok");case 49:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),m=function(){var e=(0,E.default)(g.default.mark(function e(){var t,r;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISBIGWIN&&!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=3;break}return B.info("is big win can not doDetectFireWall"),e.abrupt("return");case 3:if(!coreCommon.isMobile()){e.next=6;break}return B.info("[ doDetectFireWall ] mobile can not doDetectFireWall"),e.abrupt("return");case 6:return B.info("[ doDetectFireWall ]"),B.info("<account_login><4_firewall>begin"),t=(0,b.getLoginModel)(),t.isInDetectFireWall=!0,e.next=12,(0,R.checkDetectFireWall)();case 12:return r=e.sent,t.isInDetectFireWall=!1,coreCommon.dispatchModuleEvent("login",{event:"detectFirewall",code:0}),B.info("<account_login><4_firewall>end ok"),e.abrupt("return",r);case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,E.default)(g.default.mark(function e(){var t,r;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:B.info("[ loginSuccess ]"),t=(0,b.getLoginModel)(),window.retryUportalLoginTimes=0,window.shouldStopRertyLogin=!0,window.baseTimeInterval=0,i(),t.isTempLogin||(W(t.account,window.isHubEnv).then(function(){B.info("[maxhub] go into setLoginRecord"),(0,O.setLoginRecord)()}),window.CLIENTCONFIG.ENABLE_IT_MEETING&&(r=window.getRoute(),isNullOrEmpty(window.handleJoinTempConfNoNameURL)),t.isMobile&&document.addEventListener("pause",k.storeAppCache,!1)),coreCommon.dispatchModuleEvent("login",{event:"uportal",code:0}),(0,k.storeAppCache)(),t.clearPassword(),coreIm.initChangeShowRecentInfo(),B.info("[ loginSuccess ] ok! "),t.curPortalState=constant.CUR_PORTAL_LOGIN_STATE.FINISH;case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),C=function(){var e=(0,E.default)(g.default.mark(function e(){var t;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,b.getLoginModel)(),window.CLIENTCONFIG.ISMOBILE&&(B.info("[ initMobileNative ]",handlePhoneNumber(t.account)),window.initMobileNative());case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),T=function(){var e=(0,E.default)(g.default.mark(function e(){var t,r,n,o,a,i,s,u,c;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,b.getLoginModel)(),isNullOrEmpty(t.real_user_account)||isNullOrEmpty(t.authToken)||(0,F.checkUpgrade)(!1,t.authToken,t.real_user_account),coreCommon.dispatchModuleEvent("login",{event:"total",code:0}),B.info("[ serviceReadyLoadData ]"),B.info("serviceReadyLoadData, set isOffline false"),window.isOffline=!1,t.setLoginStatus(!1,!0),(0,k.storeAppCache)(),r={key:"confPageShowType",value:"true"},e.next=11,coreDb.saveUserConfig(r);case 11:return n=(0,b.getLoginModel)().isSupportAS,o={key:"asInfo",value:(0,l.default)(n)},e.next=15,coreDb.saveUserConfig(o);case 15:return a=handlePhoneNumber((0,b.getLoginModel)().displayAccount),i=handlePhoneNumber((0,b.getLoginModel)().show_account),s=handlePhoneNumber((0,b.getLoginModel)().account),u={displayAccount:"",showAccount:"",account:""},isNullOrEmpty(a)||(u.displayAccount=a),isNullOrEmpty(i)||(u.showAccount=i),isNullOrEmpty(s)||(u.account=s),appService.debugInfoPrint(u),e.next=25,coreDb.queryUserConfigList({key:"hasOpenPush"});case 25:return c=e.sent,(isNullOrEmpty(c)||"true"===c[0].value)&&C(),(0,M.registerResumeEvent)(),(0,k.storeAppCache)(),B.info("serviceReadyLoadData, status = "+t.status),window.CLIENTCONFIG.ENABLE_IT_MEETING||window.isPluginEnv||$getState().login.sipLoginOnly||(0,D.checkHuaweiPhonePushSetting)(),B.info("[ serviceReadyLoadData ] ok! "),e.abrupt("return",{result:!0});case 33:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();t.enableAutoLogin=i;var S=r(352),N=r(802),R=r(351),O=r(283),y=r(628),A=r(997),b=r(183),P=r(309),x=r(714),k=r(310),M=r(354),U=r(716),D=(r(713),r(804),r(1e3)),G=r(408),F=r(712),B=window.Logger("logic")("login");t.login=function(){var e=(0,E.default)(g.default.mark(function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,b.getLoginModel)(),t.curPortalState=constant.CUR_PORTAL_LOGIN_STATE.LOGINING,t.isResume=i,t.isTempLogin=d,t.desc=l,r=(0,N.getUportalApi)().loginToUportal,window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(r=(0,N.getUportalApi)().uportalAllonline,window.pcLoginState()&&(t.isMultiDeviceLogined=!0)),window.CLIENTCONFIG.ENABLE_IT_MEETING||((0,U.initService)("pre login"),!0===(n=(0,b.getMyInfo)().isOffToLine)||i||coreUi.initAvatarMap()),e.abrupt("return",a().then(I).then(h).then(r).then(o).then(V).then(c).then(L).then(m).then(s).then(u).then(v).then(T).catch(x.handleLoginError));case 9:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.reLogineServer=function(){var e=(0,E.default)(g.default.mark(function e(){var t;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=coreAccount.getLoginModel(),B.info("[ reLogineServer ]",handlePhoneNumber(t.account)),e.abrupt("return",coreIm.reLoginToeServer().then(function(){return coreIm.registerEvent()}).then(function(){return B.info("[ reLogineServer ] ok! ",handlePhoneNumber(t.account)),!0}).catch(function(e){return!1}));case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();window.startCallout=(0,E.default)(g.default.mark(function e(){return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.dealStartCall(),B.info("startCallout, set isOffline false"),window.isOffline=!1,window.webView.switchToFront();case 4:case"end":return e.stop()}},e,void 0)})),window.handlePluginOneKeyConf=function(){var e=(0,E.default)(g.default.mark(function e(t){return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.handleJoinTempConfNoName(t);case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),window.handlePluginTempUserInfo=(0,E.default)(g.default.mark(function e(){var t,r;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:B.info("deal temp get user info 10"),t="",r=JSON.parse(t),window.oneKeyConfTempUserInfo(r);case 5:case"end":return e.stop()}},e,void 0)})),window.oneKeyConfTempUserInfo=function(){var e=(0,E.default)(g.default.mark(function e(t){var r;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r={},!t||void 0===t.result&&void 0===t.reslut?r=t:(r.param=t,void 0!=t.reslut&&(r.param.result=t.reslut)),(0,G.handletempsipconfinfo)(r);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();var W=function(){var e=(0,E.default)(g.default.mark(function e(t,r){var n;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r&&(B.info("start maxhub init"),n={isAutoLogin:!0,isRememberPassword:!0},(0,b.getLoginModel)().set(n),coreConf.initAsPairServer()),e.abrupt("return",p.default.resolve(0));case 2:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),H=(t.initLoginInfo=function(){var e=(0,E.default)(g.default.mark(function e(){var t;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return B.info("[ initLoginInfo ]"),e.next=3,(0,O.loadLoginSetting)();case 3:return e.next=5,(0,O.loadLoginRecordList)();case 5:return t=e.sent,e.next=8,H();case 8:if(!window.CLIENTCONFIG.ISBIGWIN){e.next=12;break}if(!window.anonymousJoinConf){e.next=12;break}return e.next=12,coreConf.resumeDeviceInfo();case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.checkForceSwtichAccount=function(){var e=(0,b.getLoginModel)(),t=e.switchAccount;if(!isNullOrEmpty(t)&&!isNullOrEmpty(t.tempAccount)){var r={displayAccount:t.tempAccount,account:t.tempAccount,password:"",serverAddress:t.tempServerAddress,serverPort:t.tempServerPort};(0,b.getLoginModel)().set(r);var n={};(0,b.getLoginModel)().switchAccount=n}});window.handleSwitchAccount=function(){var e=(0,E.default)(g.default.mark(function e(t){var r,n,o,a,i,s;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.account,n=t.serverAddress,o=t.serverPort,a=t.noNeedLogout,window.anonymousJoinConf||a){e.next=4;break}return e.next=4,(0,U.logout)(!0,!0);case 4:B.info("handleSwitchAccount update login info"),i={account:r,displayAccount:r,password:"",serverAddress:n,serverPort:o},s={tempAccount:r,tempServerAddress:n,tempServerPort:o},(0,b.getLoginModel)().set(i),(0,b.getLoginModel)().switchAccount=s;case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();var V=(t.ipLogin=function(){var e=(0,E.default)(g.default.mark(function e(){return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return B.info("debug info ipLogin begin"),coreCommon.Observer.unsubsribleAll(),coreConf.registerConfEventAtomic.reset(),coreConf.subScribeConfListAndInfoResAtomic.reset(),coreCall.registerCallEvent(),e.next=7,(0,R.ipCallConfig)();case 7:throttle((0,E.default)(g.default.mark(function e(){return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}},e,void 0)})),1e3)(),B.info("debug info ipLogin end");case 9:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.checkShowPrivacy=function(){var e=(0,E.default)(g.default.mark(function e(){var t,r,n,o,a,i,s,u,c,d,l,f,p,_;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=PromiseObject(),!window.CLIENTCONFIG.ISMOBILE){e.next=14;break}if(window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=8;break}return e.next=5,appService.isLaunchFromPush();case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=!1;case 9:if(r=e.t0,!window.CLIENTCONFIG.ISMOBILE||!r){e.next=14;break}return B.info("[checkShowPrivacy] skip for isLaunchFromPush : "+r),t.resolve(!0),e.abrupt("return",t);case 14:if(n=(0,b.getLoginModel)(),o=n.account,a=n.isCheckPrivacy,i=n.isTempLogin,s=n.privacy_version,!(window.isHubEnv||a||window.CLIENTCONFIG.ISBIGWIN||i||window.CLIENTCONFIG.ENABLE_IT_MEETING||window.isPluginEnv)){e.next=20;break}return B.error("this is maxhub environment or resume, uncheck privacy"),t.resolve(!0),e.abrupt("return",t);case 20:return e.prev=20,B.info("[checkShowPrivacy] start"),n.set({isCheckPrivacy:!0}),e.next=25,coreDb.queryLoginSetting({key:"firstLoginAccount"});case 25:return u=e.sent.value,e.next=28,coreDb.queryLoginSetting({key:o+"_privacyVersion"});case 28:if(c=e.sent.value,d=!!c,c=c||"V01.00",s=s||"V01.00",l=c.split("V")[1],f=s.split("V")[1],p={oprEvent:constant.OPR_EVENT_TYPE.PRIVACY,privacyver:s},void 0!==u){e.next=44;break}return e.next=38,coreDb.saveLoginSetting({key:"firstLoginAccount",value:o});case 38:return e.next=40,coreDb.saveLoginSetting({key:o+"_privacyVersion",value:s});case 40:(0,S.recordPrivacy)(p),t.resolve(!0),e.next=45;break;case 44:u!==o&&!d||f>l?(B.info("[checkShowPrivacy] show privacy"),_=function(){(0,S.recordPrivacy)(p),n.setLoginStatus(!0),f>=l&&coreDb.saveLoginSetting({key:o+"_privacyVersion",value:s}),t.resolve(!0)},delegate(_,"onAgreePrivacy"),n.setLoginStatus(!1,!0),window.goRoute("firstLoginPrivacy")):t.resolve(!0);case 45:return e.abrupt("return",t);case 48:return e.prev=48,e.t1=e.catch(20),B.error("[checkShowPrivacy] error",e.t1.toString()),t.resolve(!0),e.abrupt("return",t);case 53:case"end":return e.stop()}},e,void 0,[[20,48]])}));return function(){return e.apply(this,arguments)}}())},710:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCmptEvent=t.stopCmptLog=t.startCmptLog=t.detectStopServer=t.detectStartServer=t.detectStopClientContinue=t.detectStartClientContinue=t.detectStopClient=t.detectStartClient=t.detectUnInit=t.detectInit=t.checkCertificateOverdue=t.verifyCertificate=void 0;var n=r(994),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.verifyCertificate=o.verifyCertificate,t.checkCertificateOverdue=o.checkCertificateOverdue,t.detectInit=o.detectInit,t.detectUnInit=o.detectUnInit,t.detectStartClient=o.detectStartClient,t.detectStopClient=o.detectStopClient,t.detectStartClientContinue=o.detectStartClientContinue,t.detectStopClientContinue=o.detectStopClientContinue,t.detectStartServer=o.detectStartServer,t.detectStopServer=o.detectStopServer,t.startCmptLog=o.startCmptLog,t.stopCmptLog=o.stopCmptLog,t.setCmptEvent=o.setCmptEvent},711:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getVerifyCodeAndSetUi=t.sendCaptchaResultAndSetUi=t.getCaptchaAndSetUi=t.getVerifyCode=t.sendCaptchaResult=t.getCaptcha=t.clearLocalDNSIp=t.setLocalDNSIp=t.getLocalDNSIp=t.frogetPassword=t.verifyVerificationCode=t.requestVerificationCode=t.queryUserAccount=t.recordPrivacy=t.actionGetUploadInfo=t.actionRefreshToken=t.changeLoginPassword=t.queryMediaXaddrFromServer=t.resumeUportalService=t.resetLoginInfo=void 0;var o=r(67),a=n(o),i=r(3),s=n(i),u=r(1),c=n(u),d=r(2),l=n(d),f=function(){var e=(0,l.default)(c.default.mark(function e(t,r,n){var o,a,i,s,u,d,l,f,p,_,g,w,v,I,h;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=encodeURIComponent(r),n=encodeURIComponent(n),o=n,e.next=5,new coreHttp.hwTupHttpTransSdk;case 5:return a=e.sent,i=coreAccount.getLoginModel(),s=i.proxyAddress,u=i.proxyPort,d=i.proxyAccount,l=i.isSupportProxy,f=i.changeItPasswordUrl,p=i.middleEndAddress,_=i.crypt_token,e.next=11,coreSecurity.PasswordManager.getPassword("proxyPassword");case 11:return g=e.sent,w="https://"+p+"/mcloud/mag/ProxyForText/wemiddle/api/v1/sso/personal_password_modify",E.info("change it pd url = :",w),l||(s="",u=0,d="",g=""),v=coreAccount.getLoginModel(),I=v.isSupportCACertCheck,e.next=18,a.sendSyncRequest({url:w,type:constant.REQUEST_TYPE.POST,header:{"Content-Type":"application/x-www-form-urlencoded",lang:"en",Cookie:"token="+_},body:"account="+t+"&oldPasswd="+r+"&newPasswd="+n+"&confirmPasswd="+o,proxyInfo:{proxyAddress:s,proxyPort:u,proxyAccount:d,proxyPassword:g},tlsParam:{caCertPath:window.EXEC_PATH,tlsMode:I?1:0},cipherlist:[]});case 18:return h=e.sent,e.abrupt("return",h);case 20:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),p=r(116),_=(n(p),r(183)),g=r(309),w=r(802),E=window.Logger("login")("uportal");window.refreshUportalToken=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nil;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={},t.param={},t.param.result=0,t.param.refresh_token_result={},window.webView&&!r?t.param.refresh_token_result.auth_token=window.webView.getImToken():(r&&r.indexOf("@")>0&&(r=coreSecurity.encode64(r)),t.param.refresh_token_result.auth_token=r),t.param.refresh_token_result.stg_account="",t.param.refresh_token_result.stg_pwd="",(0,w.getUportalApi)().refreshTokenCallback(t);case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();t.resetLoginInfo=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={authToken:"",sipAccount:"",sipImpi:"",sipPassword:"",sipPasswordType:0,sipOutgoingAccCode:null,sipServerAddress:"",sipServerPort:0,sipDomain:"",sipServerBackup1:"",sipServerPortBackup1:0,sipServerLocal:"",sipServerPortLocal:0,eabUri:"",groupServer:"",eServerAddressAll:"",eServerAddress:"",eServerPort:0,sipUri:"",svnUri:"",httpsProxyAll:"",httpsProxy:"",stgUri:"",stgAccount:"",sipStgUri:"",eserverStgUri:"",umHttpServerUri:"",umHttpsServerUri:"",stgUriUsed:"",isBuildStgSuc:!1,isGetFirewallRes:!1,fireWallMode:3,smcUri:"",maaProxyAddress:"",maaProxyPort:0,maaProxyUrlAll:""},e.next=3,coreSecurity.PasswordManager.setPassword("stgPassword","");case 3:return e.next=5,coreSecurity.PasswordManager.setPassword("sipPassword","");case 5:r=(0,_.getLoginModel)(),r.set(t);case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.resumeUportalService=function(){var e=(0,l.default)(c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWUportal;case 2:t=e.sent,t.setNotifyFunc(360459,(0,w.getUportalApi)().refreshTokenCallback);case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.queryMediaXaddrFromServer=function(e,t){return new s.default(function(r,n){try{var o=(0,_.getLoginModel)(),a=o.serverAddress,i=o.serverPort;e.setNotifyFunc(360486,h);var s=function(e){if(e&&e.param&&0===e.param.result){if(isNullOrEmpty(e.param.mediax_result))return void r({result:1});var n=void 0,o=e.param.mediax_result.server_uri,i=e.param.mediax_result.cms_uri;if(o&&i)n=t?i:o,E.info("cmsAddr:",i,"mediaxAddr:",o,"is_cms_addr:",t);else if(o)n=o,t=0,E.info("mediaxAddr:",o);else{if(!i)return E.error("queryMediaXaddrFromServer mediaX address is empty!"),void r({result:1});n=i,t=1,E.info("cmsAddr:",i)}var s=n.split(":");E.info("queryMediaXaddrFromServer mediaX address success"),(0,_.getLoginModel)().tempMediaxAddress=s[0],(0,_.getLoginModel)().tempMediaxPort=s[1],r({result:0,mediaxAddr:s[0],mediaxPort:parseInt(s[1]),isCmsAddr:t})}else e&&e.param&&e.param.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_TIMEOUT&&m(a),E.error("queryMediaXaddrFromServer notify failed,errorcode:",e.param.result),r({result:1})},u=window.setTimeout(function(){E.error("queryMediaXaddrFromServer 6s time out"),r({result:1}),m(a)},6e3);I(a).then(function(t){isNullOrEmpty(t)||(a=t),e.getMediaxAccessAddr(a,parseInt(i),s).then(function(e){window.clearTimeout(u),e&&0!==e.result&&(E.error("queryMediaXaddrFromServer failed"),r({result:1}))})})}catch(e){E.error("queryMediaXaddrFromServer",{e:e.toJSON()}),r({result:1})}})};window.getDnsResult=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r="",t&&(n=JSON.parse(t),n.loginOnCurrentDnsResult&&(r=n.loginOnCurrentDnsResult,h(r)));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();var v=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,E.info("change [password] checkCall"),!$getState().call.showCallToolBar&&"VIDEO_OUT"!==$getState().call.callStatus&&"VIDEO_CONNECTED"!==$getState().call.callStatus){e.next=16;break}if(t="LANG_NATIVE_CONFIRM_TITLE",r=language.COMMON_CHECK_CHANGEPASSWORD_CALLEXIST,n=!1,!window.CLIENTCONFIG.ISMOBILE){e.next=12;break}return e.next=9,window.confirm(r);case 9:n=e.sent,e.next=15;break;case 12:return e.next=14,window.confirm(r,t,!0);case 14:n=e.sent;case 15:return e.abrupt("return",!1);case 16:return e.abrupt("return",!0);case 19:return e.prev=19,e.t0=e.catch(0),E.error("checkCall",{e:e.t0.toJSON()}),e.abrupt("return",!1);case 23:case"end":return e.stop()}},e,void 0,[[0,19]])}));return function(){return e.apply(this,arguments)}}();t.changeLoginPassword=function(){var e=(0,l.default)(c.default.mark(function e(t,r,n,o){var a,i,s,u,d,p,g,I,h,m,L,C;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWUportal;case 2:return a=e.sent,e.next=5,v();case 5:if(i=e.sent){e.next=8;break}return e.abrupt("return");case 8:if(window.navigator.onLine){e.next=11;break}return alert(language.LOGIN_RESUME_NETWORK_ERROR),e.abrupt("return");case 11:if(o=(0,w.getUportalApi)().IP.serverKey,s=PromiseObject(),u=(0,_.getLoginModel)(),d=u.serverUportalPort,p=u.isOAuth,"Workplace"===window.CLIENTCONFIG.NEW_APP_NAME){e.next=25;break}return g=function(){var e=(0,l.default)(c.default.mark(function e(t){var r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.param,E.info("change [pass]word result: "+r.result),r&&0===r.result?(coreCommon.Observer.unsubsribleAll(),coreConf.registerConfEventAtomic.reset(),coreConf.subScribeConfListAndInfoResAtomic.reset(),window.CLIENTCONFIG.ISMOBILE,window.alert(language.CHANGE_PASSWORD_SUCCESS,!0).then(function(){delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT,!0),s.resolve(!0)})):r.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_NEW_PWD_CANNOT_SAME_WITH_HISTROY_PWD?(alert(language.NEW_PWD_SAME_WITH_HISTROY_PWD),s.resolve(!1)):r.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_MOD_PWD_TOO_FREQUENTLY?(alert(language.MOD_PWD_TOO_FREQUENTLY),s.resolve(!1)):r.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_INVAILD_NEW_PWD_LEVEL?(E.info("change ** result,** strength not match"),alert(language.NEW_PASSWORD_NOT_MATCH),s.resolve(!1)):r.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_INVAILD_NEW_PWD_LEN?(alert(language.NEW_PASSWORD_LENGTH_ERROR),s.resolve(!1)):r.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_CHANGEPWD_LOW_PASSWORD_SECURITY?(window.ToastNew(language.CHANGE_PWD_LOW_SECURITY_TIP,2),s.resolve(!1)):(window.ToastNew(language.CHANGE_PASSWORD_FAILED,2),s.resolve(!1));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),a.setNotifyFunc(360449,g),I=(0,_.getLoginModel)(),h=I.serverUportalPort,e.next=20,a.changeLoginUportalPassword(t,r,n,o,h);case 20:m=e.sent,0!==m.result&&(E.error("change LoginPassword, result:"+m.result),window.ToastNew(language.CHANGE_PASSWORD_FAILED,2),s.resolve(!1)),setTimeout(function(){E.error("request  10s timeout"),window.ToastNew(language.CHANGE_PASSWORD_FAILED,2),s.resolve(!1)},1e4),e.next=29;break;case 25:return e.next=27,f(t,r,n);case 27:L=e.sent;try{C=JSON.parse(L.param.recv_body),E.info("change it pd result",C.result),"success"===C.result?(coreCommon.Observer.unsubsribleAll(),coreConf.registerConfEventAtomic.reset(),coreConf.subScribeConfListAndInfoResAtomic.reset(),window.alert(""+language.CHANGE_PASSWORD_SUCCESS,!0).then(function(){delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT,!0),s.resolve(!0)})):(alert(language.CHANGE_PASSWORD_FAILED),s.resolve(!1))}catch(e){alert(language.CHANGE_PASSWORD_FAILED),E.error("change it pd error. ",L)}case 29:return e.abrupt("return",s);case 30:case"end":return e.stop()}},e,void 0)}));return function(t,r,n,o){return e.apply(this,arguments)}}();window.doingRefreshUportalToken=!1;var I=(t.actionRefreshToken=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(E.info("[ actionRefreshToken ]"),!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=5;break}window.refreshImToken(),e.next=17;break;case 5:if(t=(0,_.getLoginModel)().curPortalState,E.info("[ actionRefreshToken ] curPortalState = ",t),window.doingRefreshUportalToken||t===constant.CUR_PORTAL_LOGIN_STATE.LOGINING){e.next=16;break}return window.doingRefreshUportalToken=!0,e.next=11,new coreTup.HWUportal;case 11:r=e.sent,r.refreshToken(),setTimeout(function(){window.doingRefreshUportalToken=!1},2e4),e.next=17;break;case 16:E.info("refreshing uportal token. return don't send");case 17:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.actionGetUploadInfo=function(){var e=(0,l.default)(c.default.mark(function e(t,r){var n,o,a,i,s;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E.info("actionGetUploadInfo"),e.next=3,new coreTup.HWUportal;case 3:return n=e.sent,o=PromiseObject(),a=function(){var e=(0,l.default)(c.default.mark(function e(t){var r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.param,0!==r.result?(E.error("get upload info fail, result:"+r.result),o.resolve(r)):o.resolve(r);case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),n.setNotifyFunc(360491,a),i={req_info:{file_name:t,file_type:r}},e.next=10,n.getUploadInfo(i);case 10:return s=e.sent,0!==s.result&&(E.error("actionGetUploadInfo fail, result:"+s.result),o.resolve("request failed")),setTimeout(function(){o.resolve("request timeout")},1e4),e.abrupt("return",o);case 14:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.recordPrivacy=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,o,a,i,s,u,d,l,f,p,g,w=t.oprEvent,v=t.privacyver,I=t.chrtype;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E.info("[ recordPrivacy ]"),r=(0,_.getLoginModel)(),n=r.account,o=r.serverAddress,a=r.serverPort,i=r.serverUportalAddress,s=r.serverUportalPort,e.next=5,new coreTup.HWUportal;case 5:return u=e.sent,d=window.CLIENTCONFIG.ACS_SOFTWAREVERSION_VALUE,l=(new Date).format("yyyy-MM-dd hh:mm"),f={record_user:n,record_version:d,record_time:l,record_oprevent:w,server_url:isNullOrEmpty(i)?o:i,port_num:isNullOrEmpty(s)?parseInt(a):parseInt(s),record_other:{}},v&&(f.record_other.privacyver=v),void 0!==I&&(f.record_other.chrtype=I),e.next=13,u.recordPrivacy(f);case 13:p=e.sent,0!==p.result&&E.error("record fail, result:"+p.result+"oprEvent:"+w),g=function(e){if(e&&0===e.param.result)return E.info("record success, oprEvent:"+w);E.error("record fail, result:"+e.param.result+"oprEvent:"+w)},u.setNotifyFunc(360481,g);case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.queryUserAccount=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,o,a,i,s,u,d;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,_.getLoginModel)(),n=r.serverAddress,o=r.serverPort,e.next=4,new coreTup.HWUportal;case 4:return a=e.sent,E.info("tup init"),e.next=8,(0,w.getUportalApi)().setLoginProxy(a);case 8:return i=PromiseObject(),r.forgetPwdAccount!==t&&(r.forgetPwdAccount=t,r.isFrogetRedriect=!1),s=function(){var e=(0,l.default)(c.default.mark(function e(s){var u,d,l,f,p,_,w,v;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u=s.param,38!==u.result||""===u.query_result.redirect_url){e.next=20;break}if(r.isFrogetRedriect=!0,d=/(?:https\:\/\/)?(?:(\d+\.\d+\.\d+\.\d+)|((?:[0-9a-zA-Z\u4E00-\u9FA5\uF900-\uFA2D]+[.])+[0-9a-zA-Z\u4E00-\u9FA5\uF900-\uFA2D]+))(?:\:(\d+))+/,!(l=d.exec(u.query_result.redirect_url))){e.next=11;break}f=l[1],p=l[2],_=l[3],n=f||p,o=_&&_||0,e.next=12;break;case 11:return e.abrupt("return",(0,g.LoginError)({result:!1,errorCode:constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_REQUEST_FAILED,errorType:constant.LOGIN_ERROR_TYPE.uportal,isResume:isResume}));case 12:return r.FrogetPwdUrl=n,r.FrogetPwdUrlPort=o,w={query_user_info:{server_url:n,server_port:parseInt(o),user_account:t}},e.next=17,a.queryUserAccount(w);case 17:v=e.sent,e.next=21;break;case 20:0!==u.result?(E.error("query user account fail, result:"+u.result),void 0!==constant.UPORTAL_LOGIN_FORGET_PWD_ERROR_LOG_INFO[u.result]?window.ToastNew(language[constant.UPORTAL_LOGIN_FORGET_PWD_ERROR_LOG_INFO[u.result]],2):window.ToastNew(language.REQUEST_ERROR,2),i.resolve(u)):i.resolve(u);case 21:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),a.setNotifyFunc(360482,s),u={query_user_info:{server_url:n,server_port:parseInt(o),user_account:t}},e.next=15,a.queryUserAccount(u);case 15:return d=e.sent,0!==d.result&&(E.error("query user account fail, result:"+d.result),window.ToastNew(language.REQUEST_ERROR,2),i.resolve("request failed")),setTimeout(function(){i.resolve("request timeout")},1e4),e.abrupt("return",i);case 19:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.requestVerificationCode=function(){var e=(0,l.default)(c.default.mark(function e(t,r,n){var o,a,i,u,d;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,_.getLoginModel)(),a=o.serverAddress,i=o.serverPort,u=void 0,o.isFrogetRedriect&&(a=o.FrogetPwdUrl,i=o.FrogetPwdUrlPort),e.next=6,new coreTup.HWUportal;case 6:return d=e.sent,e.abrupt("return",new s.default(function(e,o){var s=function(){var t=(0,l.default)(c.default.mark(function t(r){var n;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=r.param,E.info("request verification code result: "+n.result),u&&window.clearTimeout(u),0!==n.result&&n.result!==constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_CHANGEPWD_INVALID_TOKEN&&n.result!==constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_RESEND_WITHIN_3MIN_NOT_ALLOWED?(void 0!==constant.UPORTAL_LOGIN_FORGET_PWD_ERROR_LOG_INFO[n.result]?window.ToastNew(language[constant.UPORTAL_LOGIN_FORGET_PWD_ERROR_LOG_INFO[n.result]],2):window.ToastNew(language.REQUEST_ERROR,2),e(n)):e(n);case 4:case"end":return t.stop()}},t,void 0)}));return function(e){return t.apply(this,arguments)}}();d.setNotifyFunc(360483,s);var f=constant.USER_AGENT.MOBILE;window.CLIENTCONFIG.ISMOBILE||(f="Workplace"===window.CLIENTCONFIG.NEW_APP_NAME?constant.USER_AGENT.WORKPLACEPC:constant.USER_AGENT.PC);var p={req_info:{server_url:a,server_port:parseInt(i),user_account:t,user_agent:f,send_mode:r,lang_type:n}};d.requestVerificationCode(p).then(function(t){0!==t.result?(E.error("requestVerificationCode fail, result:"+t.result),window.ToastNew(language.REQUEST_ERROR,2),e("request failed")):u=window.setTimeout(function(){E.error("request verification 5s time out"),e("request timeout")},1e4)})}));case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),t.verifyVerificationCode=function(){var e=(0,l.default)(c.default.mark(function e(t,r){var n,o,a,i,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_.getLoginModel)(),o=n.serverAddress,a=n.serverPort,i=void 0,n.isFrogetRedriect&&(o=n.FrogetPwdUrl,a=n.FrogetPwdUrlPort),e.next=6,new coreTup.HWUportal;case 6:return u=e.sent,e.abrupt("return",new s.default(function(e,n){var s=function(){var t=(0,l.default)(c.default.mark(function t(r){var n;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=r.param,E.info("verify verification code result: "+n.result),i&&window.clearTimeout(i),0!==n.result?(coreUi.hideModal(),void 0!==constant.UPORTAL_LOGIN_FORGET_PWD_ERROR_LOG_INFO[n.result]?window.ToastNew(language[constant.UPORTAL_LOGIN_FORGET_PWD_ERROR_LOG_INFO[n.result]],2):window.ToastNew(language.REQUEST_ERROR,2),e(n)):e(n);case 4:case"end":return t.stop()}},t,void 0)}));return function(e){return t.apply(this,arguments)}}();u.setNotifyFunc(360484,s);var d={verify_info:{server_url:o,server_port:parseInt(a),user_account:t,verification_code:r}};u.verifyVerificationCode(d).then(function(t){0!==t.result?(E.error("verify verification code fail, result:"+t.result),coreUi.hideModal(),window.ToastNew(language.REQUEST_ERROR,2),e("request failed")):i=window.setTimeout(function(){E.error("verify verification 10s time out"),e("request timeout")},1e4)})}));case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.frogetPassword=function(){var e=(0,l.default)(c.default.mark(function e(t,r,n,o,a){var i,u,d,f,p;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,_.getLoginModel)(),u=void 0,d=i.serverAddress,f=i.serverPort,i.isFrogetRedriect&&(d=i.FrogetPwdUrl,f=i.FrogetPwdUrlPort),e.next=6,new coreTup.HWUportal;case 6:return p=e.sent,e.abrupt("return",new s.default(function(e,i){var s=function(){var t=(0,l.default)(c.default.mark(function t(r){var n;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=r.param,E.info("froget request listener result: "+n.result),u&&window.clearTimeout(u),0!==n.result?(coreUi.hideModal(),void 0!==constant.UPORTAL_LOGIN_FORGET_PWD_ERROR_LOG_INFO[n.result]?window.ToastNew(language[constant.UPORTAL_LOGIN_FORGET_PWD_ERROR_LOG_INFO[n.result]],2):window.ToastNew(language.REQUEST_ERROR,2),e(n)):e(n);case 4:case"end":return t.stop()}},t,void 0)}));return function(e){return t.apply(this,arguments)}}();p.setNotifyFunc(360485,s);var _={pwd_info:{server_url:d,server_port:parseInt(f),user_account:t,new_pwd:r,pwd_type:n,lang_type:o,token:a}};p.frogetPassword(_).then(function(t){0!==t.result?(E.error("froget request fail, result:"+t.result),coreUi.hideModal(),e("request failed")):u=window.setTimeout(function(){E.error("froget pass word 15s time out"),e("request timeout")},15e3)})}));case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r,n,o,a){return e.apply(this,arguments)}}(),t.getLocalDNSIp=function(){var e=(0,l.default)(c.default.mark(function e(t){var r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t)){e.next=3;break}return E.warn("getLocalDNSIp domain is null"),e.abrupt("return");case 3:return e.next=5,coreDb.queryLoginSetting({key:"DNS:"+t});case 5:if(!(r=e.sent)||!r.value){e.next=11;break}return E.info("getLocalDNSIp suc"),e.abrupt("return",r.value);case 11:return E.info("getLocalDNSIp fail"),e.abrupt("return","");case 13:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),h=t.setLocalDNSIp=function(e){return e&&e.param&&0===e.param.result&&e.param.dns_result?isNullOrEmpty(e.param.dns_result.domain_addr)||isNullOrEmpty(e.param.dns_result.ip_addr)?void E.warn("setLocalDNSIp domain or ip is null"):(E.info("tup report setLocalDNSIp"),void coreDb.saveLoginSetting({key:"DNS:"+e.param.dns_result.domain_addr,value:e.param.dns_result.ip_addr})):void E.warn("dns result is null, res = "+(0,a.default)(e))},m=t.clearLocalDNSIp=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t)){e.next=3;break}return E.warn("clearLocalDNSIp ip is null"),e.abrupt("return");case 3:return E.info("clearLocalDNSIp"),r=[],e.next=7,coreDb.queryAllLoginSetting();case 7:n=e.sent,n.forEach(function(e){e.value===t&&-1!==e.key.indexOf("DNS:")&&r.push(e.key)}),E.info("clearLocalDNSIp server addr length = "+r.length),r.length>0&&r.forEach(function(e){coreDb.saveLoginSetting({key:e,value:""})});case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,o,a,i;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=coreAccount.getLoginModel(),r=t.proxyAddress,n=t.proxyPort,o=t.proxyAccount,a=t.isSupportProxy,e.next=3,coreSecurity.PasswordManager.getPassword("proxyPassword");case 3:return i=e.sent,a||(r="",n=0,o="",i=""),e.abrupt("return",{proxyAddress:r,proxyPort:n,proxyAccount:o,proxyPassword:i});case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),C=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,o,i,s,u,d,l,f,p,_,g,w=t.method,E=void 0===w?"post":w,v=t.path,I=void 0===v?"":v,h=t.body,m=void 0===h?{}:h;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:return r=e.sent,n=coreAccount.getLoginModel(),o=n.serverAddress,i=n.serverPort,s=n.isSupportCACertCheck,u=n.isFrogetRedriect,d=n.FrogetPwdUrl,l=n.FrogetPwdUrlPort,f="https://"+o+":"+i+I,u&&(f="https://"+d+":"+l+I),p={caCertPath:window.EXEC_PATH,tlsMode:s?1:0},_=constant.USER_AGENT.MOBILE,window.CLIENTCONFIG.ISMOBILE||(_="Workplace"===window.CLIENTCONFIG.NEW_APP_NAME?constant.USER_AGENT.WORKPLACEPC:constant.USER_AGENT.PC),g={url:f,type:"post"===E?constant.REQUEST_TYPE.POST:constant.REQUEST_TYPE.PUT,header:{"Content-Type":"application/json","User-Agent":_},body:(0,a.default)(m),proxyInfo:r,tlsParam:p,cipherlist:[]},e.abrupt("return",g);case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),T=t.getCaptcha=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,o,a,i,s;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E.info("before getCaptcha"),r="/rest/usg/sso/v1/auth/slideverifycode/send",n=coreCommon.isMobile()?6:5,o=1,a={user:t,clientType:n,checkType:o},e.next=7,C({path:r,body:a});case 7:return i=e.sent,e.next=10,new coreHttp.hwTupHttpTransSdk;case 10:return s=e.sent,e.next=13,s.sendSyncRequest(i);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),S=t.sendCaptchaResult=function(){var e=(0,l.default)(c.default.mark(function e(t,r,n,o){var a,i,s,u,d,l;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E.info("before sendCaptchaResult"),a="/rest/usg/sso/v1/auth/slideverifycode/check",i=coreCommon.isMobile()?6:5,s=1,u={user:t,clientType:i,token:r,pointX:n,slideTime:o,checkType:s},e.next=7,C({method:"put",path:a,body:u});case 7:return d=e.sent,e.next=10,new coreHttp.hwTupHttpTransSdk;case 10:return l=e.sent,e.next=13,l.sendSyncRequest(d);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}},e,void 0)}));return function(t,r,n,o){return e.apply(this,arguments)}}(),N=t.getVerifyCode=function(){var e=(0,l.default)(c.default.mark(function e(t,r){var n,o,a,i,s;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E.info("before getVerifyCode"),n="/rest/usg/ap/v1/verifycode/send",o="2052"===window.langcode?"zh-CN":"en-US",a={user:t,language:o,token:r},e.next=6,C({path:n,body:a});case 6:return i=e.sent,e.next=9,new coreHttp.hwTupHttpTransSdk;case 9:return s=e.sent,e.next=12,s.sendSyncRequest(i);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}();t.getCaptchaAndSetUi=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,o,a,i,s,u,d;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t)){e.next=3;break}return window.ToastNew(language.PC_PHONE_NUMBER_OR_ACCOUNT_NUMBER_CAN_NOT_EMPTY,2),e.abrupt("return");case 3:return e.next=5,T(t);case 5:r=e.sent,n=r.param,o=n.recv_body,a=n.resp_code,E.info("getCaptcha result, tup result : ",r&&r.result),E.info("getCaptcha result, server resp_code : ",a),i=o&&JSON.parse(o),s=i.data,u=i.returnMessage,d=i.requestId,E.info("getCaptcha result, requestId: ",d,", returnMessage: ",u),200===a&&(s.sliderResult=!1,(0,_.getLoginModel)().manMachineCode=s);case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.sendCaptchaResultAndSetUi=function(){var e=(0,l.default)(c.default.mark(function e(t,r,n,o,a,i,s){var u,d,l,f,p,g,w,v,I,h,m,L;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t,r,n,o);case 2:u=e.sent,d=u.param,l=d.recv_body,f=d.resp_code,E.info("sendCaptcha result, tup result : ",u.result),E.info("sendCaptcha result, server resp_code : ",f),p=l&&JSON.parse(l),g=p.returnCode,w=p.returnMessage,v=p.requestId,I=p.data,E.info("sendCaptcha result, requestId: ",v,", returnMessage : ",w),200===f&&(h="000000000"===g,m="000000000"===g?I.token:"",L=!0,(0,_.getLoginModel)().manMachineCode={verificationSuccess:h,sliderResult:L,shadowImage:a,cutImage:i,token:m,oldPointY:s});case 9:case"end":return e.stop()}},e,void 0)}));return function(t,r,n,o,a,i,s){return e.apply(this,arguments)}}(),t.getVerifyCodeAndSetUi=function(){var e=(0,l.default)(c.default.mark(function e(t,r){var n,o,a,i,s,u,d,l,f,p,g;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t,r);case 2:n=e.sent,o=n.param,a=o.recv_body,i=o.resp_code,E.info("getVerifyCode result, tup result : ",n.result),E.info("getVerifyCode result, server resp_code : ",i),s=a&&JSON.parse(a),u=s.returnCode,d=s.returnMessage,l=s.requestId,f=s.data,E.info("getVerifyCode result, requestId: ",l,", returnMessage : ",d),"000000000"===u||"206030004"===u?(p=$getState().login.forgetPwdAccount,g={account:p.account,email:p.email,showaccount:p.showaccount,timeout:f.expire||f.sendLeftTime,type:p.type,useCaptcha:!0,bindPhone:f.bindPhone,bindEmail:f.bindEmail},(0,_.getLoginModel)().forgetPwdAccount=g,window.CLIENTCONFIG.ISMOBILE?"SetNewPassword"!==window.getRoute()&&window.goRoute("/SetNewPassword"):"login/ResetPassword"!==window.getRoute()&&window.goRoute("/login/ResetPassword")):void 0!==constant.CLOUDUSG_ERROR_TIPS[u]?window.ToastNew(language[constant.CLOUDUSG_ERROR_TIPS[u]],2):window.ToastNew(language.REQUEST_ERROR,2);case 9:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}()},712:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.compareVersion=t.dealUpdateVersionClickEx=t.hideProgressBarModal=t.dealInstallFailed=t.startInstallNewVer=t.getInCallingState=t.clearBarPageSet=t.clickConfirmUpdate=t.dealDownloadFailed=t.downloadProcessNotify=t.clearDownloadClick=t.checkUpgrade=t.reStartUpgrade=t.clearAllUpdataState=t.changeUpdataState=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=r(121),c=n(u),d=r(67),l=n(d),f=r(116),p=n(f),_=r(352),g=r(183),w=r(309),E=window.Logger("login")("upgrade"),v={clickDownload:!1,clickTimer:null,downloadResume:!1},I=t.changeUpdataState=function(e){E.info("change updata state, obj=",(0,l.default)(e)),(0,c.default)(v,e),E.info("updataState=",(0,l.default)(v))},h=(t.clearAllUpdataState=function(){v.clickTimer&&clearTimeout(v.clickTimer),v={clickDownload:!1,clickTimer:null,downloadResume:!1},E.info("clear updata state, updataState=",(0,l.default)(v))},function(){var e=(0,s.default)(a.default.mark(function e(t,r){var n,o,i,u,c,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWUportal;case 2:return n=e.sent,o=PromiseObject(),i=function(){var e=(0,s.default)(a.default.mark(function e(t){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.param,360488===t.notify?C(r):360489===t.notify&&T(r);case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),n.setNotifyFunc(360488,i),n.setNotifyFunc(360489,i),u={download_info:{download_timeout:300,version_path:t,file_path:r,keep_download:d,local_file_size:l}},e.next=10,n.downloadUpgradeFile(u);case 10:return c=e.sent,0!==c.result&&(E.error("send downloadUpgradeFile fail, result:"+c.result),o.resolve("request failed")),setTimeout(function(){o.resolve("request timeout")},35e4),e.abrupt("return",o);case 14:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}()),m=function(){return E.info("current platform is :win"),"Workplace"===window.CLIENTCONFIG.NEW_APP_NAME?"workplace-windows":"cloudlink-windows"},L=function(){var e=(0,s.default)(a.default.mark(function e(t){var r,n,o,i,u,c,d,l,f,p,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,g.getLoginModel)(),n=r.serverAddress,o=r.serverPort,i=r.serverUportalAddress,u=r.serverUportalPort,e.next=4,new coreTup.HWUportal;case 4:return c=e.sent,E.info("[check upgrade]tup init"),e.next=8,(0,_.setLoginProxy)(c);case 8:return d=PromiseObject(),l=function(){var e=(0,s.default)(a.default.mark(function e(r){var i,s,u,l,f,p,_,g;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=r.param)||38!==i.result||!i.query_version_result||""===i.query_version_result.redirect_url){e.next=17;break}if(s=/(?:https\:\/\/)?(?:(\d+\.\d+\.\d+\.\d+)|((?:[0-9a-zA-Z\u4E00-\u9FA5\uF900-\uFA2D]+[.])+[0-9a-zA-Z\u4E00-\u9FA5\uF900-\uFA2D]+))(?:\:(\d+))+/,!(u=s.exec(i.query_version_result.redirect_url))){e.next=10;break}l=u[1],f=u[2],p=u[3],n=l||f,o=p&&p||0,e.next=11;break;case 10:return e.abrupt("return",(0,w.LoginError)({result:!1,errorCode:constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_REQUEST_FAILED,errorType:constant.LOGIN_ERROR_TYPE.uportal,isResume:isResume}));case 11:return _={query_ver_info:{server_url:n,server_port:parseInt(o),user_account:t,software_type:m(),current_version:window.CLIENTCONFIG.ACS_SOFTWAREVERSION_VALUE}},e.next=14,c.queryVersionInfo(_);case 14:g=e.sent,e.next=18;break;case 17:0!==i.result?(E.error("query version fail, result:"+i.result),d.resolve(i)):d.resolve(i);case 18:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),c.setNotifyFunc(360487,l),f={query_ver_info:{server_url:isNullOrEmpty(v)?isNullOrEmpty(I.server_url)?r.serverAddress:I.server_url:i,server_port:isNullOrEmpty(v)?isNullOrEmpty(I.port)?parseInt(r.serverPort):parseInt(I.port):parseInt(u),user_account:t,software_type:m(),current_version:window.CLIENTCONFIG.ACS_SOFTWAREVERSION_VALUE,token:v}},E.info("[check upgrade] queryVersionInfo: "),e.next=15,c.queryVersionInfo(f);case 15:return p=e.sent,setTimeout(function(){d.resolve("request timeout")},1e4),e.abrupt("return",d);case 18:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),C=(t.reStartUpgrade=function(){var e=(0,g.getLoginModel)(),t=e.isWaitUpgrade,r=e.isPortalAfterCallUpgrade;!0===t&&!0===r&&(E.info("Soft start to upgrade after call ended"),e.isPortalAfterCallUpgrade=!1,window.CLIENTCONFIG.ISMOBILE?window.webView&&window.upgradeSoftVersion():D())},t.checkUpgrade=function(){var e=(0,s.default)(a.default.mark(function e(){var t,r,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=coreCommon.TaskQueue.getInstance("checkUpgrade"),r=coreCommon.TaskOptions.defaultOptions(),t.addTask((0,s.default)(a.default.mark(function e(){var t,r,s,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(E.info("[check upgrade] start"),"Workplace"!==window.CLIENTCONFIG.NEW_APP_NAME&&!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=4;break}return E.info("the app is Workplace or ENABLE_IT_MEETING is true, can not update by esight"),e.abrupt("return");case 4:if(!window.isHubEnv){e.next=6;break}return e.abrupt("return");case 6:if(!window.isPluginEnv){e.next=8;break}return e.abrupt("return");case 8:if(t=(0,g.getLoginModel)(),isNullOrEmpty(o)||!t.sipLoginOnly){e.next=12;break}return E.info("[check upgrade] end: anonyumous join conference don't need deal non-forced upgrade"),e.abrupt("return");case 12:if(!window.webView||!window.IsGooglePlayPkg()){e.next=15;break}return E.info("[check upgrade] end: Android pkg check, the app is from google play, can not update by esight"),e.abrupt("return");case 15:if(!isNullOrEmpty(o)||t.isReqAddrChanged||n){e.next=18;break}return E.info("[check upgrade] end: addr not change, no need to query"),e.abrupt("return");case 18:if(!isNullOrEmpty(o)||!t.isAutoLogin){e.next=21;break}return E.info("[check upgrade] end: auto login no need to query"),e.abrupt("return");case 21:return t.isReqAddrChanged=!1,e.next=24,L(i,o);case 24:if(r=e.sent,0===r.result){e.next=28;break}return E.info("[check upgrade] end: queryVersionInfo res",r),e.abrupt("return");case 28:if(s=r,!1===t.isPortalUpgrade&&(E.info("[check upgrade]isPortalUpgrade become true"),t.isPortalUpgrade=!0),!s.query_version_result.is_consistent){e.next=33;break}return E.info("[check upgrade] end: current version is the newest"),e.abrupt("return");case 33:if(V(s.query_version_result.upgrading_version)){e.next=36;break}return E.info("[check upgrade] end: compareVersion false"),e.abrupt("return");case 36:if(!isNullOrEmpty(o)){e.next=40;break}if(s.query_version_result.is_force_upgrade){e.next=40;break}return E.info("[check upgrade] end:　current state is logout, not the forced upgrade"),e.abrupt("return");case 40:t.isForceUpdate=s.query_version_result.is_force_upgrade,t.set({whatsNewCHN:s.query_version_result.version_description,whatsNewENG:s.query_version_result.version_description,downloadVersion:s.query_version_result.version_description,downloadUrl:s.query_version_result.version_path}),t.isForceUpdate?t.showContentType=constant.UPDATE_MODEL_CONTENT_TYPE.NEWHINTS:t.showContentType=constant.UPDATE_MODEL_CONTENT_TYPE.WHATSNEWHINTS,isNullOrEmpty(o)||(t.isWaitUpgrade=!0),u=U(),u&&t.curPortalState!==constant.CUR_PORTAL_LOGIN_STATE.FINISH&&t.curPortalState!==constant.CUR_PORTAL_LOGIN_STATE.INIT?E.info("[check upgrade] end: User is in calling, not show hints"):(E.info("[check upgrade] end: User is not calling, start to show update hints"),A());case 46:case"end":return e.stop()}},e,void 0)})),r,null);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.clearDownloadClick=function(){E.info("clearDownloadClick in"),v.clickTimer&&clearTimeout(v.clickTimer),v.clickTimer=null,I({clickDownload:!1})},t.downloadProcessNotify=function(e){try{E.info("start set download process ",(0,l.default)(e));var t=parseFloat(e.progress_info.total_file_size),r=parseFloat(e.progress_info.cur_file_size);if(isNaN(t)||isNaN(r))return void E.error("size data error");var n=t<=0?0:parseInt(Math.round(r/t*1e4)/100);(0,g.getLoginModel)().progressPercent=n}catch(e){E.error("downloadProcessNotify, error:",e)}}),T=function(e){E.info("get download result, params",(0,l.default)(e)),0===e.result?(E.info("download update file success"),D()):(E.info("download update file failed, result=",e.result+", info=",e.FaultString),I({downloadResume:!1}),S())},S=t.dealDownloadFailed=function(){var e=(0,g.getLoginModel)();e.isUpdateError=!0,e.showContentType=constant.UPDATE_MODEL_CONTENT_TYPE.DOWNLOADING,A()},N=t.clickConfirmUpdate=function(){E.info("userClick confirm download update version");var e=(0,g.getLoginModel)(),t=e.downloadUrl;M(t)},R=function(){var e=(0,s.default)(a.default.mark(function e(){var t,r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().common.modalContent,E.info("modalContent : ",t),r=(0,g.getLoginModel)(),isNullOrEmpty(t)||"progressbar"===t.key){e.next=9;break}if(E.info("model is not empty, [key]=",t.key),"addConf"!==t.key){e.next=9;break}return e.next=8,coreConf.toggleChangeConfAcsPas("");case 8:coreConf.toggleChangeConfAcsState(constant.JOIN_CONF_PASSWORD_INPUT_STATE.UNKNOWN);case 9:n=coreCommonComponent.lazyLoadPage({getComponentProm:HwLazyUiPage.getProgressBar}),coreUi.showModal(p.default.createElement(n,{key:"progressbar"}));case 11:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),O=function(){appService.openUrl("itms-apps://itunes.apple.com/cn/app/%E5%8D%8E%E4%B8%BA%E4%BC%9A%E8%AE%AE/id1354340495?mt=8")},y=function(){var e=(0,g.getLoginModel)(),t=e.curPortalState===constant.CUR_PORTAL_LOGIN_STATE.FINISH?language.LOG_OUT:language.LANG_NATIVE_CONFIRM_CANCEL;e.isForceUpdate?coreCommon.isIos()?window.notifyIosUpdateAlert("VERSION_UPDATE_TITLE",{buttonText:language.UPDATE_NOW}).then(function(e){e.ret&&(O(),A())}):window.notifyUpdateConfirm("VERSION_UPDATE_TITLE",{leftButton:t,rightButton:language.UPDATE_NOW}).then(function(t){t.ret?N():(E.info("userClick exit download update version ",e.curPortalState),e.curPortalState===constant.CUR_PORTAL_LOGIN_STATE.FINISH&&delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT))}):window.notifyUpdateConfirm("VERSION_UPDATE_TITLE",{leftButton:language.UPDATE_LATER,rightButton:language.UPDATE_NOW}).then(function(e){e.ret?coreCommon.isIos()?O():N():E.info("userClick cancel download update version")})},A=function(){if(window.CLIENTCONFIG.ISMOBILE){var e=(0,g.getLoginModel)();constant.UPDATE_MODEL_CONTENT_TYPE.DOWNLOADING===e.showContentType?window.goRoute("mUpdateVersionInfo"):y()}else R()},b=function(e){try{if(window.fs){window.fs.readdirSync(e).forEach(function(t){var r=e+"/"+t;window.fs.statSync(r).isDirectory()||window.fs.unlinkSync(r)})}}catch(e){E.error("delete file error",e)}},P=function(e){var t=[];if(window.fs){window.fs.readdirSync(e).forEach(function(r){t.push(e+"/"+r)})}return t},x=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="",r="";if(window.fs)if(t=window.path.join(window.APP_DATA_PATH,"update/").replace(/\\/g,"/"),window.fs.existsSync(t))if(e){var n=P(t);r=Array.isArray(n)&&1===n.length&&n[0]||"",E.info("this is resume download, find old update file=",r),""===r&&(E.info("not found valid file, delete all files"),b(t))}else E.info("not resume download, delete old update files"),b(t);else E.info("creat new update file"),window.fs.mkdir(t);else window.webView&&(t=window.UPGRADE_APK_PATH,e&&(r=window.getProcessFileName(t)));return{upgradeDir:t,fileNamePath:r}},k=t.clearBarPageSet=function(){var e=(0,g.getLoginModel)();e.isUpdateError=!1,e.progressPercent=-1},M=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(0,g.getLoginModel)();E.info("start update download, iskeep=",t),E.info("start request software version check");var n=x(t),o=n.upgradeDir,a=n.fileNamePath;E.info("confirm download, set update file path=",o),""!==o&&(""!==a?(E.info("get old file path=",a),coreCwmp.getComPressFileSize({filePath:a}).then(function(t){var r=t.fileSize;E.info("get old update file size=",r),h(e,o,!0,r)})):h(e,o)),k(),r.showContentType=constant.UPDATE_MODEL_CONTENT_TYPE.DOWNLOADING,A()},U=t.getInCallingState=function(){var e=$getState().call.callStatus;return"VIDEO_CONNECTED"===e||"VIDEO_OUT"===e||"CALL_OUT"===e||"CALL_CONNECTED"===e},D=t.startInstallNewVer=function(){if(U()){var e=(0,g.getLoginModel)();E.info("User is in calling, save the state and wait for the call end"),e.isPortalAfterCallUpgrade=!0}else E.info("User is not calling, start install soft version now"),setTimeout(function(){window.CLIENTCONFIG.ISMOBILE?window.webView&&window.upgradeSoftVersion():G()},3e3)},G=function(){if(window.fs){for(var e=window.path.join(window.APP_DATA_PATH,"update").replace(/\\/g,"/"),t=window.fs.readdirSync(e),r=0;r<t.length;r++){var n=t[r];if(-1!==(0,l.default)(n).indexOf(".exe")){E.info("start execute software upgrade file, upgrade file name=",n);return void B(e+"/"+n)}}E.info("software update file is not exist"),W(language.DID_NOT_FIND_THE_AVAILABLE_UPGRADE_FILE)}},F=function(e){var t=window.process.env.APPDATA+"\\CloudLink\\log\\language.txt";window.fs.writeFile(t,window.langcode,"utf8",function(t){t&&window.log("writeFile quiteInstallFile error =",t),window.spawn(e,["/verysilent","/suppressmsgboxes","/norestart"]).on("error",function(e){E.info("execute update file error, err=",e),W(language.PC_FILE_DAMAGE_DOWN_AGAIN)})})},B=function(e){try{var t=window.APP_DATA_PATH;appService.writeFile(t,"configfile.ini","language = "+window.langcode.toString()+"\r\npackageversion = "+window.CLIENTCONFIG.NEW_APP_NAME).then(function(r){E.info("set update tip language success, file=",r);var n=t+"/ShowInstallTip.exe";appService.isFileExist(n).then(function(r){if(r){E.info("execute ShowInstallTip");var n=t.slice(0,2),o=n+" && cd "+t+" && ShowInstallTip.exe";window.exec(o),F(e)}else E.info("update tip file does not exit"),F(e)})},function(t){E.info("set update tip language failed, err:"+t),F(e)})}catch(e){E.error("install update file error:",e),W(language.PC_FILE_DAMAGE_DOWN_AGAIN)}},W=t.dealInstallFailed=function(e){E.info("intsall update file error, show download again prompt");var t=(0,g.getLoginModel)();window.exec("taskkill /f /im ShowInstallTip.exe"),H(),t.showContentType=constant.UPDATE_MODEL_CONTENT_TYPE.NEWHINTS,window.confirm(""+e,!0).then(function(e){e.ret&&(E.info("userClick to download update file again"),M(t.downloadUrl))})},H=t.hideProgressBarModal=function(){var e=(0,s.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=$getState().common.modalContent,isNullOrEmpty(t)||"progressbar"!==t.key?E.info("not update model, [key]=",t.key):(E.info("hide update model"),coreUi.hideModal());case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),V=(t.dealUpdateVersionClickEx=function(){if(E.info("userClick, show soft update state btn"),!1===(0,g.getLoginModel)().isWaitUpgrade)if(E.info("this is the latest software version"),window.CLIENTCONFIG.ISMOBILE)window.ToastNew(language.SOFT_UPGRADE_LATEST,2);else{var e=coreCommonComponent.lazyLoadPage({getComponentProm:HwLazyUiPage.getSoftVersionHint});coreUi.showModal(p.default.createElement(e,null))}else A()},t.compareVersion=function(e){var t=window.CLIENTCONFIG.ACS_SOFTWAREVERSION_VALUE,r=t.split("."),n=e.split("."),o=Math.max(r.length,n.length);if(t===e)return!1;for(var a=0;a<o;a++){var i=a>=n.length?0:parseInt(n[a],10),s=a>=r.length?0:parseInt(r[a],10);if(i>s)return!0;if(i<s)return!1}return!1})},713:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.registerPush=t.unRegisterPush=t.DB_KEY_HAS_OPEN_PUSH=t.DB_KEY_APNS_CER_TYPE=t.DB_KEY_IOS_VOIP_TOKEN=t.DB_KEY_IOS_PUSH_TOKEN=t.DB_KEY_HW_PUSH_BADGE_CLASS_NAME=t.DB_KEY_HW_PUSH_TOKEN=void 0;var o=r(67),a=n(o),i=r(1),s=n(i),u=r(2),c=n(u),d=r(183),l=(r(283),r(804)),f=window.Logger("login")("push"),p=t.DB_KEY_HW_PUSH_TOKEN="hwPushToken",_=t.DB_KEY_HW_PUSH_BADGE_CLASS_NAME="hwPushBadgeClassName",g=t.DB_KEY_IOS_PUSH_TOKEN="iosPushToken",w=t.DB_KEY_IOS_VOIP_TOKEN="voipToken",E=t.DB_KEY_APNS_CER_TYPE="apnsCerType",v=t.DB_KEY_HAS_OPEN_PUSH="hasOpenPush";window.registerHWPush=function(){var e=(0,c.default)(s.default.mark(function e(){var t,r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.webView.getLocalIp()||"0.0.0.0",!isNullOrEmpty(o)){e.next=6;break}return e.next=4,coreDb.queryLoginSetting({key:p});case 4:r=e.sent,isNullOrEmpty(r)||!r.hasOwnProperty("key")||!r.hasOwnProperty("value")||isNullOrEmpty(r.key)||isNullOrEmpty(r.value)||(o=r.value);case 6:if(!isNullOrEmpty(a)){e.next=11;break}return e.next=9,coreDb.queryLoginSetting({key:_});case 9:n=e.sent,isNullOrEmpty(n)||!n.hasOwnProperty("key")||!n.hasOwnProperty("value")||isNullOrEmpty(n.key)||isNullOrEmpty(n.value)||(a=n.value);case 11:return e.next=13,I(2,1,o,a,"","",t);case 13:return e.next=15,(0,l.registerEServerClientPush)(2,1,o,a,"","",t);case 15:coreDb.saveLoginSetting({key:p,value:o}),coreDb.saveLoginSetting({key:_,value:a});case 17:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),window.unRegisterHWClientPush=function(){var e=(0,c.default)(s.default.mark(function e(t){var r,n,o,a,i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=window.webView.getLocalIp()||"0.0.0.0",n=void 0,o=void 0,e.next=5,coreDb.queryLoginSetting({key:p});case 5:return a=e.sent,isNullOrEmpty(a)||!a.hasOwnProperty("key")||!a.hasOwnProperty("value")||isNullOrEmpty(a.key)||isNullOrEmpty(a.value)||(n=a.value),e.next=9,coreDb.queryLoginSetting({key:_});case 9:return i=e.sent,isNullOrEmpty(i)||!i.hasOwnProperty("key")||!i.hasOwnProperty("value")||isNullOrEmpty(i.key)||isNullOrEmpty(i.value)||(o=i.value),e.next=13,I(2,3,n,o,"","",r,"5",t);case 13:return e.next=15,(0,l.registerEServerClientPush)(2,3,n,o,"","",r);case 15:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();t.unRegisterPush=function(){var e=(0,c.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("android"!==window.CLIENTCONFIG.PLATFORM){e.next=5;break}return e.next=3,window.unRegisterHWClientPush(t);case 3:e.next=8;break;case 5:if("ios"!==window.CLIENTCONFIG.PLATFORM){e.next=8;break}return e.next=8,window.unRegisterIosPush(t);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();window.registerIosPush=function(){var e=(0,c.default)(s.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"5";return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.updateLocalIp().then(function(){var e=(0,c.default)(s.default.mark(function e(o){var a,i,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t)){e.next=5;break}return e.next=3,coreDb.queryLoginSetting({key:g});case 3:a=e.sent,isNullOrEmpty(a)||!a.hasOwnProperty("key")||!a.hasOwnProperty("value")||isNullOrEmpty(a.key)||isNullOrEmpty(a.value)||(t=a.value);case 5:if(!isNullOrEmpty(r)){e.next=10;break}return e.next=8,coreDb.queryLoginSetting({key:w});case 8:i=e.sent,isNullOrEmpty(i)||!i.hasOwnProperty("key")||!i.hasOwnProperty("value")||isNullOrEmpty(i.key)||isNullOrEmpty(i.value)||(r=i.value);case 10:if(!isNullOrEmpty(n)){e.next=15;break}return e.next=13,coreDb.queryLoginSetting({key:E});case 13:u=e.sent,isNullOrEmpty(u)||!u.hasOwnProperty("key")||!u.hasOwnProperty("value")||isNullOrEmpty(u.key)||isNullOrEmpty(u.value)||(n=u.value);case 15:return e.next=17,I(1,1,"","",t,r,o,n);case 17:return e.next=19,(0,l.registerEServerClientPush)(1,1,"","",t,r,o,n);case 19:coreDb.saveLoginSetting({key:g,value:t}),coreDb.saveLoginSetting({key:w,value:r});case 21:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),window.unRegisterIosPush=function(){var e=(0,c.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.updateLocalIp().then(function(){var e=(0,c.default)(s.default.mark(function e(r){var n,o,a,i,u,c;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,o=void 0,a="5",e.next=5,coreDb.queryLoginSetting({key:g});case 5:return i=e.sent,isNullOrEmpty(i)||!i.hasOwnProperty("key")||!i.hasOwnProperty("value")||isNullOrEmpty(i.key)||isNullOrEmpty(i.value)||(n=i.value),e.next=9,coreDb.queryLoginSetting({key:w});case 9:return u=e.sent,isNullOrEmpty(u)||!u.hasOwnProperty("key")||!u.hasOwnProperty("value")||isNullOrEmpty(u.key)||isNullOrEmpty(u.value)||(o=u.value),e.next=13,coreDb.queryLoginSetting({key:E});case 13:return c=e.sent,isNullOrEmpty(c)||!c.hasOwnProperty("key")||!c.hasOwnProperty("value")||isNullOrEmpty(c.key)||isNullOrEmpty(c.value)||(a=c.value),e.next=17,I(1,3,"","",n,o,r,a,t);case 17:return e.next=19,(0,l.registerEServerClientPush)(1,3,"","",n,o,r,a);case 19:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();var I=t.registerPush=function(){var e=(0,c.default)(s.default.mark(function e(t,r,n,o,i,u,c){var l,p,_,g,w,E,I,h,m,L,C,T,S,N,R,O,y,A,b,P,x,k,M,U,D,G,F,B=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"5",W=arguments.length>8&&void 0!==arguments[8]&&arguments[8];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info(" [ registerPush ] "),e.next=3,new coreHttp.hwTupHttpTransSdk;case 3:return l=e.sent,p=(0,d.getLoginModel)(),_=p.account,g=p.authToken,w=p.serverAddress,E=p.serverPort,I=p.pushgwUri,h=p.proxyAddress,m=p.proxyPort,L=p.proxyAccount,C=p.isSupportProxy,e.next=8,coreSecurity.PasswordManager.getPassword("password");case 8:return T=e.sent,e.next=11,coreSecurity.PasswordManager.getPassword("proxyPassword");case 11:if(S=e.sent,C||(h="",m="0",L="",S=""),N=1,R="00:00",O="00:00",!isNullOrEmpty(n)||!isNullOrEmpty(i)){e.next=19;break}return f.info(" [ registerPush ] androidToken and iosDeviceToken is null"),e.abrupt("return");case 19:return isNullOrEmpty(o)&&(o=""),y="",y=p.isSupportAS?"https://"+I+"/PushAgent/push/registerpush":"https://"+w+":"+E+"/pushAgent/registerpush",A={user:_,deviceToken:1===t?i:n,pushType:t,flag:r,clientIP:c,language:window.langShortName,noPushStartTime:R,noPushEndTime:O,apnsServerType:1,apnsCerType:B,pushByTimeSwitch:N,heart_beat_time:30,android_token:1===t?i:n,appId:"1",pushClassName:o,voipToken:u,appMode:1,push_mode:1,imPushMode:1,callPushMode:0,pushIMActive:"welink://welinksoftclient/h5page?page=imDetail",pushCallActive:"welink://welinksoftclient/h5page?page=call"},b=coreAccount.getLoginModel(),P=b.isSupportCACertCheck,e.next=26,l.sendSyncRequest({url:y,type:constant.REQUEST_TYPE.POST,header:{Authorization:"Basic "+g,"Content-Type":"application/json"},body:(0,a.default)(A),proxyInfo:{proxyAddress:h,proxyPort:m,proxyAccount:L,proxyPassword:S},tlsParam:{caCertPath:window.EXEC_PATH,tlsMode:P?1:0},cipherlist:[50331695,50331701,50331708,50331709]});case 26:if(x=e.sent,k=x.param,M=k.recv_body,U=k.resp_code,D=k.result,!U){e.next=46;break}if(200!==(G=parseInt(U))){e.next=42;break}if(M=JSON.parse(M),!M.error){e.next=35;break}return f.error(" [ registerPush ] failed, errorCode:"+M.error+", info:"+M.error_description),e.abrupt("return");case 35:F=!0,1===r?F=!0:3===r&&(F=!1),(3===r&&W||1===r)&&coreDb.saveUserConfigList({key:v,value:F.toString()}),$dispatch(coreUi.changeHasOpenPush(F)),f.info(" [ registerPush ] result:",M),e.next=44;break;case 42:return f.error(" [ registerPush ] failed, request error, status code: "+U+", result: "+D),e.abrupt("return");case 44:e.next=47;break;case 46:f.error(" [ registerPush ] failed, status code:"+U);case 47:case"end":return e.stop()}},e,this)}));return function(t,r,n,o,a,i,s){return e.apply(this,arguments)}}()},714:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorTips=t.handleLoginError=t.handleCommonLoginFailed=t.handleUportalLoginFailed=void 0;var n=r(67),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(353),i=r(354),s=r(715),u=window.Logger("login")("uportal"),c=(window.Logger("login")("sip"),window.Logger("login")("eab"),window.Logger("login")("common")),d=t.handleUportalLoginFailed=function(e){var t=e.errorCode,r=coreAccount.getLoginModel().isResume;c.info("handleUportalLoginFailed isResume "+r);var n=function(e){return u.error((r?"Resume UportalLoginError":"UportalLoginError")+": ["+e+"]")},o=(0,a.getLoginModel)(),d=!1,l=!1,f=void 0;switch(t){case"LOGIN_ADDRESS_OR_PORT_EMPTY":f=language.LOGIN_ADDRESS_OR_PORT_EMPTY,n("LOGIN_ADDRESS_OR_PORT_EMPTY"),d=!0;break;case"LOGIN_ACCOUNT_OR_PASSWORD_EMPTY":f=language.LOGIN_ACCOUNT_OR_PASSWORD_EMPTY,n("LOGIN_ACCOUNT_OR_PASSWORD_EMPTY"),d=!0;break;case"LOGIN_ACCOUNT_HAS_SPACE":f=language.LOGIN_ACCOUNT_HAS_SPACE,n("LOGIN_ACCOUNT_HAS_SPACE"),d=!0;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_TIMEOUT:f=language.CALL_CALLING_FAILED,n("LOGIN_ERR_NETWORK_ERROR");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_REQUEST_FAILED:f=language.CALL_CALLING_FAILED,n("LOGIN_ERR_REQUEST_FAILED");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_DNS_ERROR:f=language.CALL_CALLING_FAILED,n("LOGIN_ERR_DNS_ERROR");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_SERVICE_ERROR:f=language.CALL_CALLING_FAILED,n("LOGIN_ERR_SERVICE_ERROR");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_SEARCH_SERVER_FAIL:f=language.CALL_CALLING_FAILED,n("LOGIN_ERR_SEARCH_SERVER_FAIL");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_AUTH_FAILED:d=!0,l=!0,f=language.LOGIN_USERPWD_ERROR,n("LOGIN_ERR_AUTH_FAILED");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_AUTH_NAME_OR_PWD_ERROR:d=!0,l=!0,f=language.LOGIN_USERPWD_ERROR,n("LOGIN_E_ERR_AUTH_NAME_OR_PWD_ERROR");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_ACCOUNT_LOCKED:d=!0,f=language.LOGIN_ERR_ACCOUNT_LOCKED,n("LOGIN_ERR_ACCOUNT_LOCKED");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_STG_TUNNEL_BUILD_ERROR:f=language.CALL_CALLING_FAILED,n("LOGIN_ERR_STG_TUNNEL_BUILD_ERROR");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_NETWORK_ERROR:f=language.CALL_CALLING_FAILED,n("LOGIN_ERR_NETWORK_ERROR");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_DOWNLOAD_CA_CERT_ERROR:f=language.LOGIN_ERR_DOWNLOAD_CA_CERT_ERROR,n("LOGIN_ERR_DOWNLOAD_CA_CERT_ERROR");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_NETWORK_ERROR:f=language.CALL_CALLING_FAILED,n("LOGIN_E_ERR_NETWORK_ERROR");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_HAS_PROXY_NO_STG:f=language.LOGIN_E_ERR_AUTH_ERROR,n("LOGIN_ERR_HAS_PROXY_NO_STG");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_AUTH_ACCOUNT_DIACTIVE:d=!0,l=!0,f=language.RENEW_EXPIRED_REMINDER,n("LOGIN_E_ERR_AUTH_ACCOUNT_DIACTIVE");break;default:f=language.CALL_CALLING_FAILED,n("Unhandle errorCode:["+t+"]")}if(c.info("logLoginError msg :",f),window.CLIENTCONFIG.ISMOBILE&&window.stroage.isFastLogin()&&!r&&(window.stroage.setFastLogin(!1),navigator.splashscreen&&navigator.splashscreen.hide(),window.goRoute("loginCtn")),d&&l&&(0,s.checkAndEndCall)().then(function(){c.info("up login check and end call ",l)}),r&&!d)o.setLoginStatus(!1,!1);else if(r&&!l)(0,i.stopResume)(),o.setLoginStatus(!1,!1);else if(window.CLIENTCONFIG.ISBIGWIN)o.setLoginStatus(!1,!1);else if(window.isHubEnv)o.setLoginStatus(!1,!1),o.maxhubLoginError={serverType:0,errorCode:t},window.getRoute()&&"maxhubLogin"!==window.getRoute()&&delegate.logout();else if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){var p=f||"unknow error";window.itWeLinkNotifyCallEnded(0,p)}else o.setLoginStatus(!1,!1),c.info("handleUportalLoginFailed",f||"unknow error"),r&&l&&(0,i.stopResume)(),alert(f||"unknow error").then(function(){c.info("resetDisableLogin"),window.getRoute()&&"login"!==window.getRoute()&&"login/joinConfSIPOnly"!==window.getRoute()&&"login/noLoginJoinConference"!==window.getRoute()&&!1===window.CLIENTCONFIG.ISMOBILE&&delegate.logout(),window.CLIENTCONFIG.ISMOBILE&&l&&window.getRoute()&&"loginCtn"!==window.getRoute()&&delegate.logout()});return f},l=t.handleCommonLoginFailed=function(e){var t=e.errorCode,r=coreAccount.getLoginModel().isResume,n=function(e){return c.error((r?"Resume Login Error":"Login Error")+": "+e)};switch(t){case"duplicateLogin":n("[ DuplicateLogin ] login oper failed, there is a login oper now...");break;case"fistLoginReject":n("[ FistLoginReject ] fist login rejected, after changepassword will relogin...");break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_IWB_MAXHUB_ACCOUNT:n("[ IWB2MaxHub ] this is maxhub tegrate enviroument, the account is not iwb account"),(0,a.getLoginModel)().setLoginStatus(!1,!1),(0,a.getLoginModel)().maxhubLoginError={serverType:0,errorCode:t},window.getRoute()&&"maxhubLogin"!==window.getRoute()&&delegate.logout()}};t.handleLoginError=function(e){c.info("[ handleLoginError ]"+(0,o.default)(e));var t=(0,a.getLoginModel)();if($getState().login.sipLoginOnly)if("Workplace"===window.CLIENTCONFIG.NEW_APP_NAME){var r=t.loginHistoryList,n=t.loginRecordList;coreAccount.showLoginInfo({loginInfo:n[0],loginHistoryList:r,loginRecordList:n})}else coreAccount.getLoginModel().displayAccount="",coreAccount.getLoginModel().password="";if(t.clearInLoginState(),e&&e.errorType)window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(t.isResume?c.info("[IT-Meeting] login failed, resume login."):(c.info("[IT-Meeting] login failed, go back."),window.switchToBackMode(),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT))),e.errorType===constant.LOGIN_ERROR_TYPE.common?(window.CLIENTCONFIG.ISBIGWIN?coreConf.NotifyLoginFailedEx(1):window.isHubEnv&&("LOGIN_ERR_IWB_MAXHUB_ACCOUNT"===e.errorCode?coreConf.NotifyLoginFailed(constant.WORKPLACE_LOGIN_ERROR_TYPE.ERR_ACC_OR_PAS):coreConf.NotifyLoginFailed(constant.WORKPLACE_LOGIN_ERROR_TYPE.ERR_NETWORK),c.info("maxhub handleLoginError LOGIN_ERROR_TYPE.common errcode: "+e.errorCode)),l(e)):e.errorType===constant.LOGIN_ERROR_TYPE.uportal?(d(e),t.curPortalState=constant.CUR_PORTAL_LOGIN_STATE.INIT,window.CLIENTCONFIG.ISBIGWIN?(window.shouldStopRertyLogin=!1,window.bigwinReTryLogin()):window.isHubEnv&&(e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_TIMEOUT||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_DNS_ERROR||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_SERVICE_ERROR||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_NETWORK_ERROR||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_NETWORK_ERROR||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_BAD_ACCESS_DURING_UPGRADE||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_INVALID_URL?coreConf.NotifyLoginFailed(constant.WORKPLACE_LOGIN_ERROR_TYPE.ERR_NETWORK):e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_AUTH_FAILED||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_ACCOUNT_LOCKED||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_USER_NOT_EXISTS||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_USER_NOT_EXISTS||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_AUTH_ACCOUNT_DIACTIVE||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_TIMEOUT||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ADDRESS_OR_PORT_EMPTY||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ACCOUNT_OR_PASSWORD_EMPTY||e.errorCode===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_IWB_MAXHUB_ACCOUNT?coreConf.NotifyLoginFailed(constant.WORKPLACE_LOGIN_ERROR_TYPE.ERR_ACC_OR_PAS):coreConf.NotifyLoginFailed(constant.WORKPLACE_LOGIN_ERROR_TYPE.ERR_OTHER),c.info("maxhub handleLoginError LOGIN_ERROR_TYPE.uportal errcode: "+e.errorCode))):(e.errorType,constant.LOGIN_ERROR_TYPE.eabserver),coreCommon.dispatchModuleEvent("login",{event:e.errorType,code:e.errorCode});else{c.error("no exact error handle",e);(0,a.getLoginModel)().setLoginStatus(!1,!1)}},t.getErrorTips=function(e,t){c.info("get error tips, server=",e+", errorCode=",t);var r="";if(0===e)switch(t){case constant.UPORTAL_LOGIN_ERROR.LOGIN_ADDRESS_OR_PORT_EMPTY:r=language.LOGIN_ADDRESS_OR_PORT_EMPTY;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ACCOUNT_OR_PASSWORD_EMPTY:r=language.LOGIN_ACCOUNT_OR_PASSWORD_EMPTY;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_TIMEOUT:case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_REQUEST_FAILED:case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_DNS_ERROR:case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_SERVICE_ERROR:case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_SEARCH_SERVER_FAIL:r=language.CALL_CALLING_FAILED;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_AUTH_FAILED:case constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_AUTH_NAME_OR_PWD_ERROR:r=language.LOGIN_USERPWD_ERROR;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_ACCOUNT_LOCKED:r=language.LOGIN_ERR_ACCOUNT_LOCKED;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_STG_TUNNEL_BUILD_ERROR:case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_NETWORK_ERROR:r=language.CALL_CALLING_FAILED;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_DOWNLOAD_CA_CERT_ERROR:r=language.LOGIN_ERR_DOWNLOAD_CA_CERT_ERROR;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_NETWORK_ERROR:r=language.CALL_CALLING_FAILED;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_HAS_PROXY_NO_STG:r=language.LOGIN_E_ERR_AUTH_ERROR;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_AUTH_ACCOUNT_DIACTIVE:r=language.RENEW_EXPIRED_REMINDER;break;case constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_IWB_MAXHUB_ACCOUNT:r=language.MAXHUB_INVALID_ACCOUTN;break;default:r=language.CALL_CALLING_FAILED}else if(1===e)switch(t){case constant.ESERVER_LOGIN_ERROR.LOGIN_ADDRESS_OR_PORT_EMPTY:r=language.LOGIN_ADDRESS_OR_PORT_EMPTY;break;case constant.ESERVER_LOGIN_ERROR.LOGIN_ACCOUNT_OR_PASSWORD_EMPTY:r=language.LOGIN_ACCOUNT_OR_PASSWORD_EMPTY;break;case constant.ESERVER_LOGIN_ERROR.LOGIN_LOCALIP_GET_FAILED:case constant.ESERVER_LOGIN_ERROR.IM_E_LOGING_RESULT_TIMEOUT:r=language.CALL_CALLING_FAILED;break;case constant.ESERVER_LOGIN_ERROR.IM_E_LOGING_RESULT_PASSWORD_ERROR:case constant.ESERVER_LOGIN_ERROR.IM_E_LOGING_RESULT_FAILED:case constant.ESERVER_LOGIN_ERROR.IM_E_LOGING_RESULT_ACCOUNT_NOT_EXIST:r=language.LOGIN_USERPWD_ERROR;break;case constant.ESERVER_LOGIN_ERROR.IM_E_LOGING_RESULT_NEED_NEW_VERSION:r=language.LOGIN_NEED_NEW_VERSION;break;case constant.ESERVER_LOGIN_ERROR.IM_E_LOGING_RESULT_NOT_ACTIVE:case constant.ESERVER_LOGIN_ERROR.IM_E_LOGING_RESULT_ACCOUNT_SUSPEND:case constant.ESERVER_LOGIN_ERROR.IM_E_LOGING_RESULT_ACCOUNT_LOCKED:case constant.ESERVER_LOGIN_ERROR.IM_E_LOGING_RESULT_ACCOUNT_EXPIRE:r=language.LOGIN_ACCOUNT_ERROR;break;default:r=language.CALL_CALLING_FAILED}return r}},715:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.endCurrentCall=t.checkAndEndCall=t.checkBeforeSetOffline=t.checkBeforeLogout=void 0;var o=r(3),a=n(o),i=r(1),s=n(i),u=r(2),c=n(u),d=r(183),l=window.Logger("logic")("login/checkBeforeLogout"),f=(t.checkBeforeLogout=function(){var e=(0,c.default)(s.default.mark(function e(t){var r,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l.debug("checkBeforeLogout"),e.next=4,f(t);case 4:if(r=e.sent){e.next=7;break}return e.abrupt("return",r);case 7:if(window.CLIENTCONFIG.ISMOBILE){e.next=20;break}return e.next=10,g(t);case 10:if(r=e.sent,l.info("checkResult checkFileTransFer"+r),r&&!1!==r.ret){e.next=14;break}return e.abrupt("return",!1);case 14:return e.next=16,_(t,n);case 16:if(r=e.sent,l.info("checkResult checkEditor :"+r),r){e.next=20;break}return e.abrupt("return",r);case 20:return e.abrupt("return",r);case 23:return e.prev=23,e.t0=e.catch(0),l.error("checkBeforeLogout",{type:t,e:e.t0.toJSON()}),e.abrupt("return",!1);case 27:case"end":return e.stop()}},e,void 0,[[0,23]])}));return function(t){return e.apply(this,arguments)}}(),t.checkBeforeSetOffline=function(){var e=(0,c.default)(s.default.mark(function e(t){var r,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l.debug("checkBeforeSetOffline"),e.next=4,f(t,n);case 4:if(r=e.sent){e.next=7;break}return e.abrupt("return",r);case 7:if(window.CLIENTCONFIG.ISMOBILE){e.next=13;break}return e.next=10,g(t,n);case 10:if(r=e.sent){e.next=13;break}return e.abrupt("return",r);case 13:return e.abrupt("return",r);case 16:return e.prev=16,e.t0=e.catch(0),l.error("checkBeforeSetOffline",{type:t,e:e.t0.toJSON()}),e.abrupt("return",!1);case 20:case"end":return e.stop()}},e,void 0,[[0,16]])}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,c.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l.info(" checklogin : isInUportalLogin:"+(0,d.getLoginModel)().isInUportalLogin+", isInInitPrivateDB:"+(0,d.getLoginModel)().isInInitPrivateDB+", isInDetectFireWall:"+(0,d.getLoginModel)().isInDetectFireWall+", isInLoadConfigFromDB:"+(0,d.getLoginModel)().isInLoadConfigFromDB+", isInEserverLogin:"+(0,d.getLoginModel)().isInEserverLogin+", isInSipLogin:"+(0,d.getLoginModel)().isInSipLogin),!((0,d.getLoginModel)().isInUportalLogin||(0,d.getLoginModel)().isInInitPrivateDB||(0,d.getLoginModel)().isInDetectFireWall||(0,d.getLoginModel)().isInLoadConfigFromDB||(0,d.getLoginModel)().isInEserverLogin||(0,d.getLoginModel)().isInSipLogin)){e.next=5;break}return t=language.COMMON_CHECK_LOGOUT_LOGINEXIST,alert(t),e.abrupt("return",!1);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}},e,void 0)}))}(),function(){var e=(0,c.default)(s.default.mark(function e(t){var r,n,o,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l.info("checkCall"),!(coreCall.getCallCount()>0)){e.next=33;break}if(!(window.CLIENTCONFIG.ISBIGWIN||window.isHubEnv||window.isPluginEnv)){e.next=9;break}return e.next=6,p();case 6:window.endCallPromise=null,e.next=33;break;case 9:if(r="",n="LANG_NATIVE_CONFIRM_TITLE",t===constant.LOGOUT_TYPE.LOGOUT?r=language.COMMON_CHECK_LOGOUT_CALLEXIST:t===constant.LOGOUT_TYPE.EXIT?r=language.COMMON_CHECK_QUIT_CALLEXIST:t===constant.LOGOUT_TYPE.SETOFFLINE&&(r=language.COMMON_CHECK_QUIT_OFFLINE),!r){e.next=33;break}if(o=!1,!a){e.next=26;break}if(!window.CLIENTCONFIG.ISMOBILE){e.next=21;break}return e.next=18,window.confirm(r);case 18:o=e.sent,e.next=24;break;case 21:return e.next=23,window.confirm(r,n,!0);case 23:o=e.sent;case 24:e.next=27;break;case 26:o={ret:!0};case 27:if(!o.ret){e.next=32;break}return window.CLIENTCONFIG.ISMOBILE||appService.resetTrayMenu(),e.next=31,p();case 31:window.endCallPromise=null;case 32:return e.abrupt("return",o.ret);case 33:return"CALL_INCOMING"===$getState().call.callStatus&&coreUi.stopRing(),e.abrupt("return",!0);case 37:return e.prev=37,e.t0=e.catch(0),l.error("checkCall",{e:e.t0.toJSON()}),e.abrupt("return",!1);case 41:case"end":return e.stop()}},e,void 0,[[0,37]])}));return function(t){return e.apply(this,arguments)}}()),p=(t.checkAndEndCall=function(){try{return l.info("checkAndEndCall"),coreCall.getCallCount()>0?p():a.default.resolve(!0)}catch(e){return l.error("checkAndEndCall",{e:e.toJSON()}),a.default.resolve(!0)}},t.endCurrentCall=function(){var e=(0,c.default)(s.default.mark(function e(){var t,r,n,o,a,i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.endCallPromise=new PromiseObject,setTimeout(function(){null!==window.endCallPromise&&window.endCallPromise.resolve()},5e3),t=$getState(),r=t.conf,n=r.confHandle,o=r.selfRole,a=t.call.callId,coreConf.isInConf()){e.next=9;break}return l.info("ConfrimNotify end call, callId=",a),e.next=7,coreCall.callHangup(a);case 7:e.next=12;break;case 9:return l.info("ConfrimNotify leave conf, confHandle=",n),e.next=12,coreConf.actionLeaveConf();case 12:return coreUi.selectBoxCancelDataNWin(),window.CLIENTCONFIG.ISMOBILE&&"mConfMemberPage"===(i=window.getRoute())&&window.goRoute("main/conference"),e.abrupt("return",window.endCallPromise);case 15:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),_=function(e,t){try{var r=language.PRE_EXIT_CHECK_EDITOR,n=!0;return e===constant.LOGOUT_TYPE.LOGOUT&&(n=!0,r=language.PRE_LOGOUT_CHECK_EDITOR),t?coreIm.checkEditorBeforeLogout(r,"LANG_NATIVE_CONFIRM_TITLE",n):coreIm.checkEditor(r,"LANG_NATIVE_CONFIRM_TITLE",n)}catch(e){return l.error("checkEditor check异常，强制通过",{e:e.toJSON()}),!0}},g=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var r=language.PRE_EXIT_CHECK_FILE_TRANSFER;e===constant.LOGOUT_TYPE.LOGOUT&&(r=language.PRE_LOGOUT_CHECK_FILE_TRANSFER);return coreIm.checkFileTransFer(r,"LANG_NATIVE_CONFIRM_TITLE",!0,t)}catch(e){return l.error("checkFileTransFer  check异常，强制通过",{e:e.toJSON()}),!0}}},716:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){b.info("clearObserversAndEvents"),coreConf.unregisterConfEvent(),coreCommon.Observer.unsubsribleAll(),coreConf.registerConfEventAtomic.reset(),coreConf.subScribeConfListAndInfoResAtomic.reset()}function a(){b.info("hideAlertAndConfirm"),window.hideConfirm&&window.hideConfirm(),window.hideAlert&&window.hideAlert(),window.hideNotifyConfirm&&window.hideNotifyConfirm(),window.clearDialogQueue&&window.clearDialogQueue()}function i(){return(0,L.getLoginModel)().isBuildStgSuc?(0,I.destroyStgTunnel)():c.default.resolve(0)}function s(){b.error("logout failed");var e=(0,L.getLoginModel)();coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_LOGOUT,extraTrackKey:null,resultParams:[0],isTrackTimeCosts:!0}),coreUt.utConfigAccountInfo({configAccount:""}),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||window.goRoute(window.CLIENTCONFIG.ISMOBILE?"loginCtn":window.isHubEnv?"maxhubLogin":"login"),coreCommon.isMobile()&&(e.logoutDisable=!1),coreCommon.isPc()&&$dispatch(coreUi.dragSetEnable())}Object.defineProperty(t,"__esModule",{value:!0}),t.deRegisterService=t.clearState=t.quickLogout=t.logout=t.setOffline=t.doLogout=t.initService=void 0;var u=r(3),c=n(u),d=r(128),l=n(d),f=r(1),p=n(f),_=r(2),g=n(_),w=function(){var e=(0,g.default)(p.default.mark(function e(t){var r,n=t.isBackLogin,o=t.isClearLoginRecord;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.info("logout success"),r=(0,L.getLoginModel)(),coreCommon.isPc()&&$dispatch(coreUi.dragSetEnable()),coreCommon.isMobile()&&(r.logoutDisable=!1),coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_LOGOUT,extraTrackKey:null,resultParams:[1],isTrackTimeCosts:!0}),coreUt.utConfigAccountInfo({configAccount:""}),n&&(window.isConfLogOut=o,window.ifLogOut=!0,(0,L.getLoginModel)().showPwd=!1,(0,L.getLoginModel)().sipOnlyType=0,window.isLoadLoginRecord=!0,!window.CLIENTCONFIG.ISMOBILE&&delegate.winHide(),!window.CLIENTCONFIG.ISMOBILE&&(0,R.initImportCertificate)(),window.CLIENTCONFIG.ISMOBILE&&(0,R.initMImportCertificate)(),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?(b.info("[IT-Meeting] IS_LINK_IT_SMC_MEETING go main"),window.goRoute("callMain"),b.info("[IT-Meeting] shutDownTupServer"),window.shutDownTupServer()):window.goRoute(window.CLIENTCONFIG.ISMOBILE?"loginCtn":window.isHubEnv?"maxhubLogin":"login")),coreCommon.isMobile()&&(r.logoutDisable=!1),coreCommon.isPc()&&$dispatch(coreUi.dragSetEnable());case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=(0,g.default)(p.default.mark(function e(){var t,r,n,o,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("start deRegisterTupService"),t=(0,L.getLoginModel)(),window.CLIENTCONFIG.ISBIGWIN){e.next=9;break}return e.next=5,coreConf.endPairWithPeripherals();case 5:return e.next=7,coreConf.serverCloseAllPair();case 7:coreConf.uninitAsPairServer(),coreConf.handlePairClosed();case 9:if(!(r=coreAccount.getLoginModel().isSupportAS)){e.next=13;break}return e.next=13,coreConf.unSubscribeConfList();case 13:return e.next=15,new coreTup.HWUportal;case 15:return n=e.sent,e.next=18,n.uportalLogout();case 18:return e.next=20,coreConf.unInitConfCtrl();case 20:if(!window.CLIENTCONFIG.ISMOBILE){e.next=24;break}if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=24;break}return e.next=24,(0,h.unEnableBFCP)();case 24:return e.next=26,(0,h.sipserverDeregister)();case 26:return e.next=28,coreCwmp.stopCwmpServerAndUnInit();case 28:return e.next=30,coreContact.eaddrUnint();case 30:if(a||!t.useIM){e.next=45;break}return b.info("deRegisterTupService publishStatusToServer ONLINE_STATUS.OFFLINE"),o=$getState().recent.showRecentInfo.toString(),e.next=35,coreDb.saveUserConfig({key:"userInfoStatus",value:o});case 35:if(!window.isEserverOnline){e.next=40;break}return e.next=38,coreIm.publishStatusToServer({status:constant.ONLINE_STATUS.OFFLINE,desc:""});case 38:e.next=41;break;case 40:b.info("deRegisterTupService publishStatusToServer eserver if offline");case 41:return e.next=43,coreIm.eserverLogout();case 43:return e.next=45,coreIm.umserverLogout();case 45:b.info("deRegisterTupService success");case 46:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),v=t.deRegisterService=function(){var e=(0,g.default)(p.default.mark(function e(){var t,r=(!(arguments.length>0&&void 0!==arguments[0])||arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1]);return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,b.info("start deRegisterService"),b.info("deRegisterService, set isOffline true"),window.isOffline=!0,window.CLIENTCONFIG.ISMOBILE){e.next=9;break}return e.next=7,new coreSecurity.HWTupSupport;case 7:t=e.sent,t.addCallBack({closeSupportSocket:function(){b.info(" closeSupportSocket set null")}});case 9:return window.isLoadLoginRecord=!1,(0,T.enableAutoLogin)(!1),e.next=13,E(r);case 13:return b.info("deRegisterService success"),e.abrupt("return",!0);case 17:return e.prev=17,e.t0=e.catch(0),b.error("setOffline error",e.t0.toJSON&&e.t0.toJSON()),e.abrupt("return",c.default.resolve(!1));case 21:case"end":return e.stop()}},e,this,[[0,17]])}));return function(){return e.apply(this,arguments)}}(),I=r(352),h=r(351),m=r(408),L=r(183),C=r(715),T=r(310),S=r(354),N=r(999),R=r(283),O=r(713),y=r(794),A=r(409),b=window.Logger("logic")("logout"),P=t.initService=function(e){coreIm.initImModelService(e),coreIm.initRecentService(e),coreIm.initOpenRecentData(e),coreGroup.initGroupService(e),coreIm.localTimeService.initLocalTimeService(e)},x=(t.doLogout=delegate(function(){var e=(0,g.default)(p.default.mark(function e(t){var r,n,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("doLogout"),r=(0,L.getLoginModel)(),coreCommon.isPc()&&$dispatch(coreUi.dragSetDisable()),coreCommon.isMobile()&&(r.logoutDisable=!0),coreCommon.isPc()&&(0,m.clearFireWallStore)(),e.next=7,(0,C.checkBeforeLogout)(t);case 7:if(!(n=e.sent)){e.next=13;break}return e.next=11,(0,A.restoreMAAConfControl)();case 11:return e.next=13,x(o);case 13:return coreCommon.isPc()&&$dispatch(coreUi.dragSetEnable()),coreCommon.isMobile()&&(r.logoutDisable=!1),r.isPortalUpgrade=!1,r.isReqAddrChanged=!1,e.abrupt("return",n);case 18:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),"doLogout"),t.setOffline=function(){var e=(0,g.default)(p.default.mark(function e(){var t,r,n,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,L.getLoginModel)(),e.next=3,(0,C.checkBeforeSetOffline)(constant.LOGOUT_TYPE.SETOFFLINE,s);case 3:if(!0!==(r=e.sent)&&!0!==r.ret){e.next=21;break}return a&&(0,R.changeAutoLogin)(a),t.setAppState(constant.APP_STATE.DISCONNECTED),n=(0,L.getMyInfo)().account,$dispatch(coreUi.updataContactStatusMap((0,l.default)({},n,{status:constant.ONLINE_STATUS.OFFLINE,desc:"",client_type:0}))),(0,L.getMyInfo)().status=constant.ONLINE_STATUS.OFFLINE,$dispatch(coreUi.subscriptionAccountList([])),b.info("setOffline, change status is offline"),coreUi.clearLinkageStatusLogic(),o(),(0,S.clearResumeService)(),(0,S.stopResume)(),b.info("setOffline, set isOffline true"),window.isOffline=!0,e.abrupt("return",v(i));case 21:return e.abrupt("return",c.default.resolve(!1));case 22:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.logout=delegate(function(){var e=(0,g.default)(p.default.mark(function e(){var t,r,n,u=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a(),t=(0,L.getLoginModel)(),coreUt.utEventStart({eventId:constant.EVENT_ID.UT_LOGOUT,extraTrackKey:null,params:[]}),r=$getState(),n=r.conf.confTempAcsAccount,isNullOrEmpty(n)||($dispatch(coreUi.changeConfTempAcsAccount("")),coreAccount.getLoginModel().displayAccount=""),coreCommon.isPc()&&$dispatch(coreUi.dragSetDisable()),coreCommon.isMobile()&&(t.logoutDisable=!0),window.stroage.setFastLogin(!1),e.prev=8,b.info("[ logout ] isBackLogin:"+u+",isKickout:"+c),coreCommon.isPc()&&appService.resetTrayMenu(),window.CLIENTCONFIG.ISMOBILE&&appService.cancelAllNotification(),e.next=14,(0,O.unRegisterPush)(!1);case 14:window.skipLogin=!1,(0,S.clearResumeService)(),(0,S.stopResume)(),(0,N.getMiddleEndApi)().stopRefreshMiddleEndToken(),o(),coreCall.exitFullScreen(),coreConf.getVmrInfoToDbAtomic.reset(),coreConf.getAsInfoToDbAtomic.reset(),!c&&(0,T.storeAppCache)(),$dispatch(coreUi.toggleMobileNetTip(!0)),t.isMobile&&document.removeEventListener("pause",T.storeAppCache,!1),e.next=32;break;case 27:return e.prev=27,e.t0=e.catch(8),b.error("logout exception: "+e.t0.toString()),b.error("logout handle cache error:",e.t0),e.abrupt("return",s());case 32:return e.abrupt("return",v(!0,l).then((0,g.default)(p.default.mark(function e(){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i(),e.next=3,(0,I.resetLoginInfo)();case 3:return k(),e.abrupt("return",{isBackLogin:u,isClearLoginRecord:d});case 5:case"end":return e.stop()}},e,void 0)}))).then(w).catch(function(){s()}));case 33:case"end":return e.stop()}},e,void 0,[[8,27]])}));return function(){return e.apply(this,arguments)}}(),"logout")),k=(t.quickLogout=delegate((0,g.default)(p.default.mark(function e(){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("[ quickLogout ]"),e.next=3,coreCwmp.stopCwmpServerAndUnInit();case 3:case"end":return e.stop()}},e,void 0)})),"quickLogout"),t.clearState=function(){b.info("clearState"),coreSearch.clearGlobalData(),coreUi.clearReduxState(),P("logout clearState"),coreUi.initAvatarMap(),coreUi.hideModal(),(0,L.resetLoginModel)(),(0,y.resetMyInfo)()})},793:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.set=t.get=void 0;var n=r(67),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(183),i=window.Logger("account")("appCache"),s=t.get=function(e,t){return coreDb.queryLoginSetting({key:t?e:(0,a.getLoginModel)().account+"_"+e}).then(function(e){try{return JSON.parse(e.value)}catch(e){i.error("query login sertting parse error",e)}})},u=t.set=function(e,t,r){return coreDb.saveLoginSetting({key:r?e:(0,a.getLoginModel)().account+"_"+e,value:(0,o.default)(t)})},c=t.remove=function(e,t){return coreDb.saveLoginSetting({key:t?e:(0,a.getLoginModel)().account+"_"+e,value:""})};window.appCache={get:s,set:u,remove:c}},794:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MyInfo=t.resetMyInfo=t.getMyInfo=void 0;var o=r(117),a=n(o),i=r(4),s=n(i),u=r(5),c=n(u),d=r(118),l=n(d),f=r(119),p=n(f),_=void 0,g=(t.getMyInfo=function(){return _||(_=new w(g)),_},t.resetMyInfo=function(){_=null},{language:"",languageCode:"",isReminder:!0,closeAppWays:"minimizeApp",isAutoCollectLogs:!0,hasAllowCollectLogs:!1,isAutoAcceptConf:!1,isAutoStart:!1,statusDesc:"",statusOptions:[],selectIndex:1,isShowMyInfo:!0,signature:"",isAutoResponseConf:!1,isOffToLine:!1,isAutoLeave:!0,account:"",address:"",age:"",bind_no:"",birthday:"",compareAccount:"",dept_id:"",dept_name_cn:"",dept_name_en:"",desc:"",email:"",espacenumber:"",etag:"",fax:"",gender:0,home_phone:"",image_id:"",image_sync_time:"",ip_phone:"",is_security:0,mobile:"",modify_time:"",name:"",native_name:"",office_phone:"",office_phone2:"",old_account:"",other_mobiles:"",other_phone:"",other_phone2:"",postcode:"",q_pin_yin:"",result_code:"",short_phone:"",staff_id:0,staff_no:"",state:"0",status:1,title:"",type:"0",uri:"",user_type:"0",voip:"",website:"",selfUserUri:"",show_account:""}),w=t.MyInfo=function(e){function t(e){return(0,s.default)(this,t),(0,l.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e))}return(0,p.default)(t,e),(0,c.default)(t,[{key:"notifyChanged",value:function(e){$dispatch(coreUi.updateMyInfo(e)),e&&e.languageCode&&coreCommon.dispatchModuleEvent("changeLanguage",e.languageCode)}}]),t}(coreCommon.ModuleCache)},795:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.sipLoginAtomic=t.sipserverLogin=t.loginToRegSipServer=t.loginToSipServer=void 0;var o=r(121),a=n(o),i=r(3),s=n(i),u=r(67),c=n(u),d=r(1),l=n(d),f=r(2),p=n(f),_=function(){var e=(0,p.default)(l.default.mark(function e(){var t;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:t=e.sent,t.setNotifyFunc(98305,L);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),g=t.loginToSipServer=function(){var e=(0,p.default)(l.default.mark(function e(){var t,r,n,o,a,i,s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h=s,I.info("[ loginToSipServer ] _ignoreSipResult "+s),I.info("<account_login><7_sip>begin"),coreUt.utEventStart({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_SIP_SERVER,params:[constant.UT_LOGIN_SERVER_NAME.UT_SIP_SERVER]}),t=(0,w.getLoginModel)(),r=t.isMultiDeviceLogined,n=t.isMobile,o=t.stgUri,a=t.sipLoginOnly,(0,E.registerSipResultCallback)(),
//! 移动端因为存在多终端登录场景，不在这里进行Sip注册了，在eServer登录完成后，获取到多终端登录的通知后，进行Sip注册；PC端不变；
I.info("[ loginToSipServer ] isMultiDeviceLogined:"+r+", isMobile:"+n+", sipLoginOnly:"+a),r&&n&&(I.info("[ loginToSipServer ] end login:"),t.setLoginStatus(!1,!0)),r&&n&&!a){e.next=22;break}return _(),e.next=13,m(t.isTempLogin);case 13:if(i=e.sent,I.info("[ confctrlInit ] start"),!t.useMetting||window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=18;break}return e.next=18,coreConf.confctrlInit();case 18:return I.info("[ confctrlInit ] end"),e.abrupt("return",i);case 22:return e.abrupt("return",{result:!1});case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),w=(t.loginToRegSipServer=function(){var e=(0,p.default)(l.default.mark(function e(){return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _(),e.next=3,m(!1);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),r(183)),E=r(310),v=r(409),I=window.Logger("logic")("login/sipLogin"),h=!1,m=t.sipserverLogin=function(){var e=(0,p.default)(l.default.mark(function e(){var t,r,n,o,a,i,u,d,f,p,_,g,E,h,m,L,C,T,S,N,R,O,y,A,b,P,x,k,M,U,D,G,F,B,W,H,V,K,Y,q,j,$,X,z,J,Q,Z,ee,te=arguments.length>0&&void 0!==arguments[0]&&arguments[0],re=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,w.getLoginModel)();return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=re.sipImpi,r=re.sipAccount,n=re.sipLoginOnly,o=re.serverAddress,a=re.serverPort,i=re.deployMode,u=re.tempsipserverAddress,d=re.tempsipserverPort,re.isInSipLogin=!0,f=coreSecurity.PasswordManager.getPassword("sipPassword"),n&&(o=u,a=d),(window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING)&&(window.isSupportiDo=!0),e.next=7,new coreTup.HWTupCall;case 7:if(p=e.sent,window.CLIENTCONFIG.ISMOBILE&&(window.sendToTupConfig(),I.info("[bfcp] sendToTupConfig success")),!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=28;break}I.info("[IT-Meeting] tup service multiuser model open"),e.next=15;break;case 15:return e.next=17,p.initForMultiuser();case 17:return e.next=19,p.setEnableMutiUsed(1);case 19:return _={account:{account_enable_sip:1}},e.next=22,p.config(_);case 22:return e.next=24,p.setAccountIdEnable(0);case 24:return e.next=26,p.registerProcessNotifyForAccount(0);case 26:return e.next=28,p.setTupCallLogParams(3,5e3,1,window.LOG_PATH);case 28:g=(0,v.configHMELog)(),I.info("sip server login configHmeInfo=",g),p.setHMELog(g),e.next=34;break;case 34:if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=100;break}return e.next=37,(0,v.configSip)(te);case 37:return E=e.sent,e.next=40,p.config(E);case 40:return e.next=43,coreSetting.initMediaDevice();case 43:return h=(0,v.configCall)(),e.next=46,p.config(h);case 46:return m=(0,v.configRejectCallType)(),e.next=49,p.config(m);case 49:return L=(0,v.serPointPickupCfg)(),I.info("pointPickup + "+(0,c.default)(L)),e.next=53,p.config(L);case 53:return C=(0,v.serGroupPickupCfg)(),I.info("groupPickup + "+(0,c.default)(C)),e.next=57,p.config(C);case 57:return T=(0,v.configMKI)(),e.next=60,p.config(T);case 60:return S=(0,v.configRTP)(),e.next=63,p.config(S);case 63:return e.next=65,(0,v.configVideo)();case 65:return N=e.sent,e.next=68,p.config(N);case 68:return e.next=70,(0,v.configBFCP)();case 70:return R=e.sent,e.next=73,p.config(R);case 73:return"android"===window.CLIENTCONFIG.PLATFORM&&(O=void 0!==window.isConfHardCode?parseInt(window.isConfHardCode,10):1,window.isHardDecodeToNative(O)),I.info("debug info config bfcp sip config"),y=parseInt(window.CLIENTCONFIG["Device.ComCfg.Media.BFCPMode"]),A=!1,y!==constant.BFCP_TRANS_TYPE.BFCP_TRANS_TLS&&y!==constant.BFCP_TRANS_TYPE.BFCP_TRANS_UDP||(A=!0),e.next=80,(0,v.configBFCPForTLS)({bForceTLSMode:A});case 80:return b=e.sent,e.next=83,p.configBFCPTLSParam(b);case 83:return P=(0,v.configSessionTimer)(),e.next=86,p.config(P);case 86:return x=(0,v.configBandwidthLimit)(),e.next=89,p.config(x);case 89:if(I.info("First issue CHR config to call"),te){e.next=95;break}return e.next=93,coreSetting.issuedChrConfigToCall();case 93:return e.next=95,coreSetting.issuedTerminalConfig();case 95:I.info("sip server login sipAccount=",handlePhoneNumber(r)),-1!==r.indexOf("sip:")&&(r=r.substring(4)),window.CLIENTCONFIG.ISMOBILE&&(I.info("set capRotateCtrlMode"),p.setCapRotateCtrlMode(1)),e.next=155;break;case 100:return k=[],e.next=103,(0,v.configSip)(te);case 103:return M=e.sent,k.push(p.config(M)),e.next=108,coreSetting.initMediaDevice();case 108:return U=(0,v.configVideo)(),D=(0,v.configBFCP)(),G=(0,v.configCall)(),k.push(p.config(G)),F=(0,v.configRejectCallType)(),k.push(p.config(F)),B=(0,v.serPointPickupCfg)(),I.info("pointPickup + "+(0,c.default)(B)),k.push(p.config(B)),W=(0,v.serGroupPickupCfg)(),I.info("groupPickup + "+(0,c.default)(W)),k.push(p.config(W)),H=(0,v.configMKI)(),k.push(p.config(H)),V=(0,v.configRTP)(),k.push(p.config(V)),e.next=126,U;case 126:return K=e.sent,k.push(p.config(K)),e.next=130,D;case 130:return Y=e.sent,k.push(p.config(Y)),"android"===window.CLIENTCONFIG.PLATFORM&&(q=void 0!==window.isConfHardCode?parseInt(window.isConfHardCode,10):1,window.isHardDecodeToNative(q)),I.info("debug info config bfcp sip config"),j=parseInt(window.CLIENTCONFIG["Device.ComCfg.Media.BFCPMode"]),$=!1,j!==constant.BFCP_TRANS_TYPE.BFCP_TRANS_TLS&&j!==constant.BFCP_TRANS_TYPE.BFCP_TRANS_UDP||($=!0),e.next=139,(0,v.configBFCPForTLS)({bForceTLSMode:$});case 139:return X=e.sent,e.next=142,p.configBFCPTLSParam(X);case 142:if(z=(0,v.configSessionTimer)(),k.push(p.config(z)),J=(0,v.configBandwidthLimit)(),k.push(p.config(J)),I.info("First issue CHR config to call"),te){e.next=150;break}return e.next=150,s.default.all([coreSetting.issuedChrConfigToCall(),coreSetting.issuedTerminalConfig()]);case 150:return I.info("sip server login sipAccount=",handlePhoneNumber(r)),-1!==r.indexOf("sip:")&&(r=r.substring(4)),window.CLIENTCONFIG.ISMOBILE&&(I.info("set capRotateCtrlMode"),p.setCapRotateCtrlMode(1)),e.next=155,s.default.all(k);case 155:return e.next=157,f;case 157:if(Q=e.sent,I.info("sip server login"),Z=void 0,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=169;break}return ee={sip_account_id:0,account:{account_auth_sip:{account:r,user_name:t,passwd:Q}}},e.next=164,p.config(ee);case 164:return e.next=166,p.registerForAccount(0);case 166:Z=e.sent,e.next=172;break;case 169:return e.next=171,p.register(t,r,Q);case 171:Z=e.sent;case 172:if(I.info("hwTupCall.register sip",Z),0!==Z.result){e.next=179;break}return I.info("sip register execute success."),$dispatch(coreUi.changeDoSipReg(!0)),e.abrupt("return",{result:!0});case 179:return window.CLIENTCONFIG.ISBIGWIN?(coreConf.NotifyLoginFailedEx(1),I.info("big win login failed")):window.isHubEnv&&(coreConf.NotifyLoginFailed(constant.WORKPLACE_LOGIN_ERROR_TYPE.ERR_OTHER),I.info("maxhub sipserverLogin login failed")),I.error("sip register execute fail."),e.abrupt("return",{result:!1});case 182:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,p.default)(l.default.mark(function e(t){return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("[sip register]"),window.dispatchEvent((0,a.default)(new Event("sipRegResultEvent"),{registerState:t.param.register_state,reasonCode:t.param.reason_code})),I.info("[sip register] is_deregister: "+t.param.is_deregister+"->0:login,1:logout; reason_code:"+t.param.reason_code),(0,w.getLoginModel)().sipRegisterState=t.param.register_state,constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED===t.param.register_state&&0===t.param.reason_code?(I.info("[sip register] ok"),I.info("<account_login><7_sip>end ok"),(0,w.getLoginModel)().setLoginStatus(!1,!0),coreConf.initTupPairClient(),(0,w.getLoginModel)().isInSipLogin=!1,C.resolve(),coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_SIP_SERVER,resultParams:[1],isTrackTimeCosts:!0})):constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERING===t.param.register_state?(I.info("[sip register] registering"),(0,w.getLoginModel)().sipRegisterState=constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERING):((0,w.getLoginModel)().setLoginStatus(!1,!0),constant.SIP_REGISTER_STATE.SIP_REGISTER_BUTT!==t.param.register_state&&window.CLIENTCONFIG.ENABLE_IT_MEETING&&0!==t.param.reason_code&&coreConf.sipRegisterFailed(t.param.reason_code),I.error("[sip register] sip register not ok，sip状态离线"),(0,w.getLoginModel)().sipRegisterState=constant.SIP_REGISTER_STATE.SIP_REGISTER_UNREGISTER,0===t.param.is_deregister&&(I.info("<account_login><7_sip>end failed"),coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_SIP_SERVER,resultParams:[0,t.param.reason_code],isTrackTimeCosts:!1}),h?((0,w.getLoginModel)().isInSipLogin=!1,C.resolve()):((0,w.getLoginModel)().isInSipLogin=!1,C.reject({errorType:constant.LOGIN_ERROR_TYPE.sip,errorCode:"register_fail"})))),coreCommon.dispatchModuleEvent("sipRegResultEvent",t);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),C=PromiseObject();t.sipLoginAtomic=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(I.debug("[sipLoginAtomic]  tatus:"+(0,w.getLoginModel)().sipRegisterState+" status: "+C.status),(0,w.getLoginModel)().sipRegisterState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED)I.debug("[sipLoginAtomic]  already registered ");else if((0,w.getLoginModel)().sipRegisterState===constant.SIP_REGISTER_STATE.SIP_REGISTER_UNREGISTER)try{return C=PromiseObject(),I.debug("[sipLoginAtomic] do sip login "),g(e),I.debug("[sipLoginAtomic] finish sip login "),C}catch(e){I.error("[sipLoginAtomic] exception: "+e.toString())}else I.debug("[sipLoginAtomic]  already registering ");return C}},796:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.storeAppCache=t.recoverAppCache=void 0;var o=r(126),a=n(o),i=r(1),s=n(i),u=r(2),c=n(u),d=r(793),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(d),f={myInfo:!0,menu:!0},p=(t.recoverAppCache=function(){var e=(0,c.default)(s.default.mark(function e(){var t,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.sysLogger.info("[ recoverAppCache ]"),e.next=3,l.get("reduxState");case 3:if(!(t=e.sent)){e.next=12;break}window.sysLogger.info("recoverAppCache 1");try{for(r in t)t.hasOwnProperty(r)&&f[r]&&($getState()[r]=t[r],"myInfo"===r&&(t[r].languageCode=window.langcode))}catch(e){window.sysLogger.info("recoverAppCache error")}return window.sysLogger.info("recoverAppCache 2"),window.sysLogger.info("[ recoverAppCache ] success"),e.abrupt("return",!0);case 12:return window.sysLogger.info("[ recoverAppCache ] no app cache"),e.abrupt("return",!1);case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.storeAppCache=function(){var e=(0,c.default)(s.default.mark(function e(){var t,r,n,o;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.sysLogger.info("[ storeAppCache ]"),t=$getState(),r={},n=p(t);for(o in n)n.hasOwnProperty(o)&&f[o]&&(r[o]=n[o]);return e.next=6,l.set("reduxState",r);case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(e){var t=(0,a.default)({},e);return t&&t.myInfo&&(t.myInfo.statusDesc=""),t&&t.setting&&(t.setting.shouldResetTray=!0),t&&t.menu&&(t.menu.rightMenuStyle.left="-9999px",t.menu.rightMenuStyle.top="-9999px"),t})},797:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.firstTimeLoginChangePassword=t.firstLoginChangePassword=t.checkIsFirstLogin=t.setFistLoginInfo=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=function(){var e=(0,s.default)(a.default.mark(function e(t){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreSecurity.PasswordManager.setPassword("password",t);case 2:r=(0,c.getLoginModel)(),r.password=t;case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),c=r(353),d=r(283),l=window.Logger("login")("firstLogin"),f={};t.setFistLoginInfo=function(e,t){f={is_first_login:e.uportal_authorize_result&&e.uportal_authorize_result.is_first_login,account:t,auth_token:e.uportal_authorize_result.auth_token}},t.checkIsFirstLogin=function(){return f.is_first_login},t.firstLoginChangePassword=function(){l.info("firstLoginChange[Password] enter."),window.CLIENTCONFIG.ISMOBILE?(window.goRoute("loginCtn"),navigator.splashscreen&&navigator.splashscreen.hide(),window.goRoute("/loginCtn/firstTimeChangePassword")):window.confirm(language.FIRST_LOGIN_CHANGE_PASSWORD,"SETTING_CHANGE_PASSWORD",!0).then(function(e){e.ret?coreSetting.showChangePassword(!0):coreDb.saveUserConfig({key:"isRemindNotNotify",value:"true"})})},t.firstTimeLoginChangePassword=function(){var e=(0,s.default)(a.default.mark(function e(t,r,n,o){var i,f,p,_,g,w;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.navigator.onLine){e.next=3;break}return alert(language.LOGIN_RESUME_NETWORK_ERROR),e.abrupt("return");case 3:return e.next=5,new coreTup.HWUportal;case 5:return i=e.sent,f=PromiseObject(),p=function(){var e=(0,s.default)(a.default.mark(function e(t){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.param,l.info("change [pass]word result: "+r.result),r&&0===r.result?window.CLIENTCONFIG.ISMOBILE?window.alert(""+language.CHANGE_PASSWORD_SUCCESS_FIRST).then(function(e){u(n).then(function(){return f.resolve(!0)})}):window.confirm(language.CHANGE_PASSWORD_SUCCESS_RELOGIN,!0).then(function(e){coreSetting.showChangePassword(!1),u(n).then(function(){e.ret?(l.info("[password] change success, reLogin"),f.resolve(!0)):(l.info("[password] change success, not login"),coreSecurity.PasswordManager.setPassword("password","").then(function(e){var t=(0,c.getLoginModel)(),r={isRememberPassword:!1,isAutoLogin:!1};(0,d.setLoginInfo)(r),t.password="",document.getElementById("password").value="",f.resolve(!1)}))})}):r.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_MOD_PWD_TOO_FREQUENTLY?(alert(language.MOD_PWD_TOO_FREQUENTLY),f.resolve(!1)):r&&r.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_INVAILD_NEW_PWD_LEVEL?(l.info("change ** result,** strength not match"),alert(language.NEW_PASSWORD_NOT_MATCH),f.resolve(!1)):r.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_NEW_PWD_CANNOT_SAME_WITH_HISTROY_PWD?(alert(language.NEW_PWD_SAME_WITH_HISTROY_PWD),f.resolve(!1)):r.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_INVAILD_NEW_PWD_LEN?(alert(language.NEW_PWD_SAME_WITH_HISTROY_PWD),f.resolve(!1)):r.result===constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_CHANGEPWD_LOW_PASSWORD_SECURITY?(window.ToastNew(language.CHANGE_PWD_LOW_SECURITY_TIP,2),f.resolve(!1)):(window.ToastNew(language.CHANGE_PASSWORD_FAILED,2),f.resolve(!1));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),i.setNotifyFunc(360449,p),_=(0,c.getLoginModel)(),g=_.serverUportalAddress,w=_.serverUportalPort,isNullOrEmpty(g)&&(g=o),i.changeLoginUportalPassword(t,r,n,g,w),e.abrupt("return",f);case 13:case"end":return e.stop()}},e,void 0)}));return function(t,r,n,o){return e.apply(this,arguments)}}()},798:function(e,t,r){"use strict";function n(){i.info("checkLoginInfo 登录前check");var e=a.getLoginModel(),t=/[`~!#$^&*()+=|\\\[\]\{\}:;'\,<>\/?]|[\u4E00-\u9FA5]|[\uFE30-\uFFA0]|[^\x00-\xff]/g,r=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]|[^\x00-\xff]/g;return!(t.test(e.displayAccount)||r.test(e.password))}Object.defineProperty(t,"__esModule",{value:!0}),t.checkLoginInfo=n;var o=r(183),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),i=window.Logger("logic")("login/loginPreCheck")},799:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(){D.info("userClick  doLogin  login btn");var e=(0,U.getLoginModel)(),t=e.loginDisable;if(t)return void D.info("doLogin loginDisable",t);var r=O.checkLoginInfo();if(document.activeElement.blur(),r)return A.login();language.ERROR_ACCOUNT_PWD;return window.isHubEnv?(0,U.getLoginModel)().maxhubLoginError={serverType:0,errorCode:constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_AUTH_NAME_OR_PWD_ERROR}:window.alert(language.ERROR_ACCOUNT_PWD),S.default.reject()}function i(){D.info("userClick  showSettingMenu  login setting");var e=window.remote.Menu,t=[{label:language.MOBILE_BASIC_SETTINGS,type:"normal",click:s},{label:language.COLLECT_LOG_FILES,type:"normal",click:u},{label:language.SOFT_COPYRIGHT_DESCRIPTION,type:"normal",click:c},{label:language.PRIVACY_TITLE,type:"normal",click:d}];window.CLIENTCONFIG.ISWIN&&t.push({label:language.NET_DETECT,type:"normal",click:N}),e.buildFromTemplate(t).popup(remote.getCurrentWindow())}function s(){D.info("goToLoginSetting"),window.goRoute("login/loginSetting")}function u(){D.info("collectLogsAndOpen"),coreLog.collectLogsAndOpen()}function c(){D.info("goToLoginCopyright"),window.goRoute("login/LoginCopyright")}function d(){D.info("goToLoginPrivacy"),window.goRoute("login/LoginPrivacy")}function l(){D.info("userClick click minimize btn"),appService.minimize()}function f(){D.info("userCLick  forgetPwd  login page forget xx");var e=(0,U.getLoginModel)(),t=e.serverAddress,r=e.serverPort,n=t+":"+r;k.cannotLogin(n)}function p(e,t){(0,U.getLoginModel)().loginDisable||k.changeLoginInfo((0,I.default)({},e,t))}function _(e,t){t.target&&p(e,t.target.value||"")}function g(e){G=e,document.addEventListener("keydown",E)}function w(){G=Noop,document.removeEventListener("keydown",E)}function E(e){var t=$getState(),r=t.common,n=r.isShowModal,o=r.isShowNotifyModal,i=t.setting.isShowChangePassword,s=t.dialogModal.isShowDialog;e.altKey&&115===e.keyCode&&((0,P.getCloseAppWays)(),reactStopPropagation(e),e.preventDefault()),o||n||s||13!==e.keyCode||"login"!==window.getRoute()||i||a()}Object.defineProperty(t,"__esModule",{value:!0}),t.noLoginJoinConference=void 0;var v=r(128),I=o(v),h=r(1),m=o(h),L=r(2),C=o(L),T=r(3),S=o(T),N=function(){var e=(0,C.default)(m.default.mark(function e(){var t;return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,M.initNetDetect)();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:window.goRoute("login/NetDetection");case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();t.noLoginJoinConference=function(){var e=(0,C.default)(m.default.mark(function e(){return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return D.info("userClick noLoginJoinConference  login page join conf"),e.next=3,(0,b.getNickName)();case 3:return e.next=5,coreConf.getConfInfoFromDb();case 5:return e.next=7,coreConf.changeConfInfoCardState(!1);case 7:window.goRoute("login/noLoginJoinConference");case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();t.doLogin=a,t.showSettingMenu=i,t.miniApp=l,t.forgetPwd=f,t.valueChange=p,t.inputValueChange=_,t.addKeyDownListener=g,t.removeKeyDownListener=w;var R=r(798),O=n(R),y=r(310),A=n(y),b=r(408),P=r(629),x=r(283),k=n(x),M=r(801),U=r(309),D=window.Logger("logic")("login/uiController"),G=Noop},800:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.judgeStatusDescIsRepeat=t.changeSignature=t.SaveSigInfoAndQuit=t.cutString=t.checkStatusOptions=t.sortStatusList=t.saveUserInfo=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=r(126),c=n(u),d=window.Logger("logic")("main/myInfo"),l=(t.saveUserInfo=function(e){d.info("saveUserInfo");var t=coreAccount.getMyInfo();if(e!==t.signature)return d.info("user changed the signature"),t=(0,c.default)({},t),t.signature=e,l(t)},function(){var e=(0,s.default)(a.default.mark(function e(t){var r,n,o,i,s;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=["account","staff_no","name","native_name","q_pin_yin","gender","birthday","age","bind_no","mobile","home_phone","office_phone","short_phone","other_phone","voip","ip_phone","fax","email","website","signature","desc","address","image_id","postcode","is_security","title","dept_id","dept_name_en","dept_name_cn","image_sync_time","old_account","state","modify_time","other_phone2","other_mobiles"],n={},r.forEach(function(e){n[e]=isNullOrEmpty(t[e])?"":t[e]}),o=coreAccount.getLoginModel(),i=o.isSupportAS,!i){e.next=10;break}return e.next=7,coreContact.uploadUserInfo({signature:t.signature});case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,coreIm.setUserInfo(n);case 12:e.t0=e.sent;case 13:s=e.t0,(s&&s.result===constant.ERROR_CODE.Success||i&&s)&&(coreAccount.getMyInfo().signature=t.signature,"Workplace"===window.CLIENTCONFIG.NEW_APP_NAME&&coreContact.setSign(t.signature));case 15:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}());t.sortStatusList=function(e){var t=[],r=[],n=[],o=[],a=1,i=1;return e.forEach(function(e){e&&e.status===constant.ONLINE_STATUS.LEAVE?(e.isCustom&&(e.testId="customAwayStatusText"+a,a++),t.push(e)):e&&e.status===constant.ONLINE_STATUS.BUSY?(e.isCustom&&(e.testId="customBusyStatusText"+i,i++),r.push(e)):e&&e.status===constant.ONLINE_STATUS.ONLINE?n.push(e):e&&e.status===constant.ONLINE_STATUS.OFFLINE&&o.push(e)}),n.concat(r,t,o)},t.checkStatusOptions=function(){var e=(0,s.default)(a.default.mark(function e(){var t,r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=coreAccount.getMyInfo().selectIndex,coreAccount.getMyInfo().selectIndex=t,e.next=4,coreDb.queryUserConfig({key:"CustomStatus"});case 4:r=e.sent,isNullOrEmpty(r)||(n=JSON.parse(r.value),coreAccount.getMyInfo().statusOptions=n,d.info("check Status Options from storage sucess!"));case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.cutString=function(e,t){var r=0,n=0,o=new String;n=e.length;for(var a=0;a<n;a++){var i=e.charAt(a);if(r++,escape(i).length>4&&(r+=2),o=o.concat(i),r>t)return o=o.substring(0,o.length-1);if(r===t)return o}if(r<t)return e},t.SaveSigInfoAndQuit=function(e){d.info("userClick  tap myInfo signature save btn");var t=coreAccount.getMyInfo();t=(0,c.default)({},t),t.signature=e,l(t),window.history.back()},t.changeSignature=function(e){var t=coreAccount.getMyInfo();if(e!==t.signature)return d.info("user changed the signature"),t=(0,c.default)({},t),t.signature=e,l(t)},t.judgeStatusDescIsRepeat=function(e,t){var r=/\s+/g;t=t.replace(r," ").trim();var n=coreAccount.getMyInfo().statusOptions,o=[language.BUSY],a=[language.AWAY];return n.map(function(e){e.status===constant.ONLINE_STATUS.BUSY?o.push(e.desc):e.status===constant.ONLINE_STATUS.LEAVE&&a.push(e.desc)}),e===constant.ONLINE_STATUS.BUSY?!o.includes(t):e!==constant.ONLINE_STATUS.LEAVE||!a.includes(t)}},801:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.handleClearData=t.startDetect=t.stopDetect=t.handleDetectDataNotify=t.initNetDetect=t.updataBtns=t.checkParam=t.NET_DETECT_MODE=t.BTN_STATUS=t.CHECK_PARAM_TYPE=void 0;var o=r(121),a=n(o),i=r(67),s=n(i),u=r(1),c=n(u),d=r(2),l=n(d),f=r(710),p=r(710),_=window.Logger("logic")("login/loginNetDetect"),g=t.CHECK_PARAM_TYPE={PACKET:0,IPADDR:1},w=t.BTN_STATUS={START:0,DETECTING:1,DONE:2},E=t.NET_DETECT_MODE={NORMAL_MODE:0,ADVANCED_MODE:1},v=(t.checkParam=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=$getState().common,r=t.ipValue,n=t.netdetectMode,o=t.packetLen,a=language.PROMPT_OPEN_NETDETECT,i="#999999",s=!0,u=!0,c=!0;o=parseInt(o)?o:0,n===E.ADVANCED_MODE&&(o<200||o>1200)&&(s=!1,c=!1,a=language.PROMPT_PACKET_LENGTH,i="red");var d=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){3}$/;if(d.test(r)||(d=/(\d*\.){3}.+/,u=!1,a=language.PROMPT_WRONG_IP,i="red",c=!1),!c&&-1!==e)switch(e){case g.PACKET:s||(a=language.PROMPT_PACKET_LENGTH,i="red");break;case g.IPADDR:u||(a=language.PROMPT_WRONG_IP,i="red")}return $dispatch(coreUi.setipDetectTipCont(a)),$dispatch(coreUi.setTipColor(i)),c},t.updataBtns=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.START,r=!1,n={cancel:{visible:!1,disabled:!1,class:"btn-cancel"},detect:{visible:!1,disabled:!1,class:"btn-detect"},retry:{visible:!1,disabled:!1,class:"btn-detect"},stop:{visible:!1,disabled:!1,class:"btn-stop"},done:{visible:!1,disabled:!1,class:"btn-detect"}};switch(t){case w.START:n.cancel.visible=!0,n.cancel.disabled=!1,n.detect.visible=!0,n.detect.disabled=!e,r=!0;break;case w.DETECTING:n.cancel.visible=!0,n.cancel.disabled=!0,n.stop.visible=!0,n.stop.disabled=!1,r=!0;break;case w.DONE:n.retry.visible=!0,n.retry.disabled=!1,n.done.visible=!0,n.done.disabled=!1,r=!0}r&&$dispatch(coreUi.setDetectBtns(n))}),I=(t.initNetDetect=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _.info("initNetDetect"),t={log_level:2,max_size_kb:10240,file_count:7,log_path:window.LOG_PATH},e.next=4,(0,f.startCmptLog)(t);case 4:return e.next=6,(0,f.detectInit)();case 6:if(r=e.sent,0===r.result){e.next=15;break}return _.info("initNetDetect detectInitRet ERR = "+r.result),e.next=11,(0,p.detectUnInit)();case 11:return e.next=13,(0,p.stopCmptLog)();case 13:return S(r.result),e.abrupt("return",!1);case 15:return e.next=17,(0,f.setCmptEvent)({OnDetectDataNotify:h});case 17:return n={server_port:8020},e.next=20,(0,f.detectStartServer)(n);case 20:if(o=e.sent,0===o.result){e.next=31;break}return _.info("initNetDetect detectStartServerRet ERR = "+o.result),e.next=25,(0,p.detectStopServer)();case 25:return e.next=27,(0,p.detectUnInit)();case 27:return e.next=29,(0,p.stopCmptLog)();case 29:return S(o.result,n.server_port),e.abrupt("return",!1);case 31:return e.abrupt("return",!0);case 32:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),-1),h=t.handleDetectDataNotify=function(e){_.info("handleDetectDataNotify data = "+(0,s.default)(e));var t=e.param,r=t.avg_delay_time,n=t.avg_jitter_time,o=t.avg_recv_loss_rate,a=t.avg_send_loss_rate,i=t.current_level,u=t.max_delay_time,c=t.max_jitter_time,d=t.max_recv_cont_loss_pkts,l=t.max_recv_loss_rate,f=t.max_send_cont_loss_pkts,p=t.max_send_loss_rate,g=(t.total_level,t.total_recv_pkt_loss_seconds),h=t.total_send_pkt_loss_seconds,C=$getState().common,T=C.curResLevel,S=C.ipDetectResList,N=C.netdetectMode,R=C.bandwidth,O=C.maxDelay,y=C.maxLoss,A=C.maxContinuousLoss,b=C.maxJitter,P=[].concat(S),x=N===E.ADVANCED_MODE;if(x){u&&u>O&&(O=u,$dispatch(coreUi.setMaxDelay(O))),c&&c>b&&(b=c,$dispatch(coreUi.setMaxJitter(b)));var k=Math.max(f,d);k&&k>A&&(A=k,$dispatch(coreUi.setMaxContinuousLoss(A)));var M=Math.max(l,p);M&&M>y&&(y=M,$dispatch(coreUi.setMaxLoss(y)))}var U="  "+language.CALL_MEDIA_INFO_LOST+"(%):"+language.NET_DETECT_INFO_AVG+Math.max(o,a)+", "+language.NET_DETECT_INFO_MAX+Math.max(l,p)+" "+(x?"("+y+")":"")+"\n  "+language.LANG_QOS_JIITER+"  (ms):"+language.NET_DETECT_INFO_AVG+n+", "+language.NET_DETECT_INFO_MAX+c+" "+(x?"("+b+")":"")+"\n  "+language.LANG_QOS_FRAME_RATE+"  (ms):"+language.NET_DETECT_INFO_AVG+r+", "+language.NET_DETECT_INFO_MAX+u+" "+(x?"("+O+")":"")+"\n  "+language.NET_DETECT_INFO_MAX_CONTINUOUS_LOSS+": "+Math.max(d,f)+" "+(x?"("+A+")":"")+"\n  "+language.NET_DETECT_INFO_TOTAL_LOSS_CNT+": "+Math.max(g,h);if(N===E.ADVANCED_MODE)clearTimeout(I),P[0].col=1,P[0].level=R,P[0].cont=U,$dispatch(coreUi.setIpDetectResList(P)),L=100,$dispatch(coreUi.setipDetectTipCont(language.PROMPT_CONTINUOUS_DETECTION+"("+L+"%)")),I=setTimeout(function(){_.info("timeoutTimer curResLevel = "+T),m(!0)},15e3);else if(++T===i){clearTimeout(I),$dispatch(coreUi.setCurResLevel(i));for(var D=0;D<P.length;D++)if(P[D].level===i){if(P[D].cont===language.NET_DETECT_INFO_NOT_DETECT)return void _.info("停止检测后收到数据");5!==i&&(P[D+1].cont=language.NET_DETECT_INFO_DETECTING+"...",P[D+1].col=1),P[D].cont=U,P[D].col=1;break}$dispatch(coreUi.setIpDetectResList(P)),5===i?(v(!0,w.DONE),$dispatch(coreUi.setDisableIPInput(!1)),$dispatch(coreUi.setipDetectTipCont(language.PROMPT_OPEN_NETDETECT))):I=setTimeout(function(){_.info("timeoutTimer curResLevel = "+T),m(!0)},15e3)}},m=t.stopDetect=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,o,a,i,s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_.info("stopDetect detectStopClient"),t=$getState().common,r=t.curResLevel,n=t.ipDetectResList,o=t.netdetectMode,a=[].concat(n),clearTimeout(I),clearInterval(C),o!==E.ADVANCED_MODE){e.next=11;break}return e.next=8,(0,p.detectStopClientContinue)();case 8:a[0].level!==r&&(a[0].cont=language.NET_DETECT_INFO_NOT_DETECT,a[0].col=0),e.next=15;break;case 11:if(o!==E.NORMAL_MODE){e.next=15;break}return e.next=14,(0,p.detectStopClient)();case 14:for(i=0;i<a.length;i++)s&&i===r?(a[i].cont=language.NET_DETECT_INFO_TIME_OUT,a[i].col=2):i>=r&&(a[i].cont=language.NET_DETECT_INFO_NOT_DETECT,a[i].col=0);case 15:$dispatch(coreUi.setIpDetectResList(a)),v(!0,w.START),$dispatch(coreUi.setipDetectTipCont(language.PROMPT_OPEN_NETDETECT)),$dispatch(coreUi.setDisableIPInput(!1));case 19:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),L=0,C=-1,T=(t.startDetect=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,o,i,u,d,l;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().common,r=t.ipValue,n=t.packetLen,o=t.bandwidth,i=t.netdetectMode,u={str_server_ip:r,server_port:8020,client_port:8021},i===E.ADVANCED_MODE&&(u=(0,a.default)(u,{pkt_len:parseInt(n),level:parseInt(o)})),_.info("startDetect param = "+(0,s.default)(u)),d=-1,i!==E.ADVANCED_MODE){e.next=11;break}return e.next=8,(0,p.detectStartClientContinue)(u);case 8:d=e.sent,e.next=15;break;case 11:if(i!==E.NORMAL_MODE){e.next=15;break}return e.next=14,(0,p.detectStartClient)(u);case 14:d=e.sent;case 15:if(0===d.result){e.next=22;break}return _.info("startDetect detectStartClientRet ERR = "+d.result),e.next=19,(0,p.detectStopClient)();case 19:return l=u.client_port,S(d.result,l+"|"+(l+1)+"|"+(l+2)),e.abrupt("return",!1);case 22:clearTimeout(I),I=setTimeout(function(){var e=$getState().common.curResLevel;_.info("timeoutTimer curResLevel = "+e),0===e&&m(!0)},15e3),i===E.ADVANCED_MODE?($dispatch(coreUi.setMaxDelay(0)),$dispatch(coreUi.setMaxJitter(0)),$dispatch(coreUi.setMaxLoss(0)),$dispatch(coreUi.setMaxContinuousLoss(0)),L=0,$dispatch(coreUi.setipDetectTipCont(language.PROMPT_CONTINUOUS_DETECTION+"("+L+"%)")),C=setInterval(function(){L<99?$dispatch(coreUi.setipDetectTipCont(language.PROMPT_CONTINUOUS_DETECTION+"("+ ++L+"%)")):L>=100&&(L=0,$dispatch(coreUi.setipDetectTipCont(language.PROMPT_CONTINUOUS_DETECTION+"("+ ++L+"%)")))},100)):i===E.NORMAL_MODE&&$dispatch(coreUi.setipDetectTipCont("")),v(!0,w.DETECTING),$dispatch(coreUi.setCurResLevel(0)),$dispatch(coreUi.setIpDetectResList(T())),$dispatch(coreUi.setDisableIPInput(!0)),$dispatch(coreUi.setMaxDelay(0)),$dispatch(coreUi.setMaxLoss(0));case 31:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(){var e=$getState().common,t=e.netdetectMode,r=e.bandwidth;if(t===E.ADVANCED_MODE){var n=1===r?"0.5M:":2===r?"1M:":3===r?"1.5M:":4===r?"2M:":5===r?"4M:":"8M:",o=r+1;return $dispatch(coreUi.setCurResLevel(r)),[{title:n,cont:"",col:1,level:o}]}for(var a=[],i=1;i<6;i++){var s="",u=language.NET_DETECT_INFO_PENDING_DETECT,c=i,d=0;5!==i?1===i?(s="512 Kbit/s:",u=language.NET_DETECT_INFO_DETECTING+"...",d=1):s=512*i+" Kbit/s:":s="4096 Kbit/s:",a.push({title:s,cont:u,col:d,level:c})}return a}),S=(t.handleClearData=function(){var e=(0,l.default)(c.default.mark(function e(){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.detectStopClient)();case 2:return e.next=4,(0,p.detectStopServer)();case 4:return e.next=6,(0,p.detectUnInit)();case 6:return e.next=8,(0,p.stopCmptLog)();case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r="";switch(e){case constant.EN_CMPT_DETECT_ERROR.EN_CMPT_DETECT_UNINIT_ERROR:r=language.DETECT_UNINIT_ERROR_INFO;break;case constant.EN_CMPT_DETECT_ERROR.EN_CMPT_DETECT_THREAD_ERROR:r=language.DETECT_THREAD_ERROR_INFO;break;case constant.EN_CMPT_DETECT_ERROR.EN_CMPT_DETECT_STARTED_ERROR:r=language.DETECT_STARTED_ERROR_INFO;break;case constant.EN_CMPT_DETECT_ERROR.EN_CMPT_DETECT_SOCKET_ERROR:r=language.DETECT_SOCKET_ERROR_INFO;break;case constant.EN_CMPT_DETECT_ERROR.EN_CMPT_DETECT_SOCKET_CONN_ERROR:r=language.DETECT_SOCKET_CONN_ERROR_INFO;break;case constant.EN_CMPT_DETECT_ERROR.EN_CMPT_DETECT_SOCKET_BIND_ERROR:r=language.DETECT_SOCKET_BIND_ERROR_INFO+t;break;default:r=language.DETECT_THREAD_ERROR_DEFOULT}window.alert(r)})},802:function(e,t,r){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getUportalApi=void 0;var o=r(143),a=n(o),i=r(117),s=n(i),u=r(118),c=n(u),d=r(119),l=n(d),f=r(67),p=n(f),_=r(1),g=n(_),w=r(2),E=n(w),v=r(4),I=n(v),h=r(1765),m=n(h),L=r(183),C=r(309),T=r(803),S=r(628),N=r(797),R=r(352),O=r(995),y=window.Logger("logic")("login/uportal"),A=function e(){var t=this;(0,I.default)(this,e),this.loadLastUportalInfoFromDB=(0,E.default)(g.default.mark(function e(){var r,n;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryLoginSetting({key:"LastUportalLoginIP"});case 2:r=e.sent,n=r&&r.value&&JSON.parse(r.value)||{},t.value=n.value||"",t.serverKey=n.serverKey||"";case 6:case"end":return e.stop()}},e,t)})),this.loadLastUportalInfo=function(){var e=(0,E.default)(g.default.mark(function e(r){return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isFirstLoad){e.next=4;break}return t.isFirstLoad=!1,e.next=4,t.loadLastUportalInfoFromDB();case 4:t.serverKey!==r&&(t.value=""),t.serverKey=r;case 6:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}(),this.saveLastUportalInfo=function(){var e=(0,E.default)(g.default.mark(function e(r,n){var o;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.serverKey!==r||t.realIP!==n){e.next=2;break}return e.abrupt("return",!0);case 2:return t.serverKey=r,t.value=n,o={serverKey:t.serverKey,value:t.value},e.abrupt("return",coreDb.saveLoginSetting({key:"LastUportalLoginIP",value:(0,p.default)(o)}));case 6:case"end":return e.stop()}},e,t)}));return function(t,r){return e.apply(this,arguments)}}(),this.value="",this.serverKey="",this.isFirstLoad=!0};window.isRepeateCall=!1;var b=function(t){function r(){var t=this;(0,I.default)(this,r);var n=(0,c.default)(this,(r.__proto__||(0,s.default)(r)).call(this));return n.getUportalLoginInfo=function(e,t,r,n){var o=(0,L.getLoginModel)(),a=o.isOAuth,i=o.account,s=o.user_ticket,u="";e.indexOf("@")<0?(u="mobile",y.info("lgn acc is ",handlePhoneNumber(e))):e.length>4&&y.info("lgn acc is",e.length>4?e.substr(0,3)+"******"+e.substr(-4):"****"),y.info("login user_name_type =",u);var c="",d="";return o.isOAuth&&(s.length>40?c=s:d=s),{auth_type:a?constant.AUTH_TYPE.TICKET_WITH_USERNAME:constant.AUTH_TYPE.NORMAL,user_agent:window.CLIENTCONFIG.ISMOBILE?constant.USER_AGENT.MOBILE:"Workplace"===window.CLIENTCONFIG.NEW_APP_NAME?constant.USER_AGENT.WORKPLACEPC:constant.USER_AGENT.PC,user_tiket:c,short_ticket:d,user_name_type:u,src_of_psw:1,auth_info:{user_name:a?i:e,password:t},auth_server:{server_type:0,server_url:r,server_port:parseInt(n),server_version:"V6R6C00",proxy_url:""}}},n.uportalLogin=function(){var e=(0,E.default)(g.default.mark(function e(r){var o,a,i,s,u,c,d,l,f,p,_=r.loginAccount,w=r.password,E=r.serverAddress,v=r.serverPort;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,L.getLoginModel)(),o.set({isInUportalLogin:!0,uportalLoginState:constant.UPORTAL_LOGIN_STATE.UPORTAL_LOGIN_LOGINING}),e.next=4,new coreTup.HWUportal;case 4:if(a=e.sent,a.setNotifyFunc(360459,n.refreshTokenCallback),i=o.isSupportCACertCheck,s=window.EXEC_PATH,i?window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?a.loginSetTlsParamsEx(s,1):a.loginSetTlsParams(s,1):window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?a.loginSetTlsParamsEx(s,0):a.loginSetTlsParams(s,0),window.CLIENTCONFIG.ISBIGWIN){e.next=12;break}return e.next=12,n.setLoginProxy(a);case 12:if(u=void 0,coreUt.utEventStart({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_UPORTAL_SERVER,params:[constant.UT_LOGIN_SERVER_NAME.UT_UPORTAL_SERVER]}),c=n.getUportalLoginInfo(_,w,E,v),!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=23;break}return e.next=18,a.loginAuthorizeEx(c);case 18:d=e.sent,l=d.param,u=l,e.next=28;break;case 23:return e.next=25,a.loginAuthorize(c);case 25:f=e.sent,p=f.param,u=p;case 28:return(0,N.setFistLoginInfo)(u,_),e.abrupt("return",u);case 30:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}(),n.updateSiteInfo=function(){var e=(0,E.default)(g.default.mark(function e(r){var n,o,i,s,u,c,d,l,f,p,_,w,E,v,I,h,m,C,T,S,N,R,A,b,P,x,k,M,U,D,G,F,B,W,H,V,K,Y,q,j,$,X,z,J,Q,Z,ee,te,re,ne,oe,ae,ie,se,ue,ce,de,le,fe,pe,_e,ge,we,Ee,ve,Ie,he,me,Le,Ce,Te,Se,Ne,Re,Oe,ye,Ae,be,Pe,xe,ke,Me,Ue,De,Ge,Fe,Be,We,He,Ve,Ke,Ye,qe,je,$e,Xe,ze,Je,Qe,Ze,et,tt,rt,nt,ot,at,it,st,ut,ct,dt,lt;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=r.uportal_authorize_result.terminal_func_type,o=!0,i=r.uportal_authorize_result.terminal_scene,s=!!i&&"room"===i,(window.CLIENTCONFIG.ENABLE_IT_MEETING||s)&&(n=5),u="",-1!==n?((0,L.getLoginModel)().funcType=n,1===n?(u="soft mode",window.CLIENTCONFIG.USE_MEETING=!1,window.CLIENTCONFIG.USE_IM=!1,window.CLIENTCONFIG.USE_CALL=!0,window.CLIENTCONFIG.DEFAULT_MENU="contactGroups",window._currentRoute="/main/contactGroups",$dispatch(coreUi.navSwitch(window.CLIENTCONFIG.DEFAULT_MENU)),window.CLIENTCONFIG.MOBILE_MENU_LIST=["contactGroups","myInfo"]):5===n?(u="te mode",window.CLIENTCONFIG.USE_MEETING=!0,window.CLIENTCONFIG.USE_IM=!1,window.CLIENTCONFIG.USE_CALL=!0,window.CLIENTCONFIG.DEFAULT_MENU="conference",window._currentRoute="/main/conference",$dispatch(coreUi.navSwitch(window.CLIENTCONFIG.DEFAULT_MENU)),window.CLIENTCONFIG.MOBILE_MENU_LIST=["conference","contactGroups","myInfo"]):7===n&&(u="uc mode",window.CLIENTCONFIG.USE_MEETING=!0,window.CLIENTCONFIG.USE_IM=!0,window.CLIENTCONFIG.USE_CALL=!0,"Workplace"===window.CLIENTCONFIG.NEW_APP_NAME?(window.CLIENTCONFIG.DEFAULT_MENU="recent",window._currentRoute="/main/recent"):(window.CLIENTCONFIG.DEFAULT_MENU="conference",window._currentRoute="/main/conference"),c=$getState().menu.currentNav,window.CLIENTCONFIG.DEFAULT_MENU!==c&&"nav"!==c&&c?coreCommon.switchNav(c):$dispatch(coreUi.navSwitch(window.CLIENTCONFIG.DEFAULT_MENU)),window.CLIENTCONFIG.MOBILE_MENU_LIST=["recent","conference","contactGroups","myInfo"]),(0,O.setAppConfigList)(),y.info("functype == "+n+" "+u)):(window.CLIENTCONFIG.USE_MEETING=!0,window.CLIENTCONFIG.USE_IM=!0,window.CLIENTCONFIG.USE_CALL=!0,"Workplace"===window.CLIENTCONFIG.NEW_APP_NAME?(window.CLIENTCONFIG.DEFAULT_MENU="recent",window._currentRoute="/main/recent"):(window.CLIENTCONFIG.DEFAULT_MENU="conference",window._currentRoute="/main/conference"),d=$getState().menu.currentNav,window.CLIENTCONFIG.DEFAULT_MENU!==d&&"nav"!==d?coreCommon.switchNav(d):$dispatch(coreUi.navSwitch(window.CLIENTCONFIG.DEFAULT_MENU)),window.CLIENTCONFIG.MOBILE_MENU_LIST=["conference","recent","contactGroups","myInfo"],y.info("functype == -1")),l=r.uportal_authorize_result.all_sip_server.server_info,f=l.length<window.CLIENTCONFIG.CALL_D_MAX_IP_WHITE_LIST_COUNT?l.length:window.CLIENTCONFIG.CALL_D_MAX_IP_WHITE_LIST_COUNT,p=new Array,_=0;_<f;_++)w={server_address:l[_].server_uri,server_port:l[_].server_port},p.push(w);if($dispatch(coreUi.updateMenuInfo({menuList:window.CLIENTCONFIG.MOBILE_MENU_LIST})),!(E=r.uportal_authorize_result.site_info)||!E[0]){e.next=122;break}v=E[0],I=v.num_of_server,h=v.access_server,m=v.tms_account,C="",T="",S="",N="",R="",A="",b="",P="",x="",k="",M="",U="",D="",G="",F="",B="",W="",H="",V="",K="",Y=h[0].conf_uri,q=h[0].conf_type,q&&"CMS"===q&&!isNullOrEmpty(Y)?(y.info("new conf AS is supported"),(0,L.getLoginModel)().isSupportAS=!0,$dispatch(coreUi.changeAsAddress(Y))):(y.info("new conf AS is not supported"),(0,L.getLoginModel)().isSupportAS=!1),j=h[0].http_proxy_uri,isNullOrEmpty(j)||((0,L.getLoginModel)().ctdServerUri=j,(0,L.getLoginModel)().confctrlUri=j,y.info("http_proxy_uri:"+j)),$=h[0].onebox_address_uri,X="CloudEC","Workplace"===window.CLIENTCONFIG.NEW_APP_NAME&&(X="espace"),z=r.uportal_authorize_result.corp_id||"",$&&coreIm.setOfflineFileConfig(!0,{onebox_app_id:X,onebox_server_addr:$,corp_id:z}),"supportRest"===m&&(o=!1),window.CLIENTCONFIG.ISBIGWIN&&(o=!0),J=0,Q=0;case 33:if(!(Q<I)){e.next=57;break}if(h&&h[Q]){e.next=36;break}return e.abrupt("continue",54);case 36:C+=h[Q].sip_uri,T+=h[Q].sip_tls_uri,S+=h[Q].svn_uri,x+=h[Q].stg_info.stg_uri,U+=h[Q].stg_info.sip_stg_uri,D+=h[Q].stg_info.eserver_stg_uri,G+=h[Q].stg_info.eserver_stg_uri_backup,F+=h[Q].maa_proxy_uri,B+=h[Q].maa_drproxy_uri,A+=h[Q].eserver_uri,b+=h[Q].eserver_uri_backup,N+=h[Q].httpsproxy_uri,k=h[0].stg_info.account,M=h[0].stg_info.password,H||(window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?(h[Q].tms_uri&&(H=h[Q].tms_uri),h[Q].tms_server&&(H=h[Q].tms_server)):H=h[Q].tms_server),V||(V=h[Q].ms_param_uri),K||(K=h[Q].eua_server),Q<I-1&&(C+=";",T+=";",S+=";",x+=";",U+=";",D+=";",G+=";",F+=";",A+=";",b+=";",N+=";");case 54:Q++,e.next=33;break;case 57:if(J=I,D+=";",D+=G,A+=";",A+=b,F+=";",F+=B,window.isSupportiDo=o,y.info("uportal isSupportiDo: "+window.isSupportiDo),Z=r.uportal_authorize_result,ee=Z.auth_token,te=Z.sip_account,re=Z.sip_impi,ne=Z.sip_password,oe=Z.password_type,ae=Z.eab_server,ie=Z.group_server,se=Z.deploy_mode,ue=Z.sip_domain,ce=Z.auth_serinfo,de=Z.is_free_user,le=Z.privacy_version,fe=r.uportal_authorize_result,pe=fe.extra_parameters,_e=fe.all_extra_parameter,isNullOrEmpty(pe)&&!isNullOrEmpty(_e)){ge={};for(we in _e)ge[_e[we].parameter_name]=_e[we].parameter_value;pe=ge}isNullOrEmpty(pe)||K||(K=pe.eua_server),Ee=se,ve="",Ie="",he="",me="",pe&&(pe.ItPasswordModifyUrl&&(ve=pe.ItPasswordModifyUrl),pe.ItLoginAutoReg&&(Ie=pe.ItLoginAutoReg),pe.ItSignedUrl&&(he=pe.ItSignedUrl),pe.ItLoginAutoReg&&(me=pe.ItUploadHeadImgUrl)),Ee=0===se?constant.MEETING_NET_TYPE.USM_MEETING:1===se?constant.MEETING_NET_TYPE.SMC_MEETING:constant.MEETING_NET_TYPE.MEDIAX_MEETING,y.info("uportal get deploy_mode is "+se+",envtype is "+Ee),Le=A.split(";"),Ce=N.split(";"),Te=F.split(";"),y.info("updateSiteInfo eserverUriList.length: "+Le.length+", httpsProxyList.length: "+Ce.length+", maaProxyUrlList.length: "+Te.length),Le.length>0&&(P=Le[0]),Ce.length>0&&(R=Ce[0]),Te.length>0&&(W=Te[0]),Se=0,Ne=P.split(":"),Re=(0,a.default)(Ne,2),Oe=Re[0],ye=Re[1],Ae=W.split(":"),be=(0,a.default)(Ae,2),Pe=be[0],xe=be[1],ke=C.split(";"),Me=ke[0]?ke[0].split(":"):["",0],Ue=(0,a.default)(Me,2),De=Ue[0],Ge=Ue[1],Fe=ke[1]?ke[1].split(":"):["",0],Be=(0,a.default)(Fe,2),We=Be[0],He=Be[1],Ve=ke[2]?ke[2].split(":"):["",0],Ke=(0,a.default)(Ve,2),Ye=Ke[0],qe=Ke[1],je=T.split(";"),$e=je[0]?je[0].split(":"):["",0],Xe=(0,a.default)($e,2),ze=Xe[0],Je=Xe[1],Qe=je[1]?je[1].split(":"):["",0],Ze=(0,a.default)(Qe,2),et=Ze[0],tt=Ze[1],rt=je[2]?je[2].split(":"):["",0],nt=(0,a.default)(rt,2),ot=nt[0],at=nt[1],it="",e.t0=g.default.keys(E[0].access_server);case 98:if((e.t1=e.t0()).done){e.next=106;break}if(st=e.t1.value,isNullOrEmpty(E[0].access_server[st].push_gateway)){e.next=104;break}return y.info("push_gateway:",E[0].access_server[st].push_gateway),it=E[0].access_server[st].push_gateway,e.abrupt("break",106);case 104:e.next=98;break;case 106:if(ut={authToken:ee,sipAccount:te,sipImpi:re,sipPasswordType:oe,eabUri:ae,groupServer:ie,mainSiteSum:J,currentNum:Se,eServerAddressAll:A,eServerAddress:Oe,eServerPort:parseInt(ye),sipServerAddress:De,sipServerPort:parseInt(Ge),sipTlsServerAddress:ze,sipTlsPort:parseInt(Je),sipTlsServerBackup1:et,sipTlsPortBackup1:parseInt(tt),sipTlsServerLocal:ot,sipTlsPortLocal:parseInt(at),sipDomain:ue,sipServerBackup1:We,sipServerPortBackup1:parseInt(He),sipServerLocal:Ye,sipServerPortLocal:parseInt(qe),isFreeUser:de,sipUri:C,svnUri:S,httpsProxyAll:N,httpsProxy:R,stgUri:x,stgAccount:k,sipStgUri:U,eserverStgUri:D,deployMode:Ee,funcType:n,tmsServer:H,changeItPasswordUrl:ve,itOAuthUrl:Ie,itSignedUrl:he,itUploadHeadImgUrl:me,sipWhiteList:p,serverUportalAddress:ce.server_uri,serverUportalPort:ce.server_port,sipLoginissiptls:E[0].access_server[0].is_siptls,sipLoginissrtp:E[0].access_server[0].is_srtp,pushgwUri:it,smcUri:V,isIwb:s,privacy_version:le,euaServer:K,maaProxyUrlAll:F,maaProxyAddress:Pe,maaProxyPort:xe,real_user_account:r.uportal_authorize_result.real_user_account},window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&re.indexOf("@")&&(ct=re.split("@")[0],window.sendSipNoToProto(ct)),ut.show_account=(0,L.getLoginModel)().account,(window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||coreAccount.getLoginModel().isSupportAS)&&(dt=r.uportal_authorize_result.real_user_account,ut.show_account=(0,L.getLoginModel)().account,ut.account=dt),coreUt.utConfigAccountInfo({configAccount:ut.show_account}),e.t2=M,!e.t2){e.next=115;break}return e.next=115,coreSecurity.PasswordManager.setPassword("stgPassword",M);case 115:if(e.t3=ne,!e.t3){e.next=119;break}return e.next=119,coreSecurity.PasswordManager.setPassword("sipPassword",ne);case 119:return lt=(0,L.getLoginModel)(),lt.set(ut),e.abrupt("return",ut);case 122:return e.abrupt("return",{});case 123:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}(),n.uportalAllonline=(0,E.default)(g.default.mark(function e(){var r,o,a,i,s;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=window.getUportalRes(),o=r.param,a=(0,L.getLoginModel)(),i=a.loginAccount,a.set({uportalLoginState:constant.UPORTAL_LOGIN_STATE.UPORTAL_LOGIN_SUCCESS,account:o.uportal_authorize_result.user_name||i}),e.next=7,n.updateSiteInfo(o);case 7:return s=e.sent,e.abrupt("return",{result:!0,loginInfo:s});case 9:case"end":return e.stop()}},e,t)})),n.setLoginProxy=function(){var e=(0,E.default)(g.default.mark(function e(r){var n,o,a,i,s,u,c;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,L.getLoginModel)(),o=n.isSupportProxy,a=n.proxyAddress,i=n.proxyPort,s=n.proxyAccount,e.next=3,coreSecurity.PasswordManager.getPassword("proxyPassword");case 3:if(u=e.sent,o||(a="",i="0",s="",u=""),c={server_port:parseInt(i),server_uri:a,user_name:s,password:u},y.info("setLoginProxy proxyAddress: "+a),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=12;break}return e.next=10,r.setLoginProxy(c);case 10:e.next=14;break;case 12:return e.next=14,r.setLoginProxyEx(c);case 14:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}(),n.refreshTokenCallback=function(){var r=(0,E.default)(g.default.mark(function r(n){var o,a,i,s,u,c,d;return g.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=(0,L.getLoginModel)(),!((a=n.param)&&0===a.result&&a.refresh_token_result&&a.refresh_token_result.auth_token)){t.next=29;break}if(y.info("refreshTokenSuccess"),$dispatch(coreUi.changeuportalTokenErr(!1)),coreCommon.dispatchModuleEvent("login",{event:"tokenUpdate",code:0,data:a.refresh_token_result.auth_token}),o.set({authToken:a.refresh_token_result.auth_token}),y.info("[check upgrade] for refresh [token]"),coreAccount.checkUpgrade({isFirstIn:!1,token:a.refresh_token_result.auth_token}),"Workplace"===window.CLIENTCONFIG.NEW_APP_NAME){t.next=15;break}return t.next=12,new coreTup.HWTupOfflineFile;case 12:i=t.sent,s=new e(a.refresh_token_result.auth_token,"base64").toString(),i.refreshToken(s);case 15:if(y.info("refreshToken update stg info"),u=a.refresh_token_result.stg_account,c=a.refresh_token_result.stg_pwd,!u||!c){t.next=25;break}if(o.set({stgAccount:u}),t.t0=c,!t.t0){t.next=24;break}return t.next=24,coreSecurity.PasswordManager.setPassword("stgPassword",c);case 24:(0,S.updateStgAuthInfo)({account:u,password:c});case 25:o.isHWUC||coreContact.refreshTocken(),coreCwmp.cwmpConfigToken().then(function(){y.info("refresh cwmp [token] sucess")},function(){y.info("refresh cwmp [token] failed")}),t.next=35;break;case 29:if(y.info("refresh failed "+a.result+" isRepeateCall"+window.isRepeateCall),!window.CLIENTCONFIG.ENABLE_IT_MEETING){t.next=33;break}return y.info("it welink refresh [token] no use here"),t.abrupt("return");case 33:d=9===a.result&&!0||!1,coreConf.UportalTokenErr(d);case 35:case"end":return t.stop()}},r,t)}));return function(e){return r.apply(this,arguments)}}(),n.loginToUportal=(0,E.default)(g.default.mark(function e(){var r,o,a,i,s,u,c,d,l,f,p,_,w,E,v,I,h,m;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,L.getLoginModel)(),o=r.account,a=r.displayAccount,i=r.serverAddress,s=r.serverPort,u=r.isResume,c=r.tenantid,d=r.loginRecordList,y.info("<account_login><3_uportal>begin"),e.next=5,coreSecurity.PasswordManager.getPassword("password");case 5:if(l=e.sent,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=11;break}a=window.getLinkSmcUportalAccount?window.getLinkSmcUportalAccount:window.linkSmcW3Acc,l=window.getLinkSmcUportalPassword?window.getLinkSmcUportalPassword:window.linkSmcW3Pas,e.next=14;break;case 11:if(window.CLIENTCONFIG.ISBIGWIN){e.next=14;break}return e.next=14,n.IP.loadLastUportalInfo(i);case 14:if("Workplace"!==window.CLIENTCONFIG.NEW_APP_NAME){e.next=53;break}f=void 0,p=0;case 17:if(!(p<d.length)){e.next=24;break}if(c!==d[p].tenantid){e.next=21;break}return f=d[p],e.abrupt("break",24);case 21:p++,e.next=17;break;case 24:if(!f){e.next=53;break}return _=f.thirdcertype?f.tenantid:"",y.info("sso login,tenantcn:"+handlePhoneNumber(f.tenantcn)+",thirdcertype:"+f.thirdcertype),e.next=29,coreAccount.ssoLogin({loginName:a,password:l,tenantid:_});case 29:if(w=e.sent,r.crypt_token=w&&w.recv_body.crypt_token,!w.result||!w.recv_body.crypt_token){e.next=41;break}if(r.user_ticket=w.recv_body.crypt_token,isNullOrEmpty(w.recv_body.meetingurl)){e.next=38;break}return e.next=36,coreAccount.getUrlHost(w.recv_body.meetingurl);case 36:i=e.sent,r.serverAddress=i;case 38:r.isOAuth=!0,e.next=53;break;case 41:E=constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_REQUEST_FAILED,e.t0=parseInt(w.code),e.next=1103===e.t0?45:1146===e.t0?47:49;break;case 45:return E=constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_AUTH_NAME_OR_PWD_ERROR,e.abrupt("break",51);case 47:return E=constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_ACCOUNT_LOCKED,e.abrupt("break",51);case 49:return E=constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_REQUEST_FAILED,e.abrupt("break",51);case 51:return y.info("<account_login><3_uportal>end ok/failed"),e.abrupt("return",(0,C.LoginError)({result:!1,errorCode:E,errorType:constant.LOGIN_ERROR_TYPE.uportal,isResume:u}));case 53:y.info("[ loginToUportal ] login serverAddress "+i+", serverPort "+s),v=i,n.IP.value.length>0&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&!window.CLIENTCONFIG.ISBIGWIN&&(y.info("[ loginToUportal ] login replace ip"),v=n.IP.value),I=void 0,h=2;case 58:if(!(h>0)){e.next=101;break}return e.next=61,n.uportalLogin({loginAccount:a,password:l,serverAddress:v,serverPort:s});case 61:if(m=e.sent,y.info("[ loginToUportal ] result:"+m.result+";reloginCount:"+h),0!==m.result){e.next=70;break}return e.next=66,n.dealWithUportalLoginSuccess(m,a);case 66:return I=e.sent,e.abrupt("break",101);case 70:if(m.result!==constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_CA_VERIFY_FAILED){e.next=81;break}return e.next=73,n.dealWithUportalLoginFailed(m,a);case 73:return e.next=75,n.dealWithUportalLoginFailedAuth(o,l,i,s);case 75:if(I=e.sent,I.result){e.next=79;break}return y.info("[ loginToUportal ] download ca failed, exit login loop"),e.abrupt("break",101);case 79:e.next=99;break;case 81:if(m.result!==constant.UPORTAL_LOGIN_ERROR.LOGIN_E_ERR_SERVER_REDIRECT){e.next=94;break}return e.next=84,n.dealWithUportalLoginFailedRedirect(m,o,l);case 84:if(I=e.sent,!I.result||!I.serverInfo){e.next=90;break}v=I.serverInfo.serverAddress||v,s=I.serverInfo.serverPort||s,e.next=92;break;case 90:return y.info("[ loginToUportal ] 302 failed, exit login loop"),e.abrupt("break",101);case 92:e.next=99;break;case 94:return e.next=96,n.dealWithUportalLoginFailed(m,a);case 96:I=e.sent,h--,y.info("[ loginToUportal ] reloginCount:"+h);case 99:e.next=58;break;case 101:if(!I.result){e.next=106;break}return y.info("<account_login><3_uportal>end ok"),e.abrupt("return",I);case 106:return y.info("<account_login><3_uportal>end failed"),e.abrupt("return",(0,C.LoginError)(I));case 108:case"end":return e.stop()}},e,t)})),n.dealWithUportalLoginSuccess=function(){var e=(0,E.default)(g.default.mark(function e(r,o){var a,i,s,u,c,d,l,f,p,_,w,E;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(0,L.getLoginModel)(),i=a.sipLoginOnly,s=a.isOAuth,u=a.serverAddress,c=a.isResume,i||s||"Workplace"!==window.CLIENTCONFIG.NEW_APP_NAME||window.isHubEnv){e.next=4;break}return e.abrupt("return",n.dealWithAccountMutex());case 4:return d=r.uportal_authorize_result,l=d.user_name,f=d.onebox_app_id,p=d.onebox_server_addr,_=d.corp_id,p&&(_=_||"",coreIm.setOfflineFileConfig(!0,{onebox_app_id:f,onebox_server_addr:p,corp_id:_})),a.set({uportalLoginState:constant.UPORTAL_LOGIN_STATE.UPORTAL_LOGIN_SUCCESS,account:l||(s?a.account:o)}),e.next=10,n.updateSiteInfo(r);case 10:if(w=e.sent,coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_UPORTAL_SERVER,resultParams:[1],isTrackTimeCosts:!0}),a.isInUportalLogin=!1,w&&w.serverUportalAddress&&n.IP.value!==w.serverUportalAddress&&(window.CLIENTCONFIG.ISBIGWIN||n.IP.saveLastUportalInfo(u,w.serverUportalAddress),y.info("uportalAddrUpdate")),window.CLIENTCONFIG.ISBIGWIN||window.isHubEnv||window.isPluginEnv){e.next=19;break}if(!(0,N.checkIsFirstLogin)()||window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=19;break}return a.setLoginStatus(!1,!1),(0,N.firstLoginChangePassword)(),e.abrupt("return",{result:!1,errorCode:"fistLoginReject",errorType:constant.LOGIN_ERROR_TYPE.common,isResume:c});case 19:if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||!window.noactivity){e.next=32;break}if(e.t0=window.CLIENTCONFIG.ISMOBILE,!e.t0){e.next=25;break}return e.next=24,window.isFloatWindow;case 24:e.t0=e.sent;case 25:if(!(E=e.t0)){e.next=30;break}y.info("the window is float "),e.next=32;break;case 30:return y.error("has no activity, login err!!!"),e.abrupt("return",{result:!1,errorCode:"webView has hide",errorType:constant.LOGIN_ERROR_TYPE.common});case 32:if(!window.isHubEnv||a.isIwb){e.next=35;break}return a.setLoginStatus(!1,!1),e.abrupt("return",{result:!1,errorCode:constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_IWB_MAXHUB_ACCOUNT,errorType:constant.LOGIN_ERROR_TYPE.common,isResume:c});case 35:return e.abrupt("return",{result:!0});case 36:case"end":return e.stop()}},e,t)}));return function(t,r){return e.apply(this,arguments)}}(),n.dealWithUportalLoginFailedRedirect=function(){var e=(0,E.default)(g.default.mark(function e(r,o,a){var i,s,u,c,d,l,f,p,_,w;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(0,L.getLoginModel)(),s=r.uportal_authorize_result.redirect_url,i.OAuthUrl=s,y.info("[ O[Auth] ] enter the third ticket [auth], url:",desensitive(s)),"Huawei Meeting"!==window.CLIENTCONFIG.NEW_APP_NAME||-1!==s.indexOf("cloudportal")||window.isHubEnv){e.next=6;break}return e.abrupt("return",n.dealWithAccountMutex());case 6:if(i.isOAuth=!0,u=void 0,c=void 0,-1===s.indexOf("cloudportal")){e.next=21;break}if(d=/(?:https\:\/\/)?(?:(\d+\.\d+\.\d+\.\d+)|((?:[0-9a-zA-Z\u4E00-\u9FA5\uF900-\uFA2D]+[.])+[0-9a-zA-Z\u4E00-\u9FA5\uF900-\uFA2D]+))(?:\:(\d+))+/,!(l=d.exec(s))){e.next=17;break}f=l[1],p=l[2],_=l[3],u=f||p,c=_&&_||0,e.next=18;break;case 17:return e.abrupt("return",{result:!1,errorCode:constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_REQUEST_FAILED,errorType:constant.LOGIN_ERROR_TYPE.uportal,isResume:i.isResume});case 18:i.isOAuth=!1,e.next=28;break;case 21:return e.next=23,(0,T.getOAuthTicket)(o,a);case 23:return w=e.sent,e.next=26,(0,T.getOAuthAccount)(w);case 26:i.account=e.sent,i.user_ticket=w;case 28:return e.abrupt("return",{result:!0,serverInfo:{serverAddress:u,serverPort:c}});case 29:case"end":return e.stop()}},e,t)}));return function(t,r,n){return e.apply(this,arguments)}}(),n.dealWithUportalLoginFailedAuth=function(){var e=(0,E.default)(g.default.mark(function e(r,n,o,a){var i,s,u,c;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null,s="",u=!1,c=function(){var e=(0,E.default)(g.default.mark(function e(s){return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.ret){e.next=5;break}return y.info("user click to start login download cacert"),e.next=4,(0,R.startLoginDownLoadCaCert)({account:r,password:n,serverAddress:o,serverPort:a});case 4:i=e.sent;case 5:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}(),!window.CLIENTCONFIG.ISMOBILE){e.next=9;break}return e.next=7,window.confirm(language.CA_CERT_IS_NOT_TRUSTED).then(c);case 7:e.next=11;break;case 9:return e.next=11,window.confirm(language.CA_CERT_IS_NOT_TRUSTED,!0).then(c);case 11:return null===i?(y.info("user cancel download cacert files"),u=!1,s="USER_CANCEL_DOWNLOAD_CA_CERT"):i&&0===i.result?(y.info("Download cacert success, re-login to uportal"),u=!0,s=""):(y.info("download cacert files failed"),u=!1,s=constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_DOWNLOAD_CA_CERT_ERROR),e.abrupt("return",{result:u,errorCode:s,errorType:constant.LOGIN_ERROR_TYPE.uportal,isResume:(0,L.getLoginModel)().isResume});case 13:case"end":return e.stop()}},e,t)}));return function(t,r,n,o){return e.apply(this,arguments)}}(),n.dealWithUportalLoginFailed=function(){var e=(0,E.default)(g.default.mark(function e(r,o){var a;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,L.getLoginModel)(),window.CLIENTCONFIG.ISBIGWIN||n.IP.saveLastUportalInfo("",""),coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_UPORTAL_SERVER,resultParams:[0,r.result],isTrackTimeCosts:!0}),a.set({uportalLoginState:constant.UPORTAL_LOGIN_STATE.UPORTAL_LOGIN_FAILED,account:a.isOAuth?a.account:o}),y.error("baseLogin:loginUportal result=",r.result),a.isInUportalLogin=!1,window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&coreConf.uportalLoginFailed(r.result),e.abrupt("return",{result:!1,errorCode:r.result,errorType:constant.LOGIN_ERROR_TYPE.uportal,isResume:a.isResume});case 8:case"end":return e.stop()}},e,t)}));return function(t,r){return e.apply(this,arguments)}}(),n.dealWithAccountMutex=(0,E.default)(g.default.mark(function e(){var r;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,L.getLoginModel)(),r.isInUportalLogin=!1,r.setLoginStatus(!1,!1),y.info("[ loginToUportal ] login fail. workplace account can not login on huawe meeting"),alert(language.LOGIN_ERR_DISTINGUISH_HUAWEIMEETING_OR_WORKPLACE),e.abrupt("return",{result:!1,errorCode:constant.UPORTAL_LOGIN_ERROR.LOGIN_ERR_DISTINGUISH_HUAWEIMEETING_OR_WORKPLACE,errorType:constant.LOGIN_ERROR_TYPE.common,isResume:r.isResume});case 6:case"end":return e.stop()}},e,t)})),n.IP=new A,n}return(0,l.default)(r,t),r}(m.default),P=void 0;t.getUportalApi=function(){return isNullOrEmpty(P)&&(P=new b),P}}).call(t,r(133).Buffer)},803:function(e,t,r){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}function o(){return window.prompt({title:language.PROXY_TITLE,label:"Proxy UserName :",value:"username",inputAttrs:{type:"url"},type:"input"})}function a(){return window.prompt({title:language.PROXY_TITLE,label:"Proxy Password :",value:"password",inputAttrs:{type:"password"},type:"input"})}Object.defineProperty(t,"__esModule",{value:!0}),t.getOAuthAccount=t.getOAuthTicket=void 0;var i=r(1),s=n(i),u=r(2),c=n(u),d=(function(){var e=(0,c.default)(s.default.mark(function e(){var t,r,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,d.getLoginModel)(),e.next=3,o();case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,a();case 8:if(n=e.sent){e.next=11;break}return e.abrupt("return");case 11:return(0,d.getLoginModel)().proxyAccount=r,e.next=14,coreSecurity.PasswordManager.setPassword("proxyPassword",n);case 14:return e.next=16,(0,l.setProxyInfo)({isSupportProxy:!0,proxyAddress:(0,d.getLoginModel)().proxyAddress,proxyPort:(0,d.getLoginModel)().proxyPort,proxyAccount:r,proxyPassword:n});case 16:return e.abrupt("return",!0);case 17:case"end":return e.stop()}},e,this)}))}(),r(183)),l=r(283),f=window.Logger("login")("IT-ticket");t.getOAuthTicket=function(){var e=(0,c.default)(s.default.mark(function e(){var t,r,n,o,a,i,u,c,l,p,_,g,w,E,v,I,h,m,L,C,T;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.info(" [ getOAuthTicket ] "),t=PromiseObject(),e.next=4,new coreHttp.hwTupHttpTransSdk;case 4:return r=e.sent,n=(0,d.getLoginModel)(),o=n.OAuthClinetID,a=n.OAuthUrl,i=(0,d.getLoginModel)(),u=i.account,c=i.proxyAddress,l=i.proxyPort,p=i.proxyAccount,_=i.isSupportProxy,e.next=10,coreSecurity.PasswordManager.getPassword("password");case 10:return g=e.sent,e.next=13,coreSecurity.PasswordManager.getPassword("proxyPassword");case 13:return w=e.sent,_||(c="",l="0",p="",w=""),g=encodeURIComponent(g),E=coreAccount.getLoginModel(),v=E.isSupportCACertCheck,e.next=19,r.sendSyncRequest({url:a,type:constant.REQUEST_TYPE.POST,header:{"Content-Type":"application/x-www-form-urlencoded"},body:"username="+u+"&password="+g+"&grant_type=password&client_id="+o,proxyInfo:{proxyAddress:c,proxyPort:l,proxyAccount:p,proxyPassword:w},tlsParam:{caCertPath:window.EXEC_PATH,tlsMode:v?1:0},cipherlist:[50331695,50331701,50331708,50331709]});case 19:return I=e.sent,h=I.param,m=h.recv_body,L=h.resp_code,C=h.result,L?(T=parseInt(L),200===T?(m=JSON.parse(m),m.error&&(f.error(" [ getOAuthTicket ] failed, errorCode:"+m.error+", info:"+m.error_description),t.reject({result:!1,errorCode:d.UErrorCode.LOGIN_ERR_AUTH_FAILED,errorType:d.ErrorType.uportal,isResume:(0,d.getLoginModel)().isResume})),t.resolve((0,d.getLoginModel)().user_ticket=m.access_token),f.info(" [ getOAuthTicket ] result")):(f.error(" [ getOAuthTicket ] failed, request error, status code: "+L+", result: "+C),t.reject({result:!1,errorCode:d.UErrorCode.LOGIN_ERR_REQUEST_FAILED,errorType:d.ErrorType.uportal,isResume:(0,d.getLoginModel)().isResume}))):t.reject({result:!1,errorCode:d.UErrorCode.LOGIN_ERR_REQUEST_FAILED,errorType:d.ErrorType.uportal,isResume:(0,d.getLoginModel)().isResume}),e.abrupt("return",t);case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.getOAuthAccount=function(){var t=(0,c.default)(s.default.mark(function t(r){var n,o,a;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(f.info(" [ getO[Auth]Account ] "),!((n=r.split("."))instanceof Array)){t.next=8;break}return o=JSON.parse(new e(n[1],"base64").toString()),f.info(" [ getO[Auth]Account ] result",o.preferred_username.length>4?o.preferred_username.substr(0,3)+"******"+o.preferred_username.substr(-4):"****"),t.abrupt("return",o.preferred_username);case 8:return a=PromiseObject(),t.abrupt("return",a.reject("server config error"));case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}).call(t,r(133).Buffer)},804:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.registerEServerClientPush=void 0;var o=r(67),a=n(o),i=r(1),s=n(i),u=r(2),c=n(u),d=window.Logger("push")("index");window.registerEServerHWPush=function(){var e=(0,c.default)(s.default.mark(function e(){var t,r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.webView.getLocalIp()||"0.0.0.0",!isNullOrEmpty(o)){e.next=6;break}return e.next=4,coreDb.queryLoginSetting({key:DB_KEY_HW_PUSH_TOKEN});case 4:r=e.sent,isNullOrEmpty(r)||!r.hasOwnProperty("key")||!r.hasOwnProperty("value")||isNullOrEmpty(r.key)||isNullOrEmpty(r.value)||(o=r.value);case 6:if(!isNullOrEmpty(a)){e.next=11;break}return e.next=9,coreDb.queryLoginSetting({key:DB_KEY_HW_PUSH_BADGE_CLASS_NAME});case 9:n=e.sent,isNullOrEmpty(n)||!n.hasOwnProperty("key")||!n.hasOwnProperty("value")||isNullOrEmpty(n.key)||isNullOrEmpty(n.value)||(a=n.value);case 11:return e.next=13,l(2,1,o,a,"","",t);case 13:coreDb.saveLoginSetting({key:DB_KEY_HW_PUSH_TOKEN,value:o}),coreDb.saveLoginSetting({key:DB_KEY_HW_PUSH_BADGE_CLASS_NAME,value:a});case 15:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),window.unRegisterEServerHWClientPush=(0,c.default)(s.default.mark(function e(){var t,r,n,o,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.webView.getLocalIp()||"0.0.0.0",r=void 0,n=void 0,e.next=5,coreDb.queryLoginSetting({key:DB_KEY_HW_PUSH_TOKEN});case 5:return o=e.sent,isNullOrEmpty(o)||!o.hasOwnProperty("key")||!o.hasOwnProperty("value")||isNullOrEmpty(o.key)||isNullOrEmpty(o.value)||(r=o.value),e.next=9,coreDb.queryLoginSetting({key:DB_KEY_HW_PUSH_BADGE_CLASS_NAME});case 9:return a=e.sent,isNullOrEmpty(a)||!a.hasOwnProperty("key")||!a.hasOwnProperty("value")||isNullOrEmpty(a.key)||isNullOrEmpty(a.value)||(n=a.value),e.next=13,l(2,3,r,n,"","",t);case 13:case"end":return e.stop()}},e,void 0)})),window.registerEServerIosPush=function(){var e=(0,c.default)(s.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.updateLocalIp().then(function(){var e=(0,c.default)(s.default.mark(function e(n){var o,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t)){e.next=5;break}return e.next=3,coreDb.queryLoginSetting({key:DB_KEY_IOS_PUSH_TOKEN});case 3:o=e.sent,isNullOrEmpty(o)||!o.hasOwnProperty("key")||!o.hasOwnProperty("value")||isNullOrEmpty(o.key)||isNullOrEmpty(o.value)||(t=o.value);case 5:if(!isNullOrEmpty(r)){e.next=10;break}return e.next=8,coreDb.queryLoginSetting({key:DB_KEY_IOS_VOIP_TOKEN});case 8:a=e.sent,isNullOrEmpty(a)||!a.hasOwnProperty("key")||!a.hasOwnProperty("value")||isNullOrEmpty(a.key)||isNullOrEmpty(a.value)||(r=a.value);case 10:return e.next=12,l(1,1,"","",t,r,n);case 12:coreDb.saveLoginSetting({key:DB_KEY_IOS_PUSH_TOKEN,value:t}),coreDb.saveLoginSetting({key:DB_KEY_IOS_VOIP_TOKEN,value:r});case 14:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),window.unRegisterEServerIosPush=(0,c.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.updateLocalIp().then(function(){var e=(0,c.default)(s.default.mark(function e(t){var r,n,o,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,e.next=4,coreDb.queryLoginSetting({key:DB_KEY_IOS_PUSH_TOKEN});case 4:return o=e.sent,isNullOrEmpty(o)||!o.hasOwnProperty("key")||!o.hasOwnProperty("value")||isNullOrEmpty(o.key)||isNullOrEmpty(o.value)||(r=o.value),e.next=8,coreDb.queryLoginSetting({key:DB_KEY_IOS_VOIP_TOKEN});case 8:return a=e.sent,isNullOrEmpty(a)||!a.hasOwnProperty("key")||!a.hasOwnProperty("value")||isNullOrEmpty(a.key)||isNullOrEmpty(a.value)||(n=a.value),e.next=12,l(1,3,"","",r,iosVoipToken,t);case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,void 0)}));var l=t.registerEServerClientPush=function(){var e=(0,c.default)(s.default.mark(function e(t,r,n,o,i,u,c){var l,f,p,_,g,w,E,v,I,h,m,L,C,T=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"5";return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 2:if(!isNullOrEmpty(n)||!isNullOrEmpty(i)){e.next=5;break}return d.info(" [ registerClientPush ] androidToken and iosDeviceToken is null"),e.abrupt("return");case 5:return isNullOrEmpty(o)&&(o=""),l=coreAccount.getLoginModel(),f=l.account,p=l.authToken,_=l.serverAddress,g=l.serverPort,w=l.proxyAddress,E=l.proxyPort,v=l.proxyAccount,I=1,h="00:00",m="00:00",L={user:f,device_token:1===t?i:n,push_type:t,opt:r,client_ip:c,language:window.langShortName,no_push_start_time:h,no_push_end_time:m,apns_server:1,apns_cert:T,push_by_time_switch:I,heart_beat_time:30,android_token:1===t?i:n,app_id:"1",push_class_name:o,voip_token:u,app_mode:1,push_mode:1,im_push_mode:1,call_push_mode:0,push_im_active:"welink://welinksoftclient/h5page?page=imDetail",push_call_active:"welink://welinksoftclient/h5page?page=call"},d.info("registerClientPush","registerClientPush"),e.next=15,coreIm.registerPush(L);case 15:C=e.sent,d.info("registerClientPush","registerClientPush result : "+(0,a.default)(C));case 17:case"end":return e.stop()}},e,void 0)}));return function(t,r,n,o,a,i,s){return e.apply(this,arguments)}}();window.openConversationByMobile=function(){var e=(0,c.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:coreIm.openImDetailByUrl(t);case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},98:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.HwAccountSdk=void 0;var a=r(121),i=o(a),s=r(4),u=o(s),c=r(1764),d=n(c),l=r(793),f=n(l),p=r(992),_=n(p),g=r(994),w=n(g),E=r(710),v=n(E),I=r(714),h=n(I),m=r(998),L=n(m),C=r(997),T=n(C),S=r(353),N=n(S),R=r(801),O=n(R),y=r(798),A=n(y),b=r(283),P=n(b),x=r(715),k=n(x),M=r(796),U=n(M),D=r(310),G=n(D),F=r(709),B=n(F),W=r(716),H=n(W),V=r(354),K=n(V),Y=r(183),q=n(Y),j=r(309),$=n(j),X=r(351),z=n(X),J=r(408),Q=n(J),Z=r(799),ee=n(Z),te=r(996),re=n(te),ne=r(797),oe=n(ne),ae=r(352),ie=n(ae),se=r(713),ue=n(se),ce=r(628),de=n(ce),le=r(803),fe=n(le),pe=r(711),_e=n(pe),ge=r(629),we=n(ge),Ee=r(800),ve=n(Ee),Ie=r(1e3),he=n(Ie),me=r(804),Le=n(me),Ce=r(993),Te=n(Ce),Se=r(995),Ne=n(Se),Re=r(794),Oe=n(Re),ye=r(409),Ae=n(ye),be=r(795),Pe=n(be),xe=r(712),ke=n(xe),Me=r(1767),Ue=o(Me),De=r(999),Ge=r(1768),Fe=r(1769);t.HwAccountSdk=function e(){(0,u.default)(this,e),(0,i.default)(this,d),(0,i.default)(this,f),(0,i.default)(this,_),(0,i.default)(this,w),(0,i.default)(this,v),(0,i.default)(this,h),(0,i.default)(this,L),(0,i.default)(this,T),(0,i.default)(this,N),(0,i.default)(this,O),(0,i.default)(this,A),(0,i.default)(this,P),(0,i.default)(this,k),(0,i.default)(this,U),(0,i.default)(this,G),(0,i.default)(this,B),(0,i.default)(this,H),(0,i.default)(this,K),(0,i.default)(this,q),(0,i.default)(this,$),(0,i.default)(this,z),(0,i.default)(this,Q),(0,i.default)(this,ee),(0,i.default)(this,re),(0,i.default)(this,oe),(0,i.default)(this,ie),(0,i.default)(this,ue),(0,i.default)(this,de),(0,i.default)(this,fe),(0,i.default)(this,_e),(0,i.default)(this,we),(0,i.default)(this,ve),(0,i.default)(this,he),(0,i.default)(this,Le),(0,i.default)(this,Te),(0,i.default)(this,Ne),(0,i.default)(this,Oe),(0,i.default)(this,Ae),(0,i.default)(this,Pe),(0,i.default)(this,ke),(0,i.default)(this,{AppConfig:Ne.default}),(0,i.default)(this,Ue.default),(0,i.default)(this,(0,De.getMiddleEndApi)().getApiList()),(0,i.default)(this,Ge.verification.getApiList()),(0,i.default)(this,(0,Fe.getLoginApi)().getApiList())}},992:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.handleRefreshTokenSuc=t.handleKickPcSuc=t.handleMultiDeviceMsg=t.refreshIsMultiDeviceLogined=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=r(351),c=r(310),d=r(183),l=window.Logger("logic")("login/bridge"),f=t.refreshIsMultiDeviceLogined=function(e){l.info("refreshIsMultiDeviceLogined ","bMultiDeviceLogined:"+e),(0,d.getLoginModel)().isMultiDeviceLogined=e};t.handleMultiDeviceMsg=function(){var e=(0,s.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l.info("handleMultiDeviceMsg"),window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return l.debug("no deal"),e.abrupt("return");case 4:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=7;break}return l.info("it welink no deal"),e.abrupt("return");case 7:if(r=(0,d.getMyInfo)().account,n=(0,d.getLoginModel)().isMultiDeviceLogined,t.param.user!==r){e.next=21;break}if(1!==t.param.event_type){e.next=15;break}f(!0),(0,u.dealPcLogin)(),e.next=21;break;case 15:if(n){e.next=18;break}return l.info("not multi devices, return"),e.abrupt("return");case 18:return f(!1),e.next=21,(0,u.dealPcLogout)();case 21:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();window.refreshRegister=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.sipUseByOther=!1,(0,c.registerResumeEvent)(),(0,u.dealPcLogout)();case 3:case"end":return e.stop()}},e,void 0)})),window.stopRegister=(0,s.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(0,u.sipserverDeregister)(),l.info("stopRegister, set isOffline true"),window.isOffline=!0;case 3:case"end":return e.stop()}},e,void 0)}));t.handleKickPcSuc=function(){var e=(0,s.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l.info("handleKickPcSuc"),window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return l.debug("no deal"),e.abrupt("return");case 4:if(t=(0,d.getLoginModel)().isMultiDeviceLogined){e.next=8;break}return l.info("not multi devices, return"),e.abrupt("return");case 8:return f(!1),e.next=11,(0,u.dealPcLogout)();case 11:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.handleRefreshTokenSuc=function(){coreCall.callAfterPCKickout()}},993:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.handlesipconfinfo=t.setloginNotifyFunc=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=(window.Logger("model")("model/callService/index"),t.setloginNotifyFunc=function(){var e=(0,s.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWUportal;case 2:t=e.sent,t.setNotifyFunc(360474,u);case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.handlesipconfinfo=function(e){coreCommon.Observer.publish("TempSipConfInfo",e)})},994:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.setCmptEvent=t.stopCmptLog=t.startCmptLog=t.detectStopServer=t.detectStartServer=t.detectStopClientContinue=t.detectStartClientContinue=t.detectStopClient=t.detectStartClient=t.detectUnInit=t.detectInit=t.checkCertificateOverdue=t.verifyCertificate=void 0;var o=r(1),a=n(o),i=r(2),s=n(i),u=window.Logger("logic")("login/cmpt");t.verifyCertificate=function(){var e=(0,s.default)(a.default.mark(function e(t){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"string"!=typeof t&&u.info("verifyCertificate param error!"),e.next=3,new coreTup.HWTupCmptSdk;case 3:return r=e.sent,e.next=6,r.verifyCertificate(t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.checkCertificateOverdue=function(){var e=(0,s.default)(a.default.mark(function e(t){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"string"!=typeof t&&u.info("checkCertificateOverdue param error!"),e.next=3,new coreTup.HWTupCmptSdk;case 3:return r=e.sent,e.next=6,r.checkCertificateOverdue(t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.detectInit=function(){var e=(0,s.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return t=e.sent,e.next=5,t.detectInit();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.detectUnInit=function(){var e=(0,s.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return t=e.sent,e.next=5,t.detectUnInit();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.detectStartClient=function(){var e=(0,s.default)(a.default.mark(function e(t){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return r=e.sent,e.next=5,r.detectStartClient(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.detectStopClient=function(){var e=(0,s.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return t=e.sent,e.next=5,t.detectStopClient();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.detectStartClientContinue=function(){var e=(0,s.default)(a.default.mark(function e(t){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return r=e.sent,e.next=5,r.detectStartClientContinue(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.detectStopClientContinue=function(){var e=(0,s.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return t=e.sent,e.next=5,t.detectStopClientContinue();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.detectStartServer=function(){var e=(0,s.default)(a.default.mark(function e(t){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return r=e.sent,e.next=5,r.detectStartServer(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.detectStopServer=function(){var e=(0,s.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return t=e.sent,e.next=5,t.detectStopServer();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.startCmptLog=function(){var e=(0,s.default)(a.default.mark(function e(t){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return r=e.sent,e.next=5,r.startCmptLog(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.stopCmptLog=function(){var e=(0,s.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return t=e.sent,e.next=5,t.stopCmptLog();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setCmptEvent=function(){var e=(0,s.default)(a.default.mark(function e(t){var r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCmptSdk;case 2:return r=e.sent,e.next=5,r.setCmptEvent(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},995:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return-1===window.CLIENTCONFIG.MENU_LIST.findIndex(function(t){return t===e})?0:1},o=[{route:"recent",isShow:n("recent"),enabled:1,dataTestid:"recentinfo000123"},{route:"conference",isShow:n("conference"),enabled:1,dataTestid:"conferenceinfo000123"},{route:"contactGroups",isShow:n("contactGroups"),enabled:1,dataTestid:"contactgpinfo000123"},{route:"work",isShow:n("work"),enabled:1,dataTestid:"work000123"}];t.setAppConfigList=function(){if(window.navBarConfiglist=o.concat(),!window.CLIENTCONFIG.USE_IM){var e=window.navBarConfiglist.findIndex(function(e){return"recent"===e.route});window.navBarConfiglist.splice(e,1);var t=window.navBarConfiglist[0];window.navBarConfiglist[1]=window.navBarConfiglist[1],window.navBarConfiglist[0]=t}if(!window.CLIENTCONFIG.USE_MEETING){var r=window.navBarConfiglist.findIndex(function(e){return"conference"===e.route});window.navBarConfiglist.splice(r,1)}};window.navBarConfiglist=o},996:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.startLoginDownLoadCaCert=void 0;var o=r(1),a=n(o),i=r(67),s=n(i),u=r(3),c=n(u),d=r(144),l=n(d),f=r(2),p=n(f),_=window.Logger("login")("caCert");t.startLoginDownLoadCaCert=function(){var e=(0,p.default)(a.default.mark(function e(t){var r,n,o,i,u,d,f,p=t.account,g=t.password,w=t.serverAddress,E=t.serverPort;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _.info("startLoginDownLoadCaCert port is:",E),_.info("startLoginDownLoadCaCert port type is:",void 0===E?"undefined":(0,l.default)(E)),E&&E instanceof String&&(E=parseInt(E)),r={auth_type:0,user_agent:window.CLIENTCONFIG.ISMOBILE?constant.USER_AGENT.MOBILE:"Workplace"===window.CLIENTCONFIG.NEW_APP_NAME?constant.USER_AGENT.WORKPLACEPC:constant.USER_AGENT.PC,user_tiket:"1",auth_info:{user_name:p,password:g},auth_server:{server_type:0,server_url:w,server_port:E,server_version:"V6R6C00"}},n=window.EXEC_PATH,o={file_path:n,server_port:E,server_addr:w},e.next=8,new coreTup.HWUportal;case 8:return i=e.sent,u=new c.default(function(e,t){i.downLoadCaCert(o,r,function(t){_.info("download ca cert files, ret=",(0,s.default)(t)),e(t)})}),e.next=12,u;case 12:return d=e.sent,f=d.param,e.abrupt("return",f);case 15:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},997:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadUserConfigFromDB=void 0;var n=r(998),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.loadUserConfigFromDB=o.loadUserConfigFromDB},998:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadUserConfigFromDB=void 0;var o=r(1),a=n(o),i=r(121),s=n(i),u=r(2),c=n(u),d=r(183),l=window.Logger("logic")("login");t.loadUserConfigFromDB=function(){var e=(0,c.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0,coreDb.queryUserConfigList({all:""}).then(function(e){var r={};-1===e.findIndex(function(e){return"confPageShowType"===e.key})&&(l.info("db can not find the value of confPageShowType"),$dispatch(coreUi.changeConfPageShowType(!1))),e.forEach(function(e){if(0===e.key.indexOf("Device.ComCfg")&&(r[e.key]=e.value,t++),0===e.key.indexOf("Device.UICfg")&&coreCwmp.dealWithUICfgParam({paramName:e.key,paramValue:e.value}),"CHRPassword"===e.key){var n=JSON.parse(e.value);n.cipher&&n.salt&&coreSecurity.PasswordManager.setCipherPassword(e.key,n.cipher,n.salt)}if("experienceConfInfo"===e.key){var o=JSON.parse(e.value);o.cipher&&o.salt&&coreSecurity.PasswordManager.setCipherPassword("experienceConfPwd",o.cipher,o.salt),coreConf.changeExperienceConfId(o.confid)}if("isRemindNotNotify"===e.key&&("true"===e.value?$dispatch(coreUi.isNotNotifyChangePassword(!0)):$dispatch(coreUi.isNotNotifyChangePassword(!1))),"isOpenShock"===e.key&&("true"===e.value?$dispatch(coreUi.bOpenShock(!0)):$dispatch(coreUi.bOpenShock(!1))),"isIMRecieveRing"===e.key&&("true"===e.value?$dispatch(coreUi.bIMRecieveRing(!0)):$dispatch(coreUi.bIMRecieveRing(!1))),"isCallCommingRing"===e.key&&("true"===e.value?$dispatch(coreUi.bCallCommingRing(!0)):$dispatch(coreUi.bCallCommingRing(!1))),"checkedLanguage"===e.key&&$dispatch(coreUi.languageChooseValue(2===parseInt(e.value)?1:parseInt(e.value))),"hasOpenPush"===e.key&&("true"===e.value?$dispatch(coreUi.changeHasOpenPush(!0)):$dispatch(coreUi.changeHasOpenPush(!1))),"cmdkey"===e.key){var a=JSON.parse(e.value);void 0!==a[0]&&void 0!==a[1]&&void 0!==a[0].RPCName&&void 0!==a[1].RPCName&&(a[0].RPCName="Download",a[1].RPCName="Upload",$dispatch(coreUi.updateCmdKey(a)))}if("isAutoCollectLogs"===e.key){var i=coreSetting.stringToBoolean(e.value);(0,d.getMyInfo)().isAutoCollectLogs=i}if("hasAllowCollectLogs"===e.key){var s=coreSetting.stringToBoolean(e.value);(0,d.getMyInfo)().hasAllowCollectLogs=s}if("isAutoAcceptConf"===e.key){var u=coreSetting.stringToBoolean(e.value);(0,d.getMyInfo)().isAutoAcceptConf=u}"confPageShowType"===e.key&&(l.info("the value of confPageShowType is",e.value),$dispatch(coreUi.changeConfPageShowType(e.value)))}),t>0&&(0,s.default)(window.CLIENTCONFIG,r)});case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()},999:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getMiddleEndApi=void 0;var o=r(117),a=n(o),i=r(118),s=n(i),u=r(119),c=n(u),d=r(1),l=n(d),f=r(2),p=n(f),_=r(4),g=n(_),w=r(183),E=r(1766),v=n(E),I=window.Logger("login")("MiddleEnd"),h=function e(){var t=this;(0,g.default)(this,e),this.sendRequest=function(){var e=(0,p.default)(l.default.mark(function e(r,n){var o,a,i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getProxyInfo();case 2:return o=e.sent,e.next=5,t.getTlsInfo();case 5:return a=e.sent,i=[],e.abrupt("return",(new coreHttp.hwTupHttpTransSdk).then(function(e){return e.sendSyncRequest({url:r,type:n,header:s,body:u,proxyInfo:o,tlsParam:a,cipherlist:i})}));case 8:case"end":return e.stop()}},e,t)}));return function(t,r){return e.apply(this,arguments)}}(),this.getProxyInfo=(0,p.default)(l.default.mark(function e(){var r,n,o,a,i,s;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,w.getLoginModel)(),n=r.proxyAddress,o=r.proxyPort,a=r.proxyAccount,i=r.isSupportProxy,e.next=3,coreSecurity.PasswordManager.getPassword("proxyPassword");case 3:return s=e.sent,i||(n="",o="0",a="",s=""),e.abrupt("return",{proxyAddress:n,proxyPort:o,proxyAccount:a,proxyPassword:s});case 6:case"end":return e.stop()}},e,t)})),this.getTlsInfo=(0,p.default)(l.default.mark(function e(){var r,n;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,w.getLoginModel)(),n=r.isSupportCACertCheck,e.abrupt("return",{caCertPath:window.EXEC_PATH,tlsMode:n?1:0});case 2:case"end":return e.stop()}},e,t)}))},m=void 0,L=function(){return isNullOrEmpty(m)&&(m=new h),m},C=function(e){function t(){var e,r,n,o,i=this;(0,g.default)(this,t);for(var u=arguments.length,c=Array(u),d=0;d<u;d++)c[d]=arguments[d];return r=n=(0,s.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(c))),n.requestIDVerificationCode=function(){var e=(0,p.default)(l.default.mark(function e(t){var r,o,a;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("requestIDVerificationCode"),r=(0,w.getLoginModel)(),o=r.middleEndAddress,a="https://"+o+"/mcloud/mag/FreeProxyForText/v1/users/login/"+t+"/code",e.abrupt("return",L().sendRequest(a,constant.REQUEST_TYPE.GET).then(function(e){return n.dealWithRequestResult(e)}));case 4:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.requestTenantUserList=function(){var e=(0,p.default)(l.default.mark(function e(t){var r,o,a,s=t.phoneNumber,u=t.verificationCode;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("requestTenantUserList"),r=(0,w.getLoginModel)(),o=r.middleEndAddress,a="https://"+o+"/mcloud/mag/FreeProxyForText/wemiddle/api/v1/mdmservice/pusers?phoneNumber="+s+"&vercode="+u,e.abrupt("return",L().sendRequest(a,constant.REQUEST_TYPE.GET).then(function(e){return n.dealWithRequestResult(e)}));case 4:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.ssoLogin=function(){var e=(0,p.default)(l.default.mark(function e(t){var r,o,a,s,u,c=t.loginName,d=t.password,f=t.tenantid;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.loginName=c,n.password=encodeURIComponent(d),n.tenantid=f,I.info("ssoLogin"),r=(0,w.getLoginModel)(),o=r.middleEndAddress,a="https://"+o+"/mcloud/mag/LoginAutoReg",s={"User-Agent":"WeLink-meeting","Content-Type":"application/x-www-form-urlencoded"},u="loginName="+c+"&password="+n.password+"&publicKeyFlag=df",isNullOrEmpty(f)||(u+="&tenantid="+f),e.abrupt("return",L().sendRequest(a,constant.REQUEST_TYPE.POST,s,u).then(function(e){var t=n.dealWithRequestResult(e);if(t.result){var r=t.recv_body.refresh_expires_in,o=isNullOrEmpty(r)?7200:parseInt(r);n.startRefreshMiddleEndToken(.5*o)}return t}));case 10:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.startRefreshMiddleEndToken=function(){var e=(0,p.default)(l.default.mark(function e(t){return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.stopRefreshMiddleEndToken(),I.info("start refresh middle-end [token], interval:",t),n.refreshTokenTimer=setInterval((0,p.default)(l.default.mark(function e(){var t,r,o;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.ssoLogin({loginName:n.loginName,password:n.password,tenantid:n.tenantid});case 2:if(t=e.sent,!t.result||!t.recv_body.access_token){e.next=12;break}return r=(0,w.getLoginModel)(),r.user_ticket=t.recv_body.access_token||r.user_ticket,r.crypt_token=t.recv_body.crypt_token||r.crypt_token,I.info("refresh um crypttoken"),e.next=10,new coreTup.HWTupOfflineFile;case 10:o=e.sent,o.refreshToken(r.crypt_token);case 12:case"end":return e.stop()}},e,i)})),1e3*t);case 3:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.stopRefreshMiddleEndToken=(0,p.default)(l.default.mark(function e(){return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("stop refresh middle-end [token]"),n.refreshTokenTimer&&(clearInterval(n.refreshTokenTimer),n.refreshTokenTimer=null);case 2:case"end":return e.stop()}},e,i)})),n.getUrlHost=function(){var e=(0,p.default)(l.default.mark(function e(t){var r;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t)){e.next=2;break}return e.abrupt("return","");case 2:return r=document.createElement("a"),r.href=t,e.abrupt("return",r.hostname||t);case 5:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),n.dealWithRequestResult=function(e){var t=0,r="",n=!1,o={};try{if(0===e.result)switch(e.param.resp_code){case 200:o=JSON.parse(e.param.recv_body),t=o.code||o.errorCode||0;break;case 302:t=302;break;default:t=-1}else t=-1;I.info("dealWithRequestResult: resp_code="+(e.param&&e.param.resp_code)+",result="+e.result)}catch(e){I.error("dealWithRequestResult",e.toString()),t=-1}switch(parseInt(t)){case-1:r=language.CALL_CALLING_FAILED;break;case 0:case 200:case 302:n=!0;break;case 1024:r=language.VERIFICATION_CODE_ERROR_SERVER;break;case 1103:r=language.LOGIN_USERPWD_ERROR;break;case 1146:r=language.LOGIN_ERR_ACCOUNT_LOCKED;break;case 2e3:case 2030:r=language.VERIFICATION_CODE_ERROR_SERVER;break;case 3005:r=language.VERIFICATION_CODE_ERROR_FREQUENTLY;break;case 3007:r=language.VERIFICATION_CODE_ERROR_SMS_FAILED;break;case 3010:r=language.VERIFICATION_CODE_ERROR_NUMBER_INCORRECT;break;case 3008:r=language.VERIFICATION_CODE_ERROR;break;case 10005:r=language.VERIFICATION_CODE_ERROR_NUMBER_DISABLED;break;case 10008:r=language.VERIFICATION_CODE_ERROR_USER_NOT_EXIST;break;default:r=language.CALL_CALLING_FAILED}return I.info("dealWithRequestResult: code="+t+",message="+(o.message||o.errorMessage)),{code:t,result:n,message:r,recv_body:o}},o=r,(0,s.default)(n,o)}return(0,c.default)(t,e),t}(v.default),T=void 0;t.getMiddleEndApi=function(){return isNullOrEmpty(T)&&(T=new C),T}}});