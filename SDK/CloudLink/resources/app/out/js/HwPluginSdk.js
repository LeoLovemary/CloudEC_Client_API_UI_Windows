webpackJsonp([19],{106:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HwPluginSdk=void 0;var r=n(4),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(1843);t.HwPluginSdk=function e(){(0,o.default)(this,e),(0,a.initPluginApi)()}},1117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PLUGIN_CMD={INIT:"init",LOGIN:"login",CREATE_MEETING:"createMeeting",JOIN_MEETING_BY_ID:"joinMeetingById",EXIT:"exit"},t.PLUGIN_URL={pluginEnvConfig:"cloudlink://welinksoftclient/startupconfig?model=plugin"}},115:function(e,t,n){e.exports={default:n(165),__esModule:!0}},116:function(e,t,n){e.exports=n(0)(43)},117:function(e,t,n){e.exports=n(0)(45)},123:function(e,t,n){e.exports={default:n(155),__esModule:!0}},134:function(e,t,n){e.exports=n(0)(155)},1366:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(123),a=r(o),i=n(1),u=r(i),c=n(2),l=r(c),s=n(115),d=r(s),f=n(4),p=r(f),g=n(5),_=r(g),I=n(116),C=r(I),m=n(117),N=r(m),v=n(1845),E=r(v),M=n(1117),L=window.Logger("Plugin")("logic/pluginimlp"),P=function(e){function t(){var e,n,r,o,i=this;(0,p.default)(this,t);for(var c=arguments.length,s=Array(c),f=0;f<c;f++)s[f]=arguments[f];return n=r=(0,C.default)(this,(e=t.__proto__||(0,d.default)(t)).call.apply(e,[this].concat(s))),r.registJSLoadEvent=function(){L.info("registJSLoadEvent"),coreCommon.Observer.subscribe(constant.COMMON_NOTIFY.ON_COMMON_JS_LOADED,r.handleClmInited)},r.handleClmInited=function(){L.info("handleClmInited"),r.registNotify(),r.clmApiCallback(M.PLUGIN_CMD.INIT,{code:0,msg:"",data:""})},r.loginNotify=function(e){L.info("plugin:login notify:"+e.code+"  "+e.event),0!==e.code&&r.clmApiCallback(M.PLUGIN_CMD.LOGIN,{code:e.code,msg:e.event,data:""})},r.sipRegResultNotify=function(e){var t=$getState().login,n=t.sipImpi;if(L.info("plugin:[sip register]"),e.param.tel_number!==n)return void L.info(" [sip register] account not compared, no handle ");constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED===e.param.register_state&&0===e.param.reason_code?r.clmApiCallback(M.PLUGIN_CMD.LOGIN,{code:0,msg:"",data:""}):constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERING!==e.param.register_state&&r.clmApiCallback(M.PLUGIN_CMD.LOGIN,{code:e.param.reason_code,msg:"sip register fail",data:""}),coreCommon.Observer.subscribe("ConfInfoNotify",r.pluginConfConnected)},r.pluginConfPreCheck=function(){return coreAccount.getLoginModel().uportalLoginState!==constant.UPORTAL_LOGIN_STATE.UPORTAL_LOGIN_SUCCESS?(L.info("plugin login: uportal is not logined,return fail"),{code:-1,msg:"uportal is not logined",data:""}):coreAccount.getLoginModel().sipRegisterState!==constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED?(L.info("plugin sip is not registered, return fail"),{code:-1,msg:"sip not registered",data:""}):{code:0}},r.login=function(){var e=(0,l.default)(u.default.mark(function e(t){var n,o,a,c,l;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=coreAccount.getLoginModel().uportalLoginState,o=coreAccount.getLoginModel().sipRegisterState,n!==constant.UPORTAL_LOGIN_STATE.UPORTAL_LOGIN_LOGINING){e.next=6;break}return L.info("plugin login: is logining,return fail"),r.clmApiCallback(M.PLUGIN_CMD.LOGIN,{code:-1,msg:"repeat operate",data:""}),e.abrupt("return");case 6:if(n!==constant.UPORTAL_LOGIN_STATE.UPORTAL_LOGIN_SUCCESS||o!==constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED||t.account!==coreAccount.getLoginModel().account){e.next=10;break}return L.info("plugin login: accout has already logined"),r.clmApiCallback(M.PLUGIN_CMD.LOGIN,{code:0,msg:"has successed",data:""}),e.abrupt("return");case 10:if(!(isNullOrEmpty(t.account)||isNullOrEmpty(t.password)||isNullOrEmpty(t.serverAddress)||isNullOrEmpty(t.serverPort))){e.next=14;break}return L.info("account or [password] is null"),r.clmApiCallback(M.PLUGIN_CMD.LOGIN,{code:-1,msg:"args error",data:""}),e.abrupt("return");case 14:return e.next=16,r.handlePreLogin();case 16:return L.info("login: [account]="+handlePhoneNumber(t.account)+", serverAddress="+handlePhoneNumber(t.serverAddress)+", serverPort="+handlePhoneNumber(t.serverPort)),a=t.account,c=t.serverAddress,l=t.serverPort,e.next=22,window.handleSwitchAccount({account:a,serverAddress:c,serverPort:l,noNeedLogout:!0});case 22:coreAccount.getLoginModel().password=t.password,coreAccount.login();case 24:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),r.creatInstantMeeting=function(){var e=(0,l.default)(u.default.mark(function e(t){var n,o,c,l,s,d,f;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.pluginConfPreCheck(),0===n.code){e.next=5;break}return r.clmApiCallback(M.PLUGIN_CMD.CREATE_MEETING,n),L.warn("plugin createMeeting preCheck failed!"),e.abrupt("return");case 5:if(L.info("creatInstantMeeting: param=",(0,a.default)(t)),o=$getState().myInfo,c=[],c.push(o),l=!t.needPassword,s=t.mediaType,d=t.confSubject,!window.isPluginEnv){e.next=16;break}if(s===constant.CONF_MEDIATYPE.CONF_MEDIATYPE_FLAG_VIDEO_DATA){e.next=16;break}return r.clmApiCallback(M.PLUGIN_CMD.CREATE_MEETING,{code:1,msg:"",data:""}),e.abrupt("return");case 16:f=coreConf.actionCreateConf(o,c,{group_id:""},s,l,d),r.clmApiCallback(M.PLUGIN_CMD.CREATE_MEETING,{code:f?0:1,msg:"",data:""});case 18:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),r.joinMeetingById=function(){var e=(0,l.default)(u.default.mark(function e(t){var n,o;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.pluginConfPreCheck(),0===n.code){e.next=5;break}return r.clmApiCallback(M.PLUGIN_CMD.JOIN_MEETING_BY_ID,n),L.warn("plugin joinMeetingById preCheck failed!"),e.abrupt("return");case 5:L.info("onEnterMeetingById: ",(0,a.default)(t)),o=coreConf.enterConfByIdOnlyWithConfPas(t),o||r.clmApiCallback(M.PLUGIN_CMD.JOIN_MEETING_BY_ID,{code:-1,msg:"",data:""});case 8:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),r.pluginConfConnected=function(){L.info("pluginConfConnected"),r.clmApiCallback(M.PLUGIN_CMD.JOIN_MEETING_BY_ID,{code:0,msg:"join data success",data:""})},o=n,(0,C.default)(r,o)}return(0,N.default)(t,e),(0,_.default)(t,[{key:"registNotify",value:function(){L.info("registNotify"),coreCommon.registeModuleListener("login",this.loginNotify),coreCommon.registeModuleListener("sipRegResultEvent",this.sipRegResultNotify)}}]),t}(E.default);t.default=P},142:function(e,t,n){var r=n(10),o=n(8),a=n(144);e.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],i={};i[e]=t(n),r(r.S+r.F*a(function(){n(1)}),"Object",i)}},143:function(e,t,n){e.exports=n(0)(170)},144:function(e,t,n){e.exports=n(0)(51)},155:function(e,t,n){var r=n(8),o=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},165:function(e,t,n){n(166),e.exports=n(8).Object.getPrototypeOf},166:function(e,t,n){var r=n(134),o=n(167);n(142)("getPrototypeOf",function(){return function(e){return o(r(e))}})},167:function(e,t,n){e.exports=n(0)(377)},1843:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.initPluginApi=void 0;var o=n(1),a=r(o),i=n(2),u=r(i),c=n(1844),l=r(c),s=n(1846),d=r(s),f=n(1117),p=window.Logger("plugin")("logic/index"),g=null;t.initPluginApi=function(){var t=(0,u.default)(a.default.mark(function t(){var n;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!coreCommon.isPc()){t.next=7;break}return t.next=3,coreCommon.getConsoleUrl();case 3:n=t.sent,n===f.PLUGIN_URL.pluginEnvConfig?window.isPluginEnv=!0:n&&"cloudlink://welinksoftclient/startupconfig?model=integrated"===n&&(window.isHubEnv=!0),t.next=8;break;case 7:window.isPluginEnv="opensdk"===e.env.CHANNEL;case 8:if(window.isPluginEnv){t.next=10;break}return t.abrupt("return");case 10:try{null===g&&(coreCommon.isMobile()?g=new l.default:coreCommon.isWin()&&(g=new d.default),g&&(g.registChannel(),g.registJSLoadEvent()))}catch(e){p.error("init plugin api error",e.toString())}case 11:case"end":return t.stop()}},t,void 0)}));return function(){return t.apply(this,arguments)}}()}).call(t,n(143))},1844:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(123),a=r(o),i=n(1),u=r(i),c=n(2),l=r(c),s=n(115),d=r(s),f=n(4),p=r(f),g=n(116),_=r(g),I=n(117),C=r(I),m=n(1366),N=r(m),v=n(1117),E=window.Logger("Plugin")("logic/pluginimlp"),M=function(e){function t(){var e,n,r,o,i=this;(0,p.default)(this,t);for(var c=arguments.length,s=Array(c),f=0;f<c;f++)s[f]=arguments[f];return n=r=(0,_.default)(this,(e=t.__proto__||(0,d.default)(t)).call.apply(e,[this].concat(s))),r.registChannel=(0,l.default)(u.default.mark(function e(){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.openClmApi=r.openClmApi,window.backToNativeView=r.backToNativeView,window.isNeedBackToNative=r.isNeedBackToNative;case 3:case"end":return e.stop()}},e,i)})),r.clmApiCallback=function(e,t){if(coreCommon.isIos())window.cordova.exec(null,null,"OCJSBridge","clmApiCallback",[e,t]);else if(coreCommon.isAndroid()){var n=(0,a.default)(t);window.webView.clmApiCallback(e,n)}},r.openClmApi=function(e,t){switch(E.info("openClmApi"),e){case v.PLUGIN_CMD.LOGIN:r.login(t);break;case v.PLUGIN_CMD.CREATE_MEETING:r.creatInstantMeeting(t);break;case v.PLUGIN_CMD.JOIN_MEETING_BY_ID:r.joinMeetingById(t);break;default:E.error("call error:cmd not defined"),r.clmApiCallback(e,{result:-1,msg:"cmd error"})}},r.isNeedBackToNative=function(e){if(coreCommon.isPc())return!1;var t=window.getRoute();if(isNullOrEmpty(e)||isNullOrEmpty(t))return!1;var n=["callMain","ConfMemberList","mConfMemberPage","mShowQrcode","mSelectBox","mInitShowSelectBox","selectCorporateDirectory","selectPhoneAddress","selectCorporateDirctory"];return n.includes(t)&&!n.includes(e)},r.backToNativeView=function(){},r.handlePreLogin=(0,l.default)(u.default.mark(function e(){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $getState().dialogModal.isShowDialog&&(E.info("clear dialog"),window.clearDialogQueueIt($getState().dialogModal.contentStr)),e.next=3,coreCommon.initLogin(!1);case 3:case"end":return e.stop()}},e,i)})),o=n,(0,_.default)(r,o)}return(0,C.default)(t,e),t}(N.default);t.default=M},1845:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(1),a=r(o),i=n(2),u=r(i),c=n(115),l=r(c),s=n(4),d=r(s),f=n(116),p=r(f),g=n(117),_=r(g),I=function(e){function t(){var e,n,r,o,i=this;(0,d.default)(this,t);for(var c=arguments.length,s=Array(c),f=0;f<c;f++)s[f]=arguments[f];return n=r=(0,p.default)(this,(e=t.__proto__||(0,l.default)(t)).call.apply(e,[this].concat(s))),r.login=function(){var e=(0,u.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),r.creatInstantMeeting=function(){var e=(0,u.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),r.joinMeetingById=function(){var e=(0,u.default)(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),r.closeApp=(0,u.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,i)})),o=n,(0,p.default)(r,o)}return(0,_.default)(t,e),t}(coreCommon.Interface);t.default=I},1846:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(123),a=r(o),i=n(1),u=r(i),c=n(2),l=r(c),s=n(115),d=r(s),f=n(4),p=r(f),g=n(116),_=r(g),I=n(117),C=r(I),m=n(1366),N=r(m),v=n(1847),E=r(v),M=n(1117),L=window.Logger("plugin")("logic/index"),P=function(e){function t(){var e,n,r,o,i=this;(0,p.default)(this,t);for(var c=arguments.length,s=Array(c),f=0;f<c;f++)s[f]=arguments[f];return n=r=(0,_.default)(this,(e=t.__proto__||(0,d.default)(t)).call.apply(e,[this].concat(s))),r.registChannel=(0,l.default)(u.default.mark(function e(){var t;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new E.default;case 2:t=e.sent,null!==t?(t.setCmdFunc(r.openClmApi),L.info("initPlugin: Create WebSocket success.")):L.info("initPlugin: Create WebSocket failed.");case 4:case"end":return e.stop()}},e,i)})),r.clmApiCallback=function(){var e=(0,l.default)(u.default.mark(function e(t,n){var r,o,a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:L.info("pluginCmdCallback: cmd=",t+", result=",n),r=void 0,e.t0=t,e.next=e.t0===M.PLUGIN_CMD.INIT?5:e.t0===M.PLUGIN_CMD.LOGIN?7:e.t0===M.PLUGIN_CMD.CREATE_MEETING?9:e.t0===M.PLUGIN_CMD.JOIN_MEETING_BY_ID?11:13;break;case 5:return r=constant.CLK_PLUGIN_CMD.PLUGIN_CMD_INIT,e.abrupt("break",15);case 7:return r=constant.CLK_PLUGIN_CMD.PLUGIN_CMD_LOGIN,e.abrupt("break",15);case 9:return r=constant.CLK_PLUGIN_CMD.PLUGIN_CMD_CREATE_MEETING,e.abrupt("break",15);case 11:return r=constant.CLK_PLUGIN_CMD.PLUGIN_CMD_JOIN_MEETING_BY_ID,e.abrupt("break",15);case 13:return L.info("cmd error"),e.abrupt("return");case 15:return e.next=17,new E.default;case 17:o=e.sent,a=0,0!==n.code&&"0"!==n.code&&(a=1),o.postRpsMessage(r,a);case 21:case"end":return e.stop()}},e,i)}));return function(t,n){return e.apply(this,arguments)}}(),r.closeApp=(0,l.default)(u.default.mark(function e(){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:L.info("closeApp begin"),setTimeout(function(){try{appService.exitApp()}catch(e){L.error("closeApp:",{e:e.toJSON()})}},500);case 2:case"end":return e.stop()}},e,i)})),r.openClmApi=function(e){var t=e.cmd;switch(L.info("pluginCmdCallback: cmd=",t),t){case constant.CLK_PLUGIN_CMD.PLUGIN_CMD_LOGIN:r.login(e.param);break;case constant.CLK_PLUGIN_CMD.PLUGIN_CMD_CREATE_MEETING:r.creatInstantMeeting(e.param);break;case constant.CLK_PLUGIN_CMD.PLUGIN_CMD_JOIN_MEETING_BY_ID:r.joinMeetingById(e.param);break;case constant.CLK_PLUGIN_CMD.PLUGIN_CMD_EXIT:r.closeApp();break;default:L.error("pluginCmdCallback: not support, data=",(0,a.default)(e))}},r.handlePreLogin=function(){},o=n,(0,_.default)(r,o)}return(0,C.default)(t,e),t}(N.default);t.default=P},1847:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(123),a=r(o),i=n(3),u=r(i),c=n(4),l=r(c),s=n(5),d=r(s),f=window.Logger("plugin")("websocket"),p=null,g=null,_=null,I=function(e){null!==p&&p.sendToTup(e)},C=function(){function e(){var t=this;return(0,l.default)(this,e),g&&p&&0===p.readyState?(f.info("plugin WebSocket is connecting"),g):g=new u.default(function(e,n){p&&1===p.readyState?e(t):(p=new WebSocket("ws://localhost:"+(window.CLIENTCONFIG.API_PORT||"7685"),"clk_plugin_service_protocol"),p.onopen=function(){f.info("plugin WebSocket is opened"),e(t)},p.onclose=function(){f.info("plugin WebSocket is closed"),p=null},p.onerror=function(e){f.info("plugin WebSocket is error, e = ",(0,a.default)(e)),p=null},p.onmessage=function(e){var t=JSON.parse(e.data);f.info("CloudLink Recive plugin message: ",t),t.cmd>0&&"function"==typeof _&&_(t)})})}return(0,d.default)(e,[{key:"setCmdFunc",value:function(e){f.info("set cmd func success"),_=e}},{key:"postRpsMessage",value:function(e,t){var n={description:"",rps:e,opt:0,call:0,result:t};I(n),f.debug("CloudLink Rsp to proxy: rps = "+n.rps+", result = "+n.result)}},{key:"postRpsParamMessage",value:function(e,t,n){var r={description:"",rps:e,opt:0,call:0,result:n,param:t};I(r),f.debug("CloudLink Rsp param to proxy: rps = "+r.rps+", result = "+r.result+", param = "+r.param)}},{key:"postNotifyMessage",value:function(e){f.debug(e.description,e),I(e)}}]),e}();t.default=C}});