webpackJsonp([13],{1001:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1),o=a(r),i=n(2),c=a(i),l=n(117),s=a(l),u=n(4),d=a(u),f=n(5),p=a(f),h=n(118),v=a(h),m=n(119),C=a(m),w=n(878),I=a(w),S=window.Logger("model")("model/callService/audioCallService"),_=function(e){function t(e){(0,d.default)(this,t);var n=(0,v.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return e?n:(S.info("can not create AudioCallService object"),(0,v.default)(n))}return(0,C.default)(t,e),(0,p.default)(t,[{key:"acceptCall",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.acceptCall(this.callInfo.callId,!1);case 5:n=e.sent,0===n.result?(S.info("accept call success"),this.setDeviceControlCallId(this.callInfo.callId),coreCommon.SpkControl.getInstance().cancelSysSpkMute(),coreCommon.SpkControl.getInstance().setHandsFree(!1)):(coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_ACCEPTCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),n.result]}),S.info("accept call failed, result = "+n.result));case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"holdCall",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.holdCall(this.callInfo.callId);case 5:n=e.sent,0===n.result?S.info("hold call success"):S.info("hold call failed, result = "+n.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"unHoldCall",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.unHoldCall(this.callInfo.callId);case 5:n=e.sent,0===n.result?S.info("unhold call success"):S.info("unhold call failed, result = "+n.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"divertCall",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.divertCall(this.callInfo.callId,t);case 5:a=e.sent,0===a.result?S.info("divert call success"):S.info("divert call failed, result = "+a.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"blindTransfer",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.blindTransfer(this.callInfo.callId,t);case 5:a=e.sent,0===a.result?S.info("blind transfer call success"):S.info("blind transfer call failed, result = "+a.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"consultTransfer",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.consultTransfer(this.callInfo.callId,t);case 5:a=e.sent,0===a.result?S.info("consult transfer call success"):S.info("consult transfer call failed, result = "+a.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"addVideo",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.addVideo(this.callInfo.callId);case 5:n=e.sent,0===n.result?(this.callInfo.isVideo=!0,S.info("add video call success")):S.info("add video call failed");case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"transferConfEx",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.transferConfEx(t,this.callInfo.callId);case 5:return a=e.sent,0===a.result?S.info("transfer conference success"):S.info("transfer conference failed, result = "+a.result),e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"createCallId",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t){var n,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.createCallId(t,r,i);case 5:return a=e.sent,0===a.result?S.info("create call ID success"):S.info("create call ID failed, result = "+a.result),e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"pointPickup",value:function(){function e(e,n,a,r){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n,a,r){var i,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return i=e.sent,e.next=5,i.pointPickupEx(t,n,a,r);case 5:return c=e.sent,0===c.result?S.info("point pickup success"):S.info("point pickup failed, result = "+c.result),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"groupPickup",value:function(){function e(e,n,a,r){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n,a,r){var i,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return i=e.sent,e.next=5,i.groupPickupEx(t,n,a,r);case 5:return c=e.sent,0===c.result?S.info("group pickup success"):S.info("group pickup failed, result = "+c.result),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleCallDivertFailed",value:function(e){this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallDivertFailed",e.param),S.info("CallDivertFailed")}}]),t}(I.default);t.default=_},1002:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i=n(67),c=a(i),l=n(121),s=a(l),u=n(1),d=a(u),f=n(2),p=a(f),h=n(4),v=a(h),m=n(5),C=a(m),w=n(1001),I=a(w),S=n(1003),_=a(S),g=window.Logger("model")("model/callService/callManager"),b=window.tupVideo,N=null,E=null,T=null,k=null,y=0,x=!1,O=(o=r=function(){function e(){(0,v.default)(this,e)}return(0,C.default)(e,[{key:"acceptCall",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r,o,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return g.info("acceptCall callId: "+n),i&&(a=e.CallList[n],r={call_id:n,call_type:0,tel_num:a.callInfo.callNo,call_state:a.callInfo.callState,callInOut:a.callInfo.callInOut,isCallSuccess:a.callInfo.isCallSuccess},delete e.CallList[n],e.CallList[n]=e.getCallObject(r,!1)),o=e.CallList[n],t.next=5,o.acceptCall(i);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"endCall",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(g.info("endCall callId: "+n),!(a=e.CallList[n])){t.next=9;break}return t.next=5,a.endCall();case 5:r=t.sent,0===r.result?g.info("end call success"):(g.info("end call failed"),coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_ENDCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),r.result]})),t.next=11;break;case 9:g.info("call id is not exist "),coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_ENDCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),"callid_not_exist"]});case 11:case"end":return t.stop()}},t,this)}));return t}()},{key:"startCall",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r,o,i;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getCallObject(n,a),o=!n.hasOwnProperty("addr_vip"),t.next=4,r.startCall(a,o);case 4:return i=t.sent,i?(e.CallList[r.callInfo.callId]=r,g.info("start call success")):g.info("start call failed"),t.abrupt("return",i);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"startPickupCall",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.getCallObject(n,!1),t.next=3,a.startPickupCall();case 3:return r=t.sent,r?(e.CallList[a.callInfo.callId]=a,g.info("start pickup call success")):g.info("start pickup call failed"),t.abrupt("return",r);case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"dialDTMF",value:function(t,n,a){var r=e.CallList[t];n&&r&&r.dialDTMF(n,a)}},{key:"setCallNotifyFunc",value:function(){function t(){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(){var n;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new coreTup.HWTupCall;case 2:n=t.sent,n.setNotifyFunc(98307,e.handleCallIncomming),n.setNotifyFunc(98309,e.handleCallRingBack),n.setNotifyFunc(98310,e.handleCallConnected),n.setMultiNotifyFunc(98311,e.handleCallEnded),n.setNotifyFunc(98312,e.handleCallDestroy),n.setNotifyFunc(98313,e.handleCallRTPCreated),n.setNotifyFunc(98314,e.handleCallAddVideo),n.setNotifyFunc(98315,e.handleCallDelVideo),n.setNotifyFunc(98316,e.handleCallModifyVideoResult),n.setNotifyFunc(98317,e.handleVideoRefreshView),n.setNotifyFunc(98318,e.handleVideoDecodeSuccess),n.setNotifyFunc(98320,e.handleAudioFileEnd),n.setNotifyFunc(98321,e.handleCallLocalQos),n.setNotifyFunc(98325,e.handleSpeechLevelReport),n.setNotifyFunc(98326,e.handleSpkVolChange),n.setNotifyFunc(98327,e.handleMicVolChange),n.setNotifyFunc(98335,e.handleBFCPFrameSizeChange),n.setNotifyFunc(98337,e.handleDataSending),n.setNotifyFunc(98338,e.handleBFCPDataBeginRec),n.setNotifyFunc(98339,e.handleDataStartError),n.setNotifyFunc(98340,e.handleBFCPDataStop),n.setMultiNotifyFunc(98341,e.handleCallSessionModify),n.setNotifyFunc(98343,e.handleCallHoldSuccess),n.setNotifyFunc(98344,e.handleCallHoldFailed),n.setNotifyFunc(98345,e.handleCallUnHoldSuccess),n.setNotifyFunc(98346,e.handleCallUnHoldFailed),n.setNotifyFunc(98348,e.handleCallDivertFailed),n.setNotifyFunc(98350,e.handleCallBldTransferSuccess),n.setNotifyFunc(98351,e.handleCallBldTransferFailed),n.setNotifyFunc(98352,e.handleCallAtdTransferSuccess),n.setNotifyFunc(98353,e.handleCallAtdTransferFailed),n.setNotifyFunc(98356,e.handleSipAccountWmi),n.setNotifyFunc(98367,e.handleCallJointStartNotify),n.setNotifyFunc(98368,e.handleCallJointCloseNotify),n.setNotifyFunc(98381,e.handleCallJointOnlineNotify),n.setNotifyFunc(98382,e.handleCallJointOffLineNotify),n.setNotifyFunc(98384,e.handleCallJointOffHookNotify),n.setNotifyFunc(98385,e.handleCallJointOutGoingNotify),n.setNotifyFunc(98386,e.handleCallJointEstablishedNotify),n.setNotifyFunc(98397,e.handleCallJointPeerCapsReportNotify),n.setNotifyFunc(98435,e.handleIsKickOff),n.setNotifyFunc(98440,e.handleNewServiceRight),n.setNotifyFunc(98469,e.handleCallPickupNotify),n.setNotifyFunc(98483,e.handleCallPickupRemoteInfo),n.setNotifyFunc(98488,e.handleCallUpateRemoteInfo),n.setNotifyFunc(98489,e.handleMediaSRTPStatus),n.setNotifyFunc(98544,e.handleSpkMicList),n.setNotifyFunc(98547,e.handleCameraList),n.setNotifyFunc(98548,e.handlesetVideoIdxRet),n.setNotifyFunc(98572,e.handleNoStream),n.setNotifyFunc(98642,e.handleLowVideoBW),n.setNotifyFunc(98644,e.handleDeviceHowlStatus),n.setNotifyFunc(98648,e.handleUploadChrFile),n.setNotifyFunc(98657,e.receivePairReqNotify),n.setNotifyFunc(98659,e.pairedOrCanceledResultNotify),n.setNotifyFunc(98661,e.pairClosedNotify),n.setNotifyFunc(98668,e.pairSubscribeNotify),n.setNotifyFunc(98669,e.pairCallStateNotify),n.setNotifyFunc(98671,e.pairLinkageConfNotify),n.setNotifyFunc(98672,e.pairLinkageConfStateNotify),n.setNotifyFunc(98678,e.handlePassiveDirectionResult),n.setNotifyFunc(98679,e.handleUniversalInfoNotify),n.setNotifyFunc(98687,e.handleAudioNoStreamLeaveConf);case 66:case"end":return t.stop()}},t,this)}));return t}()},{key:"setLocalVideo",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return g.info("<video>set local video render"),a.resUpdateFn=e.resUpdateLocalFn,a.getFrameFn=b.getLocalFrame,a.onSocketClose=e.onLocalSocketClose,a.canvas=n,N?(N.setViewWH(a.viewW,a.viewH,n),g.info("<video>local video render is exist")):N=new TUPRender2(a),t.abrupt("return",N);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"setRemoteVideo",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return g.info("<video>set remote video render"),a.resUpdateFn=e.resUpdateRemoteFn,a.getFrameFn=b.getRemoteFrame,a.onSocketClose=e.onRemoteSocketClose,a.canvas=n,E?(E.setViewWH(a.viewW,a.viewH,n),g.info("<video>remote video render is exist")):E=new TUPRender2(a),t.abrupt("return",E);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"setBFCPVideo",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:g.info("<video>set bfcp render"),a.resUpdateFn=e.resUpdateBFCPFn,a.getFrameFn=b.getDataFrame,a.onSocketClose=e.onBFCPSocketClose,a.canvas=n,T?(T.setViewWH(a.viewW,a.viewH,a.canvas),g.info("<video>bfcp render is exist")):T=new TUPRender2(a);case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"closeLocalSocket",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("<video> close local socket"),N&&N.closeSocket(),N=null;case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"closeRemoteSocket",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("<video> close remote socket"),E&&E.closeSocket(),E=null;case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"closeDataSocket",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("<video> close data socket"),T&&T.closeSocket(),T=null;case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"setLocalVideoWH",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("<video> set local video wh,width = "+t+",height = "+n),N&&N.setViewWH(t,n,a);case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"setRemoteVideoWH",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("<video> set remote video wh,width = "+t+",height = "+n),E&&E.setViewWH(t,n,a);case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"calcVideoRealSize",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,r=n,t>n?t>1280&&(a=1280,r=1280*n/t):n>1280&&(r=1280,a=1280*t/n),g.info("<video> calcVideoRealSize,width = "+a+",height = "+r),e.abrupt("return",[a,r]);case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"setBFCPDataWH",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("<bfcp> set bfcp data wh,width = "+t+",height = "+n),T&&T.setViewWH(t,n);case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"setSpkVol",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.setSpkVol(t*window.CLIENTCONFIG.SPK_GAIN/100);case 5:if(a=e.sent,0!==a.result){e.next=11;break}return g.info("setSpkVol success"),e.abrupt("return",!0);case 11:return g.info("setSpkVol failed, result = "+a.result),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"setCallCapability",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.setCallCapability(t);case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setCallReinvite",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.setCallReinvite(t);case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setMicVol",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.setMicVol(t*window.CLIENTCONFIG.MIC_GAIN/100);case 5:if(a=e.sent,0!==a.result){e.next=11;break}return g.info("setMicVol success"),e.abrupt("return",!0);case 11:return g.info("setMicVol failed, result = "+a.result),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"getSpkVol",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.getSpkVol();case 5:return n=e.sent,e.abrupt("return",100*n.param.out_gain/window.CLIENTCONFIG.SPK_GAIN);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getMicVol",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.getMicVol();case 5:return n=e.sent,e.abrupt("return",100*n.param.in_gain/window.CLIENTCONFIG.MIC_GAIN);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getMediaDevices",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,g.info("getMediaDevices,type = ",t),e.next=6,n.getMediaDevices(t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getMicDeviceVol",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.getMicDeviceVol();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getSpkDeviceVol",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.getSpkDeviceVol();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setMicDeviceVol",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.setMicDeviceVol(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setSpkDeviceVol",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.setSpkDeviceVol(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getMicIndex",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.getMicIndex();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"setMicIndex",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,g.info("setMicIndex, index = ",t),e.next=6,n.setMicIndex(t);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"getSpkIndex",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.getSpkIndex();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"setBfcpIsBigWnd",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.setBfcpIsBigWnd(t,n);case 5:return r=e.sent,0===r.result?g.info("setBfcpIsBigWnd success isBfcpBigWnd = "+n):g.info("setBfcpIsBigWnd failed, res = "+r+", isBfcpBigWnd = "+n),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setAllSvcVideoWindows",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){var r,o,i;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=3;break;case 3:return e.next=5,new coreTup.HWTupCall;case 5:return r=e.sent,e.next=8,r.setAllSvcVideoWindows(t,n,a);case 8:return o=e.sent,0===o.result?g.info("setAllSvcVideoWindows success "):g.info("setAllSvcVideoWindows failed, res = ",o),i={count:t,windowArray:a},coreCommon.Observer.publish("SvcVideoWindows",i),e.abrupt("return",o);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"getCallBandwidth",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.CallList[n],t.next=3,a.getBandwidth();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return t}()},{key:"assignBandwidthForData",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r,o,i,c,l;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(g.info(">>>callid: ",n),!(a=e.CallList[n])){t.next=8;break}return t.next=5,a.assignBandwidthForData();case 5:return t.abrupt("return",t.sent);case 8:return g.info("call object is not exist"),r={callid:n,infoid:0},o=0,t.next=13,new coreTup.HWTupCall;case 13:return i=t.sent,t.next=16,i.getBasicCallInfo(r);case 16:return c=t.sent,0===c.result?(g.info("getBandwidth success,bandwidth = "+c.param.call_info.bandwidth),o=c.param.call_info.bandwidth):g.info("getBandwidth failed"),l=I.default.assignBandwidth(o),t.abrupt("return",l[1]);case 20:case"end":return t.stop()}},t,this)}));return t}()},{key:"setBandwidth",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.setBandWidth(t,n);case 5:return r=e.sent,0===r.result?g.info("setBandwidth success "):g.info("setBandwidth failed, res = ",r),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setDataBandwidth",value:function(){function t(e,t,a){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r){var o;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(g.info("setDataBandwidth, callid: "+n+" operationType: "+a+", bandwidth: "+r),!(o=e.CallList[n])){t.next=8;break}return t.next=5,o.setDataBandwidth(a,r);case 5:g.info("setDataBandwidth success!"),t.next=9;break;case 8:g.error("call object not found!");case 9:case"end":return t.stop()}},t,this)}));return t}()},{key:"setEncoderMaxCap",value:function(){function e(e,n,a,r,o){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a,r,o){var i,c;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return i=e.sent,e.next=5,i.setEncoderMaxCap(t,n,a,r,o);case 5:return c=e.sent,0===c.result?g.info("setEncoderMaxCap success "):g.info("setEncoderMaxCap failed, res = ",c),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setSpkIndex",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,g.info("setSpkIndex, index = ",t),e.next=6,n.setSpkIndex(t);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"getVideoIndex",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.getVideoIndex();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"setVideoIndex",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,g.info("setVideoIndex, index = ",t),e.next=6,n.setVideoIndex(t);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"operateMic",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.CallList[n],g.info("userClick  operateMic, callId: "+n+"to_mute = "+a),!r){t.next=8;break}return t.next=5,r.operateMic(a);case 5:return t.abrupt("return",t.sent);case 8:return g.info("operateMic not find callId: "+n),t.abrupt("return",{});case 10:case"end":return t.stop()}},t,this)}));return t}()},{key:"switchAudioChannel",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.CallList[n],g.info("switchAudioChannel, isStop = ",a),t.next=4,r.switchAudioChannel(a);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"replyAddVideo",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.CallList[n],g.info("replyAddVideo, is_accept = ",a),t.next=4,r.replyAddVideo(a);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"setCaptureRotation",value:function(){function t(e,t,a){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r){var o;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.CallList[n],g.info("setCaptureRotation callId: "+n+",capture_index: "+a+",capture_rotation: "+r),!o){t.next=6;break}return t.next=5,o.setCaptureRotation(n,a,r);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"setDisplayRotation",value:function(){function t(e,t,a){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r){var o;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.CallList[n],g.info("setDisplayRotation callId: "+n+" render_type: "+a+" rotation:"+r),t.next=4,o.setDisplayRotation(n,a,r);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"setVideoCollectMode",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.CallList[n],g.info("setVideoCollectMode callId: "+n+" collect_mode: "+a),t.next=4,r.setVideoCollectMode(n,a);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"setVideoRender",value:function(){function t(e,t,a,r,o){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r,o,i){var c;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=e.CallList[n],t.next=3,c.setVideoRender(n,a,r,o,i);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return t}()},{key:"delVideo",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.CallList[n],g.info("delVideo, callId = "+n),t.next=4,a.delVideo();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"transferConfEx",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.CallList[a],g.info("transferConfEx = ",n,a),t.next=4,r.transferConfEx(n);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}));return t}()},{key:"activeStopBFCPData",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:n=e.sent,n.stopData(t);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"startPlayMediaFile",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.startPlayMediaFile(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"stopPlayMediaFile",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.stopPlayMediaFile(t);case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"holdCall",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(g.info("holdCall callId: "+n),!(a=e.CallList[n])){t.next=7;break}return t.next=5,a.holdCall();case 5:t.next=8;break;case 7:g.info("holdCall no found call by callId = "+n);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"unHoldCall",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(g.info("unHoldCall callId: "+n),!(a=e.CallList[n])){t.next=7;break}return t.next=5,a.unHoldCall();case 5:t.next=8;break;case 7:g.info("unHoldCall no found call by callId = "+n);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"divertCall",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return g.info("divertCall = ",n,a),r=e.CallList[n],t.next=4,r.divertCall(a);case 4:case"end":return t.stop()}},t,this)}));return t}()},{key:"blindTransfer",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.CallList[n],g.info("blindTransfer = "),t.next=4,r.blindTransfer(a);case 4:case"end":return t.stop()}},t,this)}));return t}()},{key:"consultTransfer",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(g.info("consultTransfer callId: "+n+" transtoCallId: "+a),!(r=e.CallList[n])){t.next=7;break}return t.next=5,r.consultTransfer(a);case 5:t.next=8;break;case 7:g.info("consultTransfer no found call by callId = "+n);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"addVideo",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.CallList[n],g.info("addVideo = "),t.next=4,a.addVideo();case 4:case"end":return t.stop()}},t,this)}));return t}()},{key:"getCallCount",value:function(){var t=0;for(var n in e.CallList)g.info("getCallCount, callId = "+n),t++;return g.info("getCallCount, result = "+t),t}},{key:"getCallInfoByCallId",value:function(t){var n=e.CallList[t];return n?n.getCallInfo():{}}},{key:"newCallObject",value:function(t,n){if(e.CallList[t])g.info("already exist call object, callId = "+t);else{var a=e.getCallObject({call_id:t},n);a&&(e.CallList[t]=a),g.info("newCallObject, callId = "+t)}}},{key:"deleteCallObject",value:function(t){g.info("deleteCallObject, callId = "+t),e.CallList[t]&&delete e.CallList[t]}},{key:"openAudioPreview",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.openAudioPreview();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"closeAudioPreview",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.closeAudioPreview();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getMicLevel",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.getMicLevel();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"startData",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.abrupt("return",n.startData(t));case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"setVideoWindow",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){var r,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return r=e.sent,e.next=5,r.setVideoWindow(t,n,a);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"addSvcVideoWindow",value:function(t,n,a,r,o){var i=e.CallList[t];g.info("addSvcVideoWindow 参数: calid="+t+",window = "+n+",ssrc="+a+",width = "+r+",height = "+o),i?(i.addSvcVideoWindow(t,n,a,r,o),g.info("addSvcVideoWindow found call by call_id,window ="+n+",width = "+r+",height = "+o)):g.info("addSvcVideoWindow no found call by call_id = ")}},{key:"updateSvcVideoWindow",value:function(){function t(e,t,a,r,o){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r,o,i){var c;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=e.CallList[n],c?(c.updateSvcVideoWindow(n,a,r,o,i),g.info("updateSvcVideoWindow found call by call_id,width = "+o+",height = "+i+",window="+a+",ssrcId="+r)):g.info("updateSvcVideoWindow no found call by call_id = ");case 2:case"end":return t.stop()}},t,this)}));return t}()},{key:"removeSvcVideoWindow",value:function(){function t(e,t,a,r){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r,o){var i;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=e.CallList[n],i?(i.removeSvcVideoWindow(n,a,r,o),g.info("removeSvcVideoWindow found call by call_id = ")):g.info("removeSvcVideoWindow no found call by call_id = ");case 2:case"end":return t.stop()}},t,this)}));return t}()},{key:"resetBFCStatus",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=e.CallList[n],r?(r.resetBFCStatus(n,a),g.info("resetBFCStatus found call by call_id = ")):g.info("resetBFCStatus no found call by call_id = ");case 2:case"end":return t.stop()}},t,this)}));return t}()},{key:"svcRedistributeVideoTmmbr",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=e.CallList[n],a?(a.svcRedistributeVideoTmmbr(n),g.info("svcRedistributeVideoTmmbr found call by call_id = ")):g.info("svcRedistributeVideoTmmbr no found call by call_id = ");case 2:case"end":return t.stop()}},t,this)}));return t}()},{key:"setSvcLocalVideo",value:function(){function t(e,t,a){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r){var o,i;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r.getFrameFn=b.getLocalFrame,r.onSocketClose=e.onSvcSocketClose,r.resUpdateFn=e.resUpdateSvcLocalFn,r.canvas=a,o=e.getRemoteSvcRender(n),i=e.CallList[$getState().call.callId],o?(o.setViewWH(r.viewW,r.viewH,a),g.info("setSvcLocalVideo, video render is exist,canvasId = "+a.id)):(o=new TUPRender2(r),g.info("setSvcLocalVideo,create a new video render,canvasId = "+a.id)),t.abrupt("return",o);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"setSvcRemoteVideo",value:function(){function t(e,t,a){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a,r){var o,i,c,l,s,u,f,p;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.ssrc=n,r.getFrameFn=b.getSVCFrame,r.onSocketClose=e.onSvcSocketClose,r.resUpdateFn=e.resUpdateSvcRemoteFn,r.canvas=a,o=320,i=180,c=0,(0===$getState().conf.svcViewMode||2===$getState().conf.svcViewMode)&&r.viewH>70?(o=1280,i=720,c=window.CLIENTCONFIG.SVC_SHARPENING_SWITCH?1:0):(l=coreConf.SvcAttendanceManager.getSmallWatchAttendeeSize(),o=l.width,i=l.height),s=e.getRemoteSvcRender(n),u=$getState().call.callId,s){t.next=22;break}if(s=new TUPRender2(r),g.info("[SVC TupRender2]setSvcRemoteVideo,create a new video render,ssrc is "+n+",canvasId= "+a.id),!u){t.next=19;break}return t.next=17,new coreTup.HWTupCall;case 17:f=t.sent,f.addSvcVideoWindow(u,0,n,o,i,c);case 19:g.info("setSvcRemoteVideo,addSvcVideoWindow,ssrc is "+n+", width is "+o+", height is "+i),t.next=31;break;case 22:if(g.info("[SVC TupRender2]setSvcRemoteVideo, video render is exist, ssrc is "+n+",option.viewW = "+r.viewW+",option.viewH is "+r.viewH+",canvasId= "+s.canvas.id),s.setViewWH(r.viewW,r.viewH,a),g.info("[SVC TupRender2]setSvcRemoteVideo, video render is exist, canvasId = "+a.id),!u){t.next=30;break}return t.next=28,new coreTup.HWTupCall;case 28:p=t.sent,p.updateSvcVideoWindow(u,0,n,o,i,c);case 30:g.info("setSvcRemoteVideo, updateSvcVideoWindow, ssrc is "+n+", width = "+o+", height = "+i);case 31:return t.abrupt("return",s);case 32:case"end":return t.stop()}},t,this)}));return t}()},{key:"setSvcBFCPVideo",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:g.info("setSvcBFCPVideo <video>set bfcp render"),a.resUpdateFn=e.resUpdateBFCPFn,a.getFrameFn=b.getDataFrame,a.onSocketClose=e.onSvcBFCPSocketClose,a.canvas=n,k?(k.setViewWH(a.viewW,a.viewH,n),g.info("setSvcBFCPVideo <video>bfcp render is exist")):(k=new TUPRender2(a),g.info("setSvcBFCPVideo,create a data render")),coreCommon.Observer.publish("SVCBFCPWHSTYLE",a);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"closeSvcRemoteSocket",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r,o,i,c,l;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(g.info("[SVC TupRender2]closeSvcRemoteSocket,renderID = "+n),a=e.getRemoteSvcRender(n),r=$getState().call.callId,!a||!r){t.next=11;break}if(a.wsocket?a.closeSocket():g.info("[SVC TupRender2]closeSvcRemoteSocket,wsocket is null,render id = ",n),-1===n){t.next=11;break}return b.releaseSVC(Number(n)),t.next=9,new coreTup.HWTupCall;case 9:o=t.sent,o.removeSvcVideoWindow(r,0,n,!1);case 11:if(r){for(i=new Array,c=$getState().conf.svcRenders,l=0;l<c.length;l++)c[l].ssrc!==n&&i.push(c[l]);e.handleUpdateSvcRender(i)}case 12:case"end":return t.stop()}},t,this)}));return t}()},{key:"closeAllSvcRemoteSocket",value:function(){function t(){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(){var n,a,r,o,i;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=$getState().conf.svcRenders,t.next=3,new coreTup.HWTupCall;case 3:a=t.sent,r=$getState().call.callId,g.info("[SVC TupRender2]closeAllSvcRemoteSocket,svcRenders length is ",n.length),o=0;case 7:if(!(o<n.length)){t.next=19;break}if(!n[o].render||!r){t.next=16;break}if(n[o].render.wsocket?(g.info("[SVC TupRender2]closeAllSvcRemoteSocket,render id = ",n[o].ssrc),n[o].render.closeSocket()):g.info("[SVC TupRender2]closeAllSvcRemoteSocket,wsocket is null,render id = ",o),-1===n[o].ssrc){t.next=16;break}return b.releaseSVC(Number(n[o].ssrc)),t.next=14,new coreTup.HWTupCall;case 14:i=t.sent,i.removeSvcVideoWindow(r,0,n[o].ssrc,!1);case 16:o++,t.next=7;break;case 19:r&&e.handleUpdateSvcRender([]),g.info("<video> close local socket"),N&&N.closeSocket(),N=null,T&&T.closeSocket(),T=null;case 25:case"end":return t.stop()}},t,this)}));return t}()},{key:"closeSvcDataSocket",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("<video> close svc data socket"),k&&k.closeSocket(),k=null;case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"getCameraCtrl",value:function(t){var n=e.CallList[t];return n?n.getCameraCtrl():(g.error("getCameraCtrl,no found call by callId = "+t),null)}},{key:"getMicCtrl",value:function(t){var n=e.CallList[t];return n?n.getMicCtrl():(g.error("getMicCtrl,no found call by callId = "+t),null)}},{key:"getSpkCtrl",value:function(t){var n=e.CallList[t];return n?n.getSpkCtrl():(g.error("getSpkCtrl,no found call by callId = "+t),null)}},{key:"clearAllDeviceCtrl",value:function(t){var n=e.CallList[t];return n?n.clearAllDeviceCtrl():(g.error("clearAllDeviceCtrl,no found call by callId = "+t),null)}},{key:"setCntOfSpeechLevel",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n,a){var r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=e.CallList[n],r?r.cntOfSpeech=(0,s.default)(r.cntOfSpeech,a):g.error("setCntOfSpeechLevel,no found call by callId = "+n);case 2:case"end":return t.stop()}},t,this)}));return t}()},{key:"getCntOfSpeechLevel",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a=e.CallList[n])){t.next=5;break}return t.abrupt("return",a.cntOfSpeech);case 5:return g.error("getCntOfSpeechLevel,no found call by callId = "+n),t.abrupt("return",null);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"makePair",value:function(){function e(e,n,a,r,o){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a,r,o){var i,c;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return i=e.sent,e.next=5,i.makePair(t,n,a,r,o);case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"cancelPair",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.cancelPair(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairSubscribe",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.pairSubscribe(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairLinkage",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){var r,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return r=e.sent,e.next=5,r.pairLinkage(t,n,a);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairLinkageLeave",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.pairLinkageLeave(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairLinkageEnd",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.pairLinkageEnd(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairEnable",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.pairEnable(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pairPermit",value:function(){function e(e,n,a,r,o,i,c,l){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a,r,o,i,c,l){var s,u;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return s=e.sent,e.next=5,s.pairPermit(t,n,a,r,o,i,c,l);case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setTUPCallCfg",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.setTUPCallCfg(t);case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"callJointStartLinkage",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.callJointStartLinkage();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"callJointStopLinkage",value:function(){function e(){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(){var t,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.callJointStopLinkage();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"sendUniversalInfo",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n){var a,r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.sendUniversalInfo(t,n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"createCallId",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a){var r,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return r=e.sent,e.next=5,r.createCallId(t,n,a);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"pointPickupEx",value:function(){function e(e,n,a,r){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a,r){var o,i;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return o=e.sent,e.next=5,o.pointPickupEx(t,n,a,r);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"groupPickupEx",value:function(){function e(e,n,a,r){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t,n,a,r){var o,i;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return o=e.sent,e.next=5,o.groupPickupEx(t,n,a,r);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getBasicCallInfoNew",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("[IT-meeting] getBasicCallInfoNew isGettingBasicCallInfo = "+x);case 1:if(!x){e.next=6;break}return e.next=4,sleep(300);case 4:e.next=1;break;case 6:return x=!0,e.next=9,new coreTup.HWTupCall;case 9:return n=e.sent,e.next=12,n.getBasicCallInfo(t);case 12:return a=e.sent,g.info("[IT-meeting] getBasicCallInfoNew getBasicCallInfo,res = "+a),x=!1,e.abrupt("return",a);case 16:case"end":return e.stop()}},e,this)}));return e}()}],[{key:"handleUniversalInfoNotify",value:function(e){g.info("handleUniversalInfoNotify"),coreCommon.Observer.publish("handleUniversalInfoNotify",e.param)}},{key:"handlePassiveDirectionResult",value:function(e){if(!1===$getState().conf.isAudience)return void g.info("you are not an audience");coreCommon.Observer.publish("PassiveDirectionResult",e)}},{key:"handleAudioNoStreamLeaveConf",value:function(e){g.info("[IT-Meeting] meeting audio no stream to leave conference."),coreConf.actionLeaveConf(!0)}},{key:"handlesetVideoIdxRet",value:function(e){g.info("handlesetVideoIdxRet."),coreCommon.Observer.publish("handlesetVideoIdxRet",e.param)}},{key:"handleSpkMicList",value:function(e){g.info("handleSpkMicList. status: ",e),coreCommon.Observer.publish("HandleSpkMicList",e.param)}},{key:"handleCameraList",value:function(e){g.info("handleCameraList. status: ",e),coreCommon.Observer.publish("HandleCameraList",e.param)}},{key:"handleUploadChrFile",value:function(e){g.info("handleUploadChrFile. status: "+(0,c.default)(e)),coreCommon.Observer.publish("handleUploadChrFile",e.param)}},{key:"handleSpeechLevelReport",value:function(e){}},{key:"onLocalSocketClose",value:function(){g.info("local socket close ,set local render null"),N=null}},{key:"onRemoteSocketClose",value:function(){g.info("Remote socket close ,set local render null"),E=null}},{key:"onBFCPSocketClose",value:function(){g.info("BFCP socket close ,set local render null"),T=null}},{key:"resUpdateBFCPFn",value:function(e,t,n,a){var r={};r.width=n||e,r.height=a||t,$getState().conf.isSvcConf&&(r.width=e||n,r.height=t||a),r.videoWinMode=2,g.info("<video> resUpdateBFCPFn,videoWH= ",(0,c.default)(r)),coreCommon.Observer.publish("VideoWHGet",r)}},{key:"resUpdateLocalFn",value:function(e,t,n,a){var r={};r.width=n||e,r.height=a||t,r.videoWinMode=0,r.ssrc=-1,g.info("<video> handleVideoWHGet,videoWH= ",(0,c.default)(r)),coreCommon.Observer.publish("VideoWHGet",r)}},{key:"resUpdateRemoteFn",value:function(e,t,n,a){var r={};if(r.width=n||e,r.height=a||t,r.videoWinMode=1,g.info("<video> handleVideoWHGet,videoWH= ",(0,c.default)(r)),$getState().conf.isSvcConf)return void g.info("<video>resUpdateRemoteFn,isSvcConf,do nothing,return");coreCommon.Observer.publish("VideoWHGet",r)}},{key:"resUpdateSvcLocalFn",value:function(e,t,n,a,r){var o={};o.width=e||n,o.height=t||a,o.videoWinMode=0,o.ssrc=-1,g.info("<video> handleVideoWHGet,ssrc = "+r+" videoWH= "+(0,c.default)(o)),coreCommon.Observer.publish("VideoWHGet",o)}},{key:"resUpdateSvcRemoteFn",value:function(e,t,n,a,r){var o={};o.width=e||n,o.height=t||a,o.videoWinMode=1,o.ssrc=r,g.info("<video> handleVideoWHGet,ssrc = "+r+" videoWH= "+(0,c.default)(o)),coreCommon.Observer.publish("VideoWHGet",o)}},{key:"handleUpdateSvcRender",value:function(e){coreCommon.Observer.publish("updateSvcRender",e),g.info("handleUpdateSvcRender")}},{key:"handleSipRegResult",value:function(e){coreCommon.Observer.publish("SipRegResultNotify",e)}},{key:"handleCallEnded",value:function(t){var n=e.CallList[t.param.call_id];if(window.endCallPromise&&window.endCallPromise.resolve(),window.CLIENTCONFIG.ISBIGWIN){var a=$getState().call;"CALL_OUT"!==a.callStatus&&"VIDEO_OUT"!==a.callStatus||$getState().bigwinBuried.buried.postHasSent||(coreCommon.BigwinObserver.publish("OnJoinConfFailed"),coreCommon.BigwinObserver.publish("OnChangeHasSent",!0))}n?(n.handleCallEnded(t),delete e.CallList[t.param.call_id],g.info("handleCallEnded found call by callId = "+t.param.call_id)):g.info("handleCallEnded no found call by call_id = "+t.param.call_id)}},{key:"handleCallDestroy",value:function(t){g.info("handleCallDestroy  callId: "+t.param.call_id);var n=e.CallList[t.param.call_id];n?(n.handleCallDestroy(t),delete e.CallList[t.param.call_id]):g.info("handleCallDestroy no found call by call_id = "+t.param.call_id)}},{key:"handleCallRingBack",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallRingBack(t),g.info("handleCallRingBack found call by call_id = "+t.param.call_id)):g.info("handleCallRingBack no found call by call_id = "+t.param.call_id)}},{key:"handleCallLocalQos",value:function(t){var n=e.countCallQos(t.param.netquality_change.net_level);coreCommon.Observer.publish("CallLocalQos",n)}},{key:"handleBFCPDataBeginRec",value:function(e){g.info("handleBFCPDataBeginRec notify param : ",e),coreCommon.Observer.publish("BFCPDataBeginRec",e)}},{key:"handleBFCPFrameSizeChange",value:function(e){g.info("handleBFCPFrameSizeChange notify param : ",e),coreCommon.Observer.publish("BFCPFrameSizeChange",e)}},{key:"handleBFCPDataStop",value:function(e){g.info("handleBFCPDataStop notify param : ",e),coreCommon.Observer.publish("BFCPDataStopRec",!1,e)}},{key:"handlePlayMedia",value:function(e){var t=e.param.play_handle;g.info("handlePlayMedia play_handle = ",t),coreCommon.Observer.publish("PlayMediaHandle",t)}},{key:"handleLowVideoBW",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleLowVideoBW(t),g.info("handleLowVideoBW found call by call_id = "+t.param.call_id)):g.info("handleLowVideoBW no found call by call_id = "+t.param.call_id)}},{key:"handleDeviceHowlStatus",value:function(e){g.info("handleDeviceHowlStatus. howlstatus ",e),coreCommon.Observer.publish("DeviceHowlStatus",e.param)}},{key:"handleMediaSRTPStatus",value:function(e){g.info("handleMediaSRTPStatus. status: ",e),coreCommon.Observer.publish("MediaSRTPStatus",e.param)}},{key:"handleIsKickOff",value:function(e){g.info("handleSipKickOff",e),coreCommon.Observer.publish("handleSipKickOff",e)}},{key:"handleDataStartError",value:function(e){g.info("handleDataStartError",e),coreCommon.Observer.publish("handleDataStartError",e)}},{key:"handleDataSending",value:function(e){g.info("handleDataSending",e),coreCommon.Observer.publish("handleDataSending",e)}},{key:"countCallQos",value:function(e){if(coreConf.isInConf())return void g.info("countCallQos isInConf return");var t=0;return t=e>2.8?5:e>2.4?4:e>2?3:e>1.6?2:1,e<=2.4?(y+=1)>=3&&coreCommon.Observer.publish("lowCallLocalQos",y):(y>=3&&coreCommon.Observer.publish("lowCallLocalQos",0),y=0),t}},{key:"handleCallIncomming",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r,o;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(g.info("handleCallIncomming callId: "+n.param.call_id),g.info("before callInfo "+handlePhoneNumber(n.param.domain_ip)),!coreConf.isInConf()){t.next=13;break}if(g.info("handleCallIncomming already exist conf,end this call"),!(n&&n.param&&n.param.call_id)){t.next=12;break}return t.next=7,new coreTup.HWTupCall;case 7:return a=t.sent,t.next=10,a.endCall(n.param.call_id);case 10:r=t.sent,0===r.result?g.info("handleCallIncomming end call success"):g.info("handleCallIncomming end call failed");case 12:return t.abrupt("return");case 13:/[@]/.test(n.param.domain_ip)&&/[a-zA-Z]/.test(n.param.tel_num)&&(n.param.tel_num=n.param.domain_ip),g.info("after callInfo "+handlePhoneNumber(n.param.domain_ip)),o=e.getCallObject(n.param,n.param.call_type),o.callInfo.callType=n.param.call_type,e.CallList[n.param.call_id]=o,o.handleCallIncomming(n);case 19:case"end":return t.stop()}},t,this)}));return t}()},{key:"handleCallConnected",value:function(t){var n=e.CallList[t.param.call_id];if(g.info("debug info turnV handleCallConnected outer"),n.callInfo.callType!==t.param.call_type){g.info("debug info turnV handleCallConnected inner");var a=1===t.param.call_type,r=e.getCallObject({call_id:t.param.call_id},a);r.callInfo.callNo=n.callInfo.callNo,r.callInfo.callId=n.callInfo.callId,r.callInfo.callType=t.param.call_type,r.callInfo.callState=t.param.call_state,r.callInfo.callee=n.callInfo.callee,r.callInfo.ucaccount=n.callInfo.ucaccount,r.callInfo.isVideo=a,r.callInfo.callInOut=n.callInfo.callInOut,r.callInfo.isCallSuccess=n.callInfo.isCallSuccess,r.callInfo.milltime=n.callInfo.milltime,r.callInfo.startTime=n.callInfo.startTime,r.callInfo.date=n.callInfo.date,r.callInfo.remoteAddr=t.param.remote_addr,delete e.CallList[t.param.call_id],e.CallList[t.param.call_id]=r,n=r}n?(n.handleCallConnected(t),g.info("handleCallConnected found call by callId = "+t.param.call_id)):g.info("handleCallConnected no found call by callId = "+t.param.call_id)}},{key:"handleCallRTPCreated",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallRTPCreated(t),g.info("handleCallRTPCreated found call by callId = "+t.param.call_id)):g.info("handleCallRTPCreated no found call by callId = "+t.param.call_id)}},{key:"handleCallHoldSuccess",value:function(t){g.info("handleCallHoldSuccess callId = "+t.param.call_id);var n=e.CallList[t.param.call_id];n?n.handleCallHoldSuccess(t):g.info("handleCallHoldSuccess no found call by callId = "+t.param.call_id)}},{key:"handleCallHoldFailed",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallHoldFailed(t),g.info("handleCallHoldFailed found call by callId = "+t.param.call_id)):g.info("handleCallHoldFailed no found call by callId = "+t.param.call_id)}},{key:"handleCallUnHoldSuccess",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallUnHoldSuccess(t),g.info("handleCallUnHoldSuccess found call by callId = "+t.param.call_id)):g.info("handleCallUnHoldSuccess no found call by callId = "+t.param.call_id)}},{key:"handleCallUnHoldFailed",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallUnHoldFailed(t),g.info("handleCallUnHoldFailed found call by callId = "+t.param.call_id)):g.info("handleCallUnHoldFailed no found call by callId = "+t.param.call_id)}},{key:"handleCallDivertFailed",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallDivertFailed(t),g.info("handleCallDivertFailed found call by callId = "+t.param.call_id)):g.info("handleCallDivertFailed no found call by callId = "+t.param.call_id)}},{key:"handleCallBldTransferFailed",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallBldTransferFailed(t),g.info("handleCallBldTransferFailed found call by callId = "+t.param.call_id)):g.info("handleCallBldTransferFailed no found call by callId = "+t.param.call_id)}},{key:"handleCallBldTransferSuccess",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallBldTransferSuccess(t),g.info("handleCallBldTransferSuccess found call by call_id = "+t.param.call_id)):g.info("handleCallBldTransferSuccess no found call by call_id = "+t.param.call_id)}},{key:"handleCallModifyVideoResult",value:function(t){var n=e.CallList[t.param.call_id];n?(g.info("handleCallModifyVideoResult found call by call_id = "+n.callInfo.callId),n.handleCallModifyVideoResult(t)):g.info("handleCallModifyVideoResult no found call by call_id ")}},{key:"handleCallSessionModify",value:function(t){var n=e.CallList[t.param.call_id];if(g.info("handleCall[Session]Modify audio_send_mode: "+t.param.audio_send_mode+" data_send_mode: "+t.param.data_send_mode),n){if(g.info("handleCall[Session]Modify: callInfo "+n.callInfo.callType),2===t.param.audio_send_mode&&0===t.param.video_send_mode&&0===n.callInfo.callType)return g.info("handleCall[Session]Modify audio_send_mode = "+t.param.audio_send_mode),void coreCommon.Observer.publish("setTransferModify",t.param);if(4===t.param.audio_send_mode&&0===t.param.video_send_mode&&0===n.callInfo.callType)return g.info("handleCall[Session]Modify audio_send_mode = "+t.param.audio_send_mode),void coreCommon.Observer.publish("setTransferModify",t.param);if(0===n.callInfo.isFocus&&4===t.param.video_send_mode&&4===t.param.audio_send_mode&&1===t.param.is_focus&&(g.info("handleCall[Session]Modify set conf to video"),coreCommon.Observer.publish("beTransferToConfToVideo",t.param),!window.CLIENTCONFIG.ENABLE_IT_MEETING))return;var a=0;if(4===t.param.video_send_mode&&0===n.callInfo.callType)a=1;else{if(0!==t.param.video_send_mode||1!==n.callInfo.callType||4!==t.param.audio_send_mode)return void g.info("handleCall[Session]Modify, not update to video, return, video_send_mode ="+t.param.video_send_mode+"oldCallType = "+n.callInfo.callType);a=0}var r={call_id:t.param.call_id,tel_num:n.callInfo.callNo,call_type:a,call_state:n.callInfo.callState,callInOut:n.callInfo.callInOut,isCallSuccess:n.callInfo.isCallSuccess,milltime:n.callInfo.milltime,startTime:n.callInfo.startTime,date:n.callInfo.date};delete e.CallList[n.callInfo.callId];var o=e.getCallObject(r,a);e.CallList[o.callInfo.callId]=o,o.handleCallSessionModify(t),g.info("handleCallModifyVideoResult found call by call_id = "+t.param.call_id)}else g.info("handleCallModifyVideoResult no found call by call_id = "+t.param.call_id)}},{key:"handleMicVolChange",value:function(e){coreCommon.Observer.publish("CallMicVolChange",e),g.info("handleMicVolChange, CallMicVolChange = ",e)}},{key:"handleSpkMuteChange",value:function(e){coreCommon.Observer.publish("SpkMuteChange",e),g.info("SpkMuteChange, SpkMute = ",e)}},{key:"handleSpkVolChange",value:function(e){coreCommon.Observer.publish("CallSpkVolChange",e),g.info("handleSpkVolChange, CallSpkVolChange = ",e)}},{key:"handleCallAddVideo",value:function(){function t(e){return n.apply(this,arguments)}var n=(0,p.default)(d.default.mark(function t(n){var a,r;return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getBasicCallInfo(n.param.call_id);case 2:if(!(a=t.sent)){t.next=7;break}return g.info("AddVideoRequest"),coreCommon.Observer.publish("AddVideoRequest",n.param),t.abrupt("return");case 7:r=e.CallList[n.param.call_id],r?(r.handleCallAddVideo(n),g.info("handleCallAddVideo found call by call_id = ")):g.info("handleCallAddVideo no found call by call_id = ");case 9:case"end":return t.stop()}},t,this)}));return t}()},{key:"handleCallSocketClose",value:function(){}},{key:"handleCallDelVideo",value:function(t){var n=e.CallList[t.param.call_id];n?(n.handleCallDelVideo(t),g.info("handleCallDelVideo found call by call_id = ")):g.info("handleCallDelVideo no found call by call_id = ")}},{key:"handleVideoRefreshView",value:function(e){g.info("<video> handleVideoRefreshView,data.param= ",e.param),coreCommon.Observer.publish("VideoRefreshView",e.param)}},{key:"handleVideoDecodeSuccess",value:function(t){var n=e.CallList[t.param.call_id];n?(2===t.param.media_type?n.handleVideoDecodeSuccess(t):3===t.param.media_type&&n.handleBfcpDecodeSuccess(t.param.call_id),g.info("handleVideoDecodeSuccess found call by call_id = ")):g.info("handleVideoDecodeSuccess no found call by call_id = ")}},{key:"handleMobileRouteChange",value:function(e){coreCommon.Observer.publish("MobileRouteChange",e.param),g.info("handleMobileRouteChange MobileRouteChange = ",e)}},{key:"handleAudioFileEnd",value:function(e){"function"==typeof window.notifyAudioFileEnd&&(g.info("handleAudioFileEnd = ",e),window.notifyAudioFileEnd(e.param.handle))}},{key:"handleCallAtdTransferSuccess",value:function(e){coreCommon.Observer.publish("CallAtdTransferSuccess",e.param),g.info("handleCallAtdTransferSuccess CallAtdTransferSuccess = "+e.param)}},{key:"handleCallAtdTransferFailed",value:function(e){coreCommon.Observer.publish("CallAtdTransferFailed",e.param),g.info("handleCallAtdTransferFailed CallAtdTransferFailed = "+e.param)}},{key:"handleSipAccountWmi",value:function(e){coreCommon.Observer.publish("SipAccountWmi",e.param),g.info("handleSipAccountWmi SipAccountWmi = ")}},{key:"getCallObject",value:function(e,t){return t?(g.info("getCallObject isVideo "),new _.default(e)):(g.info("getCallObject not isVideo"),new I.default(e))}},{key:"getRemoteSvcRender",value:function(e){for(var t=$getState().conf.svcRenders,n=0;n<t.length;n++)if(t[n].ssrc===e)return g.info("getRemoteSvcRender, has found render by renderID = "+e+",render = "+t[n].render),t[n].render;return g.info("getRemoteSvcRender, do not found render by renderID = ",e),null}},{key:"onSvcBFCPSocketClose",value:function(){g.info("svc BFCP socket close ,set svcBfcpR null"),k=null}},{key:"onSvcSocketClose",value:function(){g.info("Svc socket closed")}},{key:"receivePairReqNotify",value:function(e){g.info("receivePairReqNotify"),coreCommon.Observer.publish("receivePairReqNotify",e.param)}},{key:"pairedOrCanceledResultNotify",value:function(e){g.info("pairedOrCanceledResultNotify"),coreCommon.Observer.publish("pairedOrCanceledResultNotify",e.param)}},{key:"pairClosedNotify",value:function(e){g.info("pairClosedNotify, data: ",e),coreCommon.Observer.publish("pairClosedNotify",e.param)}},{key:"pairSubscribeNotify",value:function(e){g.info("pairSubscribeNotify, data: ",e),coreCommon.Observer.publish("pairSubscribeNotify",e.param)}},{key:"pairCallStateNotify",value:function(e){g.info("pairCallStateNotify, data: ",e),coreCommon.Observer.publish("pairCallStateNotify",e.param)}},{key:"pairLinkageConfNotify",value:function(e){g.info("pairLinkageConfNotify, data: ",e),coreCommon.Observer.publish("pairLinkageConfNotify",e.param)}},{key:"pairLinkageConfStateNotify",value:function(e){g.info("pairLinkageConfStateNotify, data: ",e),coreCommon.Observer.publish("pairLinkageConfStateNotify",e.param)}},{key:"handleNewServiceRight",value:function(e){g.info("handleNewServiceRight"),coreCommon.Observer.publish("newServiceRightNotify",e.param)}},{key:"handleCallUpateRemoteInfo",value:function(t){g.info("handleCallUpateRemoteInfo callId: "+t.param.call_id);var n=e.CallList[t.param.call_id];n&&""!==t.param.domain_ip?(n.handleCallUpateRemoteInfo(t),g.info("handleCallUpateRemoteInfo found call by call_id = "+t.param.call_id)):g.info("handleCallUpateRemoteInfo no found call by call_id = "+t.param.call_id)}},{key:"handleCallJointStartNotify",value:function(e){g.info("handleCallJointStartNotify, data: ",e),coreCommon.Observer.publish("callJointStartNotify",e.param)}},{key:"handleCallJointCloseNotify",value:function(e){g.info("handleCallJointCloseNotify, data: ",e),coreCommon.Observer.publish("callJointCloseNotify",e.param)}},{key:"handleCallJointOnlineNotify",value:function(e){g.info("handleCallJointOnlineNotify, data: ",e),coreCommon.Observer.publish("callJointOnlineNotify",e.param)}},{key:"handleCallJointOffLineNotify",value:function(e){g.info("handleCallJointOffLineNotify, data: ",e),coreCommon.Observer.publish("callJointOffLineNotify",e.param)}},{key:"handleCallJointOffHookNotify",value:function(e){g.info("handleCallJointOffHookNotify, data: ",e),coreCommon.Observer.publish("callJointOffHookNotify",e.param)}},{key:"handleCallJointOutGoingNotify",value:function(e){g.info("handleCallJointOutGoingNotify, data: ",e),coreCommon.Observer.publish("callJointOutGoingNotify",e.param)}},{key:"handleCallJointEstablishedNotify",value:function(e){g.info("handleCallJointEstablishedNotify, data: ",e),coreCommon.Observer.publish("callJointEstablishedNotify",e.param)}},{key:"handleCallJointPeerCapsReportNotify",value:function(e){g.info("handleCallJointPeerCapsReportNotify, data: ",e),coreCommon.Observer.publish("callJointPeerCapsReportNotify",e.param)}},{key:"handleCallPickupNotify",value:function(e){g.info("handleCallPickupNotify, data: ",e),coreCommon.Observer.publish("handleCallPickupNotify",e.param)}},{key:"handleCallPickupRemoteInfo",value:function(e){g.info("handleCallPickupRemoteInfo, data: ",e),coreCommon.Observer.publish("handleCallPickupRemoteInfo",e.param)}},{key:"getBasicCallInfo",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(d.default.mark(function e(t){var n,a,r,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,a={callid:t,infoid:0},e.next=4,new coreTup.HWTupCall;case 4:return r=e.sent,e.next=7,r.getBasicCallInfo(a);case 7:return o=e.sent,0===o.result&&(n=o.param.call_info.conf_media_type),e.abrupt("return",n);case 10:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),r.CallList={},r.handleNoStream=function(e){coreCommon.Observer.publish("handleNoStream",e.params)},o);t.default=O},1003:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(1),o=a(r),i=n(2),c=a(i),l=n(117),s=a(l),u=n(4),d=a(u),f=n(5),p=a(f),h=n(118),v=a(h),m=n(119),C=a(m),w=n(878),I=a(w),S=window.Logger("model")("model/callService/videoCallService"),_=function(e){function t(e){(0,d.default)(this,t);var n=(0,v.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return n.callInfo.isVideo=!0,e?n:(S.error("can not create VideoCallService object"),(0,v.default)(n))}return(0,C.default)(t,e),(0,p.default)(t,[{key:"acceptCall",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n,a,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,S.info("<video> acceptCall,callId = ",this.callInfo.callId),n=!r,e.next=7,t.acceptCall(this.callInfo.callId,n);case 7:if((a=e.sent)&&0===a.result){e.next=13;break}S.error("<video>accept call failed, result = ",a),coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_ACCEPTCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),a.result]}),e.next=18;break;case 13:return this.setDeviceControlCallId(this.callInfo.callId),e.next=16,coreCommon.CameraControl.getInstance().initAfterGetCallId();case 16:coreCommon.SpkControl.getInstance().cancelSysSpkMute(),n&&!window.otherAudioDevicesConnect?coreCommon.SpkControl.getInstance().setHandsFree(!0):coreCommon.SpkControl.getInstance().setHandsFree(!1);case 18:case"end":return e.stop()}},e,this)}));return e}()},{key:"setCaptureRotation",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n,a){var r,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return r=e.sent,e.next=5,r.setCaptureRotation(t,n,a);case 5:return i=e.sent,0===i.result?S.info("set Capture Rotation success"):S.info("set Capture Rotation failed, result = "+i.result),e.abrupt("return",i);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setDisplayRotation",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n,a){var r,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return r=e.sent,e.next=5,r.setDisplayRotation(t,n,a);case 5:return i=e.sent,0===i.result?S.info("set Display Rotation success"):S.info("set Display Rotation failed, result = "+i.result),e.abrupt("return",i);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setVideoCollectMode",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n){var a,r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.setVideoCollectMode(t,n);case 5:return r=e.sent,0===r.result?S.info("set Video CollectMode success"):S.info("set Video CollectMode failed, result = "+r.result),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"setVideoRender",value:function(){function e(e,n,a,r,o){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(t,n,a,r,i){var c,l;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return c=e.sent,e.next=5,c.setVideoRender(t,n,a,r,i);case 5:l=e.sent;case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"delVideo",value:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return t=e.sent,e.next=5,t.delVideo(this.callInfo.callId);case 5:return n=e.sent,0===n.result?(coreCommon.SpkControl.getInstance().setHandsFree(!1),S.info("delete video success")):S.info("delete video failed, result = "+n.result),e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleVideoRefreshView",value:function(e){S.info("<video> handleVideoRefreshView,data.param= ",e.param),coreCommon.Observer.publish("VideoRefreshView",e.param)}},{key:"handleVideoDecodeSuccess",value:function(e){S.info("<video> handleVideoDecodeSuccess,data.param= ",e.param),coreCommon.Observer.publish("VideoDecodeSuccess",e.param)}},{key:"handleBfcpDecodeSuccess",value:function(e){S.info("<video> handleBfcpDecodeSuccess callID: ",e),coreCommon.Observer.publish("BFCPDecodeSuc",e,!1)}}]),t}(I.default);t.default=_},1004:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.callPermissionCheck=t.createVideoPreCheck=t.handleSvcWatchIndNotify=t.checkIsSupportWebgl=t.closeAllVideoSocket=t.handleLowVideoBWNotify=t.getBigContainerSize=t.changeBigContainerSize=t.changeScreenState=t.changeFullScreenReceiveShare=t.exitFullScreen=t.toFullScreen=t.setCurrentVideoWinForMode=t.exchangeSvcVideoWin=t.changeVideoWin=t.calcSmallWinPos=t.calcRealVideoSize=t.calcVideoSize=t.switchMobileVideoFullScreen=t.changeFullScreen=t.pcHandup=t.mlockConf=t.switchPIPMode=t.openOrOffCamera=t.resumeScreenStateWhenCallOrConfEnd=t.changeIsToolBarEnter=t.changeIsShowToolBar=t.handleSVCBFCPWHSTYLE=t.handlesetVideoIdxRet=t.registerVideoEvent=t.DoCloseSmallWin=void 0;var r=n(3),o=a(r),i=n(121),c=a(i),l=n(67),s=a(l),u=n(134),d=a(u),f=n(1),p=a(f),h=n(2),v=a(h),m=n(879),C=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(m),w=n(1782),I=window.Logger("logic")("video/index"),S=0,_=0,g=/M\d+T0/,b=!1,N=(t.DoCloseSmallWin=function(){var e=(0,v.default)(p.default.mark(function e(){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.CloseSmallWinAction()),I.info("dispatch,CloseSmallWinAction,no value");case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.registerVideoEvent=function(){I.info("registerVideoEvent, Observer subscribe topics"),coreCommon.Observer.subscribe("VideoWHGet",V),coreCommon.Observer.subscribe("VideoRefreshView",U),coreCommon.Observer.subscribe("VideoDecodeSuccess",B),coreCommon.Observer.subscribe("BFCPDecodeSuc",P),coreCommon.Observer.subscribe("BFCPDataStopRec",$),coreCommon.Observer.subscribe("SVCBFCPWHSTYLE",E),coreCommon.Observer.subscribe("BFCPDataBeginRec",G),coreCommon.Observer.subscribe("BFCPFrameSizeChange",W),coreCommon.Observer.subscribe("LowVideoBW",J),coreCommon.Observer.subscribe("handleSvcWatchInd",ne),coreCommon.Observer.subscribe("handlesetVideoIdxRet",N)},t.handlesetVideoIdxRet=function(){var e=(0,v.default)(p.default.mark(function e(t){var n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("handlesetVideoIdxRet media_type"+t.media_type+"error_type"+t.error_type),2===t.media_type&&1===t.error_type?window.CLIENTCONFIG.ISMOBILE||(window.alert(language.SET_CAMERA_FAILED),n={msg_type:1},coreCommon.CameraControl.getInstance().switchCameraStateAction(!1)):1===t.media_type&&t.error_type;case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),E=t.handleSVCBFCPWHSTYLE=function(){var e=(0,v.default)(p.default.mark(function e(t){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($getState().conf.isSvcConf){e.next=2;break}return e.abrupt("return");case 2:I.info("handleSVCBFCPWHSTYLE= ",t.viewW,t.viewH),0===$getState().conf.svcViewMode&&$dispatch(coreUi.changeBigWinStyle({width:t.viewW,height:t.viewH,position:"absolute"}));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),T=(t.changeIsShowToolBar=function(){var e=(0,v.default)(p.default.mark(function e(t){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("changeIsShowToolBar,isShow = "+t),$dispatch(coreUi.changeToolBarShow(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.changeIsToolBarEnter=function(){var e=(0,v.default)(p.default.mark(function e(t){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("changeIsToolBarEnter,isShow = "+t),$dispatch(coreUi.changeToolBarEnter(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.resumeScreenStateWhenCallOrConfEnd=function(){var e=(0,v.default)(p.default.mark(function e(){var t;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=$getState().call.screenState,I.info("<video>resumeScreenStateWhenCallOrConfEnd,change screen state,screenStateNow = "+t),window.CLIENTCONFIG.ISBIGWIN?appService.hideWindow():"full"===t?M():"extra"===t?(delegate.resumeShow(!1),window.CLIENTCONFIG.ISMOBILE||delegate.winMinimize()):A("middle");case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.openOrOffCamera=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().call.isOpenCamera,a=$getState().call.callId,I.info("openOrOffCamera",t,"===",n),t===n){e.next=6;break}return I.error("Camera is",t?"OFF":"OPEN"),e.abrupt("return");case 6:coreCommon.CameraControl.getInstance().switchCameraStateAction(!t),window.CLIENTCONFIG.ISBIGWIN&&coreConf.NotifyLocalCameraStatus(0,!t);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.switchPIPMode=function(){var e=$getState().call.isOpenPIP;I.info("userClick  switchPIPMode isOpenPIP: "+e),window.switchLocalVideoState(!1,!e),window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&coreConf.itmeetingSmallWin(!e),$dispatch(coreUi.CloseOrOpenPIP(!e))},t.mlockConf=function(e){var t="lock"===e.action?1:0;I.info("mlockConf isLock: (1 locked 0 unlocked)"+t),coreConf.lockConfService(t)},t.pcHandup=function(){var e=$getState().conf.isHandup,t=e?0:1;I.info("userClick  pcHandup isHandup: (1 handup 0 unhandup)"+t);var n=$getState().conf.memberListInfo,a=T(n);I.info("pcHandup selfnum: (1 handup 0 unhandup)"+a),coreConf.handup(t,a)},function(e){var t=void 0,n=!0,a=!1,r=void 0;try{for(var o,i=(0,d.default)(e);!(n=(o=i.next()).done);n=!0){var c=o.value;if(c.is_self){t=c.number;break}}}catch(e){a=!0,r=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw r}}return t}),k=(t.changeFullScreen=function(){var e=(0,v.default)(p.default.mark(function e(){var t;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=$getState().call.screenState,I.info("<video> userClick  change screen state,screenStateNow = "+t),"min"===t?A("middle"):"middle"===t?(R(!0),L()):"full"===t?(R(!1),M()):delegate.resumeShow(!0);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.switchMobileVideoFullScreen=function(){var e=(0,v.default)(p.default.mark(function e(){var t,n,a,r,o,i,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().call.screenState,I.info("<video> userClick switchMobileVideoFullScreen = "+t+",screenMode :"+c),(0,w.hidePopoverMenu)(),c!==t){e.next=6;break}return I.info("<video> switchMobileVideoFullScreen same mode return"),e.abrupt("return");case 6:n="VIDEO_CONNECTED"===$getState().call.callStatus||"VIDEO_OUT"===$getState().call.callStatus,window.CLIENTCONFIG.ISMOBILE&&$getState().conf.isSvcConf&&window.changeScreenOrientation(constant.SCREEN_ORIENTATION.SCREEN_ORIENTATION_PORTRAIT),a=void 0===c?"min"!==t:"min"===c,a?($dispatch(coreUi.changeFullScreenState("min")),$getState().synergismInfo.inPairConf&&(n=!1),window.showCallViewFullScreen(!1,n)):(r=window.getRoute(),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==r?coreUi.hideModal():I.info("already call main view"),o=$getState().call.screenState,i=document.querySelector(".am-modal-mask"),"full"!==o&&i&&(window.dispatchEvent(new Event("closeModalAlert")),window.dispatchEvent(new Event("closeModalConfirm"))),$dispatch(coreUi.changeFullScreenState("full")),$getState().synergismInfo.inPairConf&&(n=!1),window.showCallViewFullScreen(!0,n));case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}());window.mobileChangeFullScreen=k,window.mobileBackToCallPage=function(){var e=window.getRoute();I.info("userClick  mobileBackToCallPage current page is: "+e);var t=$getState().call.callId;(0,w.hidePopoverMenu)(),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&"android"===window.CLIENTCONFIG.PLATFORM&&(I.info("[IT-Meeting] userClick mobileBackToCallPage closeTheWeImg"),window.closeTheWeImg()),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==e&&"mConfMemberPage"!==e&&!isNullOrEmpty(t)?(I.info("window.mobileBackToCallPage go to callmain"),window.goRoute("callMain"),coreUi.hideModal(),window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&$getState().synergismInfo.pairState===constant.PAIR_STATE.PAIR_SUCCESS&&coreConf.endPairWithPeripherals(language.PAIR_CLOSED)):I.info("already call main view"),window.CLIENTCONFIG.ISMOBILE&&"mConfMemberPage"===e&&window.changeScreenOrientation(1);var n=$getState().call.screenState,a=document.querySelector(".am-modal-mask");"full"!==n&&a&&(window.dispatchEvent(new Event("closeModalAlert")),window.dispatchEvent(new Event("closeModalConfirm"))),window.CLIENTCONFIG.ENABLE_IT_MEETING&&(window.delayCreateFloat&&clearTimeout(window.delayCreateFloat),window.showPageLoading(!1)),setTimeout(function(){$dispatch(coreUi.changeFullScreenState("full"))},1e3)},window.changeToSvcIosGoToPage=function(){var e=window.getRoute();I.info("userClick  changeToSvcIosPage current page is: "+e),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==e&&"mConfMemberPage"!==e?(I.info("go to callmain"),window.goRoute("callMain"),coreUi.hideModal()):I.info("already call main view");var t=$getState().call.screenState,n=document.querySelector(".am-modal-mask");"full"!==t&&n&&(window.dispatchEvent(new Event("closeModalAlert")),window.dispatchEvent(new Event("closeModalConfirm"))),$dispatch(coreUi.changeFullScreenState("full"));var a="VIDEO_CONNECTED"===$getState().call.callStatus||"VIDEO_OUT"===$getState().call.callStatus;$getState().synergismInfo.inPairConf&&(a=!1),window.showCallViewFullScreen(!0,a)};var y=t.calcVideoSize=function(e,t){var n=0;if($getState().conf.isSvcConf){if(0===$getState().conf.svcViewMode||2===$getState().conf.svcViewMode){var a=$getState().conf.ssrcRange,r=a.min+"_frame_share";n=coreConf.SvcAttendanceManager.calcCanvas16And9Size(e),I.info("calcVideoSize,big canvasSize is ",n),C.setSvcRemoteVideoRender(a.min,r,n)}}else n=x(e,t),1===e.videoWinMode?C.setVideoWH(!0,n):0===e.videoWinMode&&C.setVideoWH(!1,n);return n},x=t.calcRealVideoSize=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a={width:0,height:0};if(e&&t){var r=e.width/e.height,o=t.width,i=t.height;I.info("<video>calcVideoSize,oldsize width = "+e.width+",height = "+e.height+",containerSize width = "+t.width+",heigth = "+t.height);var c=Math.floor(o/r),l=Math.floor(i*r),u=Math.floor((i-c)/2),d=Math.floor((o-l)/2);r>1&&u>0||r<1&&d<0?(a=n?{width:o,height:c,top:u}:{width:o,height:c},I.info("<video>newSize = ",(0,s.default)(a))):(a={width:l,height:i},I.info("<video>newSize = ",(0,s.default)(a)))}return t||I.warn("<video>containerSize is null"),a},O=(t.calcSmallWinPos=function(e,t,n,a){var r={newDragTopX:e,newDragTopY:t};if(void 0!==e&&void 0!==t&&void 0!==n&&void 0!==a){var o=e;n.clientWidth,a.clientWidth,n.clientHeight,a.clientHeight;t>n.clientHeight-a.clientHeight&&(t=n.clientHeight-a.clientHeight),r=o<=Math.floor(n.clientHeight/2)?{newDragTopX:5,newDragTopY:t}:{newDragTopX:n.clientWidth-a.clientWidth-5,newDragTopY:t}}else I.warn("dragX,dragY,bigContainerSize,smallContainerSize is null");return r},t.changeVideoWin=function(){var e=(0,v.default)(p.default.mark(function e(){var t,n,a,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.setIsDecodeSuc()),t=$getState().call,n=j(),a={height:constant.VIDEO_SMALL_SIZE.HEIGHT,width:constant.VIDEO_SMALL_SIZE.WIDTH},t.isRemoteBig?(n=x({width:$getState().call.smallWinStyle.width,height:$getState().call.smallWinStyle.height},n),C.setVideoWH(!1,n),a=x({width:$getState().call.bigWinStyle.width,height:$getState().call.bigWinStyle.height},a,!1),C.setVideoWH(!0,a)):(a=x({width:$getState().call.bigWinStyle.width,height:$getState().call.bigWinStyle.height},a,!1),C.setVideoWH(!1,a),n=x({width:$getState().call.smallWinStyle.width,height:$getState().call.smallWinStyle.height},n),C.setVideoWH(!0,n)),$dispatch(coreUi.changeSmallWinStyle(a)),$dispatch(coreUi.changeBigWinStyle(n)),r&&$dispatch(coreUi.changeBigSmallWin());case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.exchangeSvcVideoWin=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={};if(a=n?coreConf.SvcAttendanceManager.calcCanvas16And9Size(0,constant.VIDEO_SIZE_BITE.SIZE_9_B_16):coreConf.SvcAttendanceManager.calcCanvas16And9Size(),$dispatch(coreUi.changeBigWinStyle(a)),-1===e?$dispatch(coreUi.setIsOppsite(!0)):$dispatch(coreUi.setIsOppsite(!1)),-2!==e&&-3!==e&&(coreConf.SvcAttendanceManager.changeSvcWindowSize(e,a),I.info("change vedio window size, ssrc: "+e+",size: "+(0,s.default)(a))),-2!==t&&-3!==t){var r={width:127,height:70};coreConf.SvcAttendanceManager.changeSvcWindowSize(t,r),I.info("change vedio window size, ssrc: "+t+",size: "+(0,s.default)(r))}},t.setCurrentVideoWinForMode=function(){var e=(0,v.default)(p.default.mark(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:!0!==$getState().conf.isDataConfSharing&&(_=t,I.info("setCurrentVideoWinForMode methed called, mode: "+t+" lastMode: "+n),setTimeout(function(){var e=j(),a=D({width:16,height:9},e);a&&$dispatch(coreUi.changeBFCPWinStyle(a));var r={height:200,width:337};C.setVideoWHForMode(t,n,a,r)},100));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),L=t.toFullScreen=function(){var e=(0,v.default)(p.default.mark(function e(){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("call toFullScreen "),!$getState().call.showCallToolBar||$getState().conf.showDataShareMode!==constant.SHOW_DATACONF_MODE.SHOW_DATACONF_NONE){e.next=4;break}return I.info(" toFullScreen showCallToolBar is true , showDataShareMode is 0"),e.abrupt("return");case 4:"extra"===$getState().call.screenState&&(I.info("<video> toFullScreen,resume screenState "+$getState().call.screenState),delegate.resumeShow(!1)),window.CLIENTCONFIG.ISMOBILE||window.isHubEnv||window.isPluginEnv||win.setFullScreen(!0),A("full"),$getState().conf.showDataShareMode===constant.SHOW_DATACONF_MODE.SHOW_DATACONF_NORMAL&&$dispatch(coreUi.showDataShareMode(constant.SHOW_DATACONF_MODE.SHOW_DATACONF_FULL));case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),M=t.exitFullScreen=function(){var e=(0,v.default)(p.default.mark(function e(){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("call exitFullScreen "),"extra"!==$getState().call.screenState){e.next=4;break}return I.info("<video> data conf end,no need todo restore,screenState now is "+$getState().call.screenState),e.abrupt("return");case 4:window.CLIENTCONFIG.ISMOBILE||window.isHubEnv||window.isPluginEnv||win.setFullScreen(!1),A("middle"),$getState().conf.showDataShareMode===constant.SHOW_DATACONF_MODE.SHOW_DATACONF_FULL&&$dispatch(coreUi.showDataShareMode(constant.SHOW_DATACONF_MODE.SHOW_DATACONF_NORMAL));case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),R=t.changeFullScreenReceiveShare=function(){var e=(0,v.default)(p.default.mark(function e(t){var n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("changInitiativeToFullScreenState , isInitiative = ",t),n=coreConf.isDataShareStarted()&&!window.isDataSharing,n&&$dispatch(coreUi.changeisFullScreenReceiveShare(t));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),A=t.changeScreenState=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if($dispatch(coreUi.changeFullScreenState(e)),!t||!$getState().conf.isSvcConf){if("extra"===e)return void I.info("<video>changeScreenState screenState = extra,no need to set videoWH");I.info("<video>changeScreenState screenState = "+e),"VIDEO_CONNECTED"!==$getState().call.callStatus&&"VIDEO_OUT"!==$getState().call.callStatus||window.CLIENTCONFIG.ISMOBILE||($getState().conf.isSvcConf&&(coreConf.refreshShareSize($getState().conf.svcBigPicInfo.ssrc),1===$getState().conf.svcViewMode&&coreConf.SvcAttendanceManager.handleWinResize(1)),$getState().call.iSreceivingBFCP&&!0!==$getState().conf.isDataConfSharing?O(_):setTimeout(function(){var t=j(e),n=$getState().call.bigWinStyle;t=$getState().conf.isSvcConf?Math.abs(n.width)<Math.abs(n.height)?x(constant.VIDEO_SIZE_BITE.SIZE_9_B_16,t):x(constant.VIDEO_SIZE_BITE.SIZE_16_B_9,t):x({width:Math.abs($getState().call.bigWinStyle.width),height:Math.abs($getState().call.bigWinStyle.height)},t),$dispatch(coreUi.changeBigWinStyle(t)),"VIDEO_CONNECTED"!==$getState().call.callStatus||!$getState().call.isRemoteBig&&"min"!==e&&"extra"!==e?C.setVideoWH(!1,t):C.setVideoWH(!0,t),$getState().conf.isSvcConf&&coreConf.SvcAttendanceManager.setSvcVideoRender($getState().conf.svcShowAttendances,"Size")},100))}},V=(t.changeBigContainerSize=function(){var e=(0,v.default)(p.default.mark(function e(){var t;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().call,"min"!==t.screenState){e.next=3;break}return e.abrupt("return");case 3:$getState().call.iSreceivingBFCP&&!0!==$getState().conf.isDataConfSharing?O(_):setTimeout(function(){var e=j();e=x({width:$getState().call.bigWinStyle.width,height:$getState().call.bigWinStyle.height},e),$dispatch(coreUi.changeBigWinStyle(e)),"VIDEO_CONNECTED"===t.callStatus&&(t.isRemoteBig&&"extra"!==t.screenState||"extra"===t.screenState)?C.setVideoWH(!0,e):C.setVideoWH(!1,e)},100);case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(e){I.info("<video> recieve video wh,data.isRemote = "+e.videoWinMode+",width = "+e.width+",height = "+e.height);var t=$getState().call;if($getState().conf.isSvcConf)I.info("<video> getVideoWH,calc svc canvas size"),0===$getState().conf.svcViewMode&&"VIDEO_CONNECTED"===t.callStatus?e.ssrc===$getState().conf.ssrcRange.min?H(e):2===e.videoWinMode&&(I.info("getVideoWH,data.videoWinMode=",e),$dispatch(coreUi.changeBfcpFrameSize(e)),C.setSvcBFCPVideoRender(e)):1===$getState().conf.svcViewMode&&"VIDEO_CONNECTED"===t.callStatus?-1!==e.ssrc&&coreConf.SvcAttendanceManager.handleDivideModeCanvasSize(e.ssrc,e.width,e.height):2===$getState().conf.svcViewMode&&"VIDEO_CONNECTED"===t.callStatus&&(1!==e.videoWinMode||$getState().conf.isOppsite||H(e));else{if($getState().call.iSreceivingBFCP&&!0!==$getState().conf.isDataConfSharing)return void F(e);(t.isRemoteBig&&"min"!==t.screenState&&"extra"!==t.screenState||"min"===t.screenState||"extra"===t.screenState)&&"VIDEO_CONNECTED"===t.callStatus?1===e.videoWinMode?H(e):0===e.videoWinMode&&z(e):1===e.videoWinMode?z(e):0===e.videoWinMode&&H(e)}}),F=function(e){I.info("updateWinSizeWhenRecBfcp enter");var t=!1;if(2===_&&0===e.videoWinMode?t=!0:1===_&&1===e.videoWinMode?t=!0:0===_&&2===e.videoWinMode&&(t=!0),t){var n=j(),a=D(e,n);a&&$dispatch(coreUi.changeBFCPWinStyle(a))}},D=function(e,t){var n={width:t.width,height:t.height};"min"!==$getState().call.screenState&&"extra"!==$getState().call.screenState&&(n.height=t.height-100);var a=x(e,n);return a.left=Math.floor((n.width-a.width)/2),a.top=Math.floor((n.height-a.height)/2),{width:a.width,height:a.height,left:a.left,top:a.top}};window.mobileOrientationChanged=function(e){if("number"!=typeof e)return void I.info("setCameraOrient param error!");if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||$getState().login.sipRegisterState===constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED){var t=($getState().call.isSvcConfShowQOS,$getState().conf),n=t.isSvcConf,a=t.svcHadPreSetCamera,r=t.hadPreSetCamera;t.confHandle;I.info("window.mobileOrientationChanged "+e),$dispatch(coreUi.recordMobileOrientChange(e)),window.CLIENTCONFIG.ISMOBILE&&(n&&!a&&$dispatch(coreUi.changeSvcHadPreSetCamera(!0)),n||r||$dispatch(coreUi.changeHadPreSetCamera(!0))),coreCommon.CameraControl.getInstance().setCameraOrient(e,!1)}};var U=function(){var e=(0,v.default)(p.default.mark(function e(t){var n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("<video> recieve refreshView,data.media_type = "+t.media_type+" data.view_event: "+t.view_event),2!==t.media_type&&1!==t.media_type){e.next=12;break}if(1!==t.view_event){e.next=11;break}if(!(n=$getState().conf.isSvcConf)||!window.CLIENTCONFIG.ISMOBILE){e.next=8;break}if(1!==t.media_type){e.next=8;break}return I.info("curr is svcConf, refreshLocalVideoView do nothings"),e.abrupt("return");case 8:window.updateVideoLocalView(),e.next=12;break;case 11:2===t.view_event&&window.removeVideoLocalView();case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=(0,v.default)(p.default.mark(function e(t){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("<video> recieve decodeSuccess"),window.CLIENTCONFIG.ISMOBILE?window.updateRemoteVideoView(t.call_id):$dispatch(coreUi.setIsDecodeSuc());case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=(0,v.default)(p.default.mark(function e(t,n){var a,r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("<video> bfcp decode success : "+$getState().conf.isDataConfSharing+" inDataConf: "+coreConf.isInDataConf()),b=!0,!window.CLIENTCONFIG.ISMAC){e.next=9;break}if(!n){e.next=9;break}return e.next=6,coreConf.bfcpWinAttach(0);case 6:return a=e.sent,I.info("notify mac dataconf decode bfcp"),e.abrupt("return");case 9:r=function(){var e=(0,v.default)(p.default.mark(function e(){var a,r,o,i,c,l,s,u,d,f,h;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=$getState().conf.isDataConfSharing,I.info("bfcp decode success inner function "+a),"VIDEO_CONNECTED"!==$getState().call.callStatus){e.next=45;break}if($dispatch(coreUi.setBfcpReceiving(!0)),window.CLIENTCONFIG.ISMOBILE&&window.decodeBFCPSuccess(t),!a){e.next=9;break}return C.resetBFCStatus($getState().call.callId,0),I.info("bfcpDecodeSuccessHandler isDataConfSharing is true, resetBFCStatus to 0"),e.abrupt("return");case 9:if(r=$getState().conf,o=r.isSvcConf,i=r.isEnterDataConf,c=r.svcShowAttendances,l=r.svcViewMode,s=r.maxSizeForPage,u=r.svcOnLineAttendances,!window.CLIENTCONFIG.ISBIGWIN||!o){e.next=19;break}if(a){e.next=17;break}return l===constant.SVC_VIEW_MODE.DIVIDE_MODE&&(d=coreConf.SvcAtdManager.getMaxSizeForPage(l),$dispatch(coreUi.changeMaxSizeForPage(d)),I.info("changeMaxSizeForPage DIVIDE_MODE size : ",d),c.length>d&&(I.info("current attenden size : "+c.length+" >  pageMaxSize :"+d),coreConf.SvcAtdManager.destroyLastNativeWin(),coreConf.SvcAtdManager.setPageNum(l,u.length))),e.next=15,coreConf.SvcAtdManager.initBfcpFrame(t,n);case 15:I.info("isEnterDataConf = "+i),i?(I.info("notify to proxy bfcp is start"),coreConf.NotifyStartSharing(0,"")):(window.delayDispatchRecvBFCP=!0,I.info("can not dispatch join conf message,  should delay dispatch"));case 17:e.next=43;break;case 19:if(!o||!window.CLIENTCONFIG.ISWIN){e.next=23;break}a||coreConf.SvcAtdManager.initBfcpFrame(t,n),e.next=43;break;case 23:if(o||!window.CLIENTCONFIG.ISWIN){e.next=27;break}a||coreConf.initBfcpWindow(t,n),e.next=43;break;case 27:if(!window.CLIENTCONFIG.ISMAC){e.next=42;break}if(!o){e.next=34;break}return I.info("svc conf bfcp decode success"),e.next=32,coreConf.SvcAttendanceManager.receviceSvcShareOrBfcp(1,"");case 32:e.next=40;break;case 34:I.info("avc conf bfcp decode success"),f=j(),h=$getState().conf.bfcpFrameSize,isNullOrEmpty(h)?(I.info("avc bfcpFrameSize is null"),f=D({width:16,height:9},f)):(I.info("avc bfcpFrameSize is not null"),f=D({width:h.width,height:h.height},f)),$dispatch(coreUi.changeBFCPWinStyle(f)),C.setBFCPVideoRender(f);case 40:e.next=43;break;case 42:coreConf.SvcAttendanceManager.setSvcVideoRender($getState().conf.svcShowAttendances);case 43:e.next=46;break;case 45:n&&!a&&window.CLIENTCONFIG.ISWIN&&($getState().conf.isSvcConf?coreConf.SvcAtdManager.initBfcpFrame(t,n):coreConf.initBfcpWindow(t,n));case 46:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),coreConf.isInDataConf()?S=setTimeout(function(){r()},1500):r();case 11:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),$=function(){var e=(0,v.default)(p.default.mark(function e(t,n){var a,r,o,i,c,l,s,u,d,f;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("bfcp stop handler called"),clearTimeout(S),$dispatch(coreUi.setBfcpReceiving(!1)),a=$getState().conf,r=a.isSvcConf,o=a.svcShareData,window.CLIENTCONFIG.ISMOBILE?window.bfcpDataStopEvent(n.param.call_id):window.CLIENTCONFIG.ISBIGWIN?(i=$getState().conf.bfcpFrameHwnd,i>0&&(coreConf.NotifyStopSharing(0,""),I.info("NotifyStopSharing")),coreConf.SvcAtdManager.closeBfcpFrame()):window.CLIENTCONFIG.ISWIN?(t&&coreConf.bfcpWinDetach(),r?(I.info("win-stop bfcp"),coreConf.SvcAtdManager.closeBfcpFrame(),c=$getState().conf,l=c.svcViewMode,s=c.maxSizeForPage,u=c.isShowMinWin,d=coreConf.SvcAtdManager.getMaxSizeForPage(l),l===constant.SVC_VIEW_MODE.DIVIDE_MODE&&s!==d&&(I.info("changeMaxSizeForPage :",d),$dispatch(coreUi.changeMaxSizeForPage(d)),u||(I.info("isShowMinWin is false RedrawVideoMain"),coreConf.SvcAtdManager.RedrawVideoMain())),window.isDataSharing||(f=$getState().conf.isSvcConf,coreConf.SvcAtdManager.switchVideoToMain())):(I.info("win-stop bfcp in avc"),coreConf.closeBfcpFrame(),window.isDataSharing||coreConf.switchVideoToMain())):r&&o.hasOwnProperty("ssrc")&&-3===o.ssrc&&coreConf.SvcAttendanceManager.stopSvcShareOrBfcp();case 5:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),G=function(){var e=(0,v.default)(p.default.mark(function e(t){var n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b=!1,I.info("bfcp data comming handler"),window.CLIENTCONFIG.ISMOBILE?(window.bfcpDataBeginEvent(t.param.call_id),n=$getState().call.callId,t.param.call_id===n?(I.info("[bfcp] client isReceiving bfcp success!"),$dispatch(coreUi.changeReceiveBfcp(!0)),$dispatch(coreUi.changeShowBfcp(!1)),$dispatch(coreUi.toggleIsMobileAcceptShareSuccess(!0)),$dispatch(coreUi.createConfTipMsg([language.YOU_ISWATCHING_SHARE_BFCP]))):$dispatch(coreUi.changeReceiveBfcp(!1))):window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ISWIN?I.info("deal in bfcp decode success!"):I.info("mac receive bfcp info");case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("bfcp frame size = ",t.param),$dispatch(coreUi.changeBfcpFrameSize(t.param)),!$getState().conf.isDataConfSharing){e.next=4;break}return e.abrupt("return");case 4:b&&(I.info("bfcp have decode success -- bfcp frame size changed"),n=$getState().conf.isSvcConf,window.CLIENTCONFIG.ISMAC&&(n?C.setSvcBFCPVideoRender(t.param):(a=j(),a=D({width:t.param.width,height:t.param.height},a),$dispatch(coreUi.changeBFCPWinStyle(a)),C.setBFCPVideoRender(a))));case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a,r,o,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=j(),a=$getState().conf,r=a.isSvcConf,o=a.svcViewMode,r&&(n=coreConf.SvcAttendanceManager.getBigCanvasSize()),i=y(t,n),i?($dispatch(coreUi.changeBigWinStyle(i)),I.info("change big win style:",i)):I.error("bigContainerSize: style = ",i);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),z=function(e){var t={width:constant.VIDEO_SMALL_SIZE.WIDTH,height:constant.VIDEO_SMALL_SIZE.HEIGHT};(t=y(e,t))&&$dispatch(coreUi.changeSmallWinStyle(t))},j=t.getBigContainerSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=e;"default"===t&&(t=$getState().call.screenState);var n=document.getElementsByClassName("main-frame-pc")[0],a=constant.VIDEO_SMALL_SIZE.WIDTH,r=constant.VIDEO_SMALL_SIZE.HEIGHT;switch(isNullOrEmpty(n)||(a=n.width||n.clientWidth||n[0],r=n.height||n.clientHeight||n[1]),t){case"full":case"extra":break;case"max":a-=50,r-=156;break;case"middle":a-=50,r-=49;break;case"min":a=constant.VIDEO_SMALL_SIZE.WIDTH,r=constant.VIDEO_SMALL_SIZE.HEIGHT}return{width:a,height:r}},J=t.handleLowVideoBWNotify=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a,r,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.info("handleLowVideoBWNotify, msg type is "+t.msg_type),n=$getState().call.isOpenCamera,a=$getState().call.callId,r=$getState().call.cameraIsPassiveClosed,e.t0=t.msg_type,e.next=0===e.t0?7:1===e.t0?8:2===e.t0?13:3===e.t0?17:4===e.t0?18:19;break;case 7:return e.abrupt("break",20);case 8:return n?(coreCommon.CameraControl.getInstance().switchCameraStateAction(!1),I.info("handleLowVideoBWNotify, camera is open, should be forced to close, set isPassiveClosed true"),$dispatch(coreUi.changeCameraPassiveClosed(!0)),!window.CLIENTCONFIG.ISMOBILE&&o&&(window.CLIENTCONFIG.ISWIN?coreConf.SvcAtdManager.alertBox("LOW_BW_AND_CLOSE_CAMERA",0):window.Toast(language.LOW_BW_AND_CLOSE_CAMERA,5,!1,"pcToast","")),window.CLIENTCONFIG.ISMOBILE&&o&&window.JSToNativeToast(2e3,language.LOW_BW_AND_CLOSE_CAMERA)):I.info("handleLowVideoBWNotify, camera has been closed, no need to close again"),window.CLIENTCONFIG.ISWIN&&coreConf.ToolbarManager.setCameraState(-1),$dispatch(coreUi.changeCameraDisabed(!0)),$dispatch(coreUi.setIsLowVideoBWCloseCamera(!0)),e.abrupt("break",20);case 13:return n?I.info("handleLowVideoBWNotify, camera has been opened, no need to open again"):r?(coreCommon.CameraControl.getInstance().switchCameraStateAction(!0),!window.CLIENTCONFIG.ISMOBILE&&o&&(window.CLIENTCONFIG.ISWIN?coreConf.SvcAtdManager.alertBox("LOW_BW_END_OPEN_CAMERA",0):window.Toast(language.LOW_BW_END_OPEN_CAMERA,5,!1,"pcToast","")),$dispatch(coreUi.changeCameraPassiveClosed(!1)),window.CLIENTCONFIG.ISMOBILE&&(n||$getState().call.isOpenPIP||$dispatch(coreUi.CloseOrOpenPIP(!0)),o&&window.JSToNativeToast(2e3,language.LOW_BW_END_OPEN_CAMERA)),I.info("handleLowVideoBWNotify, camera should be forced to open, set isPassiveClosed false")):I.info("handleLowVideoBWNotify, camera has been active closed, can not open"),$dispatch(coreUi.changeCameraDisabed(!1)),$dispatch(coreUi.setIsLowVideoBWCloseCamera(!1)),e.abrupt("break",20);case 17:case 18:case 19:return e.abrupt("break",20);case 20:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Y=(t.closeAllVideoSocket=function(){var e=(0,v.default)(p.default.mark(function e(){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.closeLocalCanvasSocket();case 2:return e.next=4,C.closeRemoteCanvasSocket();case 4:return e.next=6,C.closeDataCanvasSocket();case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.checkIsSupportWebgl=function(){var e=(0,v.default)(p.default.mark(function e(){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(e,t){var n="";if(t&&!isNaN(t.length)&&t.length>0)for(var a=0;a<t.length;a++)n=n+";ssrc"+t[a].ssrc+",name:"+(t[a].conf_name.length>2?t[a].conf_name.substr(0,1)+"****"+t[a].conf_name.substr(-1):t[a].conf_name.substr(0,1)+"****");I.info(e,n)}),q=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a,r,o,i,l,u,d,f,h,v,m,C,w,S;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($dispatch(coreUi.changesvcWatchIndNotify(t.svc_conf_info)),n=$getState().conf,a=n.svcShowAttendances,r=n.svcShowAttendancesMobile,o=n.isSameGradeMcu,i=n.isBigConf,I.info("current devide PagerNo"+$getState().conf.svcShowPage),!i||1!==$getState().conf.svcShowPage){e.next=35;break}if(!(l=(0,c.default)([],a))||l.length!==t.conf_num){e.next=20;break}u=0;case 7:if(!(u<l.length)){e.next=20;break}d=0;case 9:if(!(d<t.svc_conf_info.length)){e.next=17;break}if(l[u].ssrc!==t.svc_conf_info[d].ssrc){e.next=14;break}return l[u].number=t.svc_conf_info[d].number,l[u].name=t.svc_conf_info[d].conf_name,e.abrupt("break",17);case 14:d++,e.next=9;break;case 17:u++,e.next=7;break;case 20:$dispatch(coreUi.changeSvcActiveAttendances(l)),f=$getState().conf.svcOnLineAttendances,h=sortPreAndOrigiArray(l,f),f=$getState().conf.svcOnLineAttendances,v=0;case 25:if(!(v<h.length)){e.next=34;break}if(m=h[v],1!==m.is_self){e.next=31;break}return h.splice(v,1),h.unshift(m),e.abrupt("break",34);case 31:v++,e.next=25;break;case 34:(0,s.default)(h)!==(0,s.default)(f)&&($dispatch(coreUi.changeSvcOnLineAttendances(h)),window.updateVideoView(h,!1));case 35:if(!(0===o&&t.conf_num>=1&&r.length>0&&r[0].ssrc===t.svc_conf_info[0].ssrc)){e.next=39;break}"M0T0"===t.svc_conf_info[0].number?(r[0].name=language.FAILURE_ERR_TUP,t.svc_conf_info[0].conf_name=language.FAILURE_ERR_TUP,$dispatch(coreUi.changeSvcShowAttendances(r)),window.svcWatchIndNotify(t)):(I.info("grade_mcu:serialNumber",t.svc_conf_info[0].number),$dispatch(coreUi.changeMobileSerialNumber(t.svc_conf_info[0].number)),t.is_same_grade_mcu=0,window.svcWatchIndNotify(t)),e.next=67;break;case 39:if(1!==t.conf_num){e.next=45;break}if(a.length>0)for(C=0;C<a.length;C++)a[C].ssrc===t.svc_conf_info[0].ssrc&&("M0T0"===t.svc_conf_info[0].number?(a[C].name=language.FAILURE_ERR_TUP,t.svc_conf_info[C].conf_name=language.FAILURE_ERR_TUP,$dispatch(coreUi.changeSvcShowAttendances(a))):t.svc_conf_info[0].number=a[C].number);t.is_same_grade_mcu=1,window.svcWatchIndNotify(t),e.next=67;break;case 45:if(!(t.conf_num>1)){e.next=67;break}if(a.length!==t.conf_num){e.next=65;break}w=0;case 48:if(!(w<a.length)){e.next=65;break}S=0;case 50:if(!(S<t.svc_conf_info.length)){e.next=62;break}if(a[w].ssrc!==t.svc_conf_info[S].ssrc){e.next=59;break}if("M0T0"!==t.svc_conf_info[S].number){e.next=57;break}return a[w].name=language.FAILURE_ERR_TUP,t.svc_conf_info[w].conf_name=language.FAILURE_ERR_TUP,$dispatch(coreUi.changeSvcShowAttendances(a)),e.abrupt("continue",59);case 57:return t.svc_conf_info[S].number=a[w].number,e.abrupt("break",62);case 59:S++,e.next=50;break;case 62:w++,e.next=48;break;case 65:t.is_same_grade_mcu=1,window.svcWatchIndNotify(t);case 67:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a,r,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().conf.svcShowAttendances,coreConf.DecoderManager.createDivideDecoderList(n),n.length>=1){for(a=(0,c.default)([],n),r=!1,o=0;o<a.length;o++)t.svc_conf_info[0].ssrc===a[o].ssrc&&(t.svc_conf_info[0].conf_name&&t.svc_conf_info[0].conf_name!==a[o].name&&(a[o].name=t.svc_conf_info[0].conf_name,r=!0),t.svc_conf_info[0].number&&t.svc_conf_info[0].number!==a[o].number&&(a[o].number=t.svc_conf_info[0].number,g.test(t.svc_conf_info[0].number)&&(a[o].name=language.MULTI_VIEW_BROADCAST_NAME,r=!0)));r&&(I.info("handleBigWinDefaultSVCWatchInd,nameIsUpdate only one!"),$dispatch(coreUi.changeSvcShowAttendances(a)),coreConf.SvcAtdManager.setWindowName(a))}case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a,r,o,i,c,l;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().conf,a=n.svcShowAttendances,r=n.svcControlMode,o=n.isSvcShareMode,i=n.svcBigPicInfo,c=n.svcViewMode,!((0===c||2===c)&&o&&i.hasOwnProperty("ssrc")&&i.ssrc<0)){e.next=3;break}return e.abrupt("return");case 3:if(2!==c||o||1!==r){e.next=5;break}return e.abrupt("return");case 5:return isNullOrEmpty(t.svc_conf_info[0].conf_name)||(l={name:t.svc_conf_info[0].conf_name,ssrc:t.svc_conf_info[0].ssrc,number:t.svc_conf_info[0].number},I.info("handleMacDefaultSVCWatchInd, the default terminal name:"+handlePhoneNumber(l.name)+", terminal number:"+handlePhoneNumber(l.number)+", terminal ssrc:"+l.ssrc),$dispatch(coreUi.changeSvcBigPicInfo(l))),e.next=8,coreConf.SvcAttendanceManager.setSvcVideoRender(a,"NoChange");case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a,r,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=$getState().conf,a=n.svcShowAttendances,r=n.svcOnLineAttendances,isNullOrEmpty(t.svc_conf_info[0].conf_name)||(o={name:t.svc_conf_info[0].conf_name,ssrc:t.svc_conf_info[0].ssrc,number:t.svc_conf_info[0].number},I.info("handleWinDefaultSVCWatchInd, the default terminal name:"+handlePhoneNumber(o.name)+", terminal number:"+handlePhoneNumber(o.number)+", terminal ssrc:"+o.ssrc),$dispatch(coreUi.changeSvcBigPicInfo(o))),r.length>=1&&coreConf.SvcAtdManager.setWindowName(a);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=(0,v.default)(p.default.mark(function e(t){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISBIGWIN){e.next=5;break}return e.next=3,K(t);case 3:e.next=12;break;case 5:if(!window.CLIENTCONFIG.ISWIN){e.next=10;break}return e.next=8,Z(t);case 8:e.next=12;break;case 10:return e.next=12,Q(t);case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a,r,o,i,l,u,d,f,h,v,m,C,w,S,_;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().conf,a=n.svcBigPicInfo,r=n.svcWndHandles,o=n.isSvcWatchSuc,i=n.svcViewMode,l=n.bfcpFrameHwnd,u=n.bfcpIsBigHwnd,d=n.dataIsBigHwnd,f=$getState().call.iSreceivingBFCP,!window.CLIENTCONFIG.ISMAC&&!window.CLIENTCONFIG.ISWIN){e.next=24;break}if(0!==i&&2!==i){e.next=24;break}if(!(!0===f&&l>0&&u)){e.next=7;break}return I.info("recv bfcp and bfcp is big pic, no need update big pic info"),e.abrupt("return");case 7:if(!0!==window.isDataSharing||!0!==d){e.next=10;break}return I.info("recv data and data is big pic, no need update big pic info"),e.abrupt("return");case 10:if(a.name=t.svc_conf_info[0].conf_name,!(1===a.is_self||a.ssrc>0)){e.next=24;break}if(h={name:t.svc_conf_info[0].conf_name,ssrc:t.svc_conf_info[0].ssrc,number:t.svc_conf_info[0].number},I.info("handleDesktopSVCWatchInd,the big picture terminal name: "+handlePhoneNumber(h.name)+" terminal number: "+handlePhoneNumber(h.number)+" terminal ssrc: "+h.ssrc),!1===o&&($dispatch(coreUi.svcWatchSuccess(!0)),I.info("before isSvcWatchSuc false,clear data,now isSvcWatchSuc is ",o)),"M0T0"===t.svc_conf_info[0].number&&(window.CLIENTCONFIG.ISWIN?(h.name=language.NATIVE_FAILURE_ERR_TUP,h.number="",$dispatch(coreUi.changeSvcBigPicInfo(h)),v=$getState().conf,m=v.videoFrameHwnd,C=v.isSvcWatchSuc,$dispatch(coreUi.svcWatchSuccess(!1)),w=r[0].hwnd,S=(0,c.default)({},{svc_watch_success:C,wnd_handle:w}),coreConf.NativeInterface.setParam(S,m),I.info("send param to PC_native",S)):(h.name=language.FAILURE_ERR_TUP,h.number="",$dispatch(coreUi.changeSvcBigPicInfo(h)),$dispatch(coreUi.svcWatchSuccess(!1)))),_=$getState().conf.svcBigPicInfo,(0,s.default)(_)===(0,s.default)(h)){e.next=23;break}if("M0T0"!==t.svc_conf_info[0].number&&$dispatch(coreUi.changeSvcBigPicInfo(h)),!window.CLIENTCONFIG.ISWIN){e.next=21;break}return e.abrupt("return",!0);case 21:e.next=24;break;case 23:I.info("handleSvcWatchIndNotify,BigPictureInfo is same with svcBigPicInfo ");case 24:return e.abrupt("return",!1);case 25:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a,r,o,i,l,s,u,d,f,h,v,m,C,w,S,_,b,N;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().conf,a=n.svcShowAttendances,r=n.svcOnLineAttendances,o=n.isBigConf,i=n.svcShowPage,l=n.svcViewMode,1!==t.conf_num){e.next=6;break}return e.next=4,X(t);case 4:e.next=49;break;case 6:for(s=new Array,u=0;u<a.length;u++)d=a[u],s[u]=(0,c.default)({},d);return e.next=10,ee(t);case 10:if(f=e.sent,I.info("handleSvcWatchIndNotify,newSvcShowAttendances.length is ",s.length),!(s.length>0&&t.conf_num>0)){e.next=48;break}h=0;case 14:if(!(h<t.conf_num)){e.next=44;break}v=0;case 16:if(!(v<s.length)){e.next=41;break}if(t.svc_conf_info[h].ssrc!==s[v].ssrc){e.next=38;break}if("M0T0"!==t.svc_conf_info[h].number){e.next=36;break}if(!window.CLIENTCONFIG.ISWIN&&!window.CLIENTCONFIG.ISBIGWIN){e.next=31;break}return s[v].name=language.NATIVE_FAILURE_ERR_TUP,window.CLIENTCONFIG.ISBIGWIN&&(s[v].name="",s[v].number=""),f=!0,m=$getState().conf,C=m.videoFrameHwnd,w=m.isSvcWatchSuc,$dispatch(coreUi.svcWatchSuccess(!1)),S=s[v].wnd_handle,_=(0,c.default)({},{svc_watch_success:w,wnd_handle:S}),coreConf.NativeInterface.setParam(_,C),e.abrupt("continue",38);case 31:return s[v].name=language.FAILURE_ERR_TUP,s[v].number=t.svc_conf_info[h].number,e.next=35,coreConf.setSvcVideoRender(a,"NoChange");case 35:return e.abrupt("continue",38);case 36:t.svc_conf_info[h].conf_name&&t.svc_conf_info[h].conf_name!==s[v].name&&(I.info("handleSvcWatchIndNotify,nameIsUpdate,ssrc is "+t.svc_conf_info[h].ssrc+",old name is "+(s[v].name.length>=2?s[v].name.substr(0,1)+"****"+s[v].name.substr(-1):s[v].name)+",new name is "+(t.svc_conf_info[h].conf_name.length>=2?t.svc_conf_info[h].conf_name.substr(0,1)+"****"+t.svc_conf_info[h].conf_name.substr(-1):t.svc_conf_info[h].conf_name)),s[v].name=t.svc_conf_info[h].conf_name,f=!0),t.svc_conf_info[h].number&&t.svc_conf_info[h].number!==s[v].number&&(I.info("handleSvcWatchIndNotify,numberIsUpdate,ssrc is "+t.svc_conf_info[h].ssrc+",old number is "+s[v].number+",new number is "+t.svc_conf_info[h].number),"M0T0"!==t.svc_conf_info[h].number&&(s[v].number=t.svc_conf_info[h].number),g.test(t.svc_conf_info[h].number)&&(s[v].name=language.MULTI_VIEW_BROADCAST_NAME,f=!0));case 38:v++,e.next=16;break;case 41:h++,e.next=14;break;case 44:f&&(I.info("handleSvcWatchIndNotify,nameIsUpdate,dispatch  newSvcShowAttendances"),$dispatch(coreUi.changeSvcShowAttendances(s)),(window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ISWIN)&&coreConf.SvcAtdManager.setWindowName(s)),!o||0!==i||l!==constant.SVC_VIEW_MODE.BIG_SMALL_MODE&&l!==constant.SVC_VIEW_MODE.DIVIDE_MODE&&l!==constant.SVC_VIEW_MODE.MIN_WIN_VERTICAL&&0!==l&&1!==l||($dispatch(coreUi.changeSvcActiveAttendances(s)),b=$getState().conf.svcActiveAttendances,f&&(N=sortPreAndOrigiArray(b,r),$dispatch(coreUi.changeSvcOnLineAttendances(N)))),e.next=49;break;case 48:I.info("handleSvcWatchIndNotify,newSvcShowAttendances.length <= 0 || param.conf_num <= 0 ");case 49:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),ne=t.handleSvcWatchIndNotify=function(){var e=(0,v.default)(p.default.mark(function e(t){var n,a,r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("handleSvcWatchIndNotify,attendee count is ",t.conf_num),Y("会场指示源处理 ",t.svc_conf_info),n=[0],t.conf_num>0){n.push(t.conf_num);for(a in t.svc_conf_info)(r=t.svc_conf_info[a].number)&&n.push(handlePhoneNumber(r))}if(coreUt.utConfOperate({eventId:constant.EVENT_ID.UT_CONF_WATCH_SVC,params:n}),!(t.conf_num<=0)){e.next=8;break}return I.error("param.conf_num <= 0, return"),e.abrupt("return");case 8:if(!window.CLIENTCONFIG.ISMOBILE){e.next=13;break}return e.next=11,q(t);case 11:e.next=15;break;case 13:return e.next=15,te(t);case 15:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();t.createVideoPreCheck=function(){var e=(0,v.default)(p.default.mark(function e(){var t,n,a;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ISMOBILE){e.next=2;break}return e.abrupt("return",!0);case 2:if(window.netWorkType!==constant.NETWORK_TYPE.TYPE_2G){e.next=5;break}return e.next=5,window.getCurrentNetWorkType();case 5:if((t=window.netWorkType)!==constant.NETWORK_TYPE.TYPE_3G&&t!==constant.NETWORK_TYPE.TYPE_4G){e.next=19;break}if(!$getState().conf.isShowMobileNetTip){e.next=16;break}return n=language.CALL_VIDEO_TO_START_WHEN_4G,e.next=11,window.confirm(n);case 11:return a=e.sent,a.ret?$dispatch(coreUi.toggleMobileNetTip(!1)):($dispatch(coreUi.changeCallStatus("")),window.goRoute("main/conference",!0)),e.abrupt("return",a.ret);case 16:return e.abrupt("return",!0);case 17:e.next=20;break;case 19:return e.abrupt("return",!0);case 20:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();window.requestPermissionFinish=(0,v.default)(p.default.mark(function e(){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.requestPermissionState=1;case 1:case"end":return e.stop()}},e,void 0)}));var ae=function(){var e=(0,v.default)(p.default.mark(function e(t){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new o.default(function(e,n){setTimeout(function(){e()},t)}));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();t.callPermissionCheck=function(){var e=(0,v.default)(p.default.mark(function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ISMOBILE){e.next=2;break}return e.abrupt("return",!0);case 2:return I.info("userClick  mobile callPermissionCheck"),e.next=5,window.isHavePermission(t?"AUDIO_AND_CAMERA_PERMISSION":"AUDIO_PERMISSION");case 5:if(window.isHavePerm){e.next=24;break}if(window.requestPermissionState=0,window.requestPermissions(t?"AUDIO_AND_CAMERA_PERMISSION":"AUDIO_PERMISSION"),!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=17;break}if(window.requestPermissionPromise=new PromiseObject,!window.webView){e.next=14;break}return e.abrupt("return",window.requestPermissionPromise);case 14:return e.abrupt("return",!1);case 15:e.next=24;break;case 17:if("android"!==window.CLIENTCONFIG.PLATFORM||!n){e.next=24;break}case 18:if(0!==window.requestPermissionState){e.next=24;break}return I.info("[requestPermissions] sleep"),e.next=22,ae(2e3);case 22:e.next=18;break;case 24:if(window.CLIENTCONFIG.ENABLE_IT_MEETING||"android"!==window.CLIENTCONFIG.PLATFORM||!n){e.next=27;break}return e.next=27,window.isHavePermission(t?"AUDIO_AND_CAMERA_PERMISSION":"AUDIO_PERMISSION");case 27:return e.abrupt("return",window.isHavePerm);case 28:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();window.resumeCamera=(0,v.default)(p.default.mark(function e(){var t,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=coreCommon.TaskQueue.getInstance("closeOrResumeCameta"),n=coreCommon.TaskOptions.defaultOptions(),t.addTask((0,v.default)(p.default.mark(function e(){var t,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("enter resume camera. "),"VIDEO_CONNECTED"!==(t=$getState().call.callStatus)){e.next=10;break}if(n=$getState().call.isOpenCamera){e.next=7;break}return I.warn("resumeCamera the camera is not open. return "),e.abrupt("return");case 7:return e.next=9,coreCommon.CameraControl.getInstance().switchCameraStateAction(!0);case 9:"mConfMemberPage"===window.getRoute()&&window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.changeScreenOrientation(constant.SCREEN_ORIENTATION.SCREEN_ORIENTATION_PORTRAIT);case 10:case"end":return e.stop()}},e,void 0)})),n,null);case 3:case"end":return e.stop()}},e,void 0)})),window.mobileGotoBackground=(0,v.default)(p.default.mark(function e(){var t,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=coreCommon.TaskQueue.getInstance("closeOrResumeCameta"),n=coreCommon.TaskOptions.defaultOptions(),t.addTask((0,v.default)(p.default.mark(function e(){var t,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I.info("enter mobileGotoBackground. "),"VIDEO_CONNECTED"!==(t=$getState().call.callStatus)){e.next=9;break}if(n=$getState().call.isOpenCamera){e.next=7;break}return I.warn("mobileGotoBackground the camera is not open. return "),e.abrupt("return");case 7:return e.next=9,coreCommon.CameraControl.getInstance().setDefaultCapture();case 9:case"end":return e.stop()}},e,void 0)})),n,null);case 3:case"end":return e.stop()}},e,void 0)})),window.setFloatWinDefaultCapture=(0,v.default)(p.default.mark(function e(){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("enter setFloatWinDefaultCapture."),e.next=3,coreCommon.CameraControl.getInstance().setDefaultCapture();case 3:case"end":return e.stop()}},e,void 0)}))},1005:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.filterCallRecordList=t.setActiveKeyValue=t.saveCallItemInfo=t.saveCallRecordItem=t.setIsCallRecordDetailMenuBack=t.getMoreAccountCallRecordList=t.getAccountCallRecordList=t.getMoreCallRecordList=t.getInitCallRecordList=void 0;var r=n(129),o=a(r),i=n(1),c=a(i),l=n(2),s=a(l),u=window.Logger("logic")("callRecord"),d=(t.getInitCallRecordList=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=3;break}return u.info("[IT-Meeting] no need to init callrecord"),e.abrupt("return");case 3:return e.prev=3,u.info("首次加载通话记录"),e.next=7,coreDb.queryAllCallRecord({starttime:9999999999999,limitcount:window.CLIENTCONFIG.ISMOBILE?+window.CLIENTCONFIG.MOBILE_MESSAGE_LIST_PAGE_SIZE:window.CLIENTCONFIG.MESSAGE_LIST_PAGE_SIZE});case 7:if(t=e.sent,isNullOrEmpty(t)){e.next=14;break}return $dispatch(coreUi.getCallRecordList(t)),e.next=12,d(t);case 12:n=e.sent,$dispatch(coreUi.getCallRecordListInfo(n));case 14:isNullOrEmpty(t)?$dispatch(coreUi.hasMoreCallRecord(!1)):($dispatch(coreUi.hasMoreCallRecord(!0)),a=t[t.length-1].starttime,$dispatch(coreUi.setNextStartTimeStamp(a))),u.info("通话记录",(t.length||0)+"条"),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),u.error("callRecordList 通话记录",{e:e.t0.toJSON()});case 21:case"end":return e.stop()}},e,void 0,[[3,18]])}));return function(){return e.apply(this,arguments)}}(),t.getMoreCallRecordList=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r,i,l,s,f,p,h,v;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=$getState(),n=t.callRecord.nextStartTime,a=t.callRecord,r=a.callRecordList,i=a.callItemInfoList,l=r||[],s=i||[],f=window.CLIENTCONFIG.ISMOBILE?window.CLIENTCONFIG.MOBILE_MESSAGE_LIST_PAGE_SIZE:window.CLIENTCONFIG.MESSAGE_LIST_PAGE_SIZE,!isNullOrEmpty(r)&&0!==r.length){e.next=8;break}return e.abrupt("return");case 8:return p=void 0,e.next=11,coreDb.queryCallRecordList({starttime:n,limitcount:f});case 11:if(p=e.sent,isNullOrEmpty(p)||0===p.length){e.next=26;break}return $dispatch(coreUi.hasMoreCallRecord(!0)),l=r.concat(p),$dispatch(coreUi.getCallRecordList([].concat((0,o.default)(l)))),e.next=18,d(l);case 18:h=e.sent,s=i.concat(h),$dispatch(coreUi.getCallRecordListInfo(s)),v=p[p.length-1].starttime,$dispatch(coreUi.setNextStartTimeStamp(v)),u.info("更多通话记录",(s.length||0)+"条"),e.next=28;break;case 26:return $dispatch(coreUi.hasMoreCallRecord(!1)),e.abrupt("return");case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(0),u.error("callRecordList 更多通话记录",{e:e.t0.toJSON()});case 33:case"end":return e.stop()}},e,void 0,[[0,30]])}));return function(){return e.apply(this,arguments)}}(),t.getAccountCallRecordList=function(){var e=(0,s.default)(c.default.mark(function e(t){var n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,coreDb.queryCallRecordList({peeraccount:t,starttime:9999999999999,limitcount:window.CLIENTCONFIG.ISMOBILE?window.CLIENTCONFIG.MOBILE_MESSAGE_LIST_PAGE_SIZE:window.CLIENTCONFIG.MESSAGE_LIST_PAGE_SIZE});case 3:n=e.sent,$dispatch(coreUi.getAccountCallRecordList(n)),u.info("通话记录"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),u.error("callRecordList 通话记录",{e:e.t0.toJSON()});case 11:case"end":return e.stop()}},e,void 0,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),t.getMoreAccountCallRecordList=function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a,r,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=$getState(),a=n.call.accountCallRecordList,r=a||[],!a){e.next=9;break}return e.next=7,coreDb.queryCallRecordList({peeraccount:t,starttime:9999999,limitcount:window.CLIENTCONFIG.ISMOBILE?window.CLIENTCONFIG.MOBILE_MESSAGE_LIST_PAGE_SIZE:window.CLIENTCONFIG.MESSAGE_LIST_PAGE_SIZE});case 7:o=e.sent,r=a.concat(o);case 9:$dispatch(coreUi.getAccountCallRecordList(r)),u.info("更多通话记录"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),u.error("callRecordList 更多通话记录",{e:e.t0.toJSON()});case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t){return e.apply(this,arguments)}}(),t.setIsCallRecordDetailMenuBack=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];$dispatch(coreUi.setIsCallRecordDetailMenuBack(e))},t.saveCallRecordItem=function(e){$dispatch(coreUi.saveCallRecordItem(e))},t.saveCallItemInfo=function(e){$dispatch(coreUi.saveCallItemInfo(e))},t.setActiveKeyValue=function(e){$dispatch(coreUi.setActiveKeyValue(e))},t.filterCallRecordList=function(e,t){var n=$getState().call.voiceMailNum;return e.map(function(e,a){return isNullOrEmpty(e)?t[a]===n?coreSearch.getTempCallUserInfo(t[a],language.VOICE_MAIL_BOX,!0):coreSearch.getTempCallUserInfo(t[a]):e})},function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a,r,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=0;case 2:if(!(a<t.length)){e.next=11;break}return r=t[a],e.next=6,f(r);case 6:o=e.sent,n.push(o);case 8:a++,e.next=2;break;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),f=function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().call.voiceMailNum,a={},t.peeraccount!==n){e.next=6;break}a=coreSearch.getTempCallUserInfo(t.peeraccount,language.VOICE_MAIL_BOX,!0),e.next=16;break;case 6:if(!t.contact_id){e.next=12;break}return e.next=9,coreDb.queryContactByContactId(t.contact_id);case 9:a=e.sent,e.next=16;break;case 12:return e.next=14,coreContact.getContactByAccount(t.peeraccount);case 14:a=e.sent,isNullOrEmpty(a)&&(a=coreSearch.getTempCallUserInfo(t.peeraccount));case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},117:function(e,t,n){e.exports={default:n(148),__esModule:!0}},118:function(e,t,n){e.exports=n(0)(45)},119:function(e,t,n){e.exports=n(0)(47)},121:function(e,t,n){e.exports=n(0)(563)},129:function(e,t,n){"use strict";t.__esModule=!0;var a=n(141),r=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,r.default)(e)}},132:function(e,t,n){e.exports=n(0)(238)},134:function(e,t,n){e.exports={default:n(157),__esModule:!0}},136:function(e,t,n){var a=n(10),r=n(8),o=n(137);e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],i={};i[e]=t(n),a(a.S+a.F*o(function(){n(1)}),"Object",i)}},137:function(e,t,n){e.exports=n(0)(59)},141:function(e,t,n){e.exports={default:n(165),__esModule:!0}},143:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var r=n(177),o=a(r),i=n(134),c=a(i);t.default=function(){function e(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=(0,c.default)(e);!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&l.return&&l.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if((0,o.default)(Object(t)))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},148:function(e,t,n){n(149),e.exports=n(8).Object.getPrototypeOf},149:function(e,t,n){var a=n(132),r=n(150);n(136)("getPrototypeOf",function(){return function(e){return r(a(e))}})},150:function(e,t,n){e.exports=n(0)(586)},157:function(e,t,n){n(23),n(22),e.exports=n(158)},158:function(e,t,n){var a=n(9),r=n(26);e.exports=n(8).getIterator=function(e){var t=r(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return a(t.call(e))}},162:function(e,t,n){var a=n(15);e.exports=function(e,t){if(!a(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},165:function(e,t,n){n(22),n(166),e.exports=n(8).Array.from},166:function(e,t,n){"use strict";var a=n(11),r=n(10),o=n(132),i=n(31),c=n(32),l=n(27),s=n(167),u=n(26);r(r.S+r.F*!n(33)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,d,f=o(e),p="function"==typeof this?this:Array,h=arguments.length,v=h>1?arguments[1]:void 0,m=void 0!==v,C=0,w=u(f);if(m&&(v=a(v,h>2?arguments[2]:void 0,2)),void 0==w||p==Array&&c(w))for(t=l(f.length),n=new p(t);t>C;C++)s(n,C,m?v(f[C],C):f[C]);else for(d=w.call(f),n=new p;!(r=d.next()).done;C++)s(n,C,m?i(d,v,[r.value,C],!0):r.value);return n.length=C,n}})},167:function(e,t,n){"use strict";var a=n(25),r=n(168);e.exports=function(e,t,n){t in e?a.f(e,t,r(0,n)):e[t]=n}},168:function(e,t,n){e.exports=n(0)(79)},174:function(e,t,n){e.exports=n(0)(594)},177:function(e,t,n){e.exports={default:n(178),__esModule:!0}},178:function(e,t,n){n(23),n(22),e.exports=n(179)},1782:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.popoverTypeMap=t.showPopoverMenuLogic=t.hidePopoverMenu=void 0;var r=n(1),o=a(r),i=n(2),c=a(i),l=n(718);t.hidePopoverMenu=function(){var e=(0,c.default)(o.default.mark(function e(){var t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$dispatch((0,l.hidePopoverModal)());case 2:t=$getState().common.showResetfuc,t&&t();case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.showPopoverMenuLogic=function(e,t,n,a,r,o,i){$dispatch((0,l.showPopoverModal)(e,t,n,a,r,o,i))},t.popoverTypeMap={TYPE_MORE:0,TYPE_SHARE:1,TYPE_CREATE:2,TYPE_VIDEO_SHARE:3}},1783:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.startCtdCall=t.getSipNumber=t.voiceCallPC=t.initTupCtd=t.initCallBackNum=t.getCallTypeAndCallBackNumFromServer=t.setCallBackNumAS=t.setCallTypeAS=t.setCallTypeAndCallBackNumToServer=t.refreshCallBackNum=t.initCallBackNumAS=t.setCallBackNum=t.setCallBackNumList=t.setCallType=void 0;var r=n(67),o=a(r),i=n(1),c=a(i),l=n(2),s=a(l),u=n(880),d=window.Logger("logic")("call"),f=t.setCallType=function(){var e=(0,s.default)(c.default.mark(function e(t){var n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $dispatch(coreUi.changeCallType(t)),n=[{key:"callType",value:t.toString()}],e.next=4,coreDb.saveUserConfig(n);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),p=t.setCallBackNumList=function(){var e=(0,s.default)(c.default.mark(function e(t){var n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $dispatch(coreUi.changeCallBackNumList(t)),n=[{key:"callBackNumList",value:(0,o.default)(t)}],e.next=4,coreDb.saveUserConfig(n);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),h=t.setCallBackNum=function(){var e=(0,s.default)(c.default.mark(function e(t){var n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $dispatch(coreUi.changeCallBackNum(t)),n=[{key:"callBackNum",value:t.toString()}],e.next=4,coreDb.saveUserConfig(n);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),v=(t.initCallBackNumAS=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r,o,i,l,s;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: initCallBackNumAS"),t=$getState().call.callBackNumList,e.next=4,m();case 4:if(!((n=e.sent)&&n.callMode&&n.callBackNumber)){e.next=13;break}return e.next=8,f("DirectVoIP"===n.callMode?0:1);case 8:return e.next=10,h(n.callBackNumber);case 10:return-1===t.findIndex(function(e){return e.number===n.callBackNumber})&&t.push({number:n.callBackNumber}),e.next=13,p(t);case 13:if(a=$getState().call.callBackNum,r=$getState().call.callType,!a){e.next=17;break}return e.abrupt("return");case 17:return e.next=19,coreContact.getUserInfo(coreAccount.getLoginModel().account);case 19:if(o=e.sent,i=o.param,!(l=i.mobile)){e.next=35;break}return e.next=25,v(0===r?"DirectVoIP":"CallBack",l);case 25:if(s=e.sent,d.info("CTD: initCallBackNumAS_result: ",s),!s){e.next=33;break}return e.next=30,h(l);case 30:return t.unshift({number:l}),e.next=33,p(t);case 33:e.next=37;break;case 35:return e.next=37,f(0);case 37:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.refreshCallBackNum=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d.info("CTD: refreshCallBackNum"),t=$getState().call.callBackNum,n=$getState().call.callType,a=$getState().call.callBackNumList,r=0;case 5:if(!(r<a.length)){e.next=11;break}if(t!==a[r].number){e.next=8;break}return e.abrupt("return");case 8:r++,e.next=5;break;case 11:if(!(0<a.length)){e.next=21;break}if(!coreAccount.getLoginModel().isSupportAS){e.next=20;break}return e.next=15,v(0===n?"DirectVoIP":"CallBack",a[0].number);case 15:o=e.sent,d.info("CTD: refreshCallBackNum_result: ",o),o&&h(a[0].number),e.next=21;break;case 20:h(a[0].number);case 21:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setCallTypeAndCallBackNumToServer=function(){var e=(0,s.default)(c.default.mark(function e(t,n){var a,r,i,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"chinaPR";return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: setCallTypeAndCallBackNumToServer"),a="ctd",r=(0,o.default)({country:s,callMode:t,callBackNumber:n}),e.next=5,C({path:a,body:r});case 5:if(i=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,I(i,l);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}()),m=(t.setCallTypeAS=function(){var e=(0,s.default)(c.default.mark(function e(t,n,a){var r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t,n,1);case 2:if(!(r=e.sent)){e.next=6;break}return e.next=6,f(a);case 6:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setCallBackNumAS=function(){var e=(0,s.default)(c.default.mark(function e(t,n){var a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t,n);case 2:if(!(a=e.sent)){e.next=6;break}return e.next=6,h(n);case 6:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getCallTypeAndCallBackNumFromServer=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: getCallTypeAndCallBackNumFromServer"),t="ctd",e.next=4,C({path:t});case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",null);case 7:return e.next=9,I(n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),C=function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a,r,o,i,l,s,u,f,p,h,v,m,C,I=t.path,S=void 0===I?"":I,_=t.body,g=void 0===_?"":_;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: constructCloudUSGParams"),e.next=3,w();case 3:if(n=e.sent,a=coreAccount.getLoginModel(),r=a.authToken,o=a.serverUportalAddress,i=a.serverAddress,l=a.serverUportalPort,s=a.serverPort,u=o||i,f=l||s,p="https://"+u+":"+f,"/"===S[0]?p+=S:p=p+"/rest/usg/abs/v1/"+S,h=coreAccount.getLoginModel(),v=h.isSupportCACertCheck,m={caCertPath:window.EXEC_PATH,tlsMode:v?1:0},""!==r){e.next=14;break}return d.error("invalid authToken for EUA Request."),e.abrupt("return",null);case 14:return C={url:p,type:constant.REQUEST_TYPE.GET,header:{Authorization:"Basic "+r},body:g,proxyInfo:n,tlsParam:m,cipherlist:[]},""!==g&&(C.type=constant.REQUEST_TYPE.PUT,C.header["Content-Type"]="application/json"),e.abrupt("return",C);case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r,o,i;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: constructCloudUSGProxy"),t=coreAccount.getLoginModel(),n=t.proxyAddress,a=t.proxyPort,r=t.proxyAccount,o=t.isSupportProxy,e.next=5,coreSecurity.PasswordManager.getPassword("proxyPassword");case 5:return i=e.sent,o||(n="",a=0,r="",i=""),e.abrupt("return",{proxyAddress:n,proxyPort:a,proxyAccount:r,proxyPassword:i});case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.info("CTD: usgRequest"),e.next=3,new coreHttp.hwTupHttpTransSdk;case 3:return n=e.sent,e.next=6,n.sendSyncRequest(t);case 6:if(a=e.sent){e.next=10;break}return d.error("Usg Request Failed, invalid response."),e.abrupt("return",null);case 10:if(a.hasOwnProperty("result")&&0===a.result){e.next=13;break}return d.error("Usg Request Failed, result: "+(a.result?a.result:"Unknown Reason.")),e.abrupt("return",null);case 13:if(!a.hasOwnProperty("param")||!a.param.hasOwnProperty("resp_code")){e.next=28;break}if(304!==a.param.resp_code&&200!==a.param.resp_code){e.next=18;break}d.info("Usg Request Succeed, rsp: "+a.param.resp_code),e.next=26;break;case 18:if(401!==a.param.resp_code){e.next=24;break}return S(),d.error("Usg Request Failed, rsp: "+a.param.resp_code),e.abrupt("return",null);case 24:return d.error("Usg Request Failed, rsp: "+a.param.resp_code),e.abrupt("return",null);case 26:e.next=30;break;case 28:return d.error("Usg Request Failed, rsp: missing param or resp_code."),e.abrupt("return",null);case 30:if(a.param.hasOwnProperty("recv_body")&&a.param.recv_body){e.next=33;break}return d.info("Usg Request Failed, recv_body is null."),e.abrupt("return",null);case 33:if(r=JSON.parse(a.param.recv_body),d.info("Usg Request Result: "+r.returnMessage.split(".").pop()),!o||"000000003"!==r.returnCode){e.next=37;break}return e.abrupt("return",r.data||!0);case 37:if("000000000"===r.returnCode){e.next=39;break}return e.abrupt("return",null);case 39:return d.info("Usg Request Succeed."),e.abrupt("return",r.data||!0);case 41:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),S=function(){window.CLIENTCONFIG.ENABLE_IT_MEETING?window.refreshImToken():coreAccount.actionRefreshToken()},_=function(){var e=$getState().call.callBackNum,t=$getState().myInfo.mobile;if(""===e)return!1;if(t&&t===e)return d.info("callback number is mobile number"),!0;for(var n=$getState().call.callBackNumList,a=0;a<n.length;a++)if(e===n[a].number)return d.info("find callback number in callBackNumList"),!0;return!1},g=(t.initCallBackNum=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==_()){e.next=2;break}return e.abrupt("return");case 2:return d.info("start initCallBackNum"),e.next=5,coreContact.getUserInfo(coreAccount.getLoginModel().account);case 5:t=e.sent,n=t.param,a=n.mobile,r=$getState().call.callBackNumList,a&&(h(a),r.unshift({number:a}),p(r));case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.initTupCtd=function(){var e=(0,s.default)(c.default.mark(function e(){var t,n,a,r,i,l,s,u,f,p,h,v;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.hwTupCtdSdk;case 2:if(t=e.sent,n=void 0,a=$getState().login,r=a.isSupportCACertCheck,i=window.EXEC_PATH,!r){e.next=13;break}return e.next=10,t.ctdSetTls(i,1);case 10:n=e.sent,e.next=16;break;case 13:return e.next=15,t.ctdSetTls(i,0);case 15:n=e.sent;case 16:if(d.info("set ctd tls res=",n),!a.isSupportProxy){e.next=29;break}return l=a.proxyAddress,s=a.proxyPort,u=a.proxyAccount,e.next=21,coreSecurity.PasswordManager.getPassword("proxyPassword");case 21:return f=e.sent,e.next=24,t.ctdSetProxy(l,s,u,f);case 24:if(n=e.sent,0===n.result){e.next=28;break}return d.info("set ctd proxy failed, res=",(0,o.default)(n)),e.abrupt("return");case 28:d.info("set ctd proxy success");case 29:return p=a.serverAddress,h=a.serverPort,v=a.ctdServerUri,isNullOrEmpty(v)&&(v=p),e.next=33,t.ctdSetServerParam(v,h);case 33:n=e.sent,0!==n.result&&d.info("set ctd server param failed, res=",(0,o.default)(n)),d.info("set ctd server param success"),t.setNotifyFunc(786433,E);case 37:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.voiceCallPC=function(){var e=(0,s.default)(c.default.mark(function e(t,n){var a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=$getState().call.callType,!window.SERVERCONFIG.HWUC&&$getState().call.isShowCTDcallbackToPC&&1===a?N(t,n):(0,u.CallOut)(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getSipNumber=function(){var e=$getState().login.sipAccount;if(e){var t=e.indexOf("@"),n=e.indexOf("sip:"),a=-1!==n?4:0;return e=-1!==t?e.substring(a,t):e.substring(a)}return""}),b=function(e){var t=$getState(),n="",a=g();return window.isOffline?(n=language.CALL_FAILED_OFFLINE,d.error("ctd offline, can not start call")):e?t.myInfo.bind_no!==e&&a!==e||(n=language.CONFIRM_MYNO,d.error("ctd callNum is self, num= "+handlePhoneNumber(e))):(n=language.NOT_EMPTYNO,d.error("ctd callNum is null, = "+handlePhoneNumber(e))),""!==n&&(window.CLIENTCONFIG.ISMOBILE?alert(n):window.Toast(n,2,!1,null,"WhiteWarning"),!0)},N=t.startCtdCall=function(){var e=(0,s.default)(c.default.mark(function e(t,n){var a,r,i,l,s,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!b(t)){e.next=3;break}return d.info("start ctd call failed, check before call abnormal"),e.abrupt("return");case 3:if(a=$getState().call.callBackNum,r=$getState().login.authToken,!isNullOrEmpty(a)){e.next=8;break}return window.ToastNew(language.CALLBACKNUM_NOT_DELETE,2),e.abrupt("return");case 8:return i=g(),d.info("startCtdCall, callNum:"+handlePhoneNumber(t)+", callBackNum:"+handlePhoneNumber(a)+", sipAccount:"+handlePhoneNumber(i)),e.next=12,new coreTup.hwTupCtdSdk;case 12:return l=e.sent,e.next=15,l.ctdStartCall(a,t,r,i);case 15:s=e.sent,0!==s.result?(d.info("start ctd call failed, res=",(0,o.default)(s)),(window.CLIENTCONFIG.ISWIN||"mac"===window.CLIENTCONFIG.PLATFORM)&&window.Toast(language.CALL_CALLING_FAILED,3,!1,"pcToast","")):(window.CLIENTCONFIG.ISWIN||"mac"===window.CLIENTCONFIG.PLATFORM)&&(u=language.CALL_BACK_TIPS1.format(a)+","+language.CALL_BACK_TIPS2,window.Toast(u,3,!1,"pcToast","")),d.info("start ctd call success"),$dispatch(coreUi.changeUserInfo(n)),$dispatch(coreUi.changeCtdCallingState(!0)),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==window.getRoute()&&window.goRoute("callMain");case 21:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),E=function(e){d.info("notify, get ctd call result, data=",e)}},1784:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.callRecordNotifyMessageToIM=void 0;var r=n(1),o=a(r),i=n(2),c=a(i),l=window.Logger("logic")("callRecordImNotify");t.callRecordNotifyMessageToIM=function(){var e=(0,c.default)(o.default.mark(function e(t){var n,a,r,i,c,s,u,d,f,p,h,v,m,C,w;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",isNullOrEmpty(t)){e.next=9;break}return a=t.peeraccount,r=t.iscallout,i=t.callernumber,c=t.calleenumber,s=t.starttime,u=t.callstate,d=t.calltype,f=t.duration,p=t.isVideo,h=t.callUserName,v=t.isCallSuccess,n=v?1===d?"视频":"音频":"已拒绝",e.next=6,coreIm.getLocalRecent({owner:a});case 6:m=e.sent,C=void 0,isNullOrEmpty(m)||(C=coreIm.createCallRecordMessage(m,n),w=$getState().recent.currentRecentInfo,w.owner===m.owner?(l.info("callRecordNotifyMessage 在当前会话"),$dispatch(coreUi.addNewMessage(C))):l.info("callRecordNotifyMessage 不在当前会话"),coreDb.saveMessage(C));case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},1785:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(1),o=a(r),i=n(2),c=a(i),l=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.code||"total"!==t.event){e.next=6;break}if(window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=6;break}return e.next=5,coreCall.initTupCtd();case 5:coreCall.getInitCallRecordList();case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),u=n(880);window.Logger("call")("moduleMessager");coreCommon.registeModuleListener("login",l),coreCommon.registeModuleListener("logout",s),coreCommon.registeModuleListener("sipRegResultEvent",u.sipRegResultNotify)},179:function(e,t,n){var a=n(16),r=n(6)("iterator"),o=n(17);e.exports=n(8).isIterable=function(e){var t=Object(e);return void 0!==t[r]||"@@iterator"in t||o.hasOwnProperty(a(t))}},187:function(e,t,n){e.exports={default:n(231),__esModule:!0}},192:function(e,t,n){"use strict";var a=n(25).f,r=n(209),o=n(29),i=n(11),c=n(28),l=n(24),s=n(210),u=n(211),d=n(37),f=n(30),p=n(174).fastKey,h=n(162),v=f?"_s":"size",m=function(e,t){var n,a=p(t);if("F"!==a)return e._i[a];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,s){var u=e(function(e,a){c(e,u,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[v]=0,void 0!=a&&l(a,n,e[s],e)});return o(u.prototype,{clear:function(){for(var e=h(this,t),n=e._i,a=e._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete n[a.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var n=h(this,t),a=m(n,e);if(a){var r=a.n,o=a.p;delete n._i[a.i],a.r=!0,o&&(o.n=r),r&&(r.p=o),n._f==a&&(n._f=r),n._l==a&&(n._l=o),n[v]--}return!!a},forEach:function(e){h(this,t);for(var n,a=i(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(a(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!m(h(this,t),e)}}),f&&a(u.prototype,"size",{get:function(){return h(this,t)[v]}}),u},def:function(e,t,n){var a,r,o=m(e,t);return o?o.v=n:(e._l=o={i:r=p(t,!0),k:t,v:n,p:a=e._l,n:void 0,r:!1},e._f||(e._f=o),a&&(a.n=o),e[v]++,"F"!==r&&(e._i[r]=o)),e},getEntry:m,setStrong:function(e,t,n){s(e,t,function(e,n){this._t=h(e,t),this._k=n,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?u(0,n.k):"values"==t?u(0,n.v):u(0,[n.k,n.v]):(e._t=void 0,u(1))},n?"entries":"values",!n,!0),d(t)}}},193:function(e,t,n){"use strict";var a=n(7),r=n(10),o=n(174),i=n(137),c=n(35),l=n(29),s=n(24),u=n(28),d=n(15),f=n(36),p=n(25).f,h=n(212)(0),v=n(30);e.exports=function(e,t,n,m,C,w){var I=a[e],S=I,_=C?"set":"add",g=S&&S.prototype,b={};return v&&"function"==typeof S&&(w||g.forEach&&!i(function(){(new S).entries().next()}))?(S=t(function(t,n){u(t,S,e,"_c"),t._c=new I,void 0!=n&&s(n,C,t[_],t)}),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in g&&(!w||"clear"!=e)&&c(S.prototype,e,function(n,a){if(u(this,S,e),!t&&w&&!d(n))return"get"==e&&void 0;var r=this._c[e](0===n?0:n,a);return t?this:r})}),w||p(S.prototype,"size",{get:function(){return this._c.size}})):(S=m.getConstructor(t,e,C,_),l(S.prototype,n),o.NEED=!0),f(S,e),b[e]=S,r(r.G+r.W+r.F,b),w||m.setStrong(S,e,C),S}},194:function(e,t,n){var a=n(16),r=n(217);e.exports=function(e){return function(){if(a(this)!=e)throw TypeError(e+"#toJSON isn't generic");return r(this)}}},195:function(e,t,n){"use strict";var a=n(10);e.exports=function(e){a(a.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},196:function(e,t,n){"use strict";var a=n(10),r=n(12),o=n(11),i=n(24);e.exports=function(e){a(a.S,e,{from:function(e){var t,n,a,c,l=arguments[1];return r(this),t=void 0!==l,t&&r(l),void 0==e?new this:(n=[],t?(a=0,c=o(l,arguments[2],2),i(e,!1,function(e){n.push(c(e,a++))})):i(e,!1,n.push,n),new this(n))}})}},209:function(e,t,n){e.exports=n(0)(133)},210:function(e,t,n){e.exports=n(0)(241)},211:function(e,t,n){e.exports=n(0)(590)},212:function(e,t,n){var a=n(11),r=n(213),o=n(132),i=n(27),c=n(214);e.exports=function(e,t){var n=1==e,l=2==e,s=3==e,u=4==e,d=6==e,f=5==e||d,p=t||c;return function(t,c,h){for(var v,m,C=o(t),w=r(C),I=a(c,h,3),S=i(w.length),_=0,g=n?p(t,S):l?p(t,0):void 0;S>_;_++)if((f||_ in w)&&(v=w[_],m=I(v,_,C),e))if(n)g[_]=m;else if(m)switch(e){case 3:return!0;case 5:return v;case 6:return _;case 2:g.push(v)}else if(u)return!1;return d?-1:s||u?u:g}}},213:function(e,t,n){e.exports=n(0)(236)},214:function(e,t,n){var a=n(215);e.exports=function(e,t){return new(a(e))(t)}},215:function(e,t,n){var a=n(15),r=n(216),o=n(6)("species");e.exports=function(e){var t;return r(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!r(t.prototype)||(t=void 0),a(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},216:function(e,t,n){e.exports=n(0)(596)},217:function(e,t,n){var a=n(24);e.exports=function(e,t){var n=[];return a(e,!1,n.push,n,t),n}},231:function(e,t,n){n(34),n(22),n(23),n(232),n(233),n(234),n(235),e.exports=n(8).Map},232:function(e,t,n){"use strict";var a=n(192),r=n(162);e.exports=n(193)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=a.getEntry(r(this,"Map"),e);return t&&t.v},set:function(e,t){return a.def(r(this,"Map"),0===e?0:e,t)}},a,!0)},233:function(e,t,n){var a=n(10);a(a.P+a.R,"Map",{toJSON:n(194)("Map")})},234:function(e,t,n){n(195)("Map")},235:function(e,t,n){n(196)("Map")},67:function(e,t,n){e.exports={default:n(68),__esModule:!0}},68:function(e,t,n){var a=n(8),r=a.JSON||(a.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},718:function(e,t,n){"use strict";function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.clone(l),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.clientX,a=t.clientY,r=t.clientW,s=t.clientH,u=t.pleft,d=t.pright,f={top:a,left:n,width:r,height:s,pleft:u,pright:d},p={top:"-9999",left:"-9999",width:"-9999",height:"-9999",pleft:"0",pright:"0"};switch(t.type){case i:return(0,o.default)({},e,{isShowPopover:!0,popoverContent:t.popoverContent,popoverStyle:f});case c:return(0,o.default)({},e,{isShowPopover:!1,popoverContent:"",popoverStyle:p});default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.hidePopoverModal=t.showPopoverModal=void 0;var r=n(121),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=a;var i="common/modal/showPopoverModal",c="common/modal/hidePopoverModal",l={popoverStyle:{top:"-9999",left:"-9999",width:"-9999",height:"-9999",pleft:"0",pright:"0"},isShowPopover:!1,popoverContent:""};t.showPopoverModal=function(e,t,n,a,r,o,c){return{type:i,popoverContent:e,clientX:t,clientY:n,clientW:a,clientH:r,pleft:o,pright:c}},t.hidePopoverModal=function(){return{type:c}}},878:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i,c=n(3),l=a(c),s=n(67),u=a(s),d=n(1),f=a(d),p=n(2),h=a(p),v=n(4),m=a(v),C=n(5),w=a(C),I=window.Logger("model")("model/callService/callService"),S=(o=r=function(){function e(t){(0,m.default)(this,e),i.call(this);var n=(new Date).getTime(),a=formatDateYYYYMMDDHHMM(n),r="undefined"+t.tel_num;this.callInfo={callNo:t.tel_num,callId:t.call_id,callType:t.call_type,callState:t.call_state,callee:this.getCallee(t.tel_num,r),milltime:isNullOrEmpty(t.milltime)?n:t.milltime,ucaccount:r,startTime:isNullOrEmpty(t.startTime)?a.time:t.startTime,date:isNullOrEmpty(t.date)?a.date:t.date,callUserInfo:"",isVideo:1===t.call_type,reasonCode:0,endcall_reason:"",callInOut:t.callInOut,isCallSuccess:t.isCallSuccess,addrVip:t.addr_vip,isCallRingBack:!1,isFocus:0,isAssignedBwForData:!1,callerNumber:t.callerNumber,ringNumber:t.ringNumber,pickupCallType:t.pickupCallType},this.cntOfSpeech={high:0,low:0}}return(0,w.default)(e,[{key:"getCallee",value:function(e,t){return{name:e,mobile:e,contactAvatar:"./bin/img/contacts/Avatar_"+(e%12||0)+".png",ucaccount:t}}},{key:"getCallInfo",value:function(){return this.callInfo}},{key:"endCall",value:function(){function e(){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(){var t,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I.info("call service ,callId = "+this.callInfo.callId),e.next=3,new coreTup.HWTupCall;case 3:return t=e.sent,e.next=6,t.endCall(this.callInfo.callId);case 6:return n=e.sent,this.unInit(),e.abrupt("return",n);case 9:case"end":return e.stop()}},e,this)}));return e}()},{key:"dialDTMF",value:function(e,t){return t?void(this.callInfo.dtmfNo=e):!e||/[^0-9*#]/.test(e)?this.callInfo.dtmfNo:(this.callInfo.dtmfNo=this.callInfo.dtmfNo+e,"*"===e?e=10:"#"===e&&(e=11),this.callTupSendDTMF(e),I.info("DTMF dial"),this.callInfo.dtmfNo)}},{key:"callTupSendDTMF",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){var n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:n=e.sent,n.dtmf(this.callInfo.callId,t),I.info("call service ,dialDTMF = ");case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"operateMic",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){var n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.operateMic(this.callInfo.callId,t);case 5:if(a=e.sent,0!==a.result){e.next=11;break}return I.info("operate mic success"),e.abrupt("return",!0);case 11:return I.info("operate mic failed, result = "+a.result),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"switchAudioChannel",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){var n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.switchAudioChannel(this.callInfo.callId,t);case 5:if(a=e.sent,0!==a.result){e.next=11;break}return I.info("switchAudioChannel success"),e.abrupt("return",!0);case 11:return I.info("switchAudioChannel failed, result = "+a.result),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleCallEnded",value:function(e){I.info("enter handleCallEnded reason_code: "+e.param.reason_code+" callId: "+e.param.call_id),this.callInfo.callState=e.param.call_state,e.param.reason_code&&(this.callInfo.reasonCode=e.param.reason_code),e.param.endcall_reason&&(this.callInfo.endcall_reason=e.param.endcall_reason),403===e.param.reason_code&&coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_BEENDEDCALL_ERROR,handlePhoneNumber($getState().call.callNum),e.param.reason_code]}),coreCommon.Observer.publish("CallEnded",this.callInfo),this.unInit(),window.CLIENTCONFIG.ISBIGWIN&&(4041===e.param.reason_code&&(coreConf.NotifyConfNoStart(0),I.info("NotifyConfNoStart")),4042===e.param.reason_code&&(coreConf.NotifyConfTermination(0),I.info("NotifyConfTermination")))}},{key:"handleCallDestroy",value:function(e){I.info("enter handleCallDestroy"),this.callInfo.callState=e.param.call_state,e.param.endcall_reason&&(this.callInfo.endcall_reason=e.param.endcall_reason),coreCommon.Observer.publish("CallDestroy",this.callInfo)}},{key:"handleCallHoldSuccess",value:function(e){I.info("handleCallHoldSuccess callState: "+e.param.call_state+" callId: "+e.param.call_id),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallHoldSuccess",this.callInfo)}},{key:"handleCallHoldFailed",value:function(e){I.info("handleCallHoldFailed callState: "+e.param.call_state+" callId: "+e.param.call_id),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallHoldFailed",this.callInfo)}},{key:"handleCallUnHoldSuccess",value:function(e){I.info("handleCallUnHoldSuccess callState: "+e.param.call_state+" callId: "+e.param.call_id),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallUnHoldSuccess",this.callInfo)}},{key:"handleCallUnHoldFailed",value:function(e){I.info("handleCallUnHoldFailed callState: "+e.param.call_state+" callId: "+e.param.call_id),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallUnHoldFailed",this.callInfo)}},{key:"handleCallUpateRemoteInfo",value:function(e){I.info("handleCallUpateRemoteInfo callId: "+e.param.call_id);var t=JSON.parse((0,u.default)(this.callInfo));if(t.callId===e.param.call_id&&t.callNo!==e.param.tel_num){var n=(new Date).getTime(),a=formatDateYYYYMMDDHHMM(n);this.callInfo.milltime=n,this.callInfo.startTime=a.time,this.callInfo.date=a.date,this.callInfo.fwd_from_num=e.param.fwd_from_num,this.callInfo.fwd_from_name=e.param.fwd_from_name,this.callInfo.callInOut=constant.CALL_IN_OUT_TYPE.CALL_IN,this.callInfo.callNo=e.param.tel_num,this.callInfo.ucaccount="undefined"+e.param.tel_num,this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallUpateRemoteInfo",[t,this.callInfo])}else I.info("the number is the same remote number does not need to be changed")}},{key:"replyAddVideo",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){var n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.replyAddVideo(this.callInfo.callId,t);case 5:a=e.sent,0===a.result?I.info("reply add video success"):I.info("reply add video failed, result = "+a.result);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleCallRingBack",value:function(e){I.info("handleCallRingBack callId: "+e.param.call_id);var t=(new Date).getTime(),n=formatDateYYYYMMDDHHMM(t);this.callInfo.milltime=t,this.callInfo.startTime=n.time,this.callInfo.date=n.date,this.callInfo.callInOut=constant.CALL_IN_OUT_TYPE.CALL_OUT,this.callInfo.callState=e.param.call_state,0!==(e.param&&e.param.have_sdp)||this.callInfo.isCallRingBack||(coreCommon.Observer.publish("CallRingBack",e.param),this.callInfo.isCallRingBack=!0)}},{key:"handleLowVideoBW",value:function(e){coreCommon.Observer.publish("LowVideoBW",e.param),I.info("LowVideoBW")}},{key:"handleCallConnected",value:function(e){I.info("handleCallConnected callid: "+e.param.call_id);var t=(new Date).getTime();this.callInfo.milltime=t,this.callInfo.callState=e.param.call_state,this.callInfo.isCallSuccess=1,this.callInfo.callType=e.param.call_type,this.callInfo.isFocus=e.param.is_focus,this.callInfo.telNum=e.param.tel_num,coreCommon.Observer.publish("CallConnected",this.callInfo)}},{key:"handleCallAddVideo",value:function(e){I.info("AddVideoRequest"),coreCommon.Observer.publish("AddVideoRequest",e.param)}},{key:"handleCallDelVideo",value:function(e){I.info("DelVideoRequest"),coreCommon.Observer.publish("DelVideoRequest",e.param)}},{key:"handleCallRTPCreated",value:function(e){coreCommon.Observer.publish("CallRTPCreated",e.param),I.info("CallRTPCreated")}},{key:"handleCallModifyVideoResult",value:function(e){this.callInfo.reason_code=e.param.result,coreCommon.Observer.publish("CallModifyVideoResult",this.callInfo),I.info("CallModifyVideoResult",e.param)}},{key:"handleCallSessionModify",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreCommon.Observer.publish("CallSessionModify",this.callInfo),1!==this.callInfo.callType){e.next=12;break}return coreCommon.CameraControl.getInstance().setCallId(this.callInfo.callId),this.setDeviceControlCallId(t.param.call_id),e.next=6,coreCommon.CameraControl.getInstance().initAfterGetCallId();case 6:if(window.CLIENTCONFIG.ENABLE_IT_MEETING,!0){e.next=9;break}return e.next=9,window.dealFloatWindow();case 9:window.otherAudioDevicesConnect||coreCommon.SpkControl.getInstance().setHandsFree(!0),e.next=14;break;case 12:"ios"===window.CLIENTCONFIG.PLATFORM?setTimeout(function(){coreCommon.SpkControl.getInstance().setHandsFree(!1)},1e3):coreCommon.SpkControl.getInstance().setHandsFree(!1),coreCommon.CameraControl.getInstance().unInit();case 14:I.info("Call[Session]Modify",t.param.svc_lables);case 15:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleCallBldTransferFailed",value:function(e){I.info("handleCallBldTransferFailed"),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallBldTransferFailed",e.param)}},{key:"handleCallBldTransferSuccess",value:function(e){I.info("handleCallBldTransferSuccess"),this.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallBldTransferSuccess",e.param)}},{key:"addSvcVideoWindow",value:function(){function e(e,n,a,r,o){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t,n,a,r,o){var i,c,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return i=e.sent,e.next=5,i.addSvcVideoWindow(t,n,a,r,o,l);case 5:return c=e.sent,0===c.result?I.info("addSvcVideoWindow success"):I.info("addSvcVideoWindow failed, result = ",c),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"updateSvcVideoWindow",value:function(){function e(e,n,a,r,o){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t,n,a,r,o){var i,c,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return i=e.sent,e.next=5,i.updateSvcVideoWindow(t,n,a,r,o,l);case 5:return c=e.sent,0===c.result?I.info("updateSvcVideoWindow success"):I.info("updateSvcVideoWindow failed, result = ",c),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"removeSvcVideoWindow",value:function(){function e(e,n,a,r){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t,n,a,r){var o,i;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return o=e.sent,e.next=5,o.removeSvcVideoWindow(t,n,a,r);case 5:return i=e.sent,0===i.result?I.info("removeSvcVideoWindow success"):I.info("removeSvcVideoWindow failed, result = ",i),e.abrupt("return",i);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"resetBFCStatus",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t,n){var a,r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return a=e.sent,e.next=5,a.resetBFCStatus(t,n);case 5:return r=e.sent,0===r.result?I.info("resetBFCStatus success"):I.info("resetBFCStatus failed, result = "+r.result),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"svcRedistributeVideoTmmbr",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t){var n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.svcRedistributeVideoTmmbr(t);case 5:return a=e.sent,0===a.result?I.info("svcRedistributeVideoTmmbr success"):I.info("svcRedistributeVideoTmmbr failed, result = "+a.result),e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"startCall",value:function(){function t(e,t){return n.apply(this,arguments)}var n=(0,h.default)(f.default.mark(function t(n,a){var r,o,i,c,l,s,u=this;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return I.info("startCall isVideo: "+n+" isConf: "+a),t.next=3,new coreTup.HWTupCall;case 3:if(r=t.sent,o=e.getPromise(),r.setNotifyFunc(98308,function(e){u.callInfo.callType=e.param.call_type,u.callInfo.isVideo=1===e.param.call_type,u.callInfo.callState=e.param.call_state,a||(I.info("CallOutGoing start call"),coreCommon.Observer.publish("CallOutGoing",u.callInfo)),o.resolve(e)}),i=e.getPromise(),r.setNotifyFunc(98306,function(e){i.resolve(e)}),!n){t.next=11;break}return t.next=11,coreCommon.CameraControl.getInstance().initSetVideoIndex();case 11:if(c=void 0,!(window.CLIENTCONFIG.ISBIGWIN&&n&&this.callInfo.addrVip.length>0)){t.next=18;break}return t.next=15,r.startVipCall(this.callInfo.callNo,n,this.callInfo.addrVip);case 15:c=t.sent,t.next=21;break;case 18:return t.next=20,r.startCall(this.callInfo.callNo,n);case 20:c=t.sent;case 21:if(I.info("start call result = "+c.result),!c||0!==c.result){t.next=27;break}this.callInfo.callId=c.param.call_id,this.setDeviceControlCallId(c.param.call_id),t.next=30;break;case 27:return r.setNotifyFunc(98308,null),coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_STARTCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),c.result]}),t.abrupt("return");case 30:return t.next=32,i.promise;case 32:if(l=t.sent,I.info("CALL_E_EVT_CALL_STARTCALL_RESULT result = "+l.param.result),0!==l.param.result){t.next=46;break}return t.next=37,o.promise;case 37:if(s=t.sent,coreCommon.SpkControl.getInstance().cancelSysSpkMute(),!n){t.next=42;break}return t.next=42,coreCommon.CameraControl.getInstance().initAfterGetCallId();case 42:return r.setNotifyFunc(98308,null),t.abrupt("return",s);case 46:return r.setNotifyFunc(98308,null),coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_CALL_ERROR,params:[constant.UT_CALL_ERROR_TYPE.UT_STARTCALL_ERROR,handlePhoneNumber(this.callInfo.callNo),c.result]}),t.abrupt("return");case 49:case"end":return t.stop()}},t,this)}));return t}()},{key:"getCallBandwidth",value:function(){function e(){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(){var t,n,a,r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={callid:this.callInfo.callId,infoid:0},n=0,a=void 0,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=9;break}return e.next=6,coreCall.getBasicCallInfoNew(t);case 6:a=e.sent,e.next=15;break;case 9:return e.next=11,new coreTup.HWTupCall;case 11:return r=e.sent,e.next=14,r.getBasicCallInfo(t);case 14:a=e.sent;case 15:return 0===a.result?(I.info("getCallBandwidth success,bandwidth = "+a.param.call_info.bandwidth),n=a.param.call_info.bandwidth):I.info("getCallBandwidth failed"),e.abrupt("return",n);case 17:case"end":return e.stop()}},e,this)}));return e}()},{key:"assignBandwidthForData",value:function(){function t(){return n.apply(this,arguments)}var n=(0,h.default)(f.default.mark(function t(){var n,a;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.callInfo.isVideo){t.next=3;break}return I.info("audio conf, default data bandwidth: 2M"),t.abrupt("return",2e3);case 3:return t.next=5,this.getCallBandwidth();case 5:return n=t.sent,a=e.assignBandwidth(n),I.info("assignBandwidthForData, total: "+n+", data: "+a[1]),t.abrupt("return",a[1]);case 9:case"end":return t.stop()}},t,this)}));return t}()},{key:"setDataBandwidth",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(t,n){var a,r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.callInfo.isVideo){e.next=3;break}return I.info("audio conf, not set data bandwidth."),e.abrupt("return");case 3:if(!(this.callInfo.isAssignedBwForData&&0===t||!this.callInfo.isAssignedBwForData&&2===t)){e.next=6;break}return I.info("not assign again, optType: ",t),e.abrupt("return");case 6:return e.next=8,new coreTup.HWTupCall;case 8:return a=e.sent,e.next=11,a.setDataBandwidth(this.callInfo.callId,t,n);case 11:r=e.sent,0===r.result?(I.info("setBandwidth success"),0===t?this.callInfo.isAssignedBwForData=!0:2===t&&(this.callInfo.isAssignedBwForData=!1)):I.info("setBandwidth failed, res = ",r);case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"startPickupCall",value:function(){function t(){return n.apply(this,arguments)}var n=(0,h.default)(f.default.mark(function t(){var n,a,r,o,i=this;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new coreTup.HWTupCall;case 2:if(n=t.sent,a=e.getPromise(),n.setNotifyFunc(98308,function(e){i.callInfo.callType=e.param.call_type,i.callInfo.isVideo=1===e.param.call_type,i.callInfo.callState=e.param.call_state,coreCommon.Observer.publish("CallOutGoing",i.callInfo),a.resolve(e)}),"tel:"===this.callInfo.callerNumber.substr(0,4)?this.callInfo.callNo=this.callInfo.callerNumber.substr(4,this.callInfo.callerNumber.length-4):this.callInfo.callNo=this.callInfo.callerNumber,I.info("this.callInfo.callNo = ",this.callInfo.callNo),r=void 0,1!==this.callInfo.pickupCallType){t.next=14;break}return t.next=11,n.groupPickupEx(this.callInfo.callId,1,this.callInfo.callerNumber,this.callInfo.ringNumber);case 11:r=t.sent,t.next=18;break;case 14:if(2!==this.callInfo.pickupCallType){t.next=18;break}return t.next=17,n.pointPickupEx(this.callInfo.callId,1,this.callInfo.callerNumber,this.callInfo.ringNumber);case 17:r=t.sent;case 18:if(I.info("start call result = "+r.result),!r||0!==r.result){t.next=27;break}return t.next=22,a.promise;case 22:return o=t.sent,n.setNotifyFunc(98308,null),t.abrupt("return",o);case 27:return n.setNotifyFunc(98308,null),t.abrupt("return");case 29:case"end":return t.stop()}},t,this)}));return t}()},{key:"unInit",value:function(){function e(){return t.apply(this,arguments)}var t=(0,h.default)(f.default.mark(function e(){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCommon.SpkControl.getInstance().makeSysSpkMute();case 2:coreCommon.SpkControl.getInstance().setHandsFree(!1),coreCommon.CameraControl.getInstance().unInit(),coreCommon.SpkControl.getInstance().unInit(),coreCommon.MicControl.getInstance().unInit();case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"setDeviceControlCallId",value:function(e){coreCommon.MicControl.getInstance().setCallId(e),coreCommon.SpkControl.getInstance().setCallId(e),coreCommon.CameraControl.getInstance().setCallId(e)}}],[{key:"getPromise",value:function(){var e={};return e.promise=new l.default(function(t,n){e.resolve=t,e.reject=n}),e}},{key:"addStarBeforeBindNo",value:function(e){return I.info("addStarBeforeBindNo = ",handlePhoneNumber(e)),"*"+e}},{key:"assignBandwidth",value:function(e){return e?e<128?[e/2,e/2]:e<256?[e/2,e/2]:e<384?[128,128]:e<512?[128,192]:e<768?[256,256]:e<1024?[384,384]:e<1152?[512,512]:e<1536?[640,512]:e<1920?[768,768]:e<2048?[1152,768]:e<2880?[1280,768]:e<3840?[1344,1536]:e<5760?[1920,1920]:[e/2,e/2]:[1152,768]}}]),e}(),i=function(){var e=this;this.handleCallIncomming=function(){var t=(0,h.default)(f.default.mark(function t(n){var a,r;return f.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:I.info("handleCallIncomming callid: "+n.param.call_id),a=(new Date).getTime(),r=formatDateYYYYMMDDHHMM(a),e.callInfo.milltime=a,e.callInfo.startTime=r.time,e.callInfo.date=r.date,e.callInfo.callState=n.param.call_state,e.callInfo.callType=n.param.call_type,e.callInfo.callInOut=constant.CALL_IN_OUT_TYPE.CALL_IN,e.callInfo.fwd_from_num=n.param.fwd_from_num,e.callInfo.fwd_from_name=n.param.fwd_from_name,e.callInfo.display_name=n.param.display_name,coreCommon.Observer.publish("CallIncomming",e.callInfo);case 13:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}()},o);t.default=S},879:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.clearAllDeviceCtrl=t.getSpkCtrl=t.getMicCtrl=t.getCameraCtrl=t.startPickupCall=t.createCallId=t.assignBandwidthForData=t.getCallBandwidth=t.setDataBandwidth=t.sendUniversalInfo=t.setEncoderMaxCap=t.getCallInfoByCallId=t.setBandwidth=t.callJointStopLinkage=t.callJointStartLinkage=t.setTUPCallCfg=t.pairPermit=t.pairEnable=t.pairLinkageEnd=t.pairLinkageLeave=t.pairLinkage=t.pairSubscribe=t.cancelPair=t.makePair=t.getCntOfSpeechLevel=t.setCntOfSpeechLevel=t.getCallById=t.closeSvcDataSocket=t.closeAllSvcRemoteSocket=t.closeSvcRemoteSocket=t.getSvcRender=t.setSvcBFCPVideoRender=t.setSvcLocalVideoRender=t.setSvcRemoteVideoRender=t.svcRedistributeVideoTmmbr=t.resetBFCStatus=t.removeSvcVideoWindow=t.updateSvcVideoWindow=t.addSvcVideoWindow=t.setVideoWindow=t.startData=t.getMicLevel=t.closeAudioPreview=t.openAudioPreview=t.deleteCallObject=t.newCallObject=t.getCallCount=t.transferConfEx=t.delVideo=t.setVideoRender=t.setVideoCollectMode=t.setDisplayRotation=t.setCaptureRotation=t.replyAddVideo=t.activeStopBFCPData=t.switchAudioChannel=t.operateMic=t.setVideoIndex=t.getVideoIndex=t.setSpkIndex=t.setAllSvcVideoWindows=t.setBfcpIsBigWnd=t.getSpkIndex=t.setMicIndex=t.getMicIndex=t.setSpkDeviceVol=t.setMicDeviceVol=t.getSpkDeviceVol=t.getMicDeviceVol=t.getMediaDevices=t.addVideo=t.consultTransfer=t.blindTransfer=t.divertCall=t.unHoldCall=t.holdCall=t.stopPlayMediaFile=t.startPlayMediaFile=t.getMicVol=t.getSpkVol=t.setMicVol=t.setCallReinvite=t.setCallCapability=t.setSpkVol=t.setVideoWHForMode=t.setVideoWH=t.closeDataCanvasSocket=t.closeRemoteCanvasSocket=t.closeLocalCanvasSocket=t.setBFCPVideoRender=t.setLocalVideoRender=t.setRemoteVideoRender=t.setCallNotifyFunc=t.getBasicCallInfoNew=t.dialDTMF=t.endCallService=t.acceptCall=t.startCall=void 0;var r=n(67),o=a(r),i=n(143),c=a(i),l=n(1),s=a(l),u=n(2),d=a(u),f=n(1002),p=a(f),h=window.Logger("model")("model/callService/index"),v=new p.default,m=(t.startCall=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("startCall isVideo: "+n),e.next=3,v.startCall(t,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.acceptCall=function(){var e=(0,d.default)(s.default.mark(function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("accept call, callId = "),e.next=3,v.acceptCall(t,n);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.endCallService=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("end call, callId = "+t),e.next=3,v.endCall(t);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.dialDTMF=function(e,t,n){return v.dialDTMF(e,t,n)},t.getBasicCallInfoNew=function(e){return h.info("callService, getBasicCallInfoNew, param ="+e),v.getBasicCallInfoNew(e)},t.setCallNotifyFunc=function(){h.info("set call service callback func"),v.setCallNotifyFunc()},t.setRemoteVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t){var n,a,r,o,i,l,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("<video>remote winSize = ",t),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setRemoteVideoRender unneeded for mobile"),e.abrupt("return");case 4:return n=document.getElementById("remoteCanvas"),n&&n.width&&n.height?h.info("<video>remoteCanvas width = "+n.width+",height = "+n.height):h.error("<video>remoteCanvas is null"),a=t.width,r=t.height,e.next=10,v.calcVideoRealSize(a,r);case 10:return o=e.sent,i=(0,c.default)(o,2),l=i[0],u=i[1],e.next=16,v.setRemoteVideo(n,{getUri:"remote_frame_share",viewW:l,viewH:u});case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setLocalVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t){var n,a,r,o,i,l,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("<video>local winSize = ",t),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setLocalVideoRender unneeded for mobile"),e.abrupt("return");case 4:return n=document.getElementById("localCanvas"),n&&n.width&&n.height?h.info("<video>localCanvas width = "+n.width+",height = "+n.height):h.error("<video>localCanvas is null"),a=t.width,r=t.height,e.next=10,v.calcVideoRealSize(a,r);case 10:return o=e.sent,i=(0,c.default)(o,2),l=i[0],u=i[1],e.next=16,v.setLocalVideo(n,{getUri:"local_frame_share",viewW:l,viewH:u});case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setBFCPVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t){var n,a,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("<video>bfcp winSize = ",t),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setBFCPVideoRender unneeded for mobile"),e.abrupt("return");case 4:return n=document.getElementById("dataCanvas"),n&&n.width&&n.height?h.info("<video>bfcpCanvas width = "+n.width+",height = "+n.height):h.error("<video>bfcpCanvas is null"),a=t.width,r=t.height,e.next=10,v.setBFCPVideo(n,{getUri:"data_frame_share",viewW:a,viewH:r});case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.closeLocalCanvasSocket=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeLocalCanvasSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,v.closeLocalSocket();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.closeRemoteCanvasSocket=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeRemoteCanvasSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,v.closeRemoteSocket();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.closeDataCanvasSocket=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeDataCanvasSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,v.closeDataSocket();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setVideoWH=function(){var e=(0,d.default)(s.default.mark(function e(t,n){var a,r,o,i,l,u,d,f;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("change video WH, videoWinMode = "+t+",width = "+n.width+",height = "+n.height),a=n.width,r=n.height,e.next=5,v.calcVideoRealSize(a,r);case 5:if(o=e.sent,i=(0,c.default)(o,2),l=i[0],u=i[1],!t){e.next=15;break}return d=document.getElementById("remoteCanvas"),e.next=13,v.setRemoteVideoWH(l,u,d);case 13:e.next=18;break;case 15:return f=document.getElementById("localCanvas"),e.next=18,v.setLocalVideoWH(l,u,f);case 18:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setVideoWHForMode=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a,r){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h.info("setVideoWHForMode, mode: "+t+"lastMode: "+n),0===t?(v.setBFCPDataWH(a.width,a.height),1===n?v.setRemoteVideoWH(r.width,r.height):2===n&&v.setLocalVideoWH(r.width,r.height)):1===t?(v.setRemoteVideoWH(a.width,a.height),0===n?v.setBFCPDataWH(r.width,r.height):2===n&&v.setLocalVideoWH(r.width,r.height)):2===t?(v.setLocalVideoWH(a.width,a.height),1===n?v.setRemoteVideoWH(r.width,r.height):0===n&&v.setBFCPDataWH(r.width,r.height)):h.info("win mode error!!!");case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n,a,r){return e.apply(this,arguments)}}(),t.setSpkVol=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setSpkVol(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setCallCapability=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setCallCapability(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setCallReinvite=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setCallReinvite(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setMicVol=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setMicVol(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getSpkVol=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getSpkVol();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getMicVol=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getMicVol();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.startPlayMediaFile=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.startPlayMediaFile(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.stopPlayMediaFile=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.stopPlayMediaFile(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.holdCall=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.holdCall(t);case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.unHoldCall=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.unHoldCall(t);case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.divertCall=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.divertCall(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.blindTransfer=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.blindTransfer(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.consultTransfer=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.consultTransfer(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.addVideo=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.addVideo(t);case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getMediaDevices=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getMediaDevices(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getMicDeviceVol=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getMicDeviceVol();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getSpkDeviceVol=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getSpkDeviceVol();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setMicDeviceVol=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setMicDeviceVol(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setSpkDeviceVol=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setSpkDeviceVol(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getMicIndex=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getMicIndex();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setMicIndex=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setMicIndex(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getSpkIndex=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getSpkIndex();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setBfcpIsBigWnd=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setBfcpIsBigWnd(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setAllSvcVideoWindows=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setAllSvcVideoWindows(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setSpkIndex=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setSpkIndex(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getVideoIndex=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getVideoIndex();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setVideoIndex=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setVideoIndex(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.operateMic=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.operateMic(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.switchAudioChannel=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.switchAudioChannel(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.activeStopBFCPData=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.activeStopBFCPData(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.replyAddVideo=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.replyAddVideo(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setCaptureRotation=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setCaptureRotation(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setDisplayRotation=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setDisplayRotation(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setVideoCollectMode=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setVideoCollectMode(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("call service setVideoRender"),e.next=3,v.setVideoRender(t,n,a,r,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.delVideo=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.delVideo(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.transferConfEx=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.transferConfEx(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getCallCount=function(){return v.getCallCount()},t.newCallObject=function(e,t){v.newCallObject(e,t)},t.deleteCallObject=function(e){v.deleteCallObject(e)},t.openAudioPreview=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.openAudioPreview();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.closeAudioPreview=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.closeAudioPreview();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getMicLevel=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getMicLevel();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.startData=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("start data, callId = "),e.next=3,v.startData(t);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setVideoWindow=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setVideoWindow(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.addSvcVideoWindow=function(e,t,n,a,r){return v.addSvcVideoWindow(e,t,n,a,r)},t.updateSvcVideoWindow=function(e,t,n){return v.updateSvcVideoWindow(e,t,n)},t.removeSvcVideoWindow=function(e,t,n,a){return v.removeSvcVideoWindow(e,t,n,a)},t.resetBFCStatus=function(e,t){return v.resetBFCStatus(e,t)},t.svcRedistributeVideoTmmbr=function(e){return h.info("svcRedistributeVideoTmmbr"),v.svcRedistributeVideoTmmbr(e)},t.setSvcRemoteVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){var r,i,c;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("[SVC TupRender2]setSvcRemoteVideoRender,renderID =  "+t+",renderURI = "+n+" ,renderSize = "+(0,o.default)(a)),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setSvcRemoteVideoRender unneeded for mobile"),e.abrupt("return");case 4:if(!((r=document.getElementById(t))&&r.width&&r.height)){e.next=9;break}h.info("[SVC TupRender2]setSvcRemoteVideoRender,svcRemoteCanvas width = "+r.width+",height = "+r.height),e.next=11;break;case 9:return h.error("[SVC TupRender2]setSvcRemoteVideoRender,svcRemoteCanvas is null,return"),e.abrupt("return");case 11:return i=a.width,c=a.height,e.next=15,v.setSvcRemoteVideo(t,r,{getUri:n,viewW:i,viewH:c});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setSvcLocalVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t){var n,a,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("[SVC TupRender2]setSvcLocalVideoRender renderSize = "+(0,o.default)(t)),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setSvcLocalVideoRender unneeded for mobile"),e.abrupt("return");case 4:if(!((n=document.getElementById("-1"))&&n.width&&n.height)){e.next=9;break}h.info("[SVC TupRender2]setSvcRemoteVideoRender,svcLocalCanvas width = "+n.width+",height = "+n.height),e.next=11;break;case 9:return h.error("[SVC TupRender2]setSvcRemoteVideoRender,svcLocalCanvas is null,return"),e.abrupt("return");case 11:return a=t.width,r=t.height,e.next=15,v.setSvcLocalVideo(-1,n,{getUri:"local_frame_share",viewW:a,viewH:r});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setSvcBFCPVideoRender=function(){var e=(0,d.default)(s.default.mark(function e(t){var n,a,r,i,c,l;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("<video>bfcp winSize = ",t),!window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return h.info("setSvcBFCPVideoRender unneeded for mobile"),e.abrupt("return");case 4:if(!((n=document.getElementById("dataCanvas"))&&n.width&&n.height)){e.next=9;break}h.info("<video>bfcpCanvas width = "+n.width+",height = "+n.height),e.next=11;break;case 9:return h.error("<video>bfcpCanvas is null"),e.abrupt("return");case 11:return a=coreConf.SvcAttendanceManager.getBigCanvasSize(),r={},i=$getState().conf.bfcpFrameSize,isNullOrEmpty(i)?(h.info("svc bfcpFrameSize is null"),r=C(t,a.width,a.height)):(h.info("svc bfcpFrameSize is ",i),r=m(i,a.width,a.height),h.info("bfcpSize = ",r)),c=r.width,l=r.height,n.width=c,n.height=l,h.info("winSize==",(0,o.default)(t)),h.info("bfcpCanvas=="+n.width+n.height),e.next=23,v.setSvcBFCPVideo(n,{getUri:"data_frame_share",viewW:c,viewH:l});case 23:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(e,t,n){var a=e.width/e.height;return a>=1?t>=n&&t/n>a?{width:Math.floor(n*a),height:n}:{width:t,height:Math.floor(t/a)}:t>=n?{width:Math.floor(n*a),height:n}:t/n>a?{width:Math.floor(n*a),height:n}:{width:t,height:Math.floor(t/a)}}),C=function(e,t,n){var a=(coreConf.SvcAttendanceManager.getBigCanvasSize(),{width:0,height:0});if(e.width<t&&e.height<n)return a={width:e.width,height:e.height},h.info("newCanvasSize=",(0,o.default)(a),e,t,n),a;if(e.width>=t&&e.height<n)a={width:t,height:Math.floor(e.height/e.width*t)};else if(e.width<t&&e.height>=n)a={width:Math.floor(e.width/e.height*n),height:n};else{var r=e.width/t,i=e.height/n;a=r>i?{width:t,height:Math.floor(e.height/e.width*t)}:{width:Math.floor(e.width/e.height*n),height:n}}return a};t.getSvcRender=function(e){return h.info("getSvcRender"),p.default.getRemoteSvcRender(e)},t.closeSvcRemoteSocket=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeSvcRemoteSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,v.closeSvcRemoteSocket(t);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.closeAllSvcRemoteSocket=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeAllSvcRemoteSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,v.closeAllSvcRemoteSocket();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.closeSvcDataSocket=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=3;break}return h.info("closeAllSvcRemoteSocket unneeded for mobile"),e.abrupt("return");case 3:return e.next=5,v.closeSvcDataSocket();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getCallById=function(e){return p.default.CallList[e]||{}},t.setCntOfSpeechLevel=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setCntOfSpeechLevel(t,n);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getCntOfSpeechLevel=function(){var e=(0,d.default)(s.default.mark(function e(t){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getCntOfSpeechLevel(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.makePair=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.makePair(t,n,a,r,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a,r){return e.apply(this,arguments)}}(),t.cancelPair=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.cancelPair(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.pairSubscribe=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.pairSubscribe(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.pairLinkage=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.pairLinkage(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.pairLinkageLeave=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.pairLinkageLeave(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.pairLinkageEnd=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.pairLinkageEnd(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.pairEnable=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.pairEnable(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.pairPermit=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a,r,o,i,c,l){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.pairPermit(t,n,a,r,o,i,c,l);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a,r,o,i,c,l){return e.apply(this,arguments)}}(),t.setTUPCallCfg=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setTUPCallCfg(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.callJointStartLinkage=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.callJointStartLinkage();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.callJointStopLinkage=function(){var e=(0,d.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.callJointStopLinkage();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setBandwidth=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setBandwidth(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.getCallInfoByCallId=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getCallInfoByCallId(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setEncoderMaxCap=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a,r,o){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setEncoderMaxCap(t,n,a,r,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),t.sendUniversalInfo=function(){var e=(0,d.default)(s.default.mark(function e(t,n){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.sendUniversalInfo(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),t.setDataBandwidth=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.setDataBandwidth(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.getCallBandwidth=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getCallBandwidth(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.assignBandwidthForData=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.assignBandwidthForData(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.createCallId=function(){var e=(0,d.default)(s.default.mark(function e(t,n,a){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.createCallId(t,n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.startPickupCall=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.startPickupCall(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getCameraCtrl=function(e){return v.getCameraCtrl(e)},t.getMicCtrl=function(e){return v.getMicCtrl(e)},t.getSpkCtrl=function(e){return v.getSpkCtrl(e)},t.clearAllDeviceCtrl=function(e){v.clearAllDeviceCtrl(e)}},880:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.rejectPickupCall=t.acceptPickupCall=t.handleCallPickupRemoteInfo=t.handleCallPickupNotify=t.handleNotifyCallBeenHangup=t.resetCallInfo=t.IsDialingCallInfo=t.transferNumberToName=t.setTransferFlagHandle=t.changeCallHoldStatusLogic=t.refreshCallPage=t.blindTranseferEntrance=t.getIsTransFer=t.consultTransfer=t.resumeCall=t.hangupHoldCall=t.getCallInfoByCallId=t.changeDirectionForMobile=t.dealPassiveDirectionResult=t.doAfterSimCall=t.recallOrHangup=t.stopBfcpReceive=t.handleDeviceHowlStatus=t.handleUpdateSvcRender=t.handleSvcVideoWindows=t.handleSeessionModify=t.handleModifyVideoResult=void 0,t.switchToAudio=t.switchToVideo=t.holdCall=t.removeVideo=t.updateToVideo=t.getCallMediaInfo=t.getCallMediaInfoBySsrc=t.handleisSvcConfShowQOS=t.getCallMediaInfoOfNative=t.getCallMediaInfoOnMobile=t.resumeUserSelect=t.setUserSelectToNone=t.SipRegusterNotOK=t.SipRegusterOKMobile=t.callAfterPCKickout=t.sipRegResultNotify=t.startsipcallout=t.handleDataStopped=t.handleDataSending=t.handleDataStartError=t.changeNoStreamEndcall=t.handleNoStream=t.handleSpkMicList=t.handleCameraList=t.handlelowCallLocalQos=t.actionDialDTMF=t.produceCallMemberList=t.closeRemoteSocketWhenCallEnd=t.endCall=t.callDestroy=t.callInfo=t.callEnded=t.callRecordSave=t.updateHoldCallList=t.callOutGoing=t.callInComming=t.acceptCall=t.configMsDataConf=t.setCallReinvite=t.setcallcapability=t.setVoiceValue=t.switchAudioChannel=t.muteMicAndSpeaker=t.callLocalQos=t.onCallAtdTransferFailed=t.onCallAtdTransferSuccess=t.onCallUnHoldFailed=t.onCallUnHoldSuccess=t.onCallHoldFailed=t.onCallHoldSuccess=t.handleCallRingBack=t.getSpkValue=t.getMicValue=t.setMicValue=t.addVideoRequest=t.delVideoRequest=t.getBasicBandInfo=t.rejectUpdateToVideo=t.acceptUpdateToVideo=t.callJointEstablishedNotify=t.callConnected=t.getInfoList=t.showMediaInfo=t.toggleSmallPageWhenCall=t.setNoMoveTrue=t.checkHasCall=t.changeNotifyContent=t.showConfirmChairNotify=t.showConfirmNotify=t.clearCallOutTimer=t.callHangup=t.dealSipLoginCheck=t.callMultiTerminalCheck=t.handleErr=t.handleMobile=t.handleVideoCall=t.handleAudioCall=t.handlePairCallResult=t.pairCallOut=t.CallOut=t.setVoiceMailInfo=t.checkBeforeCallOut=t.Call2GNet=t.onekeyMobileCallOut=t.CalloutForTempConf=t.getCameraDevices=t.getSpkDevices=t.getMicDevices=t.getALLDevices=t.getCallList=t.setNotifyInfo=t.Abnormal=t.changeNotify=t.showBrowserWindow=t.dataTipsShowBrowserWindow=t.dataConfShowBrowserWindow=t.pickiupBrowserWindow=t.newCallNotifyshowBrowserWindow=t.notifyshowBrowserWindow=t.registerCallEvent=void 0;var r=n(187),o=a(r),i=n(129),c=a(i),l=n(67),s=a(l),u=n(121),d=a(u),f=n(3),p=a(f),h=n(1),v=a(h),m=n(2),C=a(m),w=n(879),I=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(w),S=n(1004),_=n(1005),g=window.Logger("logic")("call/audio/index"),b=null,N=null,E=null,T=0,k=0,y=null,x=null,O=[],L={},M="",R=null,A=null,V=null;window.otherAudioDevicesConnect=!1;var F=(t.registerCallEvent=function(){g.info("registerCallEvent, Observer subscribe topics");var e=new coreCommon.ObserverOpts("MODULE_CALL_START_END");I.setCallNotifyFunc(),coreCommon.Observer.subscribe("CallIncomming",Re,e),coreCommon.Observer.subscribe("CallOutGoing",Ae,e),coreCommon.Observer.subscribe("CallEnded",De,e),coreCommon.Observer.subscribe("callInfo",Ue),coreCommon.Observer.subscribe("CallDestroy",Be,e),coreCommon.Observer.subscribe("CallConnected",ce,e),coreCommon.Observer.subscribe("CallLocalQos",Oe),coreCommon.Observer.subscribe("CallRingBack",Ie),coreCommon.Observer.subscribe("CallHoldSuccess",Se),coreCommon.Observer.subscribe("CallHoldFailed",_e),coreCommon.Observer.subscribe("CallUnHoldSuccess",ge),coreCommon.Observer.subscribe("CallUnHoldFailed",be),coreCommon.Observer.subscribe("CallAtdTransferFailed",Ee),coreCommon.Observer.subscribe("CallAtdTransferSuccess",Ne),coreCommon.Observer.subscribe("CallUpateRemoteInfo",Bt),coreCommon.Observer.subscribe("AddVideoRequest",ve),coreCommon.Observer.subscribe("DelVideoRequest",he),coreCommon.Observer.subscribe("CallRTPCreated",Ye),coreCommon.Observer.subscribe("handleNoStream",je),coreCommon.Observer.subscribe("HandleSpkMicList",ze),coreCommon.Observer.subscribe("HandleCameraList",He),coreCommon.Observer.subscribe("CallModifyVideoResult",mt),coreCommon.Observer.subscribe("CallSessionModify",Ct),coreCommon.Observer.subscribe("SvcVideoWindows",wt),coreCommon.Observer.subscribe("DeviceHowlStatus",St),coreCommon.Observer.subscribe("MediaSRTPStatus",_t),coreCommon.Observer.subscribe("handleSipKickOff",qe),coreCommon.Observer.subscribe("handleUploadChrFile",coreHttp.handleUploadChrFile),coreCommon.Observer.subscribe("lowCallLocalQos",Ge),coreCommon.Observer.subscribe("handleDataStartError",Ke),coreCommon.Observer.subscribe("handleDataSending",Qe),coreCommon.Observer.subscribe("BFCPDataStopRec",Ze),coreCommon.Observer.subscribe("updateSvcRender",It),coreCommon.Observer.subscribe("handleSpeechLevelReport",Tt),coreCommon.Observer.subscribe("pairClosedNotify",coreConf.pairClosedNotify),coreCommon.Observer.subscribe("pairSubscribeNotify",coreConf.pairSubscribeNotify),coreCommon.Observer.subscribe("pairCallStateNotify",coreConf.pairCallStateNotify),coreCommon.Observer.subscribe("pairLinkageConfNotify",coreConf.pairLinkageConfNotify),coreCommon.Observer.subscribe("pairLinkageConfStateNotify",coreConf.pairLinkageConfStateNotify),coreCommon.Observer.subscribe("pairInviteJoinConf",coreConf.pairInviteJoinConf),coreCommon.Observer.subscribe("newServiceRightNotify",coreUi.newServiceRightNotify),coreCommon.Observer.subscribe("callJointStartNotify",coreUi.callJointStartNotify),coreCommon.Observer.subscribe("callJointCloseNotify",coreUi.callJointCloseNotify),coreCommon.Observer.subscribe("callJointOffLineNotify",coreUi.callJointOffLineNotify),coreCommon.Observer.subscribe("callJointOffHookNotify",coreUi.callJointOffHookNotify),coreCommon.Observer.subscribe("callJointEstablishedNotify",le),coreCommon.Observer.subscribe("callJointOutGoingNotify",coreUi.callJointOutGoingNotify),coreCommon.Observer.subscribe("callJointOnlineNotify",coreUi.callJointOnlineNotify),coreCommon.Observer.subscribe("callJointPeerCapsReportNotify",coreUi.callJointPeerCapsReportNotify),coreCommon.Observer.subscribe("PassiveDirectionResult",kt),coreCommon.Observer.subscribe("receivePairReqNotify",coreConf.receivePairReqNotify),coreCommon.Observer.subscribe("pairedOrCanceledResultNotify",coreConf.pairedOrCanceledResultNotify),coreCommon.Observer.subscribe("CallBldTransferFailed",Ft),coreCommon.Observer.subscribe("CallBldTransferSuccess",Dt),coreCommon.Observer.subscribe("SipAccountWmi",coreUi.sipAccountWmiNotify),coreCommon.Observer.subscribe("setTransferModify",Ut),coreCommon.Observer.subscribe("handleUniversalInfoNotify",F),coreCommon.Observer.subscribe("meetingHWstartCallFailed",Ht),coreCommon.Observer.subscribe("CallBeenHangup",zt),coreCommon.Observer.subscribe("handleCallPickupNotify",jt),coreCommon.Observer.subscribe("handleCallPickupRemoteInfo",Jt),coreCommon.Observer.subscribe("beTransferToConfToVideo",Yt)},function(e){window.isHubEnv?coreConf.handleServerUniversalInfoNotify(e):coreConf.handleClientUniversalInfoNotify(e)}),D=(t.notifyshowBrowserWindow=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=window.require("electron").screen,a=n.getDisplayNearestPoint(n.getCursorScreenPoint()).workArea;t?(e.setBounds({x:a.width,y:a.height-constant.VIDEO_EXTRA_SIZE.HEIGHT,width:constant.VIDEO_EXTRA_SIZE.WIDTH,height:constant.VIDEO_EXTRA_SIZE.HEIGHT}),e.setPosition(a.width-constant.VIDEO_EXTRA_SIZE.WIDTH,a.height-constant.VIDEO_EXTRA_SIZE.HEIGHT,!0)):(e.setBounds({x:a.width,y:a.height-80,width:300,height:80}),e.setPosition(a.width-320,a.height-100,!0),e.setSize(300,80)),e.showInactive()},t.newCallNotifyshowBrowserWindow=function(e){e.showInactive()},t.pickiupBrowserWindow=function(e){var t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],window.require("electron").screen),n=t.getDisplayNearestPoint(t.getCursorScreenPoint()).workArea;e.setBounds({x:n.width,y:n.height,width:280,height:187}),e.setPosition(n.width-300,n.height-207,!0),e.showInactive()},t.dataConfShowBrowserWindow=function(e){var t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],window.require("electron").screen),n=t.getDisplayNearestPoint(t.getCursorScreenPoint()).workArea,a="requestPrivilege"===window.$getState().notify.notifyUserInfo.type,r=void 0,o=void 0;a?(r=250,o=126):(r=250,o=92),e.setBounds({x:n.width,y:n.height-o,width:r,height:o}),e.setPosition(n.width-r-20,n.height-o-20,!0),e.showInactive()},t.dataTipsShowBrowserWindow=function(e){var t=window.require("electron").screen,n=t.getDisplayNearestPoint(t.getCursorScreenPoint()).workArea,a=void 0,r=void 0;a=250,r=92,e.setBounds({x:n.width,y:n.height-r,width:a,height:r}),e.setPosition(n.width-a-20,n.height-r-20,!0),e.showInactive()},t.showBrowserWindow=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=window.require("electron").screen,a=n.getDisplayNearestPoint(n.getCursorScreenPoint()).workArea;t?(e.setBounds({x:a.width,y:a.height-176,width:320,height:176}),e.setPosition(a.width-320,a.height-176,!0)):(e.setBounds({x:a.width,y:a.height-160,width:322,height:160}),e.setPosition(a.width-322,a.height-160,!0)),e.showInactive()},t.changeNotify=function(e){$dispatch(coreUi.changeNotifyInfo(e))}),U=t.Abnormal=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c,l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=coreAccount.getLoginModel(),a=$getState(),r="",o=$getState(),i=o.conf.confTempAcsAccount,window.isOffline&&(!isNullOrEmpty(i)||a.login.sipLoginOnly||(g.error("offline, can not create conf"),r=language.CALL_FAILED_OFFLINE)),c=coreAccount.getLoginModel().isSipRegSuc(),c||(g.error("sip register failed, can not start call"),(!n.isMobile||n.isMobile&&!$getState().login.isMultiDeviceLogined)&&coreAccount.sipResume({})),e.next=9,coreAccount.getLoginModel().checkSipState();case 9:if(r=coreAccount.getLoginModel().isSipRegSuc()?r:language.THE_NETWORK_IS_ABNORMAL,t||(r=language.NOT_EMPTYNO,g.error("callNum is null, = "+handlePhoneNumber(t))),a.myInfo.bind_no===t&&(r=language.CONFIRM_MYNO,g.error("callNum is self bindNum, = "+handlePhoneNumber(t))),l||coreConf.isInReCall()||!a.call.showCallToolBar&&"CALL_INCOMING"!==a.call.callStatus&&"VIDEO_CONNECTED"!==a.call.callStatus&&"CALL_CONNECTED"!==a.call.callStatus&&"CALL_OUT"!==a.call.callStatus&&"VIDEO_OUT"!==a.call.callStatus||(r=language.PREVENT_TWO_CALLS,O.length>0&&(r=language.CALL_NOT_OUT_CALL_MORE),g.error("already exit a call, showCallToolBar = "+a.call.showCallToolBar+" callStatus = "+a.call.callStatus)),r!==language.CALL_SIP_NOT_REG||window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=16;break}return window.confirm(language.CALL_SIP_NOT_REG+language.FEEDBACK_MESSAGE_TIPS,{rightButton:language.FEEDBACK}).then(function(e){e.ret&&coreCommon.quickSubmitFeedback(constant.QUICK_FEEDBACK_KEYWORDS.SIP_NOT_REG_ERROR,language.CALL_SIP_NOT_REG)}),e.abrupt("return",!0);case 16:if(""===r){e.next=19;break}return window.CLIENTCONFIG.ISMOBILE?alert(r):window.Toast(r,2,!1,null,"WhiteWarning"),e.abrupt("return",!0);case 19:return e.abrupt("return",!1);case 20:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),B=t.setNotifyInfo=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments[2],a=$getState().call.notifyInfo;return a.ContentNotify=e,a.showCtrl=t,a.nameclass=n||a.nameclass,a},P=(t.getCallList=function(e,t){var n=oe(e,t);if(0===n.length){var a=$getState().call.notifyInfo;return a.ContentNotify=language.CALLING_NO_NUMBER,a.showCtrl=!1,D(a),ne(!0,2e3),!1}return n},t.getALLDevices=function(){var e=(0,C.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=9;break}return e.next=3,P();case 3:return e.next=5,$();case 5:return e.next=7,G();case 7:e.next=11;break;case 9:return e.next=11,p.default.all([P(),$(),G()]);case 11:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getMicDevices=function(){var e=(0,C.default)(v.default.mark(function e(){var t;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getMediaDevices(0);case 2:t=e.sent,0===t.result?(g.info("micDevicesList success = ."),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?(0!==t.param.devicenum?$dispatch(coreUi.changeMicDevicesList(t.param.deviceinfo)):$dispatch(coreUi.changeMicDevicesList([])),$dispatch(coreUi.changeMicCount(t.param.devicenum))):(0!==t.param.device_num?$dispatch(coreUi.changeMicDevicesList(t.param.array)):$dispatch(coreUi.changeMicDevicesList([])),$dispatch(coreUi.changeMicCount(t.param.device_num)))):g.info("micDevicesList failed");case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),$=t.getSpkDevices=function(){var e=(0,C.default)(v.default.mark(function e(){var t;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getMediaDevices(1);case 2:t=e.sent,0===t.result?(g.info("spkDevicesList success = ."),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?(0!==t.param.devicenum?$dispatch(coreUi.changeSpkDevicesList(t.param.deviceinfo)):$dispatch(coreUi.changeSpkDevicesList([])),$dispatch(coreUi.changeSpkCount(t.param.devicenum))):(0!==t.param.device_num?$dispatch(coreUi.changeSpkDevicesList(t.param.array)):$dispatch(coreUi.changeSpkDevicesList([])),$dispatch(coreUi.changeSpkCount(t.param.device_num)))):g.info("spkDevicesList failed");case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),G=t.getCameraDevices=function(){var e=(0,C.default)(v.default.mark(function e(){var t;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getMediaDevices(2);case 2:t=e.sent,0===t.result?(g.info("cameraDevicesList success ."),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?0!==t.param.devicenum?($dispatch(coreUi.setVideoNum(t.param.devicenum)),$dispatch(coreUi.changeCameraDevicesList(t.param.deviceinfo))):$dispatch(coreUi.changeCameraDevicesList([])):0!==t.param.device_num?($dispatch(coreUi.setVideoNum(t.param.device_num)),$dispatch(coreUi.changeCameraDevicesList(t.param.array))):$dispatch(coreUi.changeCameraDevicesList([]))):g.info("cameraDevicesList failed");case 4:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),W=(t.CalloutForTempConf=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];g.info("CalloutForTempConf: confAcsId : "+e+", confAcsNum: "+handlePhoneNumber(t)),coreConf.oneKeyEnterConf(t,e,n,a)},t.onekeyMobileCallOut=function(){var e=(0,C.default)(v.default.mark(function e(t,n){var a,r,o,i,c,l,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a={bConf:!1,oneKeyEnterConf:!0,bVideo:s,number:t,contactInfo:n},window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=9;break}return e.next=4,coreUi.checkMobileMultiDevice(a);case 4:if(!0!==(r=e.sent)){e.next=9;break}return g.info("multi device logined, return"),coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_CONF_JOIN,extraTrackKey:null,resultParams:[0]}),e.abrupt("return");case 9:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING||window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=17;break}if(!window.webView){e.next=17;break}return e.next=13,X();case 13:if(o=e.sent,window.requestMultiTerminalPromise=null,!o){e.next=17;break}return e.abrupt("return");case 17:if(e.t0=!1===window.skipLogin,!e.t0){e.next=22;break}return e.next=21,U(t,n);case 21:e.t0=e.sent;case 22:if(!e.t0){e.next=27;break}return coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_CONF_JOIN,extraTrackKey:null,resultParams:[0]}),e.abrupt("return");case 27:return e.next=29,H(s);case 29:if(!e.sent){e.next=33;break}if(u){e.next=33;break}return coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_CONF_JOIN,extraTrackKey:null,resultParams:[0]}),e.abrupt("return");case 33:return g.info("onekeyMobileCallOut"),$dispatch(coreUi.changeUserInfo(n)),$dispatch(coreUi.changeCallNum(t)),s?$dispatch(coreUi.changeCallStatus("VIDEO_OUT")):$dispatch(coreUi.changeCallStatus("CALL_OUT")),i=window.getRoute(),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==i&&!u&&(g.info("onekeyMobileCallOut go callmain"),window.goRoute("callMain"),c=getContactName(n),l=language.METTING,$dispatch(coreUi.createConfTipMsg([l]))),e.next=41,coreConf.getConfInfo(n.conf_id,n.cycle_conf_id);case 41:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}()),H=t.Call2GNet=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ISMOBILE){e.next=2;break}return e.abrupt("return",!1);case 2:if(window.netWorkType!==constant.NETWORK_TYPE.TYPE_2G){e.next=5;break}return e.next=5,window.getCurrentNetWorkType();case 5:if(!t||window.netWorkType!==constant.NETWORK_TYPE.TYPE_2G){e.next=9;break}return g.info("The network type is 2G. not support video "),window.isPluginEnv||alert(language.CALL_2G_NETWORK_NOT_SUPPORT_VIDEO),e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),z=t.checkBeforeCallOut=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=7;break}return e.next=3,coreUi.checkMobileMultiDevice(t);case 3:if(!0!==(n=e.sent)){e.next=7;break}return g.info("multi device logined, return"),e.abrupt("return",!1);case 7:if(e.t0=!window.skipLogin,!e.t0){e.next=12;break}return e.next=11,U(t.number,t.isConsultTransfer);case 11:e.t0=e.sent;case 12:if(!e.t0){e.next=14;break}return e.abrupt("return",!1);case 14:return e.next=16,H(t.bVideo);case 16:if(!e.sent){e.next=18;break}return e.abrupt("return",!1);case 18:if(!t.isConsultTransfer){e.next=35;break}if(!x||x.callState===constant.CALL_STATE.CALL_E_CALL_STATE_END){e.next=26;break}if(!t.bVideo){e.next=23;break}return window.ToastNew(language.PREVENT_CONFERENCE_AFTER_CALL,2),e.abrupt("return",!1);case 23:if(!x.isVideo){e.next=26;break}return window.ToastNew(language.CALL_NOT_OUT_VIDEO_CALL_MORE,2),e.abrupt("return",!1);case 26:if(!(O.length+1>=constant.CALL_CONST.MAX_CALL_LENGTH)){e.next=29;break}return window.ToastNew(language.CALL_NOT_OUT_CALL_MORE,2),e.abrupt("return",!1);case 29:if(Ot(t.number)){e.next=33;break}return g.info("this call num is already in call"),window.ToastNew(language.ALREADY_IN_CALL,2),e.abrupt("return",!1);case 33:if(!x||x.callState!==constant.CALL_STATE.CALL_E_CALL_STATE_OUT){e.next=35;break}return e.abrupt("return",!1);case 35:if(e.t1=window.CLIENTCONFIG.ISMOBILE,!e.t1){e.next=40;break}return e.next=39,window.isSimCardCall();case 39:e.t1=e.sent;case 40:if(!(a=e.t1)){e.next=45;break}return g.info("checkBeforeCallOut now is in sim card call"),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?window.itWeLinkNotifyCallEnded(0,language.PLEASE_HANG_UP_CALL):alert(language.PLEASE_HANG_UP_CALL),e.abrupt("return",!1);case 45:return e.next=47,(0,S.callPermissionCheck)(t.bVideo);case 47:if(r=e.sent,window.requestPermissionPromise&&(window.requestPermissionPromise=null),r){e.next=52;break}return g.info("do not have permission for call"),e.abrupt("return",!1);case 52:if(window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=59;break}return e.next=55,coreUi.checkMobileMultiDevice(t);case 55:if(!0!==(o=e.sent)){e.next=59;break}return g.info("multi device logined, return"),e.abrupt("return",!1);case 59:if(i=!0,!t.bVideo||coreConf.isInReCall()||$getState().login.sipLoginOnly){e.next=64;break}return e.next=63,(0,S.createVideoPreCheck)();case 63:i=e.sent;case 64:if(i){e.next=68;break}return window.CLIENTCONFIG.ISMOBILE&&(g.info("<video>mobile is 3G/4G, user cancel continue video out"),"callMain"===window.getRoute()?history.back():"mConfMemberPage"===window.getRoute()&&window.goRoute("main/conference")),g.info("<video>mobile is 3G/4G,user cancel continue video out"),e.abrupt("return",!1);case 68:return e.abrupt("return",!0);case 69:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),j=t.setVoiceMailInfo=function(e,t){g.info("callOut of set voice mail info");var n=$getState().call.voiceMailNum,a=null;return e===n&&(a=coreSearch.getTempCallUserInfo(n,language.VOICE_MAIL_BOX,!0)),{info:a,is_video:!1,is_prompt:t}},J=t.CallOut=function(){var e=(0,C.default)(v.default.mark(function e(t,n){var a,r,o,i,c,l,s,u,d,f=arguments.length>2&&void 0!==arguments[2]&&arguments[2],p=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null),h=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("start call ,isVideo = "+f+" callnum = "+handlePhoneNumber(t)+" isConsultTransfer = "+h),$dispatch(coreUi.changeIsConsultTransfer(h)),coreConf.setServerIp&&coreConf.setServerIp(""),coreUi.showSearchPanel(!1),$dispatch(coreUi.changeHasSentState(!1)),a=$getState().call.voiceMailNum,t===a&&(r=j(t,f),n=r.info,f=r.is_video,r.is_prompt&&(window.CLIENTCONFIG.ISMOBILE?alert(language.VIDEO_PERMISSIONS_ARE_RESTRICTED):window.Toast(language.VIDEO_PERMISSIONS_ARE_RESTRICTED,2,!1,null))),o=$getState().call.initiativeHoldCall,g.info("Call Out isCallHold: "+o),i={bConf:!1,bVideo:f,number:t,contactInfo:n,isConsultTransfer:h||o},g.info("call out isVmFlag = "+(n&&n.isVmFlag)),window.CLIENTCONFIG.ISBIGWIN&&(coreConf.SvcAtdManager.closeVideoFrame(),coreConf.SvcAtdManager.closeBfcpFrame()),e.next=14,z(i);case 14:if(c=e.sent){e.next=19;break}return window.CLIENTCONFIG.ISBIGWIN&&(coreConf.NotifyJoinConfFailedEx(0),$getState().bigwinBuried.buried.postHasSent||(coreConf.buriedJoinConfFailed(),$dispatch(coreUi.changeHasSentState(!0)))),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(g.info("[IT-meeting] meetingHW callHangup"),window.switchToBackMode(),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT)),e.abrupt("return",!1);case 19:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING||window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=27;break}if(!window.webView){e.next=27;break}return e.next=23,X();case 23:if(l=e.sent,window.requestMultiTerminalPromise=null,!l){e.next=27;break}return e.abrupt("return");case 27:if($dispatch(coreUi.saveCalleeInfo({})),coreConf.handleIsShowJoinButton(!1),window.webView&&f&&window.webView.initCallVideo(),f?$dispatch(coreUi.changeCallStatus("VIDEO_OUT")):$dispatch(coreUi.changeCallStatus("CALL_OUT")),!1!==window.skipLogin){e.next=39;break}if(window.CLIENTCONFIG.ISMOBILE){e.next=37;break}return e.next=35,ot(n,!0,!0);case 35:e.next=39;break;case 37:return e.next=39,ot(n,!1,!0);case 39:if(s=null,!p){e.next=45;break}I.newCallObject(p.call_id,f),s={param:{call_id:p.call_id}},e.next=48;break;case 45:return e.next=47,I.startCall({tel_num:t,addr_vip:n.addr_vip||""},f);case 47:s=e.sent;case 48:if(!s){e.next=55;break}return e.next=51,Y(s,i);case 51:return u=e.sent,e.abrupt("return",u);case 55:return Z(),window.CLIENTCONFIG.ISMOBILE&&"callMain"===(d=window.getRoute())&&(g.info("callmain page, start call failed"),window.stayCallMainPageNotify(!1),history.back()),window.CLIENTCONFIG.ISBIGWIN&&(coreConf.NotifyJoinConfFailedEx(0),$getState().bigwinBuried.buried.postHasSent||(coreConf.buriedJoinConfFailed(),$dispatch(coreUi.changeHasSentState(!0)))),e.abrupt("return",!1);case 59:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),Y=(t.pairCallOut=function(){var e=(0,C.default)(v.default.mark(function e(t){var n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("BLE: start pairCallOut"),coreUi.showSearchPanel(!1),n=t.access_number,e.t0=!1===window.skipLogin,!e.t0){e.next=8;break}return e.next=7,U(n,!1);case 7:e.t0=e.sent;case 8:if(!e.t0){e.next=11;break}return g.info("BLE: pairCallOut access number is invalid"),e.abrupt("return");case 11:$dispatch(coreUi.saveCalleeInfo({})),coreConf.handleIsShowJoinButton(!1),$dispatch(coreUi.changeCallStatus("CALL_OUT")),$dispatch(coreUi.changeEnterConfState(!0)),coreConf.startPairMeeting(t);case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.handlePairCallResult=function(){g.info("BLE: enter handlePairCallResult");var e=$getState(),t=e.synergismInfo.pairConfInfo,n=e.contactGroups.contact_status_map,a=e.myInfo,r=a.account,o=a.statusDesc;$dispatch(coreUi.changeOldStatus(n[r]&&n[r].status,o)),g.info("handlePairCallResult changeOldStatus = ",n[r]&&n[r].status,",desc:",o),$dispatch(coreUi.changeUserInfo({number:t.access_number})),$dispatch(coreUi.changeCallNum(t.access_number)),(0,S.changeScreenState)("middle"),g.info("handlePairCallResult,status:",constant.ONLINE_STATUS.BUSY,",desc:","Calling"),gt(constant.ONLINE_STATUS.BUSY,"Calling");var i=0!=(t.media_type&constant.CONF_MEDIATYPE.CONF_MEDIATYPE_FLAG_VIDEO)||0!=(t.media_type&constant.CONF_MEDIATYPE.CONF_MEDIATYPE_FLAG_HDVIDEO),c=void 0;if(i?c="VIDEO_OUT":(c="CALL_OUT",$dispatch(coreUi.changeCallToolBarShowStatus(!0))),$dispatch(coreUi.changeCallStatus(c)),window.CLIENTCONFIG.ISMOBILE){var l=t.conf_id;$dispatch(coreUi.changeCallId(l)),"ios"===window.CLIENTCONFIG.PLATFORM&&window.callStatusChangeNotify(l,c,!0);if("callMain"!==window.getRoute()){g.info("handlePairCallResult go callmain"),window.goRoute("callMain");var s=language.METTING;$dispatch(coreUi.createConfTipMsg([s]))}}},function(){var e=(0,C.default)(v.default.mark(function e(t,n){var a,r,o,i,c,l;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=$getState(),r=a.contactGroups.contact_status_map,o=a.myInfo,i=o.account,c=o.statusDesc,O.length<1&&(g.info("start call success handleCallResult changeOldStatus = "+(r[i]&&r[i].status)+",desc:"+c),$dispatch(coreUi.changeOldStatus(r[i]&&r[i].status,c))),x&&(x.userInfo=n.contactInfo,x.callNo=n.number),$dispatch(coreUi.changeUserInfo(n.contactInfo)),$dispatch(coreUi.changeCallNum(n.number)),(0,S.changeScreenState)("middle"),g.info("handleCallResult,status:",constant.ONLINE_STATUS.BUSY,",desc:","Calling"),gt(constant.ONLINE_STATUS.BUSY,"Calling"),$dispatch(coreUi.changeCallId(t.param.call_id)),!n.bVideo){e.next=19;break}if(!(l=$getState().phoneLinkage.isEnablePLA)){e.next=15;break}q(t.param.call_id),e.next=17;break;case 15:return e.next=17,K(t.param.call_id);case 17:e.next=20;break;case 19:q(t.param.call_id);case 20:return g.info("video or video conf open speaker outer : "+window.otherAudioDevicesConnect),n.bVideo&&!window.otherAudioDevicesConnect?coreCommon.SpkControl.getInstance().setHandsFree(!0):coreCommon.SpkControl.getInstance().setHandsFree(!1),Q(n.contactInfo,t.param.call_id,n.enterConfParam),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&window.CLIENTCONFIG.ISMOBILE&&(g.info("callOut timer begin"),T=setTimeout(function(){"CALL_OUT"===$getState().call.callStatus&&""!==$getState().call.callId&&(g.info("debug info call out show toast!"),window.Toast(language.JOIN_CONF_LONG_TIME_TIP,3,null,!1))},2e4)),e.abrupt("return",!0);case 25:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}()),q=t.handleAudioCall=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.changeCallToolBarShowStatus(!0)),$dispatch(coreUi.changeCallStatus("CALL_OUT")),window.CLIENTCONFIG.ISMOBILE&&window.callStatusChangeNotify(t,"CALL_OUT");case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),K=t.handleVideoCall=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$dispatch(coreUi.changeCallStatus("VIDEO_OUT"));case 2:if(g.info("<video>dispatch,changeCallStatus,value = VIDEO_OUT"),!window.CLIENTCONFIG.ISMOBILE){e.next=7;break}window.callStatusChangeNotify(t,"VIDEO_OUT"),e.next=24;break;case 7:if(window.CLIENTCONFIG.ISBIGWIN){e.next=24;break}if(n={set_window_title:{title:$getState().call.userInfo.name}},a=(0,d.default)({},n),a.set_window_title.title=handlePhoneNumber(a.set_window_title.title),g.info("set_window_title is",a),!window.CLIENTCONFIG.ISWIN){e.next=19;break}return g.info("Native初始化本地视频界面"),g.info("cwp init initCallInterface joinConf "),e.next=17,coreConf.initCallInterface(t,1,1);case 17:e.next=24;break;case 19:return r=(0,S.getBigContainerSize)(),r=(0,S.calcRealVideoSize)({width:16,height:9},r),$dispatch(coreUi.changeBigWinStyle(r)),e.next=24,I.setLocalVideoRender(r);case 24:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Q=t.handleMobile=function(e,t,n){var a=window.getRoute();if(window.CLIENTCONFIG.ISMOBILE&&"callMain"!==a){g.info("handleMobile go callmain"),window.goRoute("callMain");var r=getContactName(e),o=language.ON_CALLING.format(r);n&&(o=language.METTING),$dispatch(coreUi.createConfTipMsg([o]))}},Z=t.handleErr=function(){$dispatch(coreUi.changeCallStatus("")),coreConf.handleIsShowJoinButton(!0),O.length>0?(x=Mt(),Rt(x),At(x.callId)):x=null,$dispatch(coreUi.changeNotifyInfo(B(language.CALL_CALLING_FAILED))),ne(!0,2e3),g.error("start call fail"),window.webView&&window.webView.unInitCallVideo()},X=t.callMultiTerminalCheck=function(){var e=(0,C.default)(v.default.mark(function e(){var t;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("mobile terminal check"),0===(t=window.webView.checkTerminalStateForVoip())){e.next=10;break}return $dispatch(coreUi.changeEnterConfState(!1)),window.clickCreateWorking=!1,window.alreadyTerminalConfirm=!1,window.requestMultiTerminalPromise=new PromiseObject,e.abrupt("return",window.requestMultiTerminalPromise);case 10:return coreAccount.registerResumeEvent(),e.abrupt("return",!1);case 12:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();t.dealSipLoginCheck=function(){var e=(0,C.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("mobile do sip login wait"),!window.alreadyDoSipRegiser){e.next=4;break}return g.info("mobile do sip login wait111"),e.abrupt("return","");case 4:return window.requestSipLoginPromise=new PromiseObject,window.requestSipLoginTimer=setTimeout(function(){window.requestSipLoginPromise.resolve()},8e3),e.abrupt("return",window.requestSipLoginPromise);case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();window.dealTerminalResult=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("mobile terminal result :"+t),t+="",window.requestMultiTerminalPromise&&("1"===t?window.isOffline?window.alreadyTerminalConfirm=!0:window.requestMultiTerminalPromise.resolve(!1):"0"===t&&window.requestMultiTerminalPromise.resolve(!0));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();var ee=t.callHangup=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,f,p,h,m,C;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},window.CLIENTCONFIG.ENABLE_IT_MEETING&&(a=void 0,r=void 0,$getState().call.userInfo.contactsId&&(a=$getState().call.userInfo.contactsId),r=getContactName($getState().call.userInfo)?getContactName($getState().call.userInfo):$getState().call.userInfo.account,n={account:a,name:r},window.switchToBackMode()),$getState().call.acceptPickupCall&&$dispatch(coreUi.changeAcceptPickupCall(!1)),coreCommon.Observer.publish("CallBeenHangup",t),o=$getState().call.callId,g.info("callHangup active do endCall. callId: "+t+" currentCallId: "+o),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&$dispatch(coreUi.changeCallToolBarShowStatus(!1)),!t){e.next=11;break}return e.next=10,I.endCallService(t);case 10:window.CLIENTCONFIG.ISBIGWIN&&(coreConf.NotifyMyLeaveConf(0),g.info("NotifyMyLeaveConf"));case 11:i=(0,d.default)({},xt(t)),t===o?O.length>0?(x=Mt(),x&&t===x.consultTransferId&&(x.consultTransferId="",$dispatch(coreUi.changeConsultTransferId(""))),Rt(x),x.isClickHold||(At(x.callId),0===O.length&&Gt(!1,"callHangup"))):isNullOrEmpty(L)?Pe(t):(x=L,Rt(x),$dispatch(coreUi.changeCallToolBarShowStatus(!1)),Gt(!1,"callHangup"),L={},$dispatch(coreUi.changeNewIncommingCall(L)),c=$getState().notify.callNotify,coreUi.showCallNotify(c)):isNullOrEmpty(L)||L.callId!==t?(Lt(t),0===O.length&&Gt(!1,"callHangup")):(L={},$dispatch(coreUi.changeNewIncommingCall(L)),coreUi.closeCallNotify(t),l=$getState().call.initiativeHoldCall,s=$getState().call.isCallHold,l||s||Gt(!1,"callHangup"),coreUi.stopRing()),$getState().login.sipLoginOnly||coreConf.getConfList(),u=I.getCallById(t),f=$getState().callRecord.IdByIdGenerateRecord,p=$getState().call.receiveCallUpateInfo,!isNullOrEmpty(u.callInfo)&&(f.indexOf(t)<0||p)&&($dispatch(coreUi.changeReceiveUpateInfo(!1)),f.push(t),f.length>20&&(f=f.slice(f.length-20,f.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(f)),window.CLIENTCONFIG.ENABLE_IT_MEETING?Fe(u.callInfo,n):Fe(u.callInfo)),window.CLIENTCONFIG.ENABLE_IT_MEETING?(I.deleteCallObject(t),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(g.info("[IT-Meeting] active hangUp, doLogout."),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT))):(h=I.getCallById(t),g.info("build a record callHangup"),m=$getState().callRecord.IdByIdGenerateRecord,C=$getState().call.receiveCallUpateInfo,!isNullOrEmpty(i)&&(m.indexOf(t)<0||C)?($dispatch(coreUi.changeReceiveUpateInfo(!1)),m.push(t),m.length>20&&(m=m.slice(m.length-20,m.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(m)),Fe(i)):!isNullOrEmpty(h.callInfo)&&(m.indexOf(t)<0||C)&&($dispatch(coreUi.changeReceiveUpateInfo(!1)),m.push(t),m.length>20&&(m=m.slice(m.length-20,m.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(m)),Fe(h.callInfo)),I.deleteCallObject(t),window.CLIENTCONFIG.ISMOBILE&&window.Toast(language.END_CALL,2,!1));case 19:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),te=t.clearCallOutTimer=function(){var e=(0,C.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:T>0&&(g.info("clearCallOutTimer"),clearTimeout(T),T=0);case 1:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),ne=t.showConfirmNotify=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];g.info("showNotify =",e),$dispatch(coreUi.confirmNotify(e)),t&&(g.info("confirmNotify false,  time out",t),setTimeout(function(){$dispatch(coreUi.confirmNotify(!1))},t))},ae=(t.showConfirmChairNotify=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;g.info("showNotify =",e),$dispatch(coreUi.confirmChairNotify(e)),t&&(g.info("confirmChairNotify false,  time out",t),setTimeout(function(){$dispatch(coreUi.confirmChairNotify(!1))},t))},t.changeNotifyContent=function(e){$dispatch(coreUi.changeNotifyInfo(e))},t.checkHasCall=function(){g.info("checkHasCall"),$getState().call.callStatus&&ae()},t.setNoMoveTrue=function(){var e=$getState().call;(e.showCallToolBar||"VIDEO_CONNECTED"===e.callStatus||"VIDEO_OUT"===e.callStatus)&&(g.info("setNoMoveTrue",!0),(0,S.changeScreenState)("min",!0))}),re=(t.toggleSmallPageWhenCall=function(){ae()},t.showMediaInfo=function(e){if($getState().conf.isSvcConf&&e)return void g.info("showMediaInfo,isSvcConf,return");window.CLIENTCONFIG.IS_DEBUG&&$dispatch(coreUi.changeShowCallMediaInfo(e))}),oe=t.getInfoList=function(e,t){var n=[];return t.forEach(function(t){var a=t;if("account"===t&&(a="bind_no"),e[a]){var r={name:t,num:e[a]};n.push(r)}}),n},ie=function(){var e=(new Date).getTime();return e=parseInt(e/1e3),g.info("call start time =",e),$dispatch(coreUi.changetime(e)),e},ce=t.callConnected=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c,l;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(isNullOrEmpty(M)||M!==t.callId){e.next=3;break}return g.info("user hangup already in callConnected step 101",t.callId),e.abrupt("return");case 3:if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING,!0){e.next=7;break}return te(),g.info("[IT-Meeting] in IS_LINK_IT_SMC_MEETING callconnected return"),e.abrupt("return");case 7:if(n=window.CLIENTCONFIG,g.info("callConnected,status:",constant.ONLINE_STATUS.BUSY,",desc:","Calling"),g.info("callConnected, callType: "+t.callType+" callId: "+t.callId+" isFocus: "+t.isFocus),$dispatch(coreUi.changeTransformCallBtnDisable(!1)),$dispatch(coreUi.changeCallIsFocus(t.isFocus)),gt(constant.ONLINE_STATUS.BUSY,"Calling"),a=$getState().call,"CALL_OUT"===a.callStatus||"VIDEO_OUT"===a.callStatus){e.next=25;break}if(g.info("is call or video out,no need to open contact chat,callstatus = "+a.callStatus),window.CLIENTCONFIG.ISMOBILE){e.next=21;break}return e.next=19,ot($getState().call.userInfo,!0,!0);case 19:e.next=23;break;case 21:return e.next=23,ot($getState().call.userInfo,!1,!0);case 23:e.next=26;break;case 25:te();case 26:if(isNullOrEmpty(M)||M!==t.callId){e.next=30;break}return g.info("user hangup already in callConnected step 102",t.callId),I.deleteCallObject(t.callId),e.abrupt("return");case 30:if("CALL_TRANSTO_CONF"!==a.callStatus&&"VIDEO_TRANSTO_CONF"!==a.callStatus&&ie(),r=t.callId,o=a.callId,i=xt(t.callId),i&&((0,d.default)(i,t),i.timer=$getState().call.timer),o!==r&&(g.info("currentCallId: "+o+" callId: "+r),O.unshift(x),Lt(r),x=i,Rt(x)),window.webView&&window.webView.setKeepScreenOn(),coreUi.stopRing(),isNullOrEmpty(M)||M!==t.callId){e.next=42;break}return g.info("user hangup already in step 103",t.callId),I.deleteCallObject(t.callId),e.abrupt("return");case 42:1===t.callType?me(t.callId):("VIDEO_OUT"===$getState().call.callStatus&&window.CLIENTCONFIG.ISWIN&&(g.info("video callout,but be audio accepted"),coreConf.closeBfcpFrame(),coreConf.closeCallInterface()),$dispatch(coreUi.changeCallToolBarShowStatus(!0)),$dispatch(coreUi.changeCallStatus("CALL_CONNECTED")),window.CLIENTCONFIG.ISMOBILE&&window.callStatusChangeNotify(t.callId,"CALL_CONNECTED")),!0===$getState().call.acceptPickupCall&&(g.info("user pickupCallerInfo "),c=$getState().call.pickupCallerInfo,l=$getState().call.pickupCallerInfo.account,$dispatch(coreUi.changeUserInfo(c)),$dispatch(coreUi.changeCallNum(l)),x&&(x.userInfo=c,x.callNo=l)),coreUi.closeCallNotify(t.callId),$dispatch(coreUi.createConfTipMsg([])),window.CLIENTCONFIG.ISWIN&&(g.info("notify native enter_conf_flow_ended"),coreConf.SvcAtdManager.setParam({enter_conf_flow_ended:!0}));case 47:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),le=t.callJointEstablishedNotify=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("callJointEstablishedNotify,status:",constant.ONLINE_STATUS.BUSY,",desc:","Calling"),gt(constant.ONLINE_STATUS.BUSY,"Calling"),n=$getState().call,"CALL_OUT"===n.callStatus||"VIDEO_OUT"===n.callStatus){e.next=14;break}if(g.info("is call or video out,no need to open contact chat,callstatus = "+n.callStatus),window.CLIENTCONFIG.ISMOBILE){e.next=10;break}return e.next=8,ot($getState().call.userInfo,!0,!0);case 8:e.next=12;break;case 10:return e.next=12,ot($getState().call.userInfo,!1,!0);case 12:e.next=15;break;case 14:T>0&&(g.info("callOut timer clear when call connected"),clearTimeout(T),T=0);case 15:"CALL_TRANSTO_CONF"!==n.callStatus&&"VIDEO_TRANSTO_CONF"!==n.callStatus&&ie(),$dispatch(coreUi.changeCallId(t.call_id)),g.info("dispatch,changeCallId,value = "+t.call_id+",call_type = "+t.call_type),window.webView&&window.webView.setKeepScreenOn(),coreUi.stopRing(),1===t.call_type?me(t.call_id):($dispatch(coreUi.changeCallToolBarShowStatus(!0)),$dispatch(coreUi.changeCallStatus("CALL_CONNECTED")),window.CLIENTCONFIG.ISMOBILE&&window.callStatusChangeNotify(t.call_id,"CALL_CONNECTED"),g.info("CALL_CONNECTED, data.call_type !== 1"+t.call_id)),g.info("callconnected $getState().call.acceptPickupCall",$getState().call.acceptPickupCall),!0===$getState().call.acceptPickupCall&&(g.info("user pickupCallerInfo "),a=$getState().call.pickupCallerInfo,r=$getState().call.pickupCallerInfo.account,$dispatch(coreUi.changeUserInfo(a)),$dispatch(coreUi.changeCallNum(r)),x&&(x.userInfo=a,x.callNo=r)),coreUi.closeCallNotify(t.call_id),$dispatch(coreUi.createConfTipMsg([]));case 25:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),se=t.acceptUpdateToVideo=function(){var e=(0,C.default)(v.default.mark(function e(t){var n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("acceptUpdateToVideo"),e.next=3,I.replyAddVideo(t,!0);case 3:n=e.sent,coreUi.closeCallNotify(t),clearTimeout(N),$dispatch(coreUi.changeAddVideoBtnStatus(!1));case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),ue=t.rejectUpdateToVideo=function(){var e=(0,C.default)(v.default.mark(function e(t){var n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.replyAddVideo(t,!1);case 2:n=e.sent,n?g.info("rejectUpdateToVideo success"):g.info("rejectUpdateToVideo failed, res = ",n),coreUi.closeCallNotify(t),clearTimeout(N),$dispatch(coreUi.changeAddVideoBtnStatus(!1));case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("handleApplyTimeout,reject update to video, and enable ClickAddVideo"),e.next=3,ue(t);case 3:$dispatch(coreUi.changeAddVideoBtnStatus(!1)),clearTimeout(N);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,d;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupCall;case 2:return n=e.sent,e.next=5,n.getCallMediaParams(t);case 5:if(a=e.sent,r=$getState().conf.isSvcConf,!(a.param.svc_stream_info&&a.param.svc_stream_info.length&&a.param.svc_stream_info.length>0)){e.next=49;break}o=0;case 9:if(!(o<a.param.svc_stream_info.length)){e.next=49;break}if(!r){e.next=44;break}if(a.param.svc_stream_info[o].encode_name="H264"===a.param.svc_stream_info[o].encode_name?"H.264 SVC":a.param.svc_stream_info[o].encode_name,a.param.svc_stream_info[o].decode_name="H264"===a.param.svc_stream_info[o].decode_name?"H.264 SVC":a.param.svc_stream_info[o].decode_name,i=a.param.svc_stream_info[o],""===i.decoder_size||""!==i.encoder_size){e.next=38;break}c=o+1;case 16:if(!(c<a.param.svc_stream_info.length)){e.next=25;break}if(!a.param.svc_stream_info[c].send_delay){e.next=22;break}return l=a.param.svc_stream_info[c].send_delay/2,i.send_delay=l,i.recv_delay=l,e.abrupt("break",25);case 22:c++,e.next=16;break;case 25:if(i.recv_delay){e.next=36;break}s=o-1;case 27:if(!(s>=0)){e.next=36;break}if(!a.param.svc_stream_info[s].send_delay){e.next=33;break}return u=a.param.svc_stream_info[s].send_delay/2,i.send_delay=u,i.recv_delay=u,e.abrupt("break",36);case 33:s--,e.next=27;break;case 36:e.next=41;break;case 38:d=i.send_delay/2,i.send_delay=d,i.recv_delay=d;case 41:a.param.svc_stream_info[o]=i,e.next=46;break;case 44:a.param.svc_stream_info[o].encode_name="H264"===a.param.svc_stream_info[o].encode_name?"H.264":a.param.svc_stream_info[o].encode_name,a.param.svc_stream_info[o].decode_name="H264"===a.param.svc_stream_info[o].decode_name?"H.264":a.param.svc_stream_info[o].decode_name;case 46:o++,e.next=9;break;case 49:return a.param.video_stream_info&&(a.param.video_stream_info.encode_name="H264"===a.param.video_stream_info.encode_name?"H.264":a.param.video_stream_info.encode_name,a.param.video_stream_info.decode_name="H264"===a.param.video_stream_info.decode_name?"H.264":a.param.video_stream_info.decode_name),a.param.data_stream_info&&(a.param.data_stream_info.encode_name="H264"===a.param.data_stream_info.encode_name?"H.264":a.param.data_stream_info.encode_name,a.param.data_stream_info.decode_name="H264"===a.param.data_stream_info.decode_name?"H.264":a.param.data_stream_info.decode_name),a.param.audio_stream_info&&(a.param.audio_stream_info.recv_delay=a.param.audio_stream_info.recv_delay/2,a.param.audio_stream_info.send_delay=a.param.audio_stream_info.send_delay/2),e.abrupt("return",a);case 53:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,a={callid:t,infoid:0},e.next=4,new coreTup.HWTupCall;case 4:return r=e.sent,e.next=7,r.getBasicCallInfo(a);case 7:return o=e.sent,0===o.result&&(n=o.param.call_info.conf_media_type),e.abrupt("return",n);case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),he=(t.getBasicBandInfo=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=0,a={callid:t,infoid:0},r=void 0,!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=9;break}return e.next=6,coreCall.getBasicCallInfoNew(a);case 6:r=e.sent,e.next=15;break;case 9:return e.next=11,new coreTup.HWTupCall;case 11:return o=e.sent,e.next=14,o.getBasicCallInfo(a);case 14:r=e.sent;case 15:return 0===r.result?(g.info("getBasicBandInfo success,bandwidth = "+r.param.call_info.bandwidth),n=r.param.call_info.bandwidth):g.info("getBasicBandInfo failed"),e.abrupt("return",n);case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.delVideoRequest=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("delVideoRequest, tup reject audio to video request, so ui auto close confirm window"),window.clearDialogQueueIt('"'+language.SWITCH_TO_VIDEO+'"'),window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&window.openOrCloseFloatingWindowPrompt(0);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),ve=t.addVideoRequest=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe(t.call_id);case 2:if(!(n=e.sent)){e.next=9;break}return g.info("addVideoRequest,auto accept to video"),e.next=7,I.replyAddVideo(t.call_id,!0);case 7:return a=e.sent,e.abrupt("return");case 9:if(r={isShow:!0,isUpdateToVideo:!0,callId:t.call_id,isVideo:1},!(O.length>0)){e.next=13;break}return ue(r.callId),e.abrupt("return");case 13:if(!window.CLIENTCONFIG.ISMOBILE){e.next=22;break}return e.next=16,H(!0);case 16:if(!(o=e.sent)){e.next=20;break}return g.info("The network type is 2G. not support video"),e.abrupt("return");case 20:return e.next=22,(0,S.callPermissionCheck)(!0);case 22:return window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&window.openOrCloseFloatingWindowPrompt(1),e.next=25,window.confirm(language.SWITCH_TO_VIDEO,!0,{leftButton:language.REJECT,rightButton:language.AGREE});case 25:i=e.sent,window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&window.openOrCloseFloatingWindowPrompt(0),i.ret?(g.info("userClick  SWITCH_TO_VIDEO acceptUpdateToVideo"),se(r.callId)):(g.info("userClick  SWITCH_TO_VIDEO rejectUpdateToVideo"),ue(r.callId)),$dispatch(coreUi.changeAddVideoBtnStatus(!0)),N=setTimeout(function(){de(t.call_id)},3e4);case 30:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=(0,C.default)(v.default.mark(function e(t,n){var a,r,o,i,c,l,s,u,d,f;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(E=setTimeout(function(){$dispatch(coreUi.setIsDecodeSuc()),clearTimeout(E)},3e3),a=$getState().call,!window.CLIENTCONFIG.ISMOBILE){e.next=7;break}g.info("<video>callStatus = "+a.callStatus+",need set local and remote render"),n||($dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),window.callStatusChangeNotify(t,"VIDEO_CONNECTED")),e.next=51;break;case 7:if("VIDEO_OUT"!==a.callStatus){e.next=12;break}$getState().conf.isSvcConf?window.CLIENTCONFIG.ISBIGWIN?coreConf.SvcAtdManager.initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BIG):window.CLIENTCONFIG.ISWIN&&(window.isHubEnv?(g.info("initVideoFrame maxhub set divide mode"),coreConf.SvcAtdManager.initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BASE)):coreConf.SvcAtdManager.initVideoFrame(t,constant.SVC_VIEW_MODE.BIG_SMALL_MODE,constant.SVC_VERSION_FLAG.BASE)):window.CLIENTCONFIG.ISWIN||window.CLIENTCONFIG.ISBIGWIN?(coreConf.updateLocalwindowCallId(t),coreConf.initRemotWindow(t)):(r=(0,S.getBigContainerSize)(),r=(0,S.calcRealVideoSize)({width:16,height:9},r),$dispatch(coreUi.changeBigWinStyle(r)),I.setRemoteVideoRender(r),o={height:constant.VIDEO_SMALL_SIZE.HEIGHT,width:constant.VIDEO_SMALL_SIZE.WIDTH},$dispatch(coreUi.changeSmallWinStyle(o)),I.setVideoWH(!1,o)),$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),e.next=51;break;case 12:if(g.info("<video>callStatus = "+a.callStatus+",need set local and remote render"),""===a.callStatus&&!1===$getState().conf.isOpenCameraDe&&!0===$getState().login.sipLoginOnly&&(coreConf.SvcAtdManager.userCameraStu=!1,window.userCameraStu=!1),!1===window.userCameraStu&&"VIDEO_CONNECTED"===a.callStatus&&"mac"===window.CLIENTCONFIG.PLATFORM&&(window.userCameraStu=!0,coreCommon.CameraControl.getInstance().switchCameraStateAction(!1)),!window.CLIENTCONFIG.ISBIGWIN){e.next=21;break}g.info("bigwin init video frame, $getState().conf.isSvcConf:"+$getState().conf.isSvcConf),$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),coreConf.SvcAtdManager.initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BIG),e.next=51;break;case 21:if(!window.CLIENTCONFIG.ISWIN){e.next=49;break}if(!$getState().conf.isSvcConf){e.next=27;break}$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),window.isCreatingAVCFrame?(i=0,c=setInterval(function(){window.isCreatingAVCFrame?++i>50&&(clearInterval(c),g.info("initVideoFrame in creatting AVCFrame time = "+100*i+",please check!!!"),window.isHubEnv?(g.info("initVideoFrame maxhub set divide mode"),coreConf.SvcAtdManager.initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BASE)):coreConf.SvcAtdManager.initVideoFrame(t,constant.SVC_VIEW_MODE.BIG_SMALL_MODE,constant.SVC_VERSION_FLAG.BASE)):(clearInterval(c),g.info("initVideoFrame after create AVCFrame time = "+100*i),window.isHubEnv?(g.info("initVideoFrame maxhub set divide mode"),coreConf.SvcAtdManager.initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BASE)):coreConf.SvcAtdManager.initVideoFrame(t,constant.SVC_VIEW_MODE.BIG_SMALL_MODE,constant.SVC_VERSION_FLAG.BASE))},100)):window.isHubEnv?(g.info("initVideoFrame maxhub set divide mode"),coreConf.SvcAtdManager.initVideoFrame(t,constant.SVC_VIEW_MODE.DIVIDE_MODE,constant.SVC_VERSION_FLAG.BASE)):coreConf.SvcAtdManager.initVideoFrame(t,constant.SVC_VIEW_MODE.BIG_SMALL_MODE,constant.SVC_VERSION_FLAG.BASE),e.next=47;break;case 27:if("VIDEO_TRANS_CONF"!==a.callStatus){e.next=39;break}return $dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),g.info("P2P trans to AVC conf.",t,"setViewMode",constant.AVC_VIEW_MODE.VIDEO_MODE),l=$getState().conf,s=l.confServerId,u=l.vmrId,isNullOrEmpty(u)||(s=u),e.next=34,coreConf.updateLocalwindowCallId(t);case 34:coreConf.setViewMode(constant.AVC_VIEW_MODE.VIDEO_MODE),coreConf.setSubject($getState().conf.confSubject),coreConf.setConfServerId(s),e.next=47;break;case 39:return g.info("cwp init initCallInterface confConnected WRONG"),$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),window.isCreatingAVCFrame=!0,e.next=44,coreConf.initCallInterface(t,constant.AVC_VIEW_MODE.VIDEO_MODE,constant.SVC_VERSION_FLAG.BASE);case 44:return e.next=46,coreConf.initRemotWindow(t);case 46:window.isCreatingAVCFrame=!1;case 47:e.next=51;break;case 49:$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),$getState().conf.isSvcConf||(d=(0,S.getBigContainerSize)(),d=(0,S.calcRealVideoSize)({width:16,height:9},d),$dispatch(coreUi.changeBigWinStyle(d)),I.setRemoteVideoRender(d),f={height:constant.VIDEO_SMALL_SIZE.HEIGHT,width:constant.VIDEO_SMALL_SIZE.WIDTH},$dispatch(coreUi.changeSmallWinStyle(f)),I.setLocalVideoRender(f));case 51:$dispatch(coreUi.changeCallToolBarShowStatus(!1)),window.CLIENTCONFIG.ISWIN&&isNullOrEmpty($getState().conf.confhandle)&&coreConf.SvcAtdManager.setParam({p2pConnected:!0});case 53:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),Ce=(t.setMicValue=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCommon.MicControl.getInstance().muteMic(!1);case 2:return t=parseInt(t,10),e.next=5,I.setMicVol(t);case 5:$dispatch(coreUi.changeMicValue(t)),coreConf.SvcAtdManager.setMuteState(!0),g.info("set mic value = ",t);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getMicValue=function(){var e=(0,C.default)(v.default.mark(function e(){var t;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getMicVol();case 2:return t=e.sent,g.info("getMicValue ="+t),e.abrupt("return",t);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),we=t.getSpkValue=function(){var e=(0,C.default)(v.default.mark(function e(){var t;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getSpkVol();case 2:return t=e.sent,g.info("getSpkValue ="+t),e.abrupt("return",t);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),Ie=t.handleCallRingBack=function(e){g.info("handleCallRingBack,callId = "+e.call_id),coreUi.stopRing(),e&&e.have_sdp||coreUi.incommingRing("ring",!1)},Se=t.onCallHoldSuccess=function(e){g.info("onCallHoldSuccess callId: "+e.callId);var t=e.callId,n=xt(t);n&&(0,d.default)(n,e),t===$getState().call.callId&&(g.info("onCallHoldSuccess changeCallTransferFlag(true)"),Gt(!0,"onCallHoldSuccess")),Ve(O),Rt(x)},_e=t.onCallHoldFailed=function(e){g.info("onCallHoldFailed callId: "+e.callId),$dispatch(coreUi.changeHoldCallInitiative(!1));var t=e.callId,n=xt(t);n&&((0,d.default)(n,e),n.isClickHold&&(n.isClickHold=!1)),Ve(O),$getState().call.initiativeHoldCall&&window.Toast(language.HOLD_CALL_FAILE,2,!1)},ge=t.onCallUnHoldSuccess=function(e){g.info("onCallUnHoldSuccess callId: "+e.callId);var t=e.callId,n=xt(t);n&&((0,d.default)(n,e),n.isClickHold&&(n.isClickHold=!1)),e.callId!==x.callId?(O.push(x),Lt(e.callId),x=n,Gt(!0,"onCallUnHoldSuccess")):(Gt(!1,"onCallUnHoldSuccess"),g.info("onCallUnHoldSuccess changeCallTransferFlag(false)"),$dispatch(coreUi.changeHoldCallInitiative(!1))),Ve(O),Rt(x)},be=t.onCallUnHoldFailed=function(e){g.info("onCallHoldFailed callId: "+e.callId);var t=e.callId,n=xt(t);n&&(0,d.default)(n,e),Ve(O),$getState().call.initiativeHoldCall&&window.Toast(language.RESUME_CALL_FAILE,2,!1)},Ne=t.onCallAtdTransferSuccess=function(e){g.info("onCallAtdTransferSuccess, callId: "+t);var t=e.call_id;window.CLIENTCONFIG.ISMOBILE?window.Toast(language.CALL_TRANSFER_SUCCEEDED,2,null,!0):window.ToastNew(language.CALL_TRANSFER_SUCCEEDED,2)},Ee=t.onCallAtdTransferFailed=function(e){g.info("onCallAtdTransferFailed, callId: "+t+", reason code: "+e.reason_code);var t=e.call_id;window.CLIENTCONFIG.ISMOBILE?window.Toast(language.CALL_TRANSFER_FAILED,2,null,!0):window.ToastNew(language.CALL_TRANSFER_FAILED,2)},Te=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r,o,i,c,l,u,d,f,p,h,m,C,w;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fe({});case 2:if(t=e.sent,0!==t.result){e.next=42;break}if(A=t,e.prev=5,n=$getState().conf,a=n.isVideoConf,r=n.isSvcConf,o=-1,t.param.audio_stream_info&&(o=t.param.audio_stream_info.recv_average_mos),i=[],c=0,r){if((l=t.param.svc_stream_info)&&l.length>0)for(u=0;u<l.length;u++)l[u].dec_ssrc>0&&(c+=l[u].bandwidth,i.push(l[u].recv_loss_fraction),i.push(l[u].send_loss_fraction))}else c=t.param.video_stream_info.bandwidth,t.param.video_stream_info&&(i.push(t.param.video_stream_info.recv_loss_fraction),i.push(t.param.video_stream_info.send_loss_fraction));if(t.param.data_stream_info&&(i.push(t.param.data_stream_info.recv_loss_fraction),i.push(t.param.data_stream_info.send_loss_fraction)),t.param.audio_stream_info&&(i.push(t.param.audio_stream_info.recv_loss_fraction),i.push(t.param.audio_stream_info.send_loss_fraction)),0!==i.length){e.next=17;break}return g.info("calculateLocalQosPrama Err data_stream_info = "+(0,s.default)(t.param.data_stream_info)+", audio_stream_info = "+(0,s.default)(t.param.audio_stream_info)+", video_stream_info = "+(0,s.default)(t.param.video_stream_info)),e.abrupt("return",null);case 17:d=i.sort(function(e,t){return e-t}),g.info("calculateLocalQosPrama newLossRates = "+(0,s.default)(d)),f=d.length-1,p=d[f],h=f;case 22:if(!(h>=0)){e.next=29;break}if(!(d[h]<p)){e.next=26;break}return p=d[h],e.abrupt("break",29);case 26:h--,e.next=22;break;case 29:return m=t.param.effective_bitrate||0,C=t.param.data_stream_info.bandwidth||0,w=$getState().call.isLowVideoBWCloseCamera,g.info("calculateLocalQosPrama isVideoConf = "+a+", MOS = "+o+", lossRate = "+p+", TMMBR = "+m+", videoBandWidth = "+c+", BFCPBandWidth = "+C+", isLowVideoBWCloseCamera = "+w),e.abrupt("return",{isVideoConf:a,MOS:o,lossRate:p,TMMBR:m,videoBandWidth:c,BFCPBandWidth:C,isLowVideoBWCloseCamera:w});case 36:return e.prev=36,e.t0=e.catch(5),g.error("calculateLocalQosPrama Err = "+(0,s.default)(e.t0)),e.abrupt("return",null);case 40:e.next=44;break;case 42:A=null,g.info("calculateLocalQosPrama Err res.result = "+t.result);case 44:case"end":return e.stop()}},e,void 0,[[5,36]])}));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r,o,i,c,l,s,u,d;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=4,e.next=3,Te();case 3:if(n=e.sent,!isNullOrEmpty(n)){e.next=7;break}return g.info("calculateLocalQos Err, get param err"),e.abrupt("return",t);case 7:if(a=n.MOS,r=n.lossRate,o=n.TMMBR,i=n.videoBandWidth,c=n.BFCPBandWidth,l=n.isLowVideoBWCloseCamera,-1!==a&&(t=a>=4?4:a>=3?3:a>=2?2:1),s=r<=1?4:r<=5?3:r<=15?2:1,u=i+c,d=0,!(u>0&&o>0)){e.next=16;break}d=o/u<.4?2:4,e.next=18;break;case 16:return g.info("calculateLocalQos data = "+t),e.abrupt("return",t);case 18:return 4===d?t=s:2===d&&(t=l&&4===s?3:s<d?s:d),g.info("calculateLocalQos data = "+t),e.abrupt("return",t);case 21:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),ye=function(){var e=(0,C.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:V&&(clearInterval(V),V=null),g.info("stop querying qos.");case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r,o,i,c;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().call,n=t.isSvcConfShowQOS,a=t.showMediaInfo,r=$getState().conf.isSvcConf,o=$getState().call.callId){e.next=6;break}return ye(),e.abrupt("return");case 6:if(window.CLIENTCONFIG.ISMOBILE&&window.CLIENTCONFIG.ENABLE_IT_MEETING&&(lt(A),coreConf.firstQosReport()),!window.CLIENTCONFIG.IS_DEBUG){e.next=35;break}if(!r){e.next=25;break}if(!window.CLIENTCONFIG.ISMOBILE){e.next=15;break}if(!(!window.CLIENTCONFIG.IS_SVC_CONF_DEBUG||window.CLIENTCONFIG.IS_SVC_CONF_DEBUG&&n)){e.next=13;break}return e.next=13,lt(A);case 13:e.next=23;break;case 15:if(!window.CLIENTCONFIG.ISWIN){e.next=20;break}return e.next=18,st(A);case 18:e.next=23;break;case 20:if(!a){e.next=23;break}return e.next=23,ut(k);case 23:e.next=35;break;case 25:if(!window.CLIENTCONFIG.ISWIN||"VIDEO_CONNECTED"!==$getState().call.callStatus){e.next=30;break}return e.next=28,st(A);case 28:e.next=35;break;case 30:if(!a){e.next=35;break}return e.next=33,dt();case 33:i=e.sent,window.CLIENTCONFIG.ISWIN&&coreConf.isDataShareStarted()&&i&&(c=(0,d.default)({},{QOS:i}),coreConf.NativeInterface.reportQos(0,c));case 35:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),Oe=t.callLocalQos=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$getState().call.callLocalQoslevel,e.next=3,ke();case 3:n=e.sent,$dispatch(coreUi.changeCallLocalQoslevel(n)),n<3&&window.CLIENTCONFIG.ENABLE_IT_MEETING&&coreConf.qosAlertSend(),window.CLIENTCONFIG.ISWIN&&t!==n&&coreConf.SvcAtdManager.setSignal(n),V||(V=setInterval(function(){xe()},2e3));case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),Le=t.muteMicAndSpeaker=function(){var e=(0,C.default)(v.default.mark(function e(t,n){var a;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=$getState().call,0!==t){e.next=4;break}e.next=7;break;case 4:if(1!==t){e.next=7;break}return e.next=7,I.operateMic(a.callId,n);case 7:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),Me=t.switchAudioChannel=function(){var e=(0,C.default)(v.default.mark(function e(t){var n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=$getState().call.callId,e.next=3,I.switchAudioChannel(n,t);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Re=(t.setVoiceValue=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreCommon.SpkControl.getInstance().muteSpk(!1);case 2:return t=parseInt(t,10),e.next=5,I.setSpkVol(t);case 5:$dispatch(coreUi.changeVoiceValue(t)),g.info("set voice value = ",t);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setcallcapability=function(){var e=(0,C.default)(v.default.mark(function e(t,n,a){var r,o;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={callid:$getState().call.callId,protocol:0,cap_id:9,val:{audio_dir:t,video_dir:n,aux_dir:a}},g.info("set Call Capability = ",r),e.next=4,I.setCallCapability(r);case 4:o=e.sent,0===o.result?g.info("[ action_call ] HWTUP.setCallCapability success,",o):g.error("[ action_call ] HWTUP.setCallCapability faild, ",o);case 6:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}(),t.setCallReinvite=function(){var e=(0,C.default)(v.default.mark(function e(){var t;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("call setCallReinvite"),e.next=3,I.setCallReinvite($getState().call.callId);case 3:t=e.sent,0===t.result?g.info("[ action_call ] HWTUP.setCallReinvite success",t):g.error("[ action_call ] HWTUP.setCallReinvite faild",t);case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.configMsDataConf=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("configMsDataconf "+t),n={conf:{enable_ms_dataconf:t}},e.next=4,new coreTup.HWTupCall;case 4:return a=e.sent,e.next=7,a.config(n);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.acceptCall=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("acceptCall, callId = "+t+" isForceAudio: "+a),window.CLIENTCONFIG.ISMOBILE||($getState().common.isShowModal?coreUi.hideModal():$getState().common.isShowPop?window.hideAlert():$getState().common.isShowNotifyModal&&$dispatch(coreUi.hideNotifyModal())),coreUi.stopRing(),(0,S.changeScreenState)("middle"),window.CLIENTCONFIG.ISMOBILE&&window.netWorkType===constant.NETWORK_TYPE.TYPE_2G&&(g.info("The network is 2G not support video conf"),a=!0),n=$getState().notify.callNotify,g.info("callNotify.callType: "+n.callType+" isForceAudio: "+a),1!==n.callType||a||window.webView&&window.webView.initCallVideo(),e.next=10,I.acceptCall(t,a);case 10:x&&x.callId===t?(x.userInfo=$getState().call.userInfo,x.callNo=$getState().call.callNum):isNullOrEmpty(L)||L.callId!==t||(O.push(x),Ve(O),x=L,Rt(x),L={},$dispatch(coreUi.changeNewIncommingCall(L)),$dispatch(coreUi.changetime(0))),n.isShow=!1,n.isUpdateToVideo=!1,a&&(n.callType=0),coreUi.showCallNotify(n),g.info("callNotify.isShow = false");case 16:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.callInComming=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,f,p,h,m,C,w,_,b,N,E,T;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("callInComming, data.callId: "+t.callId),n=$getState().call,a=n.callStatus,e.t0=window.CLIENTCONFIG.ISMOBILE,!e.t0){e.next=8;break}return e.next=7,window.isSimCardCall();case 7:e.t0=e.sent;case 8:if(!(r=e.t0)){e.next=14;break}return g.info("callInComming, now is in sim card call,end call"),e.next=13,I.endCallService(t.callId);case 13:return e.abrupt("return");case 14:if(!("VIDEO_OUT"===a||"CALL_OUT"===a||"CALL_INCOMING"===a||"VIDEO_CONNECTED"===a||"VIDEO_TRANSTO_CONF"===a||"CALL_TRANSTO_CONF"===a||coreConf.isInConf()||window.CLIENTCONFIG.ISBIGWIN||window.isHubEnv||window.isPluginEnv)){e.next=20;break}if(!t.callId){e.next=19;break}return g.info("already exist a call, end this call, callId: "+t.callId),e.next=19,I.endCallService(t.callId);case 19:return e.abrupt("return");case 20:if(!(O.length+1>=constant.CALL_CONST.MAX_CALL_LENGTH)){e.next=26;break}if(!t.callId){e.next=25;break}return g.info("call list is max, end this call, callId: "+t.callId),e.next=25,I.endCallService(t.callId);case 25:return e.abrupt("return");case 26:if(!x||x.isEnd||!t.isVideo&&!x.isVideo){e.next=32;break}if(!t.callId){e.next=31;break}return g.info(": "+t.callId),e.next=31,I.endCallService(t.callId);case 31:return e.abrupt("return");case 32:return window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.switchToFront(),o=$getState().call.callId,""===o&&$dispatch(coreUi.changeCallStatus("CALL_INCOMING")),""===o&&(i=$getState(),c=i.myInfo,l=c.account,s=c.statusDesc,u=i.contactGroups.contact_status_map,$dispatch(coreUi.changeOldStatus(u[l]&&u[l].status,s)),g.info("dispatch changeOldStatus status= "+(u[l]&&u[l].status)+",desc = "+s),g.info("callInComming,status: "+constant.ONLINE_STATUS.BUSY+",desc = Calling"),gt(constant.ONLINE_STATUS.BUSY,"Calling")),e.next=38,coreContact.getContactByCallNumber(t.callNo);case 38:if(f=e.sent,coreUi.getContactAvatar(f),e.t1=t.callNo,e.t2=t.callNo,e.t3=t.fwd_from_name,e.t3){e.next=47;break}return e.next=46,Wt(t.fwd_from_num);case 46:e.t3=e.sent;case 47:if(e.t4=e.t3,e.t5=t.fwd_from_num,e.t6=t.callId,e.t7=f,e.t8=t.isVideo?1:0,e.t9=t.callType,p={isShow:!0,isUpdateToVideo:!1,callerName:e.t1,callerDepartment:"",callerNumber:e.t2,callTransferName:e.t4,callTransferNumber:e.t5,callId:e.t6,callAccount:e.t7,isVideo:e.t8,callType:e.t9},h=t.callNo,m=void 0,C=void 0,"*"===t.callNo.substr(0,1)&&(h=t.callNo.substr(1,t.callNo.length-1)),window.skipLogin){e.next=67;break}return e.next=61,coreContact.searchServerContact(h,1,1);case 61:w=e.sent,_=w.userInformationList||[],p.callerNumber=h,_.length>0?(p.callerName=getContactName(_[0]),""===p.callerName&&(p.callerName=p.callerNumber),p.callAccount=_[0].account,p.callerDepartment=getContactDept(_[0]),m=_[0],C=p.callerNumber):(b={account:h},isNullOrEmpty(t.display_name)||(p.callerName=t.display_name,b.account=t.display_name),m=b,C=p.callerNumber),e.next=70;break;case 67:N={account:h},m=N,C=p.callerNumber;case 70:return""===o?(x=(0,d.default)({},t),x.userInfo=m,x.callNo=C,Rt(x),window.CLIENTCONFIG.ISMOBILE&&window.callStatusChangeNotify(t.callId,"CALL_INCOMING")):(g.info("current callId: "+o),L=(0,d.default)({},t),L.userInfo=m,L.callNo=C,$dispatch(coreUi.changeNewIncommingCall(L)),Gt(!0,"callInComming")),window.webView&&window.webView.setFrontToLock(),1===t.callType&&window.webView,coreUi.showCallNotify(p),coreUi.incommingRing("in",!0),E=window.getRoute(),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==E&&($dispatch(coreUi.changeCtdCallingState(!1)),window.goRoute("callMain")),e.next=79,(0,S.callPermissionCheck)(1===t.callType,!1);case 79:return window.requestPermissionPromise&&(window.requestPermissionPromise=null),e.next=82,ot({account:p.callAccount},!1,!0);case 82:if(window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=93;break}if(1!==t.callType){e.next=93;break}return e.next=86,(0,S.createVideoPreCheck)();case 86:if(T=e.sent){e.next=93;break}if(g.info("userClick  <video>mobile user 3/4G reject callincoming"),!t.callId){e.next=93;break}return g.info("callHangup,calID = "+t.callId),e.next=93,I.endCallService(t.callId);case 93:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),Ae=t.callOutGoing=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=$getState().call.callId,g.info("callOutGoing callId: "+t.callId+" currentCallId: "+n),n&&(g.info("callOutGoing push currentCall to holdCallList"),O.push(x),Ve(O)),a=(0,d.default)({},t),x=a,n!==t.callId&&(r=$getState().call.isConsultTransfer,r&&(x.consultTransferId=n,$dispatch(coreUi.changeConsultTransferId(x.consultTransferId))),$dispatch(coreUi.changeCallId(t.callId)),$t(!1)),Vt();case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ve=t.updateHoldCallList=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("updateHoldCallList size: "+t.length),$dispatch(coreUi.changeHoldCallListInfo(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Fe=t.callRecordSave=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,l,s,u,d,f,p,h,m,C,w,I,S,_,b,N,E,T,k,y,x,O,L=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||""!==t.callNo&&void 0!==t.callNo&&"undefined"!==t.callNo){e.next=3;break}return g.info("callRecordSave callNo is empty!"),e.abrupt("return");case 3:if(!t){e.next=62;break}if(n=$getState(),a=parseInt(t.milltime),r=parseInt((new Date).getTime()),o=r-a,i={},l=0,s=isNullOrEmpty(t.callInOut)?constant.CALL_IN_OUT_TYPE.CALL_OUT:t.callInOut,window.CLIENTCONFIG.ENABLE_IT_MEETING&&1===s&&(t.userInfo=L),!t.userInfo){e.next=16;break}i=t.userInfo,e.next=22;break;case 16:return u=t.callNo,e.next=19,coreContact.searchServerContact(u,1,1);case 19:d=e.sent,f=d.userInformationList||[],f.length>0?i=f[0]:(p={account:u},isNullOrEmpty(t.display_name)||(p.account=t.display_name),i=p);case 22:if(h=void 0,m=void 0,!isNullOrEmpty(i)&&i.contact_id&&isNullOrEmpty(i.account)?(h=t.callNo,l=i.contact_id,m=getContactName(i)):isNullOrEmpty(i)||isNullOrEmpty(i.account)?(h=t.callNo,l=0,m=t.callNo):(h=i.account,l=0,m=getContactName(i)),C=n.myInfo,w=isNullOrEmpty(t.isCallSuccess)?0:t.isCallSuccess,!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=35;break}if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=29;break}return e.abrupt("return");case 29:if(isNullOrEmpty(i)||isNullOrEmpty(i.contactsId)||(h=i.contactsId,g.info("save current num call 2")),isNullOrEmpty(i)||isNullOrEmpty(i.contactId)||(h=i.contactId,g.info("save current num call 3")),void 0!==m){e.next=33;break}return e.abrupt("return");case 33:return s?window.callRecordNotify(C.bind_no,t.callNo,C.account,h,m,a,r,0,t.callType?1:0,s,w):window.callRecordNotify(t.callNo,C.bind_no,h,C.account,m,a,r,0,t.callType?1:0,s,w),e.abrupt("return");case 35:return I={peeraccount:h,iscallout:s,callernumber:C.bind_no,calleenumber:t.callNo,starttime:a,callstate:t.callState,calltype:t.callType,duration:o,confid:"",confpasscode:"",confmembers:"",groupid:"",isVideo:t.callType?1:0,callUserName:m,contact_id:l,isCallSuccess:t.isCallSuccess?1:0},e.next=38,coreDb.saveCallRecord(I);case 38:if(!(S=e.sent)){e.next=62;break}return window.CLIENTCONFIG.ISMOBILE,e.next=43,coreDb.queryCallRecord({peeraccount:h,starttime:9999999999999,limitcount:1});case 43:if(_=e.sent,isNullOrEmpty(_)){e.next=62;break}return b=n.callRecord,N=b.callRecordList,E=b.callItemInfoList,N.unshift(_),e.next=49,coreContact.getContactByAccount(_.peeraccount);case 49:if(T=e.sent,k=JSON.parse(_.exparams),!k.contact_id){e.next=57;break}return e.next=54,coreDb.queryContactByContactId(k.contact_id);case 54:T=e.sent,e.next=58;break;case 57:isNullOrEmpty(T)&&(y=$getState().call,x=y.voiceMailNum,O=y.userInfo,T=O&&O.number===x&&O.isVmFlag?coreSearch.getTempCallUserInfo(_.peeraccount,language.VOICE_MAIL_BOX,!0):coreSearch.getTempCallUserInfo(_.peeraccount));case 58:g.info(" 保存最新一条通话记录 "),E.unshift(T),$dispatch(coreUi.getCallRecordList([].concat((0,c.default)(N)))),$dispatch(coreUi.getCallRecordListInfo([].concat((0,c.default)(E))));case 62:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),De=t.callEnded=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,f,p,h,m,C,w,S;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},window.CLIENTCONFIG.ENABLE_IT_MEETING&&(a=void 0,r=void 0,$getState().call.userInfo.contactsId&&(a=$getState().call.userInfo.contactsId),r=getContactName($getState().call.userInfo)?getContactName($getState().call.userInfo):$getState().call.userInfo.account,n={account:a,name:r}),$getState().call.acceptPickupCall&&$dispatch(coreUi.changeAcceptPickupCall(!1)),y&&(g.info("close last update confirm window"),y.close(),y=null),o=xt(t.callId),g.info("build a record callEnded"),i=$getState().callRecord.IdByIdGenerateRecord,c=$getState().call.receiveCallUpateInfo,window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||!(i.indexOf(t.callId)<0||c)){e.next=21;break}if($dispatch(coreUi.changeReceiveUpateInfo(!1)),i.push(t.callId),i.length>20&&(i=i.slice(i.length-20,i.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(i)),!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=19;break}return e.next=17,Fe((0,d.default)({},o,t),n);case 17:e.next=21;break;case 19:return e.next=21,Fe((0,d.default)({},o,t));case 21:if(l=t.reasonCode,s=$getState(),u=s.conf.confTempAcsAccount,f=s.call.callId,g.info("callEnded, callId: "+t.callId+" current callId: "+f+" reason_code is "+l),p=!0,window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.requestPermissionPromise&&(p=!1,window.requestPermissionPromise.resolve(!1)),isNullOrEmpty(L)||L.callId!==t.callId){e.next=36;break}return L={},$dispatch(coreUi.changeNewIncommingCall(L)),coreUi.stopRing(),coreUi.closeCallNotify(t.callId),I.deleteCallObject(t.callId),h=$getState().call.initiativeHoldCall,m=$getState().call.isCallHold,h||m||0!==O.length||Gt(!1,"callEnded"),e.abrupt("return");case 36:if(f!==t.callId){e.next=54;break}if(!(O.length>0)){e.next=44;break}return x=Mt(),Rt(x),x.isClickHold||(At(x.callId),0===O.length&&Gt(!1,"callEnded")),I.deleteCallObject(t.callId),coreUi.stopRing(),e.abrupt("return");case 44:if(isNullOrEmpty(L)){e.next=52;break}return x=L,Rt(x),$dispatch(coreUi.changeCallToolBarShowStatus(!1)),Gt(!1,"callEnded"),L={},$dispatch(coreUi.changeNewIncommingCall(L)),e.abrupt("return");case 52:e.next=60;break;case 54:return Lt(t.callId),I.deleteCallObject(t.callId),x&&t.callId===x.consultTransferId&&(x.consultTransferId="",$dispatch(coreUi.changeConsultTransferId(""))),0===O.length&&Gt(!1,"callEnded"),coreUi.stopRing(),e.abrupt("return");case 60:coreConf.handleIsShowJoinButton(!0),"extra"===$getState().call.screenState&&(delegate.resumeShow(!1),delegate.winMinimize()),C=!1,coreConf.isInConf()&&!window.CLIENTCONFIG.ISBIGWIN?g.info("still exit conf, ignore call ended msg"):(window.CLIENTCONFIG.ISBIGWIN&&(w=$getState().call,"CALL_OUT"!==w.callStatus&&"VIDEO_OUT"!==w.callStatus||(coreConf.NotifyJoinConfFailedEx(0),$getState().bigwinBuried.buried.postHasSent||(coreConf.buriedJoinConfFailed(),$dispatch(coreUi.changeHasSentState(!0))))),Pe(t.callId),I.deleteCallObject(t.callId),$getState().conf.isSvcConf&&(window.CLIENTCONFIG.ISWIN||window.CLIENTCONFIG.ISBIGWIN)?(coreConf.SvcAtdManager.closeVideoFrame(),coreConf.SvcAtdManager.closeBfcpFrame(),coreConf.SvcAtdManager.clear()):!$getState().conf.isSvcConf&&window.CLIENTCONFIG.ISWIN?(coreConf.closeBfcpFrame(),coreConf.closeCallInterface()):window.CLIENTCONFIG.ENABLE_IT_MEETING&&!C&&(p&&window.switchToBackMode(),window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(g.info("[IT-Meeting] inactive callend, doLogout."),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT)))),S=language.END_CALL,480===l?S=language.CALL_NOT_ONLINE:486===l?S=language.CALL_BUSY:4041===l?S=language.IT_CONF_NOT_STARTED:4042===l&&(S=language.IT_CONF_ENDED),window.CLIENTCONFIG.ISMOBILE?(window.Toast(S,2,!1),window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.itWeLinkNotifyCallEnded(l,S)):480!==l&&486!==l||alert(S),$dispatch(coreUi.clearConfInfo()),$dispatch(coreUi.clearBuriedData()),$dispatch(coreUi.changeHoldCallInitiative(!1));case 70:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ue=t.callInfo=function(e){0===e.param.bIsRomoteHangup&&0===e.param.is_passive_end&&0===e.param.reason_code&&0===e.param.audio_send_mode&&(g.info("call number illegal"),alert(language.STOP_CALL_NUMBER_AT_BEHIND_NOT_IP_OR_DOMAIN)),coreConf.handleIsShowJoinButton(!0)},Be=t.callDestroy=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=$getState(),a=n.call.callId,g.info("handle receive call destory,callId: "+t.callId+" current callId: "+a),t.callId===a&&(O.length>0?(x=Mt(),Rt(x),x.isClickHold||(At(x.callId),0===O.length&&Gt(!1,"callDestroy")),I.deleteCallObject(t.callId)):x=null);case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Pe=t.endCall=function(e){var t=$getState().call,n=$getState().call.timer;g.info("end call callId: "+e);var a=window.getRoute(),r=$getState(),o=r.callRecord.isCallRecordDetailMenuBack;coreUi.stopRing();var i=r.login.sipLoginOnly;if(""===$getState().call.callId)return window.CLIENTCONFIG.ISMOBILE&&(g.info("end call call id is empty currentPage: "+a),"callMain"!==a||i?"mConfMemberPage"===a?window.goRoute("main/conference"):"mSelectBox"===a&&coreUi.clearTransferOfShowBox():(history.back(),"falg"===o&&(0,_.setIsCallRecordDetailMenuBack)(!0))),$dispatch(coreUi.changeCallStatus("")),coreConf.handleIsShowJoinButton(!0),void g.info("call id is empty, call has ended");var c=$getState(),l=c.myInfo.account,s=c.contactGroups.contact_status_map,u=$getState().call,d=u.oldStatus,f=u.oldStatusDesc;((s[l]&&s[l].status)!==constant.ONLINE_STATUS.OFFLINE&&(g.info("endCall,changeStatus:",d,",desc = ",f),gt(d,f)),window.CLIENTCONFIG.ISMOBILE&&(g.info("audio or video ended currentPage: "+a),"callMain"!==a||i?"mConfMemberPage"===a?window.goRoute("main/conference"):"mSelectBox"===a?coreUi.clearTransferOfShowBox():window.goRoute("main/conference"):(window.CLIENTCONFIG.ENABLE_IT_MEETING?window.goRoute("main/conference"):(g.info("endCall history back"),history.back()),"falg"===o&&(0,_.setIsCallRecordDetailMenuBack)(!0))),y&&(y.close(),y=null),bt(e),coreUi.closeCallNotify(e),x=null,L={},coreConf.handleIsShowJoinButton(!0),$dispatch(coreUi.changeNewIncommingCall(L)),$dispatch(coreUi.changeConsultTransferId("")),$dispatch(coreUi.changeIsConsultTransfer(!1)),$dispatch(coreUi.changeCallId("")),$t(!1),$dispatch(coreUi.changeMuteMic(!1)),$dispatch(coreUi.changeMuteSpk(!1)),$dispatch(coreUi.changeAddVideoBtnStatus(!1)),$dispatch(coreUi.changeIsSrtp(!1)),$dispatch(coreUi.changeCallNum("")),$dispatch(coreUi.changCurrentPageInfo({currentPage:0,totalPage:1})),$dispatch(coreUi.clearPhoneAddrInfo()),$dispatch(coreUi.changeHoldCallInitiative(!1)),re(!1),k=0,g.info("dispatch,changeCallId,value = "+e),$getState().login.sipLoginOnly||coreConf.getConfList(),$e(),(window.CLIENTCONFIG.ISBIGWIN&&"CALL_OUT"===t.callStatus||"VIDEO_OUT"===t.callStatus)&&!$getState().bigwinBuried.buried.postHasSent&&(coreConf.buriedJoinConfFailed(),$dispatch(coreUi.changeHasSentState(!0))),$dispatch(coreUi.changeCallToolBarShowStatus(!1)),$dispatch(coreUi.changeCallStatus("")),$dispatch(coreUi.initVideoDucks()),$dispatch(coreUi.changetime(0)),$dispatch(coreUi.switchSpeakerAndReceive(!1)),$dispatch(coreUi.changeHasUnreadMsg(!1)),(0,S.resumeScreenStateWhenCallOrConfEnd)(),coreCwmp.checkUpdateConfig(),coreAccount.getLoginModel().isPortalUpgrade?coreAccount.reStartUpgrade():coreCwmp.restartUpgrade(),window.CLIENTCONFIG.ISMOBILE&&(window.callOrConfEnded(),coreConf.handleMobileBfcpStatus(),$dispatch(coreUi.changeHadPreSetCamera(!1)),window.CLIENTCONFIG.ENABLE_IT_MEETING&&T>0&&(clearTimeout(T),T=0,g.info("callOut timer clear when call end"))),window.CLIENTCONFIG.ISWIN&&$getState().conf.isSvcConf?(coreConf.SvcAtdManager.closeVideoFrame(),coreConf.SvcAtdManager.clear()):!$getState().conf.isSvcConf&&window.CLIENTCONFIG.ISWIN&&(coreConf.closeBfcpFrame(),coreConf.closeCallInterface()),window.CLIENTCONFIG.ISBIGWIN&&"CALL_OUT"!==t.callStatus&&"VIDEO_OUT"!==t.callStatus)&&(coreConf.buriedNormalEnd(0,!0,n),window.bigWinCommonLogOut(),coreConf.SvcAtdManager.closeVideoFrame(),coreConf.SvcAtdManager.closeBfcpFrame());$dispatch(coreUi.clearConfInfo()),$dispatch(coreUi.changeUserInfo({})),$getState().call.isCallTransfer&&Gt(!1,"endCall"),$dispatch(coreUi.clearBuriedData())},$e=t.closeRemoteSocketWhenCallEnd=function(){var e=$getState().call.callStatus;"VIDEO_OUT"!==e&&"VIDEO_CONNECTED"!==e||window.CLIENTCONFIG.ISMOBILE&&window.callStatusChangeNotify($getState().call.callId,"VIDEO_END")},Ge=(t.produceCallMemberList=function(){var e=$getState().call.userInfo,t=$getState().myInfo,n=$getState().call.callNum,a=t.bind_no,r={number:a,userInfo:t,role:0,is_mute:0,is_deaf:0,state:constant.CONF_AUDIO_STATE.CONF_AUDIO_INCONF,hand_state:0,media_type:0,is_self:!0,is_speaking:!1,speak_volume:0,participant_id:"",is_broadcast:0},o={number:n,userInfo:e,role:0,is_mute:0,is_deaf:0,state:constant.CONF_AUDIO_STATE.CONF_AUDIO_INCONF,hand_state:0,media_type:0,is_self:!1,is_speaking:!1,speak_volume:0,participant_id:"",is_broadcast:0},i=[r,o];$dispatch(coreUi.changeMemberListInfo(i)),isNullOrEmpty($getState().conf.searchText)||coreConf.searchMemberList($getState().conf.searchText,i)},t.actionDialDTMF=function(e,t,n){return g.info("actionDialDTMF"),I.dialDTMF(e,t,n)},t.handlelowCallLocalQos=function(e){e>=3?(g.info("handlelowCallLocalQos",e),window.CLIENTCONFIG.ISMOBILE&&window.ToastNew(language.LOW_CALL_QS,2,!1,!1),$dispatch(coreUi.changelowCallLocalQos(!0))):$dispatch(coreUi.changelowCallLocalQos(!1))}),We=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!0;g.info("deviceInfo = ",e),g.info("updateDeviceList = ",t);for(var r=0,o=t.length;r<o;r++){var i=t[r];if(n){if(i.name===e.name){a=!1;break}}else{if(i.device_id===e.device_id){a=!1;break}}}return a},He=t.handleCameraList=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c,l,u,f,p,h,m,C,w,I,_,b,N,E,T,k,y;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("handleCameraList ",(0,s.default)(t)),n=$getState().call,a=void 0,r=void 0,o=$getState().setting.camIndex,i=$getState().call.cameraDevicesList,c=i.length,l={},g.info("cameraIndex = ",o),g.info("call.cameraDevicesList = ",n.cameraDevicesList),u=$getState().call.callStatus;case 10:if(0===t.capture_num){e.next=30;break}if($dispatch(coreUi.changeCameraDevicesList(t.array)),!window.CLIENTCONFIG.ISBIGWIN){e.next=20;break}if(0===n.cameraDevicesList.length&&""!==n.callId&&((0,S.openOrOffCamera)(!1),g.info("open camera")),!(n.cameraDevicesList.length<o+1)){e.next=17;break}return g.error("cameraIndex error"),e.abrupt("break",51);case 17:We(n.cameraDevicesList[o],t.array)&&(g.info("pull camera : ",n.cameraDevicesList[o]),a=n.cameraDevicesList[o].device_id,r=n.cameraDevicesList[o].name,coreConf.NotifyLocalCameraPull(0,a,r)),e.next=28;break;case 20:f=0,0!==c&&o<c&&(f=i[o].device_id),p=void 0,t.capture_num>c?(h=coreSetting.getInsertDeviceById(i,t.array),g.info("Camera device added, get insert device serial number= ",h),-1!==h?(p=coreSetting.getValidCamDeviceSerialNum(t.array,h,f),coreSetting.setAndSaveCamDevice(p)):(p=coreSetting.getValidCamDeviceSerialNum(t.array,-1,f),coreSetting.setAndSaveCamDevice(p))):t.capture_num<c&&(p=coreSetting.getValidCamDeviceSerialNum(t.array,-1,f),g.info("some Camera device has deleted, set default device serial number=",p),coreSetting.setAndSaveCamDevice(p)),window.CLIENTCONFIG.ISWIN&&!$getState().conf.isSvcConf&&coreConf.updateCameraList(p),$dispatch(coreUi.setVideoNum(t.capture_num)),t.capture_num>0&&coreCommon.CameraControl.getInstance().switchCameraStateAction(!0),"win"===window.CLIENTCONFIG.PLATFORM&&(m=$getState().call,C=m.isOpenCamera,w=m.isMuteMic,I=$getState().conf.isConfMicMute,_=w||I?0:100,l=(0,d.default)(l,{init_device_state:{mic_volume:_,camera_on:t.capture_num>0?C:-1}}),l=(0,d.default)(l,{camera_devices:{camIndex:p,cameraDevicesList:t.array}}),coreConf.SvcAtdManager.setParam(l));case 28:e.next=50;break;case 30:return $dispatch(coreUi.changeCameraDevicesList([])),"win"===window.CLIENTCONFIG.PLATFORM&&(b=$getState().call.isMuteMic,N=$getState().conf.isConfMicMute,E=b||N?0:100,l=(0,d.default)(l,{init_device_state:{mic_volume:E,camera_on:-1}}),l=(0,d.default)(l,{camera_devices:{camIndex:0,cameraDevicesList:[]}}),coreConf.SvcAtdManager.setParam(l)),e.next=34,new coreTup.HWTupCall;case 34:return T=e.sent,k=window.VIDEO_DEFAULT_IMG+"default_camera.bmp",y={media:{video_default_image:k}},e.next=39,T.config(y);case 39:if(""!==n.callId&&((0,S.openOrOffCamera)(!0),g.info("close camera")),!window.CLIENTCONFIG.ISBIGWIN){e.next=48;break}if(!(n.cameraDevicesList.length<o+1)){e.next=44;break}return g.error("cameraIndex error"),e.abrupt("break",51);case 44:a=n.cameraDevicesList[o].device_id,r=n.cameraDevicesList[o].name,g.info("pull camera : ",n.cameraDevicesList[o]),coreConf.NotifyLocalCameraPull(0,a,r);case 48:"VIDEO_OUT"!==u&&"VIDEO_CONNECTED"!==u||("win"===window.CLIENTCONFIG.PLATFORM&&coreConf.SvcAtdManager.alertBox(language.NATIVE_NO_CAMERA_THEN_TIPS,3),"mac"===window.CLIENTCONFIG.PLATFORM&&window.alert(language.NO_CAMERA_THEN_TIPS)),window.CLIENTCONFIG.ISWIN&&!$getState().conf.isSvcConf&&coreConf.updateCameraList();case 50:case 51:window.CLIENTCONFIG.ISBIGWIN&&coreConf.NotifyCameraListUpdateEx(0);case 52:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),ze=t.handleSpkMicList=function(e){g.info("handleSpkMicList ",(0,s.default)(e));var t={};if(0!==e.input_num){window.isOpenSpeechDetect=!0,g.info("isOpenSpeechDetect.true");var n=$getState().call.micDevicesList;$dispatch(coreUi.changeMicDevicesList(e.input_array));var a=$getState().setting.micCount;if(e.input_num>a){var r=coreSetting.getInsertDeviceByName(n,e.input_array);g.info("Mic device added, get new device serial number=",r),-1!==r?coreSetting.setAndSaveMicDevice(r):coreSetting.setAndSaveMicDevice(0),t=(0,d.default)(t,{mic_devices:{micIndex:-1===r?0:r,micDevicesList:e.input_array}}),coreConf.SvcAtdManager.setParam(t)}else e.input_num<a&&(g.info("some mic device has deleted, set device index 0"),coreSetting.setAndSaveMicDevice(0))}else $dispatch(coreUi.changeMicDevicesList([])),t=(0,d.default)(t,{mic_devices:{micDevicesList:[]}}),coreConf.SvcAtdManager.setParam(t);if(0!==e.output_num){var o=$getState().call.spkDevicesList;$dispatch(coreUi.changeSpkDevicesList(e.output_array));var i=$getState().setting.spkCount,c=void 0;if(window.CLIENTCONFIG.ISBIGWIN){var l=coreSetting.getDefaultSpkDevice(e.output_array);coreSetting.setAndSaveSpkDevice(l)}else if(e.output_num>i){var u=coreSetting.getInsertDeviceByName(o,e.output_array);g.info("some spk device added, get new device serial number=",u),-1!==u?(c=coreSetting.getValidSpkDeviceSerialNum(e.output_array,u),coreSetting.setAndSaveSpkDevice(c)):(c=coreSetting.getValidSpkDeviceSerialNum(e.output_array),coreSetting.setAndSaveSpkDevice(c)),t=(0,d.default)(t,{spk_devices:{spkIndex:c,spkDevicesList:e.output_array}}),coreConf.SvcAtdManager.setParam(t)}else e.output_num<i&&(c=coreSetting.getValidSpkDeviceSerialNum(e.output_array),g.info("some spk device has deleted, set default device serial number=",c),coreSetting.setAndSaveSpkDevice(c))}else $dispatch(coreUi.changeSpkDevicesList([])),t=(0,d.default)(t,{spk_devices:{spkDevicesList:[]}}),coreConf.SvcAtdManager.setParam(t);$dispatch(coreUi.changeMicCount(e.input_num)),$dispatch(coreUi.changeSpkCount(e.output_num))},je=t.handleNoStream=function(e){var t=$getState().call.noStreamEndcall;if(e.Duration&&(5===e.Duration?t=1:10===e.Duration?t=2:e.Duration>=15&&(t=3)),g.info("receive no stream notify,noStreamEndCall = ",t),t>=3){g.info("receive 3 times no stream notify,need active hangup call"),window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&coreConf.meetingHWreCallTimeOut("30s No Stream");var n=coreConf.isInConf(),a=void 0;if(n){a=[coreConf.getCurrentConfId()]}else{var r=$getState().call.callNum;a=[handlePhoneNumber(r)]}coreUt.utCustomEvent({eventId:constant.EVENT_ID.UT_NO_STREAM_HANGUP,params:[a]});var o=coreConf.getSavedRecallInfo();Nt(o,!0,e.callId),t=0}Je(t)},Je=t.changeNoStreamEndcall=function(e){g.info("changenoStreamEndcall: Num"+e+" bNeedReCall: "+coreConf.isInReCall()),window.CLIENTCONFIG.ISMOBILE?1===e?g.info("continues 5 seconds without stream"):2===e?(g.info("continues 10 seconds without stream"),window.ToastNew(language.NO_STREAM_AFTER_TIMES.format(5*e),2)):coreConf.isInReCall()&&window.ToastNew(language.READY_TO_RECALL,2):window.CLIENTCONFIG.ISWIN&&(1===e?g.info("continues 5 seconds without stream"):2===e?(g.info("continues 10 seconds without stream"),coreConf.SvcAtdManager.alertBox(language.NO_STREAM_AFTER_TIMES.format(5*e),3)):coreConf.isInReCall()&&coreConf.SvcAtdManager.alertBox(language.READY_TO_RECALL,3)),$dispatch(coreUi.changenoStreamEndcall(e))},Ye=function(e){e.call_id===$getState().call.callId&&coreUi.stopRing()},qe=function(){var e=(0,C.default)(v.default.mark(function e(t){var n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=$getState().call,"CALL_OUT"!==n.callStatus&&"VIDEO_OUT"!==n.callStatus||1===t.param.is_kick_off&&Pe(n.callNum),1!==t.param.is_kick_off||window.CLIENTCONFIG.USE_IM&&window.isEserverOnline||(g.info("sip kickOff"),coreAccount.clearResumeService(),coreAccount.checkAndEndCall().then(function(){if(window.CLIENTCONFIG.ENABLE_IT_MEETING)return window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||window.setSipState("0"),g.info("handleSipKickOff, set isOffline true"),window.isOffline=!0,coreAccount.sipserverDeregister(),void g.info("it welink return by kick off");coreAccount.setOffline({}),window.endCallPromise&&(window.endCallPromise=null)}).then((0,C.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.ISMOBILE||appService.showMainWindow(!0),!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=7;break}return window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?window.itWeLinkNotifyCallEnded(0,language.LOGIN_LOGGEDON_ANOTHER):window.setSipState("0"),g.info("handleSipKickOff, set isOffline true"),window.isOffline=!0,g.info("it welink return by kick off 1"),e.abrupt("return");case 7:return g.info("sip kickOff to loginPage"),e.next=10,coreAccount.changeAutoLogin();case 10:if(window.isPluginEnv){e.next=13;break}return e.next=13,alert(language.LOGIN_LOGGEDON_ANOTHER);case 13:coreCommon.dispatchModuleEvent("sipKickOutFinished"),coreAccount.clearState(),window.CLIENTCONFIG.ISMOBILE?window.goRoute("loginCtn"):window.goRoute(window.isHubEnv?"maxhubLogin":"login");case 16:case"end":return e.stop()}},e,this)}))));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ke=t.handleDataStartError=function(e){var t=$getState(),n=t.call.callId;window.CLIENTCONFIG.ISMOBILE&&e.param.call_id===n||n&&e.param.call_id===n&&(g.error("data start error"),window.ToastNew(language.CONFERENCE_DATA_START_FAIL,2),$dispatch(coreUi.hideDataShareButton(!1)),g.info("isDataSharing false 1"),window.isDataSharing=!1,$dispatch(coreUi.showDataControl(!1)),(0,S.exitFullScreen)())},Qe=t.handleDataSending=function(e){if(window.CLIENTCONFIG.ISMOBILE){var t=$getState().call.callId;e.param.call_id===t?(g.info("[bfcp] send bfcp from socket success!"),$getState().call.isReceiveBfcp?(1,0):(0,0),$dispatch(coreUi.changeSendBfcp(!0)),$dispatch(coreUi.changeReceiveBfcp(!1)),$dispatch(coreUi.createConfTipMsg([language.ISSHARING_NOT_WATCH_VIDEO]))):(g.info("[bfcp] send bfcp from socket failed!"),$dispatch(coreUi.createConfTipMsg([language.SHARE_FAILED])))}},Ze=t.handleDataStopped=function(e,t){if(window.CLIENTCONFIG.ISMOBILE){var n=$getState().call.callId;t.param.call_id===n?(g.info("[bfcp] stop bfcp from socket success!"),$getState().call.isSendBfcp?(0,0):$getState().call.isReceiveBfcp&&(1,0),$dispatch(coreUi.createConfTipMsg([])),$dispatch(coreUi.changeSendBfcp(!1)),$dispatch(coreUi.changeReceiveBfcp(!1))):g.info("[bfcp] stop bfcp from socket failed!")}},Xe=t.startsipcallout=function(){var e=(0,C.default)(v.default.mark(function e(){var t;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=$getState().login.tempConfInfo,coreConf.oneKeyEnterConf(t.access_code,t.conf_id,t.conf_pwd,!0);case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),et=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreConf.NotifyLoginSuccess(),g.info("big win login sucess"),g.debug("CloudLink confAcc "+window.confAccesscode+", confPas ***"),isNullOrEmpty(window.confAccesscode)||isNullOrEmpty(window.confPasscode)){e.next=26;break}if(t=window.confVip?window.confVip:"",$dispatch(coreUi.changeBuriedAccesscode(window.confAccesscode)),$dispatch(coreUi.changeBuriedPasscode(window.confPasscode)),$dispatch(coreUi.changeBuriedJoinConfVip(window.confVip)),n=window.confAccesscode+"*"+window.confPasscode,(a=coreAccount.getLoginModel().isSipRegSuc())&&!window.isOffline){e.next=14;break}return g.error("CloudLink is offline, auto call is failed"),coreConf.NotifyJoinConfFailedEx(0),e.abrupt("return");case 14:if(isNullOrEmpty(window.ConfUsername)){e.next=19;break}return e.next=17,new coreTup.HWTupCall;case 17:r=e.sent,r.configTUPCallCfgAccountName(window.ConfUsername);case 19:g.info("window.bigConfIsVideo = "+window.bigConfIsVideo),J(n,{number:n,addr_vip:t},window.bigConfIsVideo),window.confAccesscode="",window.confPasscode="",window.confVip="",window.ConfUsername="",window.switchAccount=!1;case 26:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),tt=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r,o;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.noactivity&&!coreConf.isInReCall()){e.next=14;break}return g.info("[IT-Meeting] recv sip register OK, start call enter conf"),t=window.getUserInfo(),n=t.userNameEN,isNullOrEmpty(n)&&(n=window.linkSmcW3Acc),e.next=7,new coreTup.HWTupCall;case 7:a=e.sent,a.configTUPCallCfgAccountName(n),r=window.linkSmcAccessCode,o=window.linkSmcPasscode,coreConf.oneKeyEnterConf(r,"",o,window.linkSmcIsVideo),e.next=16;break;case 14:g.info("[IT-Meeting] recv sip register OK but no activity, do logout."),coreAccount.meetinghwSipEnableToLogout();case 16:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),nt=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return coreAccount.getLoginModel().sipRegisterState=constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED,t=$getState().login.sipLoginOnly,n=$getState().call,a="VIDEO_CONNECTED"===n.callStatus||"CALL_CONNECTED"===n.callStatus||"VIDEO_OUT"===n.callStatus,g.info("[sip register] sip register ok. siploginonly = "+t+" isCallConnected: "+a),r=[],t&&isNullOrEmpty($getState().conf.confTempAcsAccount)&&(a||(window.CLIENTCONFIG.ENABLE_IT_MEETING||r.push(coreConf.confctrlInit()),r.push(coreConf.saveTempMediaxInfo()))),r.push(it()),e.next=10,p.default.all(r);case 10:if(window.CLIENTCONFIG.ENABLE_IT_MEETING&&(window.requestMultiTerminalPromise&&(g.info("[sip register] resume start conf"),window.requestMultiTerminalPromise.resolve(!1)),g.info("sipResultStateRegisted, set isOffline false"),window.isOffline=!1),!t){e.next=14;break}return coreConf.isInReCall()?coreConf.reCallEnterConf():a||(coreAccount.registerResumeEvent(),Xe()),e.abrupt("return");case 14:if(!window.CLIENTCONFIG.ISBIGWIN){e.next=19;break}return e.next=17,et();case 17:e.next=20;break;case 19:window.isHubEnv&&(coreConf.NotifySipRegisterd(),coreConf.NotifyLoginSuccess(),g.info("send maxhub notify, sip register success and Login Success"));case 20:if(window.CLIENTCONFIG.ISMOBILE?at(t):g.debug("no need to call"),isNullOrEmpty(window.enterNoNameConfUrl)){e.next=26;break}return g.info("[sip register] handle delay join temp conf"),e.next=25,window.handleJoinTempConfNoName(window.enterNoNameConfUrl);case 25:window.enterNoNameConfUrl=null;case 26:if(!coreConf.linkJoinConfService.shouldJoinConfByLink){e.next=30;break}return g.info("[sip register] handle delay join link conf"),e.next=30,coreConf.linkJoinConfService.actionJoinConfByLink();case 30:if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=36;break}return coreAccount.resetSipResumeFlag(),e.next=34,tt();case 34:e.next=37;break;case 36:coreConf.reCallEnterConf();case 37:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();t.sipRegResultNotify=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().login,a=n.sipImpi,g.info("[sip register]"),t.param.tel_number===a){e.next=6;break}return g.info(" [sip register] account not compared, no handle "),e.abrupt("return");case 6:if(1!==t.param.register_state&&window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&$dispatch(coreUi.enableHangUp(!0)),r=$getState().call,"CALL_OUT"!==r.callStatus&&"VIDEO_OUT"!==r.callStatus||window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||2!==t.param.register_state&&4!==t.param.register_state||ee(r.callNum),g.info("[sip register] reason_code",t.param.reason_code),o="0",constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERED!==t.param.register_state||0!==t.param.reason_code){e.next=27;break}return coreCommon.Observer.unsubsribleAll(),coreCall.registerCallEvent(),coreCall.registerVideoEvent(),coreConf.registerConfEventAtomic.reset(),coreConf.subScribeConfListAndInfoResAtomic.reset(),coreConf.registerConfEventAtomic.wait(),i=coreAccount.getLoginModel(),i.useMetting&&coreConf.initializeDataConf(),(window.CLIENTCONFIG.ISBIGWIN||window.CLIENTCONFIG.ISWIN)&&coreConf.registerNativeWndEvent(),window.CLIENTCONFIG.ENABLE_IT_MEETING||(c=$getState().login.sipLoginOnly)||window.CLIENTCONFIG.ISBIGWIN||coreConf.getVRMList(),o="1",e.next=25,nt();case 25:e.next=28;break;case 27:constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERING===t.param.register_state||rt(t);case 28:window.CLIENTCONFIG.ENABLE_IT_MEETING&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(constant.SIP_REGISTER_STATE.SIP_REGISTER_REGISTERING!==t.param.register_state&&(window.requestSipLoginPromise&&window.requestSipLoginPromise.resolve(),window.requestSipLoginTimer&&(clearTimeout(window.requestSipLoginTimer),window.requestSipLoginTimer=null),window.alreadyDoSipRegiser=!0),window.setSipState(o));case 29:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}();window.dealStartCall=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,t=o,g.info("debug info [delete] deal start call : ",handlePhoneNumber(t.calleeNumber)),!t){e.next=19;break}if(t.calleeNumber&&(t.calleeNumber=t.calleeNumber.replace(/\s*/g,"").replace(/-/g,"")),t.number=t.calleeNumber,t.name||(t.name=t.number),!t.name||t.name!==t.number){e.next=15;break}return n=t.number,n.length>11&&0===n.indexOf("+86")&&(n=n.replace("+86","")),e.next=12,coreContact.searchServerContact(n);case 12:a=e.sent,r=a.userInformationList||[],r.length>0&&(t.name=getContactName(r[0]),t.account=r[0].account,t.contactsId=r[0].account,t.contactId=r[0].account,g.info("debug info [delete] deal start call : "+handlePhoneNumber(t.account)+handlePhoneNumber(t.contactsId)));case 15:t.acount||(t.contactsId?t.account=t.contactsId:t.account=t.calleeNumber),t.name||(t.name=t.calleeNumber),window.CLIENTCONFIG.ENABLE_IT_MEETING&&$dispatch(coreUi.changeUserInfo({contactsId:t.contactsId,name:t.name})),J(t.number,t,!1);case 19:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),window.dealStartVideo=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=null,t=n,g.info("debug info [delete] callee: ",t),g.info("dealStartVideo, set isOffline false"),window.isOffline=!1,t&&(t.account||(t.account=t.contactsId),t.calleeNumber&&(t.calleeNumber=t.calleeNumber.replace(/\s*/g,"").replace(/-/g,"")),t.isVideo=!0,t.number||(t.number=t.calleeNumber),J(t.number,t,!0));case 6:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();var at=(t.callAfterPCKickout=function(){if(window.CLIENTCONFIG.ISMOBILE){var e=$getState(),t=e.call.savedCalleeInfo;isNullOrEmpty(t)||(g.info("call after kick out pc"),window.Toast("",0,null,!1,!0),t.bConf?window.dispatchEvent(new Event("sipRegisterSuc")):t.oneKeyEnterConf?W(t.number,t.contactInfo,t.bVideo):coreConf.oneKeyEnterConf(t.number,t.enterConfParam.pstconfparam.confid,t.enterConfParam.pstconfparam.conf_paswd,t.bVideo))}},t.SipRegusterOKMobile=function(e){var t=$getState(),n=t.call,a=n.savedCalleeInfo,r=n.tempConfInfo;isNullOrEmpty(a)?isNullOrEmpty(r)?g.debug("no need to call"):(g.info("call by temp conf"),window.dispatchEvent(new Event("sipRegisterSuc"))):(g.info("refresh [token] after kickout pc"),coreAccount.actionRefreshToken())}),rt=t.SipRegusterNotOK=function(e){if(window.CLIENTCONFIG.ENABLE_IT_MEETING&&(g.info("SipRegusterNotOK, set isOffline true"),window.isOffline=!0),window.CLIENTCONFIG.ISMOBILE){var t=$getState(),n=t.call,a=n.savedCalleeInfo,r=n.tempConfInfo;isNullOrEmpty(a)||(g.info("notify sip register failed"),window.Toast(language.CALL_CALLING_FAILED,3,null,!1),$dispatch(coreUi.saveCalleeInfo({}))),isNullOrEmpty(r)||(g.info("notify sip register failed for temp conf"),window.Toast(language.CALL_CALLING_FAILED,3,null,!1),$dispatch(coreUi.saveTempConfInfo({})),delegate.logout(!0,!0));var o=coreConf.getSavedRecallInfo();if(!isNullOrEmpty(o))return void(window.CLIENTCONFIG.USE_IM&&(g.info("notify sip register failed,recallOrHangup"),Nt(o,!0,"")))}window.CLIENTCONFIG.ISBIGWIN&&constant.SIP_REGISTER_STATE.SIP_REGISTER_DEREGISTERING!==e.param.register_state&&constant.SIP_REGISTER_STATE.SIP_REGISTER_BUTT!==e.param.register_state&&(coreConf.NotifyJoinConfFailedEx(1),g.info("big win login failed",e.param.register_state)),$getState().login.sipLoginOnly&&($dispatch(coreUi.changeEnterConfState(!1)),$dispatch(coreUi.changeEnterConfNotifyMsg("")),coreConf.isInReCall()||window.ToastNew(language.ENTER_CONF_FAIL,2),g.info("SipRegusterNotOK alter "))},ot=(t.setUserSelectToNone=function(){window.getSelection().removeAllRanges(),document.documentElement.style["user-select"]="none",document.unselectable="on",document.onselectstart=function(){return!1},document.activeElement&&document.activeElement.blur instanceof Function&&document.activeElement.blur()},t.resumeUserSelect=function(){document.documentElement.style["user-select"]="text",document.unselectable="off",document.onselectstart=null},function(){var e=(0,C.default)(v.default.mark(function e(t,n,a){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CLIENTCONFIG.USE_IM){e.next=2;break}return e.abrupt("return");case 2:if(t.account){e.next=4;break}return e.abrupt("return");case 4:if(g.debug("refresh recent by userInfo: "+handlePhoneNumber(t.account)),!a){e.next=7;break}return e.abrupt("return");case 7:case"end":return e.stop()}},e,void 0)}));return function(t,n,a){return e.apply(this,arguments)}}()),it=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ce(),n=we(),e.next=4,t;case 4:return a=e.sent,e.next=7,n;case 7:r=e.sent,$dispatch(coreUi.changeMicValue(a)),$dispatch(coreUi.changeVoiceValue(r)),g.info("init mic volume: ",a,", init spk volume: ",r);case 11:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),ct=function(e){for(var t=e,n=$getState().conf,a=n.svcOnLineAttendances,r=n.svcShowAttendances,o=n.svcWatchIndNotify,i=0;i<r.length;i++)if(e===r[i].ssrc&&r[i].number)for(var c=0;c<a.length;c++)r[i].number===a[c].number&&(t=a[c].name);for(var l=0;l<o.length;l++)e===o[l].ssrc&&o[l].conf_name&&(t=o[l].conf_name);return t},lt=t.getCallMediaInfoOnMobile=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r,o,i,c,l,u,d,f,p,h,m,C,w,I,S,_,b,N,E,T,k,y,x,O,L,M,R=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=R,!isNullOrEmpty(t)){e.next=5;break}return e.next=4,fe({});case 4:t=e.sent;case 5:if(g.info("getCallMediaInfoOnMobile->getCallMediaParams,res = ",(0,s.default)(t)),n=$getState().conf,a=n.svcShowAttendances,r=n.isDataConfSharing,o=$getState().call,i=o.iSreceivingBFCP,c=o.mediaInfo,0!==t.result){e.next=54;break}if(l="",u="",d="",f="",p="",h="",m="",C="",w="",I="",S="",_="",b="",N="",E="",T="",k="",y={audio:{send:{},recv:{}},video:{send:{encodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"},recv:{ssrc:"--",decodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"}}},x=$getState(),O=x.conf.svcNativeToJS.multiStreamMode,r&&!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&(window.getASCodeInfo(),isNullOrEmpty(c.data)||(g.info("get old data info:"+c.data),y.data=c.data)),!(t.param.svc_stream_info&&t.param.svc_stream_info.length&&t.param.svc_stream_info.length>0&&2!==O)){e.next=50;break}L=0;case 31:if(!(L<t.param.svc_stream_info.length)){e.next=50;break}if(""!==t.param.svc_stream_info[L].encoder_size&&(l=t.param.svc_stream_info[L].encode_name+" "+t.param.svc_stream_info[L].encoder_profile+";"+l,u=t.param.svc_stream_info[L].video_send_bit_rate/1e3+";"+u,d=t.param.svc_stream_info[L].encoder_size+";"+d,f=t.param.svc_stream_info[L].send_fram_rate+";"+f,p=t.param.svc_stream_info[L].send_loss_fraction+";"+p,h=t.param.svc_stream_info[L].send_delay+";"+h,m=t.param.svc_stream_info[L].send_jitter+";"+m,C=t.param.svc_stream_info[L].is_srtp+";"+C),0===t.param.svc_stream_info[L].dec_ssrc){e.next=46;break}if((M=ct(t.param.svc_stream_info[L].dec_ssrc))!==language.FAILURE_ERR_TUP){e.next=37;break}return e.abrupt("return");case 37:w=M+";"+w,I=t.param.svc_stream_info[L].encode_name+" "+t.param.svc_stream_info[L].encoder_profile+";"+I,S=t.param.svc_stream_info[L].video_recv_bit_rate/1e3+";"+S,_=t.param.svc_stream_info[L].decoder_size+";"+_,b=t.param.svc_stream_info[L].recv_fram_rate+";"+b,N=t.param.svc_stream_info[L].recv_loss_fraction+";"+N,E=t.param.svc_stream_info[L].recv_delay+";"+E,T=t.param.svc_stream_info[L].recv_jitter+";"+T,k=t.param.svc_stream_info[L].is_srtp+";"+k;case 46:(0!==t.param.svc_stream_info[L].dec_ssrc&&!t.param.svc_stream_info[L].video_recv_bit_rate||!t.param.svc_stream_info[L].send_fram_rate&&""!==t.param.svc_stream_info[L].encoder_size)&&g.info("getCallMediaParams OnMobile no stream recv. tempSSRC=",t.param.svc_stream_info[L].dec_ssrc,(0,s.default)(t.param.svc_stream_info[L]));case 47:L++,e.next=31;break;case 50:y.video={send:{encodeProtocol:isNullOrEmpty(l)?"--":l,bitRate:isNullOrEmpty(u)?"--":u,frameSize:isNullOrEmpty(d)?"--":d,frameRate:isNullOrEmpty(f)?"--":f,lost:isNullOrEmpty(p)?"--":p,delay:isNullOrEmpty(h)?"--":h,jitter:isNullOrEmpty(m)?"--":m,srtp:isNullOrEmpty(C)?"--":C},recv:{confName:isNullOrEmpty(w)?"--":w,decodeProtocol:isNullOrEmpty(I)?"--":I,bitRate:isNullOrEmpty(S)?"--":S,frameSize:isNullOrEmpty(_)?"--":_,frameRate:isNullOrEmpty(b)?"--":b,lost:isNullOrEmpty(N)?"--":N,delay:isNullOrEmpty(E)?"--":E,jitter:isNullOrEmpty(T)?"--":T,srtp:isNullOrEmpty(k)?"--":k}},i&&(y.bfcp={send:{encodeProtocol:"--",bitRate:"--",frameSize:"--",frameRate:"--",lost:"--",delay:"--",jitter:"--",srtp:"--"},recv:{decodeProtocol:t.param.data_stream_info.decode_name+" "+t.param.data_stream_info.decoder_profile,bitRate:t.param.data_stream_info.video_recv_bit_rate/1e3,frameSize:t.param.data_stream_info.decoder_size,frameRate:t.param.data_stream_info.recv_fram_rate,lost:t.param.data_stream_info.recv_loss_fraction,delay:t.param.data_stream_info.recv_delay,jitter:t.param.data_stream_info.recv_jitter,srtp:t.param.data_stream_info.is_srtp}}),y.audio={send:{encodeProtocol:t.param.audio_stream_info.encode_protocol,bitRate:t.param.audio_stream_info.send_bit_rate,lost:t.param.audio_stream_info.send_loss_fraction,srtp:t.param.audio_stream_info.is_srtp,delay:t.param.audio_stream_info.send_delay,jitter:t.param.audio_stream_info.send_jitter},recv:{decodeProtocol:t.param.audio_stream_info.decode_protocol,bitRate:t.param.audio_stream_info.recv_bit_rate,lost:t.param.audio_stream_info.recv_loss_fraction,srtp:t.param.audio_stream_info.is_srtp,delay:t.param.audio_stream_info.recv_delay,jitter:t.param.audio_stream_info.recv_jitter}},$dispatch(coreUi.changeCallMediaInfo(y));case 54:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();window.notifyAsGetCodecInfo=function(e){var t=$getState().call.mediaInfo;if(!isNullOrEmpty(t)){if(isNullOrEmpty(e))return g.info("asCodeInfo is null"),void(t.data=null);g.info("asCodeInfo",e),t.data={send:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"},recv:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"}},0!==e.codecType?t.data.send={frameRate:e.frameRate+"",byteRate:e.byteRate+"",frameSize:e.width+"*"+e.height,codecVersion:ft(e.codecVersion)}:t.data.recv={frameRate:e.frameRate+"",byteRate:e.byteRate+"",frameSize:e.width+"*"+e.height,codecVersion:ft(e.codecVersion)},$dispatch(coreUi.changeCallMediaInfo(t))}};var st=t.getCallMediaInfoOfNative=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r,i,c,l,s,u,f,p,h,m,C,w,I,S,_,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=b,!isNullOrEmpty(t)){e.next=5;break}return e.next=4,fe({});case 4:t=e.sent;case 5:if(n=$getState().call,a=n.showMediaInfo,r=n.iSreceivingBFCP,i=$getState().conf.isSvcConf,c=$getState().conf.isDataConfSharing,l=new Array,s=new o.default,0!==t.result){e.next=25;break}if(u={audio_stream_info:t.param.audio_stream_info},r&&(u=(0,d.default)({},u,{data_stream_info:t.param.data_stream_info})),t.param.svc_stream_info&&t.param.svc_stream_info.length>0)for(f=0;f<t.param.svc_stream_info.length;f++)p=t.param.svc_stream_info[f],h=p.dec_ssrc,h>0&&(m=coreConf.SvcAtdManager.getConfhwndBySsrc(h))>0&&(C=t.param.svc_stream_info[f].recv_loss_fraction,w=C<10?0:C<25?1:2,s.set(m,w)),a&&(I="",h>0?(I=coreConf.SvcAtdManager.getConfNameBySsrc(h),p=(0,d.default)(p,{conf_name:I}),l.push(p)):f<4&&(p=(0,d.default)(p,{conf_name:I}),l.push(p)));if(s.size>0&&coreConf.SvcAtdManager.reportSingleState(s),!a){e.next=23;break}if(u=i?(0,d.default)(u,{svc_stream_info:l}):(0,d.default)(u,{video_stream_info:t.param.video_stream_info}),!coreConf.isDataShareStarted()){e.next=22;break}return e.next=20,coreConf.getDataStreamInfo();case 20:S=e.sent,S&&S.param&&(g.info(" set share_stream_info"),_={},0===S.param.status?(_.status=1,_.enc_version=S.param.version,_.enc_width=S.param.width,_.enc_height=S.param.height,_.enc_framerate=S.param.framerate,_.enc_bitrate=S.param.bitrate,_.enc_pktloss=S.param.pktloss,_.enc_rtt=S.param.rtt,_.enc_jitter=S.param.jitter):1===S.param.status&&(_.status=2,_.dec_version=S.param.version,_.dec_width=S.param.width,_.dec_height=S.param.height,_.dec_framerate=S.param.framerate,_.dec_bitrate=S.param.bitrate,_.dec_pktloss=S.param.pktloss,_.dec_rtt=S.param.rtt,_.dec_jitter=S.param.jitter),u=(0,d.default)(u,{share_stream_info:_}));case 22:coreConf.SvcAtdManager.reportQos(u);case 23:e.next=26;break;case 25:g.info("getCallMediaInfoOfNative getCallMediaParams failed!");case 26:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),ut=(t.handleisSvcConfShowQOS=function(e){g.info("userClick  change SvcConf Show QOS = ",e),$dispatch(coreUi.changeisSvcConfShowQOS(e))},t.getCallMediaInfoBySsrc=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,f,p,h,m,C,w,I,S,_,b,N,E,T;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("getCallMediaInfoBySsrc,ssrc = ",t),k=t,!(!t||t>$getState().conf.ssrcRange.max||t<$getState().conf.ssrcRange.min)){e.next=5;break}return g.info("getCallMediaInfoBySsrc, ssrc is invalid, return"),e.abrupt("return");case 5:return n={},e.next=8,fe(n);case 8:if(a=e.sent,0!==a.result){e.next=34;break}if(r="",o="",i="",c="",l="",s="",u="--",f={encodeProtocol:u,bitRate:u,frameSize:u,frameRate:u,lost:u,delay:u,jitter:u,srtp:u},p={decodeProtocol:u,bitRate:u,frameSize:u,frameRate:u,lost:u,delay:u,jitter:u,srtp:u},h={version:u,width:u,height:u,frameRate:u,bitRate:u},m={audio:{send:f,recv:p},video:{send:f,recv:p}},C={decodeProtocol:a.param.data_stream_info.decode_name+" "+a.param.data_stream_info.decoder_profile,bitRate:a.param.data_stream_info.video_recv_bit_rate/1e3,frameSize:a.param.data_stream_info.decoder_size,frameRate:a.param.data_stream_info.recv_fram_rate,lost:a.param.data_stream_info.recv_loss_fraction,delay:a.param.data_stream_info.recv_delay,jitter:a.param.data_stream_info.recv_jitter,srtp:a.param.data_stream_info.is_srtp},w=$getState().conf,I=w.isSvcShareMode,S=w.svcShareData,_=$getState().call.iSreceivingBFCP,(window.isDataSharing||I&&S.hasOwnProperty("ssrc")&&-2===S.ssrc)&&(C={decodeProtocol:"",bitRate:0,frameSize:"",frameRate:0,lost:0,delay:0,jitter:0,srtp:a.param.data_stream_info.is_srtp}),!(a.param.svc_stream_info&&a.param.svc_stream_info.length&&a.param.svc_stream_info.length>0)){e.next=32;break}for(b=0;b<a.param.svc_stream_info.length;b++)""!==a.param.svc_stream_info[b].encoder_size&&(r=a.param.svc_stream_info[b].video_send_bit_rate/1e3+","+r,o=a.param.svc_stream_info[b].encoder_size+","+o,i=a.param.svc_stream_info[b].send_fram_rate+","+i,c=a.param.svc_stream_info[b].send_loss_fraction+","+c,l=a.param.svc_stream_info[b].send_delay+","+l,s=a.param.svc_stream_info[b].send_jitter+","+s),a.param.svc_stream_info[b].dec_ssrc===t&&(m={audio:{send:{encodeProtocol:a.param.audio_stream_info.encode_protocol,bitRate:a.param.audio_stream_info.send_bit_rate,lost:a.param.audio_stream_info.send_loss_fraction,srtp:a.param.audio_stream_info.is_srtp,delay:a.param.audio_stream_info.send_delay,jitter:a.param.audio_stream_info.send_jitter},recv:{decodeProtocol:a.param.audio_stream_info.decode_protocol,bitRate:a.param.audio_stream_info.recv_bit_rate,lost:a.param.audio_stream_info.recv_loss_fraction,srtp:a.param.audio_stream_info.is_srtp,delay:a.param.audio_stream_info.recv_delay,jitter:a.param.audio_stream_info.recv_jitter}},video:{send:{encodeProtocol:a.param.svc_stream_info[b].encode_name+" "+a.param.svc_stream_info[b].encoder_profile,bitRate:r,frameSize:o,frameRate:i,lost:c,delay:l,jitter:s,srtp:a.param.svc_stream_info[b].is_srtp},recv:{decodeProtocol:a.param.svc_stream_info[b].decode_name+" "+a.param.svc_stream_info[b].decoder_profile,bitRate:a.param.svc_stream_info[b].video_recv_bit_rate/1e3,frameSize:a.param.svc_stream_info[b].decoder_size,frameRate:a.param.svc_stream_info[b].recv_fram_rate,lost:a.param.svc_stream_info[b].recv_loss_fraction,delay:a.param.svc_stream_info[b].recv_delay,jitter:a.param.svc_stream_info[b].recv_jitter,srtp:a.param.svc_stream_info[b].is_srtp}}},_?m.bfcp={send:{encodeProtocol:a.param.data_stream_info.encode_name+" "+a.param.data_stream_info.encoder_profile,bitRate:a.param.data_stream_info.video_send_bit_rate/1e3,frameSize:a.param.data_stream_info.encoder_size,frameRate:a.param.data_stream_info.send_fram_rate,lost:a.param.data_stream_info.send_loss_fraction,delay:a.param.data_stream_info.send_delay,jitter:a.param.data_stream_info.send_jitter,srtp:a.param.data_stream_info.is_srtp},recv:C}:m.video.send={encodeProtocol:a.param.svc_stream_info[b].encode_name+" "+a.param.svc_stream_info[b].encoder_profile,bitRate:r,frameSize:o,frameRate:i,lost:c,delay:l,jitter:s,srtp:a.param.svc_stream_info[b].is_srtp});if(!coreConf.isDataShareStarted()){e.next=32;break}return e.next=30,coreConf.getDataStreamInfo();case 30:N=e.sent,N&&N.param&&(E={send:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"},recv:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"}},T={codecVersion:ft(N.param.version),frameSize:N.param.width+"*"+N.param.height,frameRate:N.param.framerate,byteRate:N.param.bitrate},0===N.param.status?(m.data=E,m.data.send=T):1===N.param.status&&(m.data=E,m.data.recv=T),g.info(" set share_stream_info "));case 32:n=(0,d.default)({},m),$dispatch(coreUi.changeCallMediaInfo(n));case 34:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),dt=t.getCallMediaInfo=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r,o,i,c,l,s,u,f,p,h;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().call,n=t.showMediaInfo,a=t.iSreceivingBFCP,r=t.mediaInfo,o=t.callStatus,i=$getState().conf.isDataConfSharing,c="VIDEO_OUT"===o||"VIDEO_CONNECTED"===o,l={},s={},!n){e.next=12;break}if(!coreConf.isDataShareStarted()||window.CLIENTCONFIG.ISMOBILE){e.next=12;break}return e.next=9,coreConf.getDataStreamInfo();case 9:u=e.sent,u&&u.param&&(g.info(" set share_stream_info"),0===u.param.status?(l.status=1,l.enc_version=u.param.version,l.enc_width=u.param.width,l.enc_height=u.param.height,l.enc_framerate=u.param.framerate,l.enc_bitrate=u.param.bitrate,l.enc_pktloss=u.param.pktloss,l.enc_rtt=u.param.rtt,l.enc_jitter=u.param.jitter):1===u.param.status&&(l.status=2,l.dec_version=u.param.version,l.dec_width=u.param.width,l.dec_height=u.param.height,l.dec_framerate=u.param.framerate,l.dec_bitrate=u.param.bitrate,l.dec_pktloss=u.param.pktloss,l.dec_rtt=u.param.rtt,l.dec_jitter=u.param.jitter)),s=(0,d.default)(s,{share_stream_info:l});case 12:return f={},e.next=15,fe(f);case 15:if(p=e.sent,0!==p.result){e.next=27;break}return f={audio:{send:{encodeProtocol:p.param.audio_stream_info.encode_protocol,bitRate:p.param.audio_stream_info.send_bit_rate/1e3,lost:p.param.audio_stream_info.send_loss_fraction,srtp:p.param.audio_stream_info.is_srtp,delay:p.param.audio_stream_info.send_delay,jitter:p.param.audio_stream_info.send_jitter},recv:{decodeProtocol:p.param.audio_stream_info.decode_protocol,bitRate:p.param.audio_stream_info.recv_bit_rate,lost:p.param.audio_stream_info.recv_loss_fraction,srtp:p.param.audio_stream_info.is_srtp,delay:p.param.audio_stream_info.recv_delay,jitter:p.param.audio_stream_info.recv_jitter}}},c&&(f.video={send:{encodeProtocol:p.param.video_stream_info.encode_name+" "+p.param.video_stream_info.encoder_profile,bitRate:p.param.video_stream_info.video_send_bit_rate/1e3,frameSize:p.param.video_stream_info.encoder_size,frameRate:p.param.video_stream_info.send_fram_rate,lost:p.param.video_stream_info.send_loss_fraction,delay:p.param.video_stream_info.send_delay,jitter:p.param.video_stream_info.send_jitter,srtp:p.param.video_stream_info.is_srtp},recv:{decodeProtocol:p.param.video_stream_info.decode_name+" "+p.param.video_stream_info.decoder_profile,bitRate:p.param.video_stream_info.video_recv_bit_rate/1e3,frameSize:p.param.video_stream_info.decoder_size,frameRate:p.param.video_stream_info.recv_fram_rate,lost:p.param.video_stream_info.recv_loss_fraction,delay:p.param.video_stream_info.recv_delay,jitter:p.param.video_stream_info.recv_jitter,srtp:p.param.video_stream_info.is_srtp}}),a&&(f.bfcp={send:{encodeProtocol:p.param.data_stream_info.encode_name+" "+p.param.data_stream_info.encoder_profile,bitRate:p.param.data_stream_info.video_send_bit_rate/1e3,frameSize:p.param.data_stream_info.encoder_size,frameRate:p.param.data_stream_info.send_fram_rate,lost:p.param.data_stream_info.send_loss_fraction,delay:p.param.data_stream_info.send_delay,jitter:p.param.data_stream_info.send_jitter,srtp:p.param.data_stream_info.is_srtp},recv:{decodeProtocol:p.param.data_stream_info.decode_name+" "+p.param.data_stream_info.decoder_profile,bitRate:p.param.data_stream_info.video_recv_bit_rate/1e3,frameSize:p.param.data_stream_info.decoder_size,frameRate:p.param.data_stream_info.recv_fram_rate,lost:p.param.data_stream_info.recv_loss_fraction,delay:p.param.data_stream_info.recv_delay,jitter:p.param.data_stream_info.recv_jitter,srtp:p.param.data_stream_info.is_srtp}}),i&&(window.CLIENTCONFIG.ISMOBILE?(window.getASCodeInfo(),isNullOrEmpty(r.data)||(g.info("get old data info:"+r.data),f.data=r.data)):(h={send:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"},recv:{frameRate:"--",byteRate:"--",frameSize:"--",codecVersion:"--"}},1===l.status?(f.data=h,f.data.send={codecVersion:0===ft(l.enc_version)?"--":ft(l.enc_version),frameSize:0===l.enc_width||0===l.enc_height?"--":l.enc_width+"*"+l.enc_height,frameRate:0===l.enc_framerate?"--":l.enc_framerate,byteRate:0===l.enc_bitrate?"--":l.enc_bitrate}):2===l.status&&(f.data=h,f.data.recv={codecVersion:0===ft(l.dec_version)?"--":ft(l.dec_version),frameSize:0===l.dec_width||0===l.dec_height?"--":l.dec_width+"*"+l.dec_height,frameRate:0===l.dec_framerate?"--":l.dec_framerate,byteRate:0===l.dec_bitrate?"--":l.dec_bitrate}))),$dispatch(coreUi.changeCallMediaInfo(f)),s=c?(0,d.default)(s,{audio_stream_info:p.param.audio_stream_info},{video_stream_info:p.param.video_stream_info}):(0,d.default)(s,{audio_stream_info:p.param.audio_stream_info}),a&&(s=(0,d.default)(s,{data_stream_info:p.param.data_stream_info})),e.abrupt("return",s);case 27:g.error("getCallMediaParams failed, result = "+p.result);case 28:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),ft=function(e){var t=void 0;switch(e){case 0:t="1.0";break;case 2:t="2.0";break;case 3:t="H.264";break;case 5:t="H.265 SCC";break;default:t=e+""}return t};window.callInLink=function(e){if(!coreAccount.getLoginModel().isSipRegSuc())return void g.error("sip register failed, can not start call");J(e,{number:e},!0)};var pt=function(){g.info("handleTimeout,enable ClickAddVideo"),$dispatch(coreUi.changeAddVideoBtnStatus(!1)),clearTimeout(b)},ht=(t.updateToVideo=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,S.callPermissionCheck)(!0);case 2:if(n=e.sent,window.requestPermissionPromise&&(window.requestPermissionPromise=null),n){e.next=7;break}return g.info("updateToVideo do not have permission for call"),e.abrupt("return");case 7:if(!$getState().call.isDisableClickAddVideo){e.next=10;break}return g.info("changeAddVideoBtnStatus is disabled,return"),e.abrupt("return");case 10:return e.next=12,H(!0);case 12:if(!(a=e.sent)){e.next=16;break}return g.info("The network type is 2G. not support video"),e.abrupt("return");case 16:if(!t){e.next=25;break}return $dispatch(coreUi.changeAddVideoBtnStatus(!0)),g.info("dispatch  changeAddVideoBtnStatus,true,disable click"),e.next=21,I.addVideo(t);case 21:g.info("updateToVideo,calID = "),b=setTimeout(function(){pt()},3e4),e.next=28;break;case 25:$dispatch(coreUi.changeAddVideoBtnStatus(!1)),g.info("dispatch  changeAddVideoBtnStatus,false,enable click"),g.error("updateToVideo,calID is null");case 28:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.removeVideo=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return g.info("removeVideo,calID = "),e.next=4,I.delVideo(t);case 4:e.next=7;break;case 6:g.error("removeVideo,calID is null");case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.holdCall=function(){var e=(0,C.default)(v.default.mark(function e(t){var n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return g.info("holdCall,calID = "),e.next=4,I.holdCall(t);case 4:e.next=7;break;case 6:g.error("holdCall,calID is null");case 7:n=xt(t),n&&(n.isClickHold=!0);case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.switchToVideo=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("VIDEO_CONNECTED"!==$getState().call.callStatus){e.next=3;break}return g.error("<video>already status is VIDEO_CONNECTED,not switchToVideo"),e.abrupt("return");case 3:window.webView&&window.webView.initCallVideo(),me(t),g.info("handleModifyVideoResult, go to video call view");case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),vt=t.switchToAudio=function(){var e=(0,C.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("enter switchToAudio"),window.CLIENTCONFIG.ISWIN&&!0===$getState().conf.isShowMemberListNew&&$dispatch(coreUi.changeIsShowMemberListNew(!$getState().conf.isShowMemberListNew)),coreConf.closeCallInterface(),$dispatch(coreUi.changeCallToolBarShowStatus(!0)),$dispatch(coreUi.changeMeetingType(!1)),$dispatch(coreUi.changeCallStatus("CALL_CONNECTED")),window.CLIENTCONFIG.ISMOBILE&&(window.switchToAudioFromVideo($getState().call.callId),window.callStatusChangeNotify($getState().call.callId,"CALL_CONNECTED"));case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),mt=t.handleModifyVideoResult=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.reason_code){e.next=6;break}return g.info("handleCallModifyVideoResult,result is false,return"+t.reason_code),$dispatch(coreUi.changeAddVideoBtnStatus(!1)),window.CLIENTCONFIG.ENABLE_IT_MEETING?window.Toast(language.CALL_UPDATE_TO_VIDEO_REGECT,3,null,!1):window.Toast(language.CALL_UPDATE_TO_VIDEO_REGECT,2,!1,null),$dispatch(coreUi.changeAddVideoBtnStatus(!1)),e.abrupt("return");case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ct=t.handleSeessionModify=function(){var e=(0,C.default)(v.default.mark(function e(t){var n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=xt(t.callId),n&&(0,d.default)(n,t),clearTimeout(b),t.isVideo?ht(t.callId):vt(),$dispatch(coreUi.changeAddVideoBtnStatus(!1)),g.info("dispatch  changeAddVideoBtnStatus,false,enable click");case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),wt=t.handleSvcVideoWindows=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("handleSvcVideoWindows",(0,s.default)(t)),$dispatch(coreUi.changeSvcVideoWindows(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),It=t.handleUpdateSvcRender=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("handleUpdateSvcRender"),$dispatch(coreUi.changeSvcRenders(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),St=t.handleDeviceHowlStatus=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("handleDeviceHowlStatus",t),window.CLIENTCONFIG.ISMOBILE){e.next=4;break}return g.info("not mobile so return"),e.abrupt("return");case 4:if(1!==t.iStatus){e.next=22;break}if(0!==t.iDirection){e.next=22;break}if(n=$getState().conf,a=n.confHandle,r=n.isConfMicMute,o=$getState().conf.selfNum,i=$getState().myInfo.bind_no,coreCommon.SpkControl.getInstance().setHandsFree(!1),""===a){e.next=20;break}if(g.info("handleDeviceHowlStatus in conf "),!(r>=1)){e.next=15;break}return g.info("middle mute state, do nothing..."),e.abrupt("return");case 15:g.info("conf mute self mic"),c=isNullOrEmpty(o)?i:o,coreConf.actionMuteAttendee(!0,c,!0),e.next=22;break;case 20:g.info("handleDeviceHowlStatus in p2p "),coreCommon.MicControl.getInstance().muteMic(!0);case 22:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),_t=function(e){g.info("call is srtp media.  callId: "+e.call_id+" is_srtp: "+e.is_srtp);var t=xt(e.call_id);t&&(t.isSrtp=0!==e.is_srtp),$dispatch(coreUi.changeIsSrtp(0!==e.is_srtp)),coreConf.SvcAtdManager.reportSRTPStatus()},gt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";window.CLIENTCONFIG.ENABLE_IT_MEETING&&window.webView&&(e===constant.ONLINE_STATUS.BUSY?window.webView.setTalkingState():window.webView.cancelTalkingState()),window.CLIENTCONFIG.USE_IM&&!window.isOffline&&(g.info(" changeStatus status: "+e+", not handle offline"),e!==constant.ONLINE_STATUS.OFFLINE&&coreAccount.publishStatus({status:e,desc:t}))};window.pageInfoChangeNotify=function(e){g.info("debug info page info : ",e);var t={currentPage:e.currentPage,totalPage:e.totalPage};$dispatch(coreUi.changCurrentPageInfo(t))},window.JSToNativeToastLocalize=function(e){var t=e.times,n=void 0===t?0:t,a=e.text,r=e.delayTimes,o=void 0===r?0:r;g.info("JSToNativeToastLocalize -1 times="+n+",text="+a+",delayTimes="+o),language[a]&&(a=language[a]),g.info("JSToNativeToastLocalize times="+n+",text="+a+",delayTimes="+o),isNullOrEmpty(a)||window.JSToNativeToast(n,a,o)},window.setMobileRemoteViewHandle=function(e){g.info("debug info mobileRemoteViewHandleInfo : ",e);var t=new Array;t.push(e.remoteFirstViewIdx),t.push(e.remoteSecondViewIdx),t.push(e.remoteThirdViewIdx),t.push(e.remoteFourthViewIdx),t.push(e.remoteFifthViewIdx),t.push(e.remoteSixthViewIdx);var n={remoteLargeViewIdx:e.remoteLargeViewIdx,remoteViewIdx:t};$dispatch(coreUi.changeSvcMobileConfHandles(n));var a=$getState().conf.isFirstSvcConfSSRC;g.info("isFirstSvcConfSSRC",a),coreConf.handleSSRCURL(-1);var r=$getState().conf.svcMobileConfHandles;g.info("debug info mobileRemoteViewHandleInfo :",r);var o=Math.ceil(t.length/window.CLIENTCONFIG.SVC_WINDOW_PHONE_RATIO)||window.CLIENTCONFIG.SVC_WINDOW_MAX_DIVIDE_NUM_PHONE;window.CLIENTCONFIG.SVC_WINDOW_PHONE_FLAG&&(o=window.CLIENTCONFIG.SVC_WINDOW_MAX_DIVIDE_NUM_PHONE),$dispatch(coreUi.changeSvcMobileHandleNum(o))},window.audioOutputDevicesChange=function(e,t,n){g.info("debug info audioOutputDevicesChange : ",e,t,n);var a=$getState().call.isSpeaker,r=$getState().call.callStatus,o="true"===e||!0===e;window.otherAudioDevicesConnect=o,"ios"===window.CLIENTCONFIG.PLATFORM&&window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?t===constant.AUDIO_ROUTE_CHANGE_REASON.DETECT_AUDIO_ROUTE_RESULT?n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_HEADPHONE?($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_HEADPHONEBT&&($dispatch(coreUi.switchSpeakerBluetooth(!0)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):""===$getState().conf.confHandle?t!==constant.AUDIO_ROUTE_TYPE.OLD_DEVICE_UNAVAILABLE||o?n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_HEADPHONEBT&&($dispatch(coreUi.switchSpeakerBluetooth(!0)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):isIPad?($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!0))):($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_SPEAKER?($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!0))):n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_RECEIVER?($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_HEADPHONE?($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):n===constant.AUDIO_ROUTE_TYPE.AUDIO_TYPE_HEADPHONEBT&&($dispatch(coreUi.switchSpeakerBluetooth(!0)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):"android"===window.CLIENTCONFIG.PLATFORM&&window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?"1"===t?"2"===n?($dispatch(coreUi.switchSpeakerBluetooth(!0)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):"3"===t?(g.info("扬声器状态插拔设备"),$dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!0))):o&&"2"===n?($dispatch(coreUi.switchSpeakerBluetooth(!0)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):($dispatch(coreUi.switchSpeakerBluetooth(!1)),$dispatch(coreUi.switchSpeakerAndReceive(!1))):("android"===window.CLIENTCONFIG.PLATFORM?"2"!==n?"0"===t?"VIDEO_CONNECTED"===r?(coreCommon.SpkControl.getInstance().setHandsFree(!0),$dispatch(coreUi.switchSpeakerAndReceive(!0))):(coreCommon.SpkControl.getInstance().setHandsFree(a),$dispatch(coreUi.switchSpeakerAndReceive(a))):$dispatch(coreUi.switchSpeakerAndReceive(!1)):$dispatch(coreUi.switchSpeakerAndReceive(!0)):a&&0===t?(g.info("debug info turn receiver"),$dispatch(coreUi.switchSpeakerAndReceive(!1))):a||1!==t||$dispatch(coreUi.switchSpeakerAndReceive(!0)),o&&"android"===window.CLIENTCONFIG.PLATFORM&&"2"===n&&"0"!==t?$dispatch(coreUi.switchSpeakerBluetooth(!0)):$dispatch(coreUi.switchSpeakerBluetooth(!1)))};var bt=t.stopBfcpReceive=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";!0===$getState().call.iSreceivingBFCP&&(g.info("stop bfcp call in end call"),$dispatch(coreUi.setBfcpReceiving(!1)),""===e&&(e=$getState().call.callId),e&&I.activeStopBFCPData(e))},Nt=t.recallOrHangup=function(){var e=(0,C.default)(v.default.mark(function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("recallOrHangup, need to leave conf or dispatch recallStart event, bNeedLeaveConf: "+n),isNullOrEmpty(t)?(g.info("recallOrHangup,savedRecallInfo is empty,no stream hangup call"),coreConf.isInConf()?coreConf.actionLeaveConf():ee(a)):coreConf.reCallStart(t);case 2:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}();window.answerSimCardCalling=function(){if(g.info("enter afterAnswerSimCall"),""===$getState().call.callId)return void g.info("afterAnswerSimCall call id is null ");window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&""!==$getState().conf.confHandle&&(g.info("[IT-Meeting] afterAnswerSimCall actionLeaveConf"),coreConf.actionLeaveConf())},window.mobileDoBeforeSimCall=(0,C.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("enter mobileDoBeforeSimCall"),""!==$getState().call.callId){e.next=4;break}return g.info("mobileDoBeforeSimCall call id is null "),e.abrupt("return");case 4:return $dispatch(coreUi.changeSimIncomming(!0)),e.next=7,coreCommon.SpkControl.getInstance().muteSpk(!0,!1);case 7:return e.next=9,Le(1,1);case 9:if(window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING&&!window.linkSmcIsVideo){e.next=12;break}return e.next=12,Me(1);case 12:g.info("leave mobileDoBeforeSimCall");case 13:case"end":return e.stop()}},e,void 0)})),window.mobileDoAfterSimCall=(0,C.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("enter mobileDoAfterSimCall"),""!==$getState().call.callId){e.next=5;break}return g.info("mobileDoAfterSimCall call id is null "),$dispatch(coreUi.changeSimIncomming(!1)),e.abrupt("return");case 5:setTimeout(function(){return Et()},2e3);case 6:case"end":return e.stop()}},e,void 0)}));var Et=t.doAfterSimCall=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("enter doAfterSimCall"),$dispatch(coreUi.changeSimIncomming(!1)),e.next=4,coreCommon.SpkControl.getInstance().muteSpk(!1,!1);case 4:if(t=$getState().call.isMuteMic){e.next=8;break}return e.next=8,Le(1,0);case 8:return e.next=10,Me(0);case 10:n=$getState().call.isSpeaker,n||coreCommon.SpkControl.getInstance().setHandsFree(!n),coreCommon.SpkControl.getInstance().setHandsFree(n),g.info("leave doAfterSimCall");case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();window.noPermissionLeaveConfNotify=function(){g.info("enter noPermissionLeaveConf"),window.switchToBackMode(),delegate.doLogout(constant.LOGOUT_TYPE.LOGOUT)};var Tt=function(){var e=(0,C.default)(v.default.mark(function e(t,n){var a,r,o,i,c,l;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE&&!window.CLIENTCONFIG.ISBIGWIN){e.next=2;break}return e.abrupt("return");case 2:if(!1!==(a=window.isOpenSpeechDetect)){e.next=6;break}return g.info("this call is stop check speech level"),e.abrupt("return");case 6:return g.info("handleSpeechLevelReport in logic,send_speech__level = "+t+",send_noise_level = "+n),r=$getState().common.modalContent,o=r.props?r.props.children:"",i=o===language.IS_MUTE_NEED_CHANGE_INPUT&&$getState().common.isShowModal,e.next=12,I.getCntOfSpeechLevel($getState().call.callId);case 12:if(c=e.sent,c&&((t<90||n<=50)&&++c.low>1&&(c.low=0,window.isOpenSpeechDetect=!1,g.info("isOpenSpeechDetect.false,normal"),i&&coreUi.hideModal()),t>=90&&n>=75?i||$getState().setting.isShowSetting||c.high++:c.high=0),!(c&&c.high>1)||$getState().call.isMuteMic){e.next=26;break}if(g.info("is need to change"),c.high=0,!($getState().setting.micCount>2)||i){e.next=26;break}if(!window.isHubEnv){e.next=22;break}return g.info("maxhub no to confirm change input audio"),window.isOpenSpeechDetect=!1,e.abrupt("return");case 22:return e.next=24,window.confirm(language.IS_MUTE_NEED_CHANGE_INPUT,!0,{leftButton:language.FALSE_ALARM,rightButton:language.BTN_ENSURE_TO_SET});case 24:l=e.sent,l.ret?(g.info("userClick yes to confirm change input audio,result = "+l),coreSetting.showSystemSettings(!0)):(g.info("userClick no to confirm change input audio,result = "+l),window.isOpenSpeechDetect=!1);case 26:return e.next=28,I.setCntOfSpeechLevel($getState().call.callId,c);case 28:case"end":return e.stop()}},e,void 0)}));return function(t,n){return e.apply(this,arguments)}}(),kt=t.dealPassiveDirectionResult=function(e){if(g.info("change Current Direction Status Passive."),window.CLIENTCONFIG.ISMOBILE){var t=$getState().call.isBidirection,n=1===e.param.dir;return g.info("audience js Notity audienceDirectionNotify ,data.param.dir = "+n+",isBidirection = "+t),void yt(n)}e&&e.param&&(1===e.param.dir?(g.info("Passive change Current Direction Status to bidirection."),$dispatch(coreUi.changeBidirectionStatus(!0)),g.info("deal[Pass]iveDirectionResult isOpenCamera = "+$getState().call.isOpenCamera),coreCommon.CameraControl.getInstance().switchCameraStateAction(!0),$dispatch(coreUi.toggleSmallSvcVisible(!0))):(g.info("Passive change Current Direction Status to onedirection."),$dispatch(coreUi.changeBidirectionStatus(!1)),g.info("deal[Pass]iveDirectionResult isOpenCamera = "+$getState().call.isOpenCamera),coreCommon.CameraControl.getInstance().switchCameraStateAction(!1),$dispatch(coreUi.toggleSmallSvcVisible(!1)))),window.CLIENTCONFIG.ISWIN&&coreConf.notifyChangePassiveBidirectionStatus(e)},yt=t.changeDirectionForMobile=function(e){g.info("audience, changeDirectionForMobile");var t=null;t=e?language.PASSIVE_BIDIRECTION:language.ONEDIRECTION,$dispatch(coreUi.changeBidirectionStatus(e)),window.showWebView(),window.switchLocalVideoState(!1,e),$dispatch(coreUi.CloseOrOpenPIP(e)),$dispatch(coreUi.changeAudienceHint(!0)),$dispatch(coreUi.createConfHintMsg([t])),setTimeout(function(){$dispatch(coreUi.createConfHintMsg([])),$dispatch(coreUi.changeAudienceHint(!1))},3e3)},xt=t.getCallInfoByCallId=function(e){var t=void 0,n=O.length;if(e===$getState().call.callId)return x;for(var a=0;a<n;a++)if(t=O[a],e===t.callId)return t;return L&&e===L.callId?L:(g.info("getCallInfoByCallId error. callid: "+e),null)},Ot=function(e){var t=void 0;if(x&&x.callNo===e)return!1;if(x&&x.userInfo&&x.userInfo.bind_no===e)return!1;for(var n=O.length,a=0;a<n;a++){if(t=O[a],e===t.callNo)return!1;if(t.userInfo&&t.userInfo.bind_no===e)return!1}return!0},Lt=function(e){O=O.filter(function(t){return e!==t.callId}),Ve(O)},Mt=function(){var e=O.pop();return Ve(O),e},Rt=function(e){var t={callId:e.callId,userInfo:e.userInfo,callNum:e.callNo,callStatus:"",noStreamEndcall:0,tipMsg:[],isSrtp:e.isSrtp,consultTransferId:"",timer:e.timer};e.callState===constant.CALL_STATE.CALL_E_CALL_STATE_OUT?1===e.callType?t.callStatus="VIDEO_OUT":t.callStatus="CALL_OUT":e.callState===constant.CALL_STATE.CALL_E_CALL_STATE_LIVE||e.callState===constant.CALL_STATE.CALL_E_CALL_STATE_HOLD?1===e.callType?t.callStatus="VIDEO_CONNECTED":t.callStatus="CALL_CONNECTED":e.callState===constant.CALL_STATE.CALL_E_CALL_STATE_IN&&(t.callStatus="CALL_INCOMING");var n=$getState().call.callStatus;"VIDEO_TRANSTO_CONF"!==n&&"CALL_TRANSTO_CONF"!==n||(t.callStatus=n),e.callState===constant.CALL_STATE.CALL_E_CALL_STATE_HOLD?t.isCallHold=!0:t.isCallHold=!1,e.consultTransferId&&(t.consultTransferId=e.consultTransferId),$dispatch(coreUi.changeCurrentCallInfo(t))},At=(t.hangupHoldCall=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("hangupHoldCall callId: "+t),e.next=3,I.endCallService(t);case 3:n=xt(t),a=$getState().callRecord.IdByIdGenerateRecord,r=$getState().call.receiveCallUpateInfo,n&&(a.indexOf(t)<0||r)&&($dispatch(coreUi.changeReceiveUpateInfo(!1)),a.push(t),g.info("build a record hangupHoldCall"),a.length>20&&(a=a.slice(a.length-20,a.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(a)),Fe(n)),Lt(t),I.deleteCallObject(t),0===O.length&&Gt(!1,"hangupHoldCall"),t===x.consultTransferId&&(x.consultTransferId="",$dispatch(coreUi.changeConsultTransferId("")));case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.resumeCall=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("resume call callid: "+t),e.next=3,I.unHoldCall(t);case 3:a&&(n=xt(t))&&(n.isClickHold=!1);case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),Vt=(t.consultTransfer=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x.consultTransferId,n=$getState().call.callId,g.info("consultTransfer currentCallId: "+n+" consultId: "+t),t&&n){e.next=6;break}return g.info("user consultTransfer call error, currentCallId: "+n+" consultId: "+t),e.abrupt("return");case 6:return e.next=8,I.consultTransfer(t,n);case 8:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(){var e=(0,C.default)(v.default.mark(function e(){var t,n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ISMOBILE){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,I.getMicDeviceVol();case 4:return t=e.sent,0===t.result&&0===t.param.volume&&I.setMicDeviceVol(0,50),e.next=8,I.getSpkDeviceVol();case 8:n=e.sent,0===n.result&&0===n.param.volume&&I.setSpkDeviceVol(0,50);case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),Ft=(t.getIsTransFer=function(){var e=$getState().selectBox,t=e.selectBox_modalType,n=e.selectBox_accessPoint;return t===constant.CONTACT_SELECT_DIALOG_TYPE.CONTACT_SELECT_DIALOG_TRANSFERCALL&&n===constant.SELECT_BOX_ACCESSPOINT.ACCESSPOINT_ELEVEN},t.blindTranseferEntrance=function(){var e=(0,C.default)(v.default.mark(function e(t,n){var a;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,g.info("start blindTransefer Entrance [1]"),a=$getState().call.callId,isNullOrEmpty(a)&&g.error("start blindTransefer Entrance callId is null or undefined"),!isNullOrEmpty(n)){e.next=8;break}g.error("start blindTransefer Entrance transferNumber is null or undefined"),e.next=11;break;case 8:return g.info("start blindTransefer Entrance [1]",t),e.next=11,I.blindTransfer(a,n);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),g.error("blindTransefer Entrance");case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t,n){return e.apply(this,arguments)}}(),function(){var e=(0,C.default)(v.default.mark(function e(t){var n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.info("handleCallBldTransferFailed callId: "+t.call_id),window.CLIENTCONFIG.ISMOBILE?window.Toast(language.CALL_TRANSFER_FAILED,2,!1):window.Toast(language.CALL_TRANSFER_FAILED,2,!1,null),e.next=4,I.unHoldCall(t.call_id);case 4:n=$getState().call.isCallTransfer,n&&Gt(!1,"handleCallBldTransferFailed");case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),Dt=function(){var e=(0,C.default)(v.default.mark(function e(t){var n;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.call_id&&(g.info("handleCallBldTransferSuccess callId: "+t.call_id),window.CLIENTCONFIG.ISMOBILE?window.Toast(language.CALL_TRANSFER_SUCCEEDED,2,!1):window.Toast(language.CALL_TRANSFER_SUCCEEDED,2,!1,null),(n=$getState().call.isCallTransfer)&&Gt(!1,"handleCallBldTransferSuccess"));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ut=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.info("handleSetTransferModify callId: "+t.call_id),n=t.call_id,a=$getState().call.callId,n===a&&(r=$getState().call.isCallTransfer,2===t.audio_send_mode?(g.info("handleSetTransferModify changeCallTransferFlag(true)"),Gt(!0,"handleSetTransferModify")):4===t.audio_send_mode&&r&&0===O.length&&(g.info("handleSetTransferModify changeCallTransferFlag(false)"),Gt(!1,"handleSetTransferModify")));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Bt=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$getState().call.callId,isNullOrEmpty(t)||!Array.isArray(t)||2!==t.length){e.next=8;break}if(a=$getState().callRecord.IdByIdGenerateRecord,$dispatch(coreUi.changeReceiveUpateInfo(!0)),t[0]&&t[0].callId&&n===t[0].callId&&a.indexOf(t[0].callId)<0&&(a.push(n),a.length>20&&(a=a.slice(a.length-20,a.length)),$dispatch(coreUi.RecordIdByIdGenerateRecord(a)),g.info("build a record handleCallUpateRemoteInfo"),Fe(t[0])),!t[1]||!t[1].callId||n!==t[1].callId){e.next=8;break}return e.next=8,Pt(t[1]);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Pt=t.refreshCallPage=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.info("refreshCallPage start"),n={callerName:t.callNo,callerDepartment:"",callerNumber:t.callNo,callAccount:t.ucaccount},a=t.callNo,"*"===t.callNo.substr(0,1)&&(a=t.callNo.substr(1,t.callNo.length-1)),r=void 0,window.skipLogin){e.next=14;break}return e.next=8,coreContact.searchServerContact(a,1,1);case 8:o=e.sent,i=o.userInformationList||[],n.callerNumber=a,i.length>0?(n.callerName=getContactName(i[0]),""===n.callerName&&(n.callerName=n.callerNumber),n.callAccount=i[0].account,n.callerDepartment=getContactDept(i[0]),r=i[0],$dispatch(coreUi.changeUserInfo(r)),$dispatch(coreUi.changeCallNum(n.callerNumber))):(r={account:a},$dispatch(coreUi.changeUserInfo(r)),$dispatch(coreUi.changeCallNum(n.callerNumber))),e.next=17;break;case 14:r={account:a},$dispatch(coreUi.changeUserInfo(r)),$dispatch(coreUi.changeCallNum(n.callerNumber));case 17:return c=xt(t.callId),c&&(c.userInfo=r,c.callNo=n.callerNumber),e.next=21,ot({account:n.callAccount},!1,!0);case 21:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),$t=t.changeCallHoldStatusLogic=function(e){g.info("changeCallHoldStatusLogic: "+e),$dispatch(coreUi.changeCallHoldStatus(e))},Gt=t.setTransferFlagHandle=function(e,t){g.info("setTransferFlagHandle ["+t+"]("+e+")"),$dispatch(coreUi.changeCallTransferFlag(e))},Wt=t.transferNumberToName=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,a="",""!==t){e.next=4;break}return e.abrupt("return",a);case 4:return"*"===t.substr(0,1)&&(n=t.substr(1,t.length-1)),e.next=7,coreContact.searchServerContact(n);case 7:return r=e.sent,o=r.userInformationList||[],o.length>0&&""===(a=getContactName(o[0]))&&(a=n),e.abrupt("return",a);case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Ht=(t.IsDialingCallInfo=function(e){$dispatch(coreUi.changeIsDialingCallInfo(e))},t.resetCallInfo=function(){g.info("set current call null"),x=null,O=[],L={}},function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:coreConf.startCallFailed(t);case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),zt=t.handleNotifyCallBeenHangup=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:M=t;case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),jt=t.handleCallPickupNotify=function(){var e=(0,C.default)(v.default.mark(function e(t){var n,a,r,o,i,c,l,s,u,f,p,h,m,C,w,I,S,_,b,N,E,T,k,y;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.CLIENTCONFIG,0!==(a=parseInt(n["Device.ComCfg.Service.pickupActive"]))){e.next=5;break}return g.info("pickup call is not active : "+a),e.abrupt("return");case 5:if(t.sipAccountID=t.sipaccoutid,t.callerNumber=t.callerno,t.ringNumber=t.ringno,t.pickupCallType=t.pickup_type,t.pickupType=t.indicate,g.info("callPickupNotify, data.pickupCallType: "+t.pickupCallType),g.info("callPickupNotify, data.pickupType: "+t.pickupType),r=$getState().call.pointPickupCap,o=$getState().call.groupPickupCap,1===t.pickupCallType||2===t.pickupCallType){e.next=17;break}return g.info("wrong pickupCallType"),e.abrupt("return");case 17:if(i=$getState().call,c=i.callStatus,e.t0=window.CLIENTCONFIG.ISMOBILE,!e.t0){e.next=24;break}return e.next=23,window.isSimCardCall();case 23:e.t0=e.sent;case 24:if(l=e.t0,null!==R){e.next=31;break}if(0!==t.pickupType){e.next=29;break}return g.info("data.pickupCallType: "+t.pickupCallType),e.abrupt("return");case 29:e.next=55;break;case 31:if(0!==t.pickupType){e.next=53;break}if(!$getState().call.acceptPickupCall){e.next=36;break}R=null,e.next=51;break;case 36:if(!R||R.callerNumber!==t.callerNumber||R.ringNumber!==t.ringNumber||R.pickupCallType!==t.pickupCallType){e.next=49;break}return g.info("run at close a notify"),coreUi.closePickupCallNotify(),s=window.getRoute(),g.info("currentPage + ",s),g.info("acceptPickupCall + ",$getState().call.acceptPickupCall),window.CLIENTCONFIG.ISMOBILE&&!1===$getState().call.acceptPickupCall&&(g.info("rejectPickupCall end call "+s),"callMain"===s?history.back():"mConfMemberPage"===s?window.goRoute("main/conference"):"mSelectBox"===s&&coreUi.clearTransferOfShowBox()),coreUi.stopRing(),!1===$getState().call.acceptPickupCall&&(g.info("handleCallPickupNotify, changeStatus"),gt(constant.ONLINE_STATUS.ONLINE)),R=null,e.abrupt("return");case 49:return g.info("run at receive a wrong notify"),e.abrupt("return");case 51:e.next=55;break;case 53:return g.info("run at receive a new notify"),e.abrupt("return");case 55:if($dispatch(coreUi.changeAcceptPickupCall(!1)),!l){e.next=59;break}return g.info("callPickupNotify, now is in sim card call,end call"),e.abrupt("return");case 59:if(!("VIDEO_OUT"===c||"CALL_OUT"===c||"CALL_INCOMING"===c||"CALL_CONNECTED"===c||"VIDEO_CONNECTED"===c||"VIDEO_TRANSTO_CONF"===c||"CALL_TRANSTO_CONF"===c||coreConf.isInConf()||window.CLIENTCONFIG.ISBIGWIN||window.isHubEnv)){e.next=61;break}return e.abrupt("return");case 61:if(u=$getState().call.callId,""===u&&(f=$getState(),p=f.myInfo,h=p.account,m=p.statusDesc,C=f.contactGroups.contact_status_map,$dispatch(coreUi.changeOldStatus(C[h]&&C[h].status,m)),g.info("dispatch changeOldStatus status= "+(C[h]&&C[h].status)+",desc = "+m),g.info("callInComming,status: "+constant.ONLINE_STATUS.BUSY+",desc = Calling"),gt(constant.ONLINE_STATUS.BUSY)),R=(0,d.default)({},{callerNumber:t.callerNumber,ringNumber:t.ringNumber,pickupCallType:t.pickupCallType,isConnected:0}),w={isShow:!0,pickupType:t.pickupType,sipAccountID:t.sipAccountID,callAccount:"",callerDepartment:"",callerName:"",callerNumber:t.callerNumber,ringAccount:"",ringDepartment:"",ringName:"",ringNumber:t.ringNumber,pickupCallType:t.pickupCallType},I=t.callerNumber,S=t.ringNumber,_=void 0,"tel:"===t.callerNumber.substr(0,4)&&(I=t.callerNumber.substr(4,t.callerNumber.length-4)),"tel:"===t.ringNumber.substr(0,4)&&(S=t.ringNumber.substr(4,t.ringNumber.length-4)),b=void 0,window.skipLogin){e.next=85;break}return e.next=74,coreContact.searchServerContact(I,1,1);case 74:return N=e.sent,e.next=77,coreContact.searchServerContact(S,1,1);case 77:E=e.sent,T=N.userInformationList||[],k=E.userInformationList||[],w.ringNumber=S,T.length>0?(w.callerName=getContactName(T[0]),""===w.callerName&&(w.callerName=w.callerNumber),w.callAccount=T[0].account,w.callerDepartment=getContactDept(T[0]),b=T[0]):(b={account:I},w.callerName=w.callerNumber),k.length>0?(w.ringName=getContactName(k[0]),""===w.ringName&&(w.ringName=w.ringNumber),w.ringAccount=k[0].account,w.ringDepartment=getContactDept(k[0])):w.ringName=w.ringNumber,e.next=86;break;case 85:b={account:I};case 86:$dispatch(coreUi.changePickupCallerInfo(b)),g.info("callPickupNotify "+w),window.webView&&window.webView.setFrontToLock(),g.info("showPickupCallNotify"),coreUi.showPickupCallNotify(w),y=window.getRoute(),g.info("go into callmain, current page : "+y),window.CLIENTCONFIG.ISMOBILE&&"callMain"!==y&&(g.info("go into callmain"),window.goRoute("callMain")),g.info("pickup call incommingRing"),coreUi.incommingRing("in",!0);case 96:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Jt=t.handleCallPickupRemoteInfo=function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),Yt=(t.acceptPickupCall=function(){var e=(0,C.default)(v.default.mark(function e(t,n,a,r){var o,i,c,l,s,u,d,f,p,h,m,C,w,S,_,b,N,E;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return coreConf.setServerIp&&coreConf.setServerIp(""),coreUi.showSearchPanel(!1),$dispatch(coreUi.changeAcceptPickupCall(!0)),o=$getState().call.initiativeHoldCall,g.info("Call Out isCallHold: "+o),i={},i.account=a,c={bConf:!1,bVideo:!1,number:a,contactInfo:i,enterConfParam:null,isConsultTransfer:!0},e.next=10,z(c);case 10:if(l=e.sent){e.next=14;break}return window.CLIENTCONFIG.ISBIGWIN&&(coreConf.NotifyJoinConfFailed(0),$getState().bigwinBuried.buried.postHasSent||(coreConf.buriedJoinConfFailed(),$dispatch(coreUi.changeHasSentState(!0)))),e.abrupt("return",!1);case 14:if($dispatch(coreUi.saveCalleeInfo({})),s=$getState(),u=s.myInfo,d=u.account,f=u.statusDesc,p=s.login.sipLoginOnly,h=null,coreConf.handleIsShowJoinButton(!1),$dispatch(coreUi.changeCallStatus("CALL_OUT")),!1!==window.skipLogin){e.next=27;break}if(window.CLIENTCONFIG.ISMOBILE){e.next=25;break}return e.next=23,ot(i,!0,!0);case 23:e.next=27;break;case 25:return e.next=27,ot(i,!1,!0);case 27:return coreUi.closePickupCallNotify(),coreUi.stopRing(),m=null,e.next=32,I.createCallId(n,0,0);case 32:if(!(m=e.sent)||0!==m.result){e.next=52;break}if(0!==m.param.call_id){e.next=37;break}return g.info("create call id failed, call_id"+m.param.call_id),e.abrupt("return",!1);case 37:return e.next=39,I.startPickupCall({call_id:m.param.call_id,callerNumber:a,ringNumber:r,pickupCallType:t});case 39:if(m=e.sent){e.next=48;break}return $dispatch(coreUi.changeAcceptPickupCall(!1)),C=window.getRoute(),window.CLIENTCONFIG.ISMOBILE&&(g.info("rejectPickupCall end call"),"callMain"===C?history.back():"mConfMemberPage"===C?window.goRoute("main/conference"):"mSelectBox"===C&&coreUi.clearTransferOfShowBox()),w=$getState().call,S=w.oldStatus,_=w.oldStatusDesc,g.info("acceptPickupCall, oldStatus = "+S+"oldStatusDesc = "+_),gt(S,_),e.abrupt("return",!1);case 48:g.info("current call status : ",$getState().call.callStatus),$dispatch(coreUi.changeCallStatus("VIDEO_OUT")),e.next=57;break;case 52:return g.info("create call id failed"),b=$getState().call,N=b.oldStatus,E=b.oldStatusDesc,g.info("acceptPickupCall, oldStatus = "+N+"oldStatusDesc = "+E),gt(N,E),e.abrupt("return",!1);case 57:R=null;case 58:case"end":return e.stop()}},e,void 0)}));return function(t,n,a,r){return e.apply(this,arguments)}}(),t.rejectPickupCall=function(){var e=(0,C.default)(v.default.mark(function e(){var t,n,a,r;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:R=null,t=window.getRoute(),$dispatch(coreUi.changeAcceptPickupCall(!1)),g.info("rejectPickupCall end call"),window.CLIENTCONFIG.ISMOBILE&&(g.info("rejectPickupCall end call"),"callMain"===t?history.back():"mConfMemberPage"===t?window.goRoute("main/conference"):"mSelectBox"===t&&coreUi.clearTransferOfShowBox()),coreUi.closePickupCallNotify(),coreUi.stopRing(),n=$getState().call,a=n.oldStatus,r=n.oldStatusDesc,g.info("rejectPickupCall, oldStatus = "+a+"oldStatusDesc = "+r),gt(a,r);case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),function(){var e=(0,C.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.changeCallStatus("VIDEO_CONNECTED")),$dispatch(coreUi.changeCallId(t.call_id)),$dispatch(coreUi.changeMeetingType(!0)),$dispatch(coreUi.changeCallToolBarShowStatus(!1));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}())},99:function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.HwCallSdk=void 0;var o=n(121),i=r(o),c=n(4),l=r(c),s=n(1001),u=r(s),d=n(1002),f=r(d),p=n(878),h=r(p),v=n(879),m=a(v),C=n(1003),w=r(C),I=n(880),S=a(I),_=n(1783),g=a(_),b=n(1004),N=a(b),E=n(1784),T=a(E),k=n(1005),y=a(k),x=n(1785),O=a(x);t.HwCallSdk=function e(){(0,l.default)(this,e),this.AudioCallService=u.default,this.CallManager=f.default,this.CallService=h.default,(0,i.default)(this,m),this.VideoCallService=w.default,(0,i.default)(this,S),(0,i.default)(this,g),(0,i.default)(this,N),(0,i.default)(this,T),(0,i.default)(this,y),(0,i.default)(this,O)}}});