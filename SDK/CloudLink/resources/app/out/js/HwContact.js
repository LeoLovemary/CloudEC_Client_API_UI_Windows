webpackJsonp([17],{101:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.HwContactSdk=void 0;var o=r(124),u=a(o),c=r(4),i=a(c),s=r(1277),p=n(s),d=r(1278),f=n(d),l=r(1281),v=n(l),h=r(1280),m=n(h),g=r(1279),b=n(g),x=r(1282),C=n(x),y=r(959),_=n(y),w=r(1054),k=n(w),I=r(1765),S=n(I),E=r(1283),L=n(E),N=r(994),O=n(N),T=r(1766),M=n(T),G=r(1767),D=n(G),A=r(466),U=n(A),P=r(1768),R=n(P),F=r(1769),$=n(F),B=r(1770),q=r(1772),H=n(q);t.HwContactSdk=function e(){(0,i.default)(this,e),(0,u.default)(this,v),(0,u.default)(this,m),(0,u.default)(this,b),(0,u.default)(this,C),(0,u.default)(this,f),(0,u.default)(this,_),(0,u.default)(this,k),(0,u.default)(this,S),(0,u.default)(this,L),(0,u.default)(this,p),(0,u.default)(this,O),(0,u.default)(this,M),(0,u.default)(this,D),(0,u.default)(this,U),(0,u.default)(this,R),(0,u.default)(this,$),(0,u.default)(this,B.euaserver.getApiList()),(0,u.default)(this,H)}},1054:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.preQueryUserListEaddr=t.deleteContactPreSave=t.getUserInfo=void 0;var a=r(3),o=n(a),u=r(1),c=n(u),i=r(124),s=n(i),p=r(2),d=n(p),f=window.Logger("contactInterface")("corporateDirectory"),l=(t.getUserInfo=function(){var e=(0,d.default)(c.default.mark(function e(t,r,n){var a,o,u,i,p,d,f;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreUi.getContactAvatar(t),a=coreAccount.getLoginModel(),o=a.isSupportAS,u={},i={},p={},isNullOrEmpty(n)){e.next=11;break}return e.next=8,coreContact.queryServerContact(n);case 8:p=e.sent,e.next=15;break;case 11:return e.next=13,coreContact.queryUserListFromEaddr([{username:t,etag:"fffff"}]);case 13:d=e.sent,!isNullOrEmpty(d)&&d.entry&&(p={param:d.entry[0],result:d.result});case 15:if(!window.CLIENTCONFIG.USE_IM||o){e.next=19;break}return e.next=18,l(t);case 18:u=e.sent;case 19:return f=o?{}:{image_sync_time:"",modify_time:"",q_pin_yin:"",signature:"",staff_id:"",state:"",age:"",birthday:"",dept_id:"",desc:"",ip_phone:"",is_security:0,old_account:"",other_mobiles:"",voip:""},isNullOrEmpty(u)||isNullOrEmpty(u.param)||(f={image_sync_time:u.param.image_sync_time,modify_time:u.param.modify_time,q_pin_yin:u.param.q_pin_yin,signature:u.param.signature,staff_id:u.param.staff_id,state:u.param.state,age:u.param.age,birthday:u.param.birthday,dept_id:u.param.dept_id,desc:u.param.desc,ip_phone:u.param.ip_phone,is_security:u.param.is_security,old_account:u.param.old_account,other_mobiles:u.param.other_mobiles,voip:u.param.voip}),i=isNullOrEmpty(p)||isNullOrEmpty(p.param)||p.param.result_code!==constant.EADDR_CONTACT_RESULT_CODE.SUCCESS?isNullOrEmpty(u)||isNullOrEmpty(u.param)?(0,s.default)({},{param:{},result:1}):(0,s.default)({},u):(0,s.default)({},p,{param:(0,s.default)({},p.param,f)}),e.abrupt("return",i);case 23:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),function(){var e=(0,d.default)(c.default.mark(function e(t){var r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreIm.checkEServerOnlineNoToast("queryEServerFuc")){e.next=2;break}return e.abrupt("return",{param:{}});case 2:return e.next=4,coreContact.getEserverUserInfo({account:t});case 4:if(!(r=e.sent)||!r.param||0!==r.result){e.next=9;break}return e.abrupt("return",{param:r.param,result:r.result});case 9:return f.error("queryEServerFuc search user info failed"),e.abrupt("return",{param:{}});case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}());t.deleteContactPreSave=function(){var e=(0,d.default)(c.default.mark(function e(t){var r,n,a,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!isNullOrEmpty(t)){e.next=4;break}return f.info("deleteContactPreSave account is empty"),e.abrupt("return");case 4:return e.next=6,coreDb.queryContactList({all:"",accountlist:t});case 6:if(r=e.sent,n=[],!isNullOrEmpty(r)){e.next=11;break}return f.info("deleteContactPreSave dbResult is empty"),e.abrupt("return");case 11:for(a=0;a<r.length;a++)u=r[a],n.push(coreDb.deleteContact({id:u.id}));return e.next=14,o.default.all(n);case 14:f.info("deleteContactPreSave success,has delete",r.length),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),f.error("deleteContactPreSave"+{error:e.t0.toJSON()});case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t){return e.apply(this,arguments)}}(),t.preQueryUserListEaddr=function(){var e=(0,d.default)(c.default.mark(function e(t){var r,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!isNullOrEmpty(t)){e.next=3;break}return e.abrupt("return",[]);case 3:if(r=[],!isNullOrEmpty(a)){e.next=9;break}return n=t.getKeyArr("account").join(","),e.next=8,coreDb.queryContactList({all:"",accountlist:n});case 8:a=e.sent;case 9:return t.forEach(function(e){var t=a.query({account:e.account})||{},n={username:e.account,etag:isNullOrEmpty(t.etag)?"fffff":t.etag},o=r.query({username:n.username});isNullOrEmpty(o)&&r.push(n)}),e.abrupt("return",r);case 13:return e.prev=13,e.t0=e.catch(0),f.error("preQueryUserListEaddr error"+{error:e.t0.toJSON()}),e.abrupt("return",[]);case 17:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t){return e.apply(this,arguments)}}()},1150:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.formatContactGroupMemberList=t.queueDealMergeServerGroupMember=t.setUnMergeServerGroup=t.isMergeServerGroupList=t.initIncrementData=void 0;var a=r(133),o=n(a),u=r(134),c=n(u),i=r(3),s=n(i),p=r(1),d=n(p),f=r(2),l=n(f),v=r(162),h={},m=[],g=[],b={},x=!1,C=window.Logger("group")("member/increment"),y=(t.initIncrementData=function(e){C.info("initIncrementData ",e),h={},m=[],g=[],b={},x=!1},t.isMergeServerGroupList=function(e){return C.info("isMergeServerGroupList ",e),g.includes(e)}),_=(t.setUnMergeServerGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];isNullOrEmpty(e.group_id)||m.includes(e.group_id)||b.group_id===e.group_id||y(e.group_id)||(t?(C.info("setUnMergeServerGroup unshift",e.group_id),m.unshift(e.group_id)):(C.info("setUnMergeServerGroup push",e.group_id),m.push(e.group_id)),h[e.group_id]=e,x||_())},t.queueDealMergeServerGroupMember=function(){var e=(0,l.default)(d.default.mark(function e(){var t,r,n,a,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(x=!0,b={},0!==m.length){e.next=5;break}return x=!1,e.abrupt("return");case 5:if(coreIm.checkEServerOnlineNoToast("queueDealMergeServerGroupMember")){e.next=9;break}return C.info("queueDealMergeServerGroupMember eserver is not login,wait for eServer login"),x=!1,e.abrupt("return");case 9:if(t=m[0],C.info("queueDealMergeServerGroupMember will deal group is ",t),r=h[t],n=r.sync_member_time,a=r.group_id,o=r.owner,!n){e.next=20;break}C.info("queueDealMergeServerGroupMember","sync_member_time is not empty,deal createGroupMemberChangeEvent",a),m.shift(),delete h[t],coreGroup.createGroupMemberChangeEvent(a,o),e.next=28;break;case 20:if(coreIm.checkEServerOnlineNoToast("queueDealMergeServerGroupMember")){e.next=23;break}return x=!1,e.abrupt("return");case 23:return m.shift(),delete h[t],b=r,e.next=28,w(r);case 28:return e.next=30,_();case 30:return e.abrupt("return",e.sent);case 31:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()),w=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,o,u,i,p,f,l;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.group_id,n=t.owner,C.info("mergeServerGroupMember",r),e.next=5,(0,v.getGroupMemberList)(r);case 5:return a=e.sent,o=a.memberList,u=a.time_stamp,i=[],p=[],t.sync_member_time=u,f=[],l=[],isNullOrEmpty(o)||o.forEach(function(e){e.group_id=r,e.state===constant.GROUP_STATE.DELETE?l.push(e):f.push(e)}),i=f.splitByNum(50).map(function(e){return coreDb.bulkPutGroupMember(k(e))}),p=l.map(function(e){return coreDb.deleteGroupMember({account:e.account,group_id:r})}),isNullOrEmpty(t.id)||delete t.id,e.next=16,s.default.all([].concat((0,c.default)(i),(0,c.default)(p),[coreGroup.saveGroupInfo(t)]));case 16:coreGroup.createGroupMemberChangeEvent(r,n),g.push(r),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),C.error("mergeServerGroupMember",e.t0.toString());case 23:case"end":return e.stop()}},e,void 0,[[0,20]])}));return function(t){return e.apply(this,arguments)}}(),k=t.formatContactGroupMemberList=function(e){return e.map(function(e){return{account:e.account,group_id:e.group_id,name:getContactName(e),staffid:e.staff_id}})};!function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,u,c,i,p,f;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(C.info("dealMemberList 群成员列表开始处理！"),e.prev=1,r=[],n="",a=0,u=[],isNullOrEmpty(t)){e.next=22;break}return c=t.getKeyArr("account"),n=c.join(","),e.next=11,coreDb.queryContactList({all:"",accountlist:n});case 11:return i=e.sent,e.next=14,coreContact.queryUsersIncrementFromEaddr(t,i);case 14:if(p=e.sent,f=coreContact.coverUserList(t,p),c.splitByNum(20).forEach(function(e){coreUi.getContactListAvatar(e)}),!isNullOrEmpty(i)){e.next=19;break}return e.abrupt("return",f);case 19:return f.forEach(function(e){var t=i.queryList({account:e.account}),n=(0,o.default)({},e);t.length>1?(C.info("dealMemberList find more about one person:"+t.length),t.forEach(function(t){t.contact_id>a&&(a=t.contact_id),u.push(coreDb.deleteContact({id:""+e.id}))}),n.contact_id=a,a=0,r.push(n)):(isNullOrEmpty(t)||0===t[0].contact_id)&&r.push(e)}),e.next=22,s.default.all(u);case 22:return e.abrupt("return",r);case 25:return e.prev=25,e.t0=e.catch(1),C.error("dealMemberList fail",{error:e.t0.toJSON()}),e.abrupt("return",[]);case 29:case"end":return e.stop()}},e,void 0,[[1,25]])}))}()},119:function(e,t,r){e.exports={default:r(165),__esModule:!0}},120:function(e,t,r){e.exports=r(0)(43)},121:function(e,t,r){e.exports=r(0)(45)},124:function(e,t,r){e.exports=r(0)(277)},1277:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.transformAccountToUuid=t.goBackLastInfo=t.clickAddCustomContact=t.clickCorporateMenu=t.loadSliderDetailInfo=t.toggleSliderDetailContent=t.toggleSliderDetailShow=t.clickMenuItem=t.toggleSubMenuOpen=t.toggleSpecialMenuOpen=t.toggleMainMenuOpen=t.updateContactGroupDetailShow=t.updateSelectedItemKey=void 0;var a=r(124),o=n(a),u=r(1),c=n(u),i=r(134),s=n(i),p=r(2),d=n(p),f=r(959),l=window.Logger("logic")("contactGroups/index"),v=(t.updateSelectedItemKey=function(e){$dispatch(coreUi.updateSelectedItemKey(e))},t.updateContactGroupDetailShow=function(e){$dispatch(coreUi.updateContactGroupDetailShow(e))}),h=(t.toggleMainMenuOpen=function(){var e=(0,d.default)(c.default.mark(function e(t,r){var n,a,o,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=$getState(),a=n.contactGroups.contactMenu,o=[].concat((0,s.default)(a)),u=0;case 5:if(!(u<o.length)){e.next=12;break}if(o[u].menu_name!==t){e.next=9;break}return o[u].menu_open=r,e.abrupt("break",12);case 9:u++,e.next=5;break;case 12:return e.next=14,$dispatch(coreUi.updateContactMenuOpen(o));case 14:l.info("toggleMainMenuOpen"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),l.error("toggleMainMenuOpen",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t,r){return e.apply(this,arguments)}}(),t.toggleSpecialMenuOpen=function(){var e=(0,d.default)(c.default.mark(function e(t,r){var n,a,o,u;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=$getState(),a=n.contactGroups.specialFocusMenu,o=[].concat((0,s.default)(a)),u=0;case 4:if(!(u<o.length)){e.next=11;break}if(o[u].id!==t){e.next=8;break}return o[u].sf_menu_open=r,e.abrupt("break",11);case 8:u++,e.next=4;break;case 11:return e.next=13,$dispatch(coreUi.updateSpecialMenuOpen(o));case 13:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}()),m=(t.toggleSubMenuOpen=function(){var e=(0,d.default)(c.default.mark(function e(t,r,n){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t!==language.SPECIAL_FOCUS){e.next=6;break}return e.next=4,h(r,n);case 4:e.next=9;break;case 6:if(t!==language.CONTACTS){e.next=9;break}return e.next=9,(0,f.toggleContactTypeOpen)(r,n);case 9:l.info("切换联系人群组副目录列表折叠展开"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),l.error("toggleSubMenuOpen",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t,r,n){return e.apply(this,arguments)}}(),t.clickMenuItem=function(){var e=(0,d.default)(c.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.contact_id){e.next=7;break}return e.next=3,(0,f.clickContact)(t);case 3:coreUi.getContactAvatar(t.account),v("contact"),e.next=11;break;case 7:if(!t.group_id){e.next=11;break}return e.next=10,coreGroup.openGroupDetailById(t.group_id);case 10:v("group");case 11:$dispatch(coreUi.updateSubmenuId(r)),$dispatch(coreUi.updateLastInfo({menuItem:t,submenuId:r})),coreGroup.initGroupAnnounceInfo();case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.toggleSliderDetailShow=function(e){$dispatch(coreUi.updateSliderDetailShow(e))}),g=t.toggleSliderDetailContent=function(){var e=(0,d.default)(c.default.mark(function e(t){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $dispatch(coreUi.updateSliderDetailContent(t)),e.next=3,$dispatch(coreUi.updateSliderDetailLoading(!1));case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),b=(t.loadSliderDetailInfo=function(){var e=(0,d.default)(c.default.mark(function e(t){var r,n,a,u,i,s,p,d,v,h,x,C,y;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=$getState(),n=r.contactGroups.sliderDetailShow,e.next=5,b();case 5:return e.next=7,$dispatch(coreUi.updateSliderDetailLoading(!0));case 7:if(isNullOrEmpty(t.group_id)||!isNullOrEmpty(t.account)){e.next=36;break}if(!isNullOrEmpty(t.recent)){e.next=28;break}return e.next=11,coreGroup.getGroupDetailInfo(t);case 11:return a=e.sent,u=a.groupId,i=a.groupInfoNew,s=a.groupMemberInfo,p=a.isOwner,d=a.groupSetting,e.next=19,$dispatch(coreUi.updateSliderGroupDetail(i,s,d,p));case 19:return e.next=21,g(constant.SLIDER_DETAIL_TYPE.group);case 21:return e.next=23,coreGroup.initGroupAnnounceInfo();case 23:if(n){e.next=26;break}return e.next=26,m(!0);case 26:e.next=34;break;case 28:return e.next=30,m(!1);case 30:return coreIm.toggleRecent(t.recent),coreUi.openGroupDetail(t.recent.group),e.next=34,$dispatch(coreUi.updateSliderDetailLoading(!1));case 34:e.next=64;break;case 36:return v=isNullOrEmpty(t.account),e.next=39,$dispatch(coreUi.updateSliderContactDetail(t,v));case 39:return e.next=41,g(constant.SLIDER_DETAIL_TYPE.contact);case 41:if(n){e.next=44;break}return e.next=44,m(!0);case 44:return e.next=46,(0,f.getContactDetailInfo)(t,!0);case 46:if(h=e.sent,x=h.userInfo,C=h.customContact,!0!==x.isNotServerInfo){e.next=61;break}if($getState().login.deployMode!==constant.MEETING_NET_TYPE.SMC_MEETING){e.next=58;break}return l.info("user not found,search by sip"),e.next=54,coreContact.queryServerContact(t.account);case 54:y=e.sent,isNullOrEmpty(y)||isNullOrEmpty(y.param)?x=(0,o.default)({},t,{isNotServerInfo:!0}):(l.info("search userInfo by sip success"),x=y.param),e.next=59;break;case 58:x=(0,o.default)({},t,{isNotServerInfo:!0});case 59:e.next=62;break;case 61:x.isNotServerInfo=!1;case 62:return e.next=64,$dispatch(coreUi.updateSliderContactDetail(x,C));case 64:l.info("加载弹窗联系人或群组详情"),e.next=70;break;case 67:e.prev=67,e.t0=e.catch(0),l.error("loadSliderDetailInfo",e.t0);case 70:case"end":return e.stop()}},e,void 0,[[0,67]])}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,d.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),!(r=t.call.callStatus)){e.next=5;break}return l.info("toggle call page when open detail"),e.next=5,coreCall.setNoMoveTrue();case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}());t.clickCorporateMenu=function(){var e=(0,d.default)(c.default.mark(function e(t,r){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:v(t),$dispatch(coreUi.updateSubmenuId(r)),$dispatch(coreUi.updateLastInfo({menuItem:t,submenuId:r}));case 3:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.clickAddCustomContact=function(){var e=(0,d.default)(c.default.mark(function e(t){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:v(t);case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.goBackLastInfo=function(){var e=(0,d.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState().contactGroups.lastContactGroupInfo,r=void 0===t?{}:t,!r.menuItem.contact_id){e.next=7;break}return e.next=4,(0,f.clickContact)(r.menuItem);case 4:v("contact"),e.next=14;break;case 7:if(!r.menuItem.group_id){e.next=13;break}return e.next=10,coreGroup.openGroupDetailById(r.menuItem.group_id);case 10:v("group"),e.next=14;break;case 13:v(r.menuItem);case 14:$dispatch(coreUi.updateSubmenuId(r.submenuId));case 15:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.transformAccountToUuid=function(){var e=(0,d.default)(c.default.mark(function e(t){var r,n,a,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!coreAccount.getLoginModel().isSupportAS){e.next=18;break}return e.next=3,coreDb.queryContactList({account:t});case 3:if(r=e.sent,""===(n=isNullOrEmpty(r)?"":r[0].uuid)){e.next=10;break}return l.info("transformAccountToUuid dbuuid",n),e.abrupt("return",n);case 10:return e.next=12,coreContact.searchServerContact(t);case 12:return a=e.sent,o=isNullOrEmpty(a)?"":a.userInformationList[0].id,l.info("transformAccountToUuid euauuid",o),e.abrupt("return",o);case 16:e.next=19;break;case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},1278:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.uploadAvatar=t.setSign=t.removeEventListenerDealKeyBoard=t.addEventListenerDealKeyBoard=t.modifyCustomContact=t.openEditCustomPage=t.checkIsChange=t.updataEditStatus=t.checkEmailInput=t.mHandleChangeCustomResult=t.updataCustomDucks=t.searchContactByNum=t.addCustomContact=t.getRecentContactList=t.getFriendList=t.dealContactGroupInfo=t.addContactToContactGroup=t.saveContactInfoList=t.saveContactInfo=void 0;var a=r(1763);Object.defineProperty(t,"setSign",{enumerable:!0,get:function(){return a.setSign}}),Object.defineProperty(t,"uploadAvatar",{enumerable:!0,get:function(){return a.uploadAvatar}});var o=r(1279),u=n(o),c=r(1280),i=n(c),s=r(1281),p=n(s),d=r(1764),f=r(1282),l=n(f);t.saveContactInfo=d.saveContactInfo,t.saveContactInfoList=d.saveContactInfoList;t.addContactToContactGroup=i.addContactToContactGroup,t.dealContactGroupInfo=i.dealContactGroupInfo,t.getFriendList=u.getFriendList,t.getRecentContactList=u.getRecentContactList,t.addCustomContact=p.addCustomContact,t.searchContactByNum=p.searchContactByNum,t.updataCustomDucks=p.updataCustomDucks,t.mHandleChangeCustomResult=p.mHandleChangeCustomResult,t.checkEmailInput=p.checkEmailInput,t.updataEditStatus=p.updataEditStatus,t.checkIsChange=p.checkIsChange,t.openEditCustomPage=p.openEditCustomPage,t.modifyCustomContact=p.modifyCustomContact,t.addEventListenerDealKeyBoard=l.addEventListenerDealKeyBoard,t.removeEventListenerDealKeyBoard=l.removeEventListenerDealKeyBoard},1279:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.Logger("logic")("contactGroup/contact/dealData");t.getRecentContactList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t=$getState(),r=t.myInfo,a=t.recent.recentList,o=e.filterContacts,u=void 0===o?[]:o;return n.info("getRecentContactList"),a.filter(function(e){return!coreIm.isGroup(e.chat_type)&&!isNullOrEmpty(e.contact)&&e.contact.account!==r.account&&isNullOrEmpty(u.query({account:e.account}))}).map(function(e){return e.contact})}catch(e){n.error("getRecentContactList",e)}},t.getFriendList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t=$getState(),r=t.myInfo,a=t.contactGroups.contactUserList,o=e.filterContacts,u=void 0===o?[]:o;return n.info("getFriendList"),a.filter(function(e){return e.account!==r.account&&isNullOrEmpty(u.query({account:e.account}))})}catch(e){n.error("getFriendList",e)}}},1280:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){var e=$getState(),t=e.contactGroups.contactUserList,r=parseInt(window.CLIENTCONFIG["Device.ComCfg.IM.MaxContact"]);if(isNaN(r))return window.alert(window.language.ADD_FRIEND_ERROR),b.error("checkNowFriendNum esight config IM.MaxContact error"),!1;var n=t?t.length:0;return n>=r?(window.alert(window.language.ADD_TO_MAX),!1):n<r}Object.defineProperty(t,"__esModule",{value:!0}),t.dealContactGroupInfo=t.normalAddContactToContactGroup=t.addContactToContactGroup=void 0;var o=r(149),u=n(o),c=r(1),i=n(c),s=r(2),p=n(s),d=(t.addContactToContactGroup=function(){var e=(0,p.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(b.info("addContactToContactGroup add a contact as a friend"),t&&t.account){e.next=5;break}if(!window.CLIENTCONFIG.USE_IM){e.next=5;break}return b.info("addContactToContactGroup contact information has a problem or no account"),e.abrupt("return");case 5:if(a()){e.next=7;break}return e.abrupt("return");case 7:return e.abrupt("return",window.CLIENTCONFIG.USE_IM?x(t):d(t));case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,p.default)(i.default.mark(function e(t){var r,n=this;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.delegateYield(i.default.mark(function e(){var r,a,o,u,c,s,p,d,f,v,m,x,C;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.info("teAddContactToContactGroup add a contact as a friend"),e.next=3,l();case 3:if(r=e.sent,t.id){e.next=9;break}return e.next=7,coreDb.queryContact({account:t.account});case 7:a=e.sent,isNullOrEmpty(a)||(t=a);case 9:for(o=$getState(),u=o.contactGroups.contactUserList,c=1;-1!==u.findIndex(function(e){return parseInt(e.contact_id)===c});)c++;return t.contact_id=c.toString(),e.next=16,coreContact.saveContactInfo(t);case 16:return t=e.sent,s={contact_id:t.contact_id,group_id:r.group_id,state:constant.CONTACT_STATE.ADD},e.next=20,coreDb.saveContactMemberGroup(s);case 20:return e.next=22,(0,g.reloadContactListData)();case 22:if(p=o.contactGroups,d=p.detailContent,f=p.contactInfo,v=p.sliderDetailShow,m=p.sliderContent,x=p.sliderContactInfo,!v||"Contact"!==m||x.account!==t.account){e.next=26;break}return e.next=26,$dispatch(coreUi.updateSliderContactDetail(t,!1));case 26:if("contact"!==d||f.account!==t.account&&f.contact_id!==t.contact_id||$dispatch(coreUi.updateContactDetail(t,!1)),!window.CLIENTCONFIG.ISMOBILE){e.next=35;break}if($dispatch(coreUi.updateMobileContactDetail(t,!1)),window.Toast(language.ADDED_FRIEND,2,!1),window.CLIENTCONFIG.USE_IM){e.next=32;break}return e.abrupt("return",{v:void 0});case 32:return C={account:t.account,contact_id:t.contact_id},e.next=35,(0,h.tapContact)(C);case 35:case"end":return e.stop()}},e,n)})(),"t0",2);case 2:if(r=e.t0,"object"!==(void 0===r?"undefined":(0,u.default)(r))){e.next=5;break}return e.abrupt("return",r.v);case 5:e.next=10;break;case 7:e.prev=7,e.t1=e.catch(0),b.error("teAddContactToContactGroup",e.t1.toJSON);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t){return e.apply(this,arguments)}}()),f=t.dealContactGroupInfo=function(){var e=(0,p.default)(i.default.mark(function e(){var t,r,n,a,o,u,c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),r=void 0,n=t.contactGroups.contactGroup,a="Group",-1!==(o=n.findIndex(function(e){return e.name===a}))){e.next=14;break}return e.next=7,(0,v.addContactGroupService)(a,n.length);case 7:return u=e.sent,c={group_id:u.param.id,index:n.length,name:a,state:0},e.next=11,coreDb.saveContactGroup(c);case 11:r={group_id:u.param.id,index:n.length},e.next=15;break;case 14:r={group_id:n[o].group_id,index:o};case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),l=function(){var e=(0,p.default)(i.default.mark(function e(){var t,r,n,a,o,u=this;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),r=void 0,n=t.contactGroups.contactGroup,a="Group",-1!==(o=n.findIndex(function(e){return e.name===a}))){e.next=8;break}return e.delegateYield(i.default.mark(function e(){var t,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=1;-1!==n.findIndex(function(e){return e.group_id===t});)t++;return o={group_id:t,index:n.length,name:a,state:0},e.next=5,coreDb.saveContactGroup(o);case 5:r={group_id:t,index:n.length};case 6:case"end":return e.stop()}},e,u)})(),"t0",6);case 6:e.next=9;break;case 8:r={group_id:n[o].group_id,index:o};case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),v=r(466),h=r(994),m=r(1054),g=r(959),b=window.Logger("logic")("contact"),x=t.normalAddContactToContactGroup=function(){var e=(0,p.default)(i.default.mark(function e(t){var r,n,a,o,u,c,s,p,d,l,x,C,y,_;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,b.info("normalAddContactToContactGroup add a contact as a friend"),e.next=4,f();case 4:return r=e.sent,n={account:t.account,group_id:r.group_id,display_name:""},e.next=8,(0,v.addContactService)(n);case 8:if(a=e.sent,a.result!==constant.ERROR_CODE.Success){e.next=47;break}if(t.id){e.next=15;break}return e.next=13,coreDb.queryContact({all:"",accountlist:t.account});case 13:o=e.sent,isNullOrEmpty(o)||(t=o);case 15:return t.contact_id=a.param.contact_id,e.next=18,(0,m.deleteContactPreSave)(t.account);case 18:return e.next=20,coreContact.saveContactInfo(t);case 20:return t=e.sent,u={contact_id:t.contact_id,group_id:r.group_id,state:constant.CONTACT_STATE.ADD},e.next=24,coreDb.saveContactMemberGroup(u);case 24:return e.next=26,(0,g.reloadContactListData)();case 26:if(c=$getState(),s=c.contactGroups,p=s.detailContent,d=s.contactInfo,l=s.sliderDetailShow,x=s.sliderContent,C=s.sliderContactInfo,!l||"Contact"!==x||C.account!==t.account){e.next=31;break}return e.next=31,$dispatch(coreUi.updateSliderContactDetail(t,!1));case 31:if("contact"!==p||d.account!==t.account&&d.contact_id!==t.contact_id||$dispatch(coreUi.updateContactDetail(t,!1)),!window.CLIENTCONFIG.ISMOBILE){e.next=37;break}return $dispatch(coreUi.updateMobileContactDetail(t,!1)),y={account:t.account,contact_id:t.contact_id},e.next=37,(0,h.tapContact)(y);case 37:return e.next=39,coreIm.getLocalRecent({owner:t.account});case 39:if(_=e.sent,isNullOrEmpty(_)){e.next=46;break}return _.contact=t,e.next=44,coreDb.saveRecent(_);case 44:_=e.sent,$dispatch(coreUi.updateRecent(_));case 46:return e.abrupt("return",a.result);case 47:e.next=52;break;case 49:e.prev=49,e.t0=e.catch(0),b.error("normalAddContactToContactGroup",e.t0.toJSON);case 52:case"end":return e.stop()}},e,void 0,[[0,49]])}));return function(t){return e.apply(this,arguments)}}()},1281:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){var e=$getState(),t=e.contactGroups.contactUserList,r=parseInt(window.CLIENTCONFIG["Device.ComCfg.IM.MaxContact"]);if(isNaN(r))return window.alert(window.language.ADD_FRIEND_ERROR),y.error("checkNowFriendNum esight config IM.MaxContact error"),!1;var n=t?t.length:0;return n>=r?(window.alert(window.language.ADD_TO_MAX),!1):n<r}Object.defineProperty(t,"__esModule",{value:!0}),t.searchContactByNum=t.checkIsChange=t.checkEmailInput=t.mHandleChangeCustomResult=t.openEditCustomPage=t.updataEditStatus=t.updataCustomDucks=t.delCustomContact=t.modifyCustomContact=t.addCustomContact=void 0;var o=r(135),u=n(o),c=r(124),i=n(c),s=r(149),p=n(s),d=r(1),f=n(d),l=r(2),v=n(l),h=function(){var e=(0,v.default)(f.default.mark(function e(){var t,r,n,a,o,u=this;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$getState(),r=void 0,n=t.contactGroups.contactGroup,a="Group",-1!==(o=n.findIndex(function(e){return e.name===a}))){e.next=8;break}return e.delegateYield(f.default.mark(function e(){var t,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=1;-1!==n.findIndex(function(e){return e.group_id===t});)t++;return o={group_id:t,index:n.length,name:a,state:0},e.next=5,coreDb.saveContactGroup(o);case 5:r={group_id:t,index:n.length};case 6:case"end":return e.stop()}},e,u)})(),"t0",6);case 6:e.next=9;break;case 8:r={group_id:n[o].group_id,index:o};case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),m=r(466),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(m),b=r(959),x=(r(994),r(1278)),C=r(1277),y=window.Logger("logic")("addCustom"),_=(t.addCustomContact=function(){var e=(0,v.default)(f.default.mark(function e(t){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(y.info("addCustomContact add custom contact to contact group"),a()){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",window.CLIENTCONFIG.USE_IM?_(t):w(t));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,v.default)(f.default.mark(function e(t){var r,n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,y.info("normalAddCustomContact begin"),!window.CLIENTCONFIG.ISMOBILE){e.next=7;break}return e.next=5,(0,x.dealContactGroupInfo)();case 5:r=e.sent,t.group_id=r.group_id;case 7:return e.next=9,g.addCustomContactService(t);case 9:if(n=e.sent,n.result!==constant.RESULT.SUCCESS||1!==n.param.result){e.next=20;break}return t.contact_id=n.param.contact_id,e.next=14,coreContact.saveContactInfo(t);case 14:return t=e.sent,a={contact_id:t.contact_id,group_id:t.group_id,state:constant.CONTACT_STATE.ADD},e.next=18,coreDb.saveContactMemberGroup(a);case 18:return e.next=20,(0,b.reloadContactListData)();case 20:return e.abrupt("return",{result:n.result});case 23:return e.prev=23,e.t0=e.catch(0),y.error("normalAddCustomContact error",e.t0),e.abrupt("return",{result:1});case 27:case"end":return e.stop()}},e,void 0,[[0,23]])}));return function(t){return e.apply(this,arguments)}}()),w=function(){var e=(0,v.default)(f.default.mark(function e(t){var r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.delegateYield(f.default.mark(function e(){var r,n,a,o,u;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return y.info("TeAddCustomContact begin"),e.next=3,h();case 3:for(r=e.sent,n=$getState(),a=n.contactGroups.contactUserList,o=1;-1!==a.findIndex(function(e){return parseInt(e.contact_id)===o});)o++;return t.contact_id=o.toString(),t.gender=2,e.next=12,coreContact.saveContactInfo(t);case 12:return t=e.sent,u={contact_id:t.contact_id,group_id:r.group_id,state:constant.CONTACT_STATE.ADD},e.next=16,coreDb.saveContactMemberGroup(u);case 16:return e.next=18,(0,b.reloadContactListData)();case 18:return e.abrupt("return",{v:{result:0}});case 19:case"end":return e.stop()}},e,void 0)})(),"t0",2);case 2:if(r=e.t0,"object"!==(void 0===r?"undefined":(0,p.default)(r))){e.next=5;break}return e.abrupt("return",r.v);case 5:e.next=10;break;case 7:e.prev=7,e.t1=e.catch(0),y.error("TeAddCustomContact",e.t1.toJSON);case 10:case"end":return e.stop()}},e,void 0,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),k=(t.modifyCustomContact=function(){var e=(0,v.default)(f.default.mark(function e(t){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return y.info("modifyCustomContact modify custom info"),e.abrupt("return",window.CLIENTCONFIG.USE_IM?k(t):I(t));case 2:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,v.default)(f.default.mark(function e(t){var r,n,a,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y.info("modifyCustomContact begin"),r=$getState().contactGroups.lastContactGroupInfo,n=void 0===r?{}:r,a={},e.next=6,g.modifyCustomContactService(t);case 6:if(o=e.sent,o.result!==constant.RESULT.SUCCESS||1!==o.param.result){e.next=15;break}return e.next=10,coreContact.saveContactInfo(t);case 10:return t=e.sent,e.next=13,(0,b.reloadContactListData)();case 13:$dispatch(coreUi.updateSliderContactDetail(t,!0)),!isNullOrEmpty(n)&&n.menuItem&&n.menuItem.contact_id===t.contact_id&&(a=(0,i.default)({},n,{menuItem:t}),$dispatch(coreUi.updateLastInfo(a)));case 15:return e.abrupt("return",{result:o.result});case 18:e.prev=18,e.t0=e.catch(0),y.error("normalModifyCustomContact error",e.t0);case 21:case"end":return e.stop()}},e,void 0,[[0,18]])}));return function(t){return e.apply(this,arguments)}}()),I=function(){var e=(0,v.default)(f.default.mark(function e(t){var r,n,a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y.info("TeModifyCustomContact begin"),r=$getState().contactGroups.lastContactGroupInfo,n=void 0===r?{}:r,a={},e.next=6,coreContact.saveContactInfo(t);case 6:return t=e.sent,e.next=9,(0,b.reloadContactListData)();case 9:return $dispatch(coreUi.updateSliderContactDetail(t,!0)),!isNullOrEmpty(n)&&n.menuItem&&n.menuItem.contact_id===t.contact_id&&(n.menuItem=t,a=(0,i.default)({},n,{menuItem:t}),$dispatch(coreUi.updateLastInfo(a))),e.abrupt("return",{result:0});case 14:e.prev=14,e.t0=e.catch(0),y.error("TeModifyCustomContact",e.t0.toJSON);case 17:case"end":return e.stop()}},e,void 0,[[0,14]])}));return function(t){return e.apply(this,arguments)}}(),S=(t.delCustomContact=function(){var e=(0,v.default)(f.default.mark(function e(t){return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.updataCustomDucks=function(e){$dispatch(coreUi.updateCustomInfo(e))});t.updataEditStatus=function(e){$dispatch(coreUi.changeCustomEditStatus(e))},t.openEditCustomPage=function(e){if(e.contact_id&&(e.isModify=!0),S(e),window.CLIENTCONFIG.ISMOBILE)return window.goRoute("newCustomContact"),void y.info("openEditCustomPage current client is mobile");window.goRoute("main/contactGroups"),(0,C.clickAddCustomContact)("addCustom")},t.mHandleChangeCustomResult=function(e){if(!window.CLIENTCONFIG.ISMOBILE)return void y.info("mHandleChangeCustomResult current client is pc");S({}),window.history.back(),$dispatch(coreUi.updateMobileContactDetail(e,isNullOrEmpty(e.account)))},t.checkEmailInput=function(e){var t=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;return!!isNullOrEmpty(e)||t.test(e)},t.checkIsChange=function(e,t){if("object"!==Object.type(e)||"object"!==Object.type(t))return!1;var r=!1;return(0,u.default)(e).forEach(function(n){t.hasOwnProperty(n)?e[n]!==t[n]&&(r=!0):r=!0}),r},t.searchContactByNum=function(){var e=(0,v.default)(f.default.mark(function e(){var t,r,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,coreDb.queryContactByPhonenumberAccurate(a);case 3:if(r=e.sent,isNullOrEmpty(r)){e.next=10;break}y.info("searchContactByNum find constact in DB success"),t=r[0],r.length>1&&r.forEach(function(e){""===e.account&&(t=e)}),e.next=15;break;case 10:return y.info("searchContactByNum  not find in DB, query contact from server"),e.next=13,coreContact.queryServerContact(a);case 13:n=e.sent,n&&n.param&&(t=n.param);case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}()},1282:function(e,t,r){"use strict";function n(){coreCommon.isIos()&&(u.info("addEventListenerDealKeyBoard 添加键盘变化事件"),window.removeEventListener("keyBoardChange",o),window.addEventListener("keyBoardChange",o))}function a(){coreCommon.isIos()&&(u.info("removeEventListenerDealKeyBoard 去除键盘变化事件"),window.removeEventListener("keyBoardChange",o))}function o(e){try{u.debug("键盘Change");var t=e.data,r=t.kbWidth,n=t.changeHeight,a=t.kbHeight,o=document.querySelector(".mobile-add-custom-others");if(o){if(n-a==0)return u.info("键盘Change 键盘落下"),void(o.style.marginBottom=null);u.info("键盘Change 键盘不落下");o.style.marginBottom=a*window.innerWidth/r-0+"px"}}catch(e){u.error("键盘Change",e.toString())}}Object.defineProperty(t,"__esModule",{value:!0}),t.addEventListenerDealKeyBoard=n,t.removeEventListenerDealKeyBoard=a;var u=window.Logger("logic")("addCustom/dealIosKeyBoardChange")},1283:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.coverUserList=t.queryUsersIncrementFromEaddr=t.queryAllfromList=t.deleteContactFromDB=t.getLocalContactAndGroupInfo=t.teLoadContactAndGroupList=t.normalLoadContactAndGroupList=void 0;var a=r(367),o=n(a),u=r(159),c=n(u),i=r(149),s=n(i),p=r(134),d=n(p),f=r(151),l=n(f),v=r(124),h=n(v),m=r(1),g=n(m),b=r(3),x=n(b),C=r(2),y=n(C),_=(t.normalLoadContactAndGroupList=function(){var e=(0,y.default)(g.default.mark(function e(){var t,r,n,a,o,u,c;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=coreAccount.getLoginModel(),t.useIM){e.next=4;break}return M.info("normalLoadContactAndGroupList","now is te eva"),e.abrupt("return");case 4:return M.info("uc get contactList and groupList from eserver"),e.next=7,L.getContactList();case 7:if(!(r=e.sent)||r.result!==constant.ERROR_CODE.Success){e.next=12;break}return n=r.param,a=n.im_group_list,o=n.im_group_user_info_list,u=n.user_info_list,c=n.time_stamp,e.next=12,x.default.all([D(r.param),coreGroup.calGroupListData(a),j(o,u,c)]);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.teLoadContactAndGroupList=function(){var e=(0,y.default)(g.default.mark(function e(){var t,r;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=coreAccount.getLoginModel(),!t.useIM){e.next=4;break}return M.info("teLoadContactAndGroupList","now is uc eva"),e.abrupt("return");case 4:return M.debug("teLoadContactAndGroupList TE模式 获取联系人和群组"),e.next=7,G();case 7:r=e.sent,_(r&&r.contactUserList);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n,a,o,u,c,i,s;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,M.info("updataTeContactInfo begin!"),!isNullOrEmpty(t)){e.next=5;break}return M.error("updataTeContactInfo contactList is empty!"),e.abrupt("return");case 5:return r=[],n=t.getKeyArr("account"),coreUi.getContactListAvatar(n),a=t.map(function(e){if(""!==e.account)return{username:e.account,etag:""===e.etag?"fffff":e.etag}}),o=[],a.splitByNum(20).forEach(function(e){r.push(coreContact.queryUserListFromEaddr(e))}),e.next=13,x.default.all(r).then(function(e){e.forEach(function(e){0===e.result&&e.entry.forEach(function(e){e.result_code===constant.EADDR_CONTACT_RESULT_CODE.SUCCESS&&o.push(e)})})});case 13:if(!isNullOrEmpty(o)){e.next=16;break}return M.info("updataTeContactInfo contact info already newest!"),e.abrupt("return");case 16:if(u=t.map(function(e){var t=o.query({account:e.account});return isNullOrEmpty(t)?e:(0,h.default)({},e,t)}),coreContact.saveContactInfoList(u),$dispatch(coreUi.updateContactListData({contactUserList:u})),!window.CLIENTCONFIG.ISMOBILE){e.next=26;break}return e.next=22,(0,N.sortMUserList)(u);case 22:c=e.sent,i=c.mList,s=c.enList,$dispatch(coreUi.updateMobileContactList(i,s));case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),M.error("updataTeContactInfo error",e.t0);case 31:case"end":return e.stop()}},e,this,[[0,28]])}));return function(t){return e.apply(this,arguments)}}()),w=function(){var e=(0,y.default)(g.default.mark(function e(t,r){var n,a,o,u,c,i,s,p,d,f;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(M.info("好友列表 begin"),!isNullOrEmpty(t)){e.next=4;break}return M.info("dealContactInfo recordList is empty"),e.abrupt("return",[]);case 4:
//! 操作记录去重
return n=[],a=[],o=F(t),e.next=9,k(o);case 9:if(u=e.sent,c=$(u,r),i=c.getKeyArr("account"),s=i.join(","),i.splitByNum(20).forEach(function(e){coreUi.getContactListAvatar(e)}),isNullOrEmpty(s)){e.next=21;break}return e.next=17,coreDb.queryContactList({all:"",accountlist:s});case 17:return p=e.sent,p.forEach(function(e){n.push(coreDb.deleteContact({id:""+e.id}))}),e.next=21,x.default.all(n);case 21:return e.next=23,B(c);case 23:return d=e.sent,f=q(c,d),f.forEach(function(e){e.state===constant.CONTACT_STATE.ADD&&(e.contact_id=e.id),delete e.id,a.push(e)}),M.info("dealContactInfo success! data length:"+a.length),e.abrupt("return",a);case 28:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),k=function(){var e=(0,y.default)(g.default.mark(function e(){var t,r,n,a,o,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(u)){e.next=3;break}return M.info("dealCustomContact contactList is empty"),e.abrupt("return",[]);case 3:t=[],r=[],n=0;case 6:if(!(n<u.length)){e.next=23;break}if(a=u[n],!isNullOrEmpty(a.account)||a.state!==constant.CONTACT_STATE.ADD){e.next=12;break}t.push(a),e.next=20;break;case 12:if(!isNullOrEmpty(a.account)||a.state!==constant.CONTACT_STATE.DELETE){e.next=19;break}return e.next=15,coreDb.queryContactByContactId(a.id);case 15:o=e.sent,!isNullOrEmpty(o)&&r.push(coreDb.deleteContact({id:o.id})),e.next=20;break;case 19:t.push(a);case 20:n++,e.next=6;break;case 23:return e.next=25,x.default.all(r);case 25:return e.abrupt("return",t);case 26:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n,a,o,u;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:M.info("dealContactGroupInfo"),t=t||[],r=[],n=[],a=0;case 5:if(!(a<t.length)){e.next=23;break}if(o=t[a],o.state!==constant.CONTACT_STATE.ADD){e.next=18;break}if("Group"!==o.name){e.next=13;break}return e.next=11,coreDb.queryAllContactGroupList();case 11:u=e.sent,u.forEach(function(e){"Group"===e.name&&(n.push(coreDb.deleteContactGroup({group_id:e.group_id})),n.push(coreDb.deleteContactMemberGroup({group_id:e.group_id})))});case 13:o.group_id=o.id,delete o.id,r.push(o),e.next=20;break;case 18:n.push(coreDb.deleteContactGroup({group_id:o.id})),n.push(coreDb.deleteContactMemberGroup({group_id:o.id}));case 20:a++,e.next=5;break;case 23:return e.next=25,x.default.all(n);case 25:return r=A(r),e.abrupt("return",r);case 27:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return M.debug("dealContactGroupMemberList"),t=t||[],r=[],n=[],t.forEach(function(e){e.state===constant.CONTACT_STATE.ADD?r.push(e):n.push(coreDb.deleteContactMemberGroup({group_id:e.group_id,contact_id:e.contact_id}))}),e.next=7,x.default.all(n);case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),E=r(466),L=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(E),N=r(994),O=r(1054),T=r(1150),M=window.Logger("logic")("contactGroup/联系人群组增量处理"),G=t.getLocalContactAndGroupInfo=function(){var e=(0,y.default)(g.default.mark(function e(){var t,r,n,a,o,u,c,i,s;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.ENABLE_IT_MEETING){e.next=2;break}return e.abrupt("return");case 2:return M.debug("getLocalContactAndGroupInfo"),e.next=5,x.default.all([coreDb.queryAllContact(),coreDb.queryAllContactGroupList(),coreDb.queryAllContactMemberGroupList()]);case 5:if(t=e.sent,r=(0,l.default)(t,3),n=r[0],a=r[1],o=r[2],u={hasContact:n.length>0,contactUserList:n,contactGroup:a,contactMemberGroup:o},$dispatch(coreUi.updateContactListData(u)),U(n),!window.CLIENTCONFIG.ISMOBILE){e.next=20;break}return e.next=16,(0,N.sortMUserList)(n);case 16:c=e.sent,i=c.mList,s=c.enList,$dispatch(coreUi.updateMobileContactList(i,s));case 20:return P(),e.abrupt("return",u);case 22:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),D=function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n,a,o,u,c,i,s,p;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,M.info("calcContactListData deal contactList"),r=t.contact_list,n=t.user_list,a=t.user_group_list,o=t.user_group_member_list,e.next=5,x.default.all([coreAccount.getLoginModel().isSupportAS?W(r):w(r,n),I(a),S(o)]);case 5:return u=e.sent,c=(0,l.default)(u,3),i=c[0],s=c[1],p=c[2],M.info("整理联系人列表数据","success"),e.next=13,x.default.all([coreContact.saveContactInfoList(i),coreDb.bulkPutContactGroup(s),coreDb.bulkPutContactMemberGroup(p)]);case 13:return e.next=15,G();case 15:return e.abrupt("return",e.sent);case 18:e.prev=18,e.t0=e.catch(0),M.error("calcContactListData",e.t0);case 21:case"end":return e.stop()}},e,void 0,[[0,18]])}));return function(t){return e.apply(this,arguments)}}(),A=function(e){return e=e||[],e.sort(function(e,t){return e.group_id>t.group_id})},U=function(e){M.debug("dealSpecialContacts 筛选特别关注联系人");var t=[];e&&e.length>0&&e.forEach(function(e){e.isSpecial&&t.push(e)}),$dispatch(coreUi.updateSpecialContactListData(t))},P=function(){try{M.debug("loadContactTypeOpen 加载与刷新联系人分组折叠对应表");var e=$getState(),t=e.contactGroups.contactGroup,r=e.contactGroups.contactTypeOpen,n=[].concat((0,d.default)(t)),a=[].concat((0,d.default)(r));if(0===r.length)n.forEach(function(e){a.push({group:e.group_id,open:!1})});else{var o=[],u=[];a.forEach(function(e){u.push(e.group)}),n.forEach(function(e){a.forEach(function(t){e.group_id===t.group?o.push({group:e.group_id,open:t.open}):-1===u.indexOf(e.group_id)&&o.push({group:e.group_id,open:!1})})}),a=[].concat(o)}M.info("loadContactTypeOpen 加载刷新联系人分组折叠表","success"),$dispatch(coreUi.updateContactTypeOpen(a))}catch(e){M.error("loadContactTypeOpen",e)}},R=(t.deleteContactFromDB=function(){var e=(0,y.default)(g.default.mark(function e(t){return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t)){e.next=3;break}return M.debug("deleteContact data null"),e.abrupt("return",{});case 3:if(!t.id){e.next=11;break}return e.next=6,coreDb.deleteContact({id:t.id});case 6:if(""===t.account){e.next=9;break}return e.next=9,coreContact.saveContactInfo(t);case 9:e.next=11;break;case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n,a;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r="",n=[],isNullOrEmpty(t)){e.next=15;break}return r=t.getKeyArr("account").join(","),e.next=7,coreDb.queryContactList({all:"",accountlist:r});case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=[];case 10:return a=e.t0,t.forEach(function(e){for(var t=R(a,{account:e.account}),r=0;r<t.length;r++){var o=t[r];n.push(coreDb.deleteContact({id:""+o.id}))}}),e.next=14,x.default.all(n);case 14:M.info("delDbContactList success");case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(0),M.error("delDbContactList fail",{error:e.t1.toJSON()});case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}))}(),t.queryAllfromList=function(e,t){try{var r=function(){var r=[];for(var n in t)!function(n){e.forEach(function(e){t[n]===e[n]&&r.push(e)})}(n);return{v:r}}();if("object"===(void 0===r?"undefined":(0,s.default)(r)))return r.v}catch(e){return M.error("queryAllfromList fail",e.toString()),[]}}),F=function(e){var t=[];return isNullOrEmpty(e)?(M.info("delContactOperationRecord contactList empty!"),[]):(e.forEach(function(r){if(0===r.staff_id)return r.gender=2,t.push(r),!1;var n=e.queryList({staff_id:r.staff_id});if(!isNullOrEmpty(n))if(1===n.length)t.push(r);else{for(var a=n[0],o=1;o<n.length;o++){var u=n[o];u.id>a.id&&(a=u)}isNullOrEmpty(t.query(a))&&t.push(a)}}),t)},$=function(e,t){try{var r=[];return e.forEach(function(e){""===e.name&&(0,h.default)(e,t.query({staff_id:e.staff_id}),{state:e.state}),r.push(e)}),r}catch(e){return M.error("delCoverEserverList",{error:e.toJSON()}),[]}},B=t.queryUsersIncrementFromEaddr=function(){var e=(0,y.default)(g.default.mark(function e(t,r){var n,a,o,u,c,i,s,p;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=[],a=[],e.next=5,(0,O.preQueryUserListEaddr)(t,r);case 5:o=e.sent,u=o.splitByNum(20),c=0;case 8:if(!(c<u.length)){e.next=17;break}return i=u[c],e.next=12,coreContact.queryUserListFromEaddr(i);case 12:s=e.sent,!isNullOrEmpty(s)&&s.entry&&n.push.apply(n,(0,d.default)(s.entry));case 14:c++,e.next=8;break;case 17:if(p=[],!isNullOrEmpty(n)){e.next=21;break}return M.error("queryUsersIncrementFromEaddr willCoverList is empty"),e.abrupt("return",[]);case 21:return n.forEach(function(e){if(e.result_code===constant.EADDR_CONTACT_RESULT_CODE.NO_CHANGE){var t=r.query({etag:e.etag});isNullOrEmpty(t)||(delete t.id,delete t.contact_id,p.push(t))}else e.result_code===constant.EADDR_CONTACT_RESULT_CODE.SUCCESS&&p.push(e)}),e.abrupt("return",p);case 25:return e.prev=25,e.t0=e.catch(0),M.error("queryUsersIncrementFromEaddr",{error:e.t0.toJSON()}),e.abrupt("return",[]);case 29:case"end":return e.stop()}},e,void 0,[[0,25]])}));return function(t,r){return e.apply(this,arguments)}}(),q=t.coverUserList=function(e,t){if(isNullOrEmpty(e)&&isNullOrEmpty(t))return M.info("coverUserList all empty"),[];if(isNullOrEmpty(e))return M.info("coverUserList eSerList empty"),t;if(isNullOrEmpty(t))return M.info("coverUserList eaddrList empty"),e;var r=[];return e.length<t.length?t.forEach(function(t){var n=e.query({account:t.account}),a=H(n,t);r.push(a)}):e.forEach(function(e){if(isNullOrEmpty(e.account))r.push(e);else{var n=t.query({account:e.account}),a=H(e,n);r.push(a)}}),r},H=function(e,t){if(isNullOrEmpty(e)&&isNullOrEmpty(t))return M.info("coverUserInfo all empty"),{};if(isNullOrEmpty(e))return M.debug("coverUserInfo eserverInfo empty"),t;if(isNullOrEmpty(t))return M.debug("coverUserInfo eaddrInfo empty"),e;if(e.account!==t.account)return M.debug("coverUserInfo two info is not one person!"),{};var r={staff_id:e.staff_id,account:e.account,etag:t.etag,state:e.state,name:t.name,q_pin_yin:e.q_pin_yin,gender:t.gender,mobile:t.mobile,office_phone:t.office_phone,office_phone2:t.office_phone2,other_phone:t.other_phone,fax:t.fax,email:t.email,address:t.address,title:t.title,image_id:t.image_id,signature:e.signature,website:t.website,bind_no:t.bind_no,native_name:t.native_name,home_phone:t.home_phone,other_phone2:t.other_phone2,staff_no:t.staff_no,dept_id:e.dept_id,dept_name_cn:t.dept_name_cn,dept_name_en:t.dept_name_en,desc:e.desc,image_sync_time:e.image_sync_time,ip_phone:e.ip_phone,is_security:e.is_security,old_account:e.old_account,short_phone:t.short_phone,voip:e.voip,modify_time:e.modify_time,espacenumber:t.espacenumber};return void 0!==e.id&&(r.id=e.id),r},j=function(){var e=(0,y.default)(g.default.mark(function e(t,r,n){var a,u,i,s,p;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:M.info("Deal with changed members about increment, count:",t&&t.length),t&&(a=coreCommon.TaskQueue.getInstance("groupMemberQueue"),u=coreCommon.TaskOptions.defaultOptions(),u.interval=0,i=[],s=[],p={},r&&r.map(function(e){p[e.account]=e}),t.map(function(e){if(e.state===constant.GROUP_STATE.DELETE)a.addTask(function(){return coreDb.deleteGroupMember({account:e.account,group_id:e.group_id})},u);else{var t=p[e.account];t.group_id=e.group_id,i.push(t)}s.push(e.group_id)}),i.splitByNum(50).map(function(e){a.addTask(function(){return coreDb.bulkPutGroupMember((0,T.formatContactGroupMemberList)(e))},u)}),s.length&&(s=(0,c.default)(new o.default(s)),M.info("Refresh groups with member changes, count:",s.length),s.map(function(){var e=(0,y.default)(g.default.mark(function e(t){var r;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreDb.queryGroup({group_id:t});case 2:r=e.sent,isNullOrEmpty(r)||(r.sync_member_time=n,coreGroup.saveGroupInfo(r),coreGroup.createGroupMemberChangeEvent(t,r.owner));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}())));case 2:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),W=function(){var e=(0,y.default)(g.default.mark(function e(t){var r,n,a,o,u,c;return g.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t||[],M.info("deal increment contactList at AS, length : ",r.length),n=[],a=[],o=[],r.map(function(e){e.state===constant.CONTACT_STATE.ADD?o.push({id:e.staffAccount||e.name}):a.push(e.staffAccount||e.name)}),!a.length){e.next=12;break}return e.next=9,coreDb.queryContactList({all:"",accountlist:a});case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=[];case 13:return u=e.t0,M.info("deal increment contactList at AS, need to delete count : ",u&&u.length),u&&u.map(function(e){n.push(coreDb.deleteContact({id:e.id}))}),e.next=18,x.default.all(n);case 18:if(M.info("deal increment contactList at AS, need to add count : ",o.length),!o.length){e.next=25;break}return e.next=22,coreContact.syncUserDetails(o);case 22:e.t1=e.sent,e.next=26;break;case 25:e.t1=[];case 26:return c=e.t1,c.map(function(e){for(var t=0;t<r.length;t++)if(e.account===r[t].staffAccount){e.contact_id=r[t].id;break}e.dept_name=e.deptName,e.mobile=e.phone,e.bind_no=e.number,delete e.deptName,delete e.phone,delete e.number}),e.abrupt("return",c);case 29:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},133:function(e,t,r){e.exports=r(0)(49)},134:function(e,t,r){"use strict";t.__esModule=!0;var n=r(159),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,a.default)(e)}},135:function(e,t,r){e.exports={default:r(358),__esModule:!0}},139:function(e,t,r){e.exports=r(0)(155)},141:function(e,t,r){e.exports={default:r(180),__esModule:!0}},145:function(e,t,r){var n=r(10),a=r(8),o=r(147);e.exports=function(e,t){var r=(a.Object||{})[e]||Object[e],u={};u[e]=t(r),n(n.S+n.F*o(function(){r(1)}),"Object",u)}},147:function(e,t,r){e.exports=r(0)(51)},149:function(e,t,r){e.exports=r(0)(72)},151:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=r(400),o=n(a),u=r(141),c=n(u);t.default=function(){function e(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var u,i=(0,c.default)(e);!(n=(u=i.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if((0,o.default)(Object(t)))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},159:function(e,t,r){e.exports={default:r(195),__esModule:!0}},162:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.addDiscussGroupMember=t.addDiscussGroup=t.dealFixedGroupApply=t.setGroupMsgPolicyType=t.transferFixedGroupService=t.transferDiscussionGroupService=t.fixedGroupChangeService=t.bulkAddGroupMember=t.addGroupPhoneMemberService=t.addGroupMemberService=t.bulkDelGroupMemberService=t.searchFixedGroups=t.joinFlagChgService=t.modifyFixedGroupInfoService=t.modifyDisGroupInfoService=t.deleteGroupService=t.exitGroupService=t.setDisgroupPolicy=t.bulkAddGroupMemberService=t.delMembers=t.changeGroupTypeService=t.confirmFixedGroupInvite=t.createDiscussGroup=t.createFixedGroup=t.getFixedGroupMembers=t.applyToJoinFixedGroup=t.getGroupInfo=t.getGroupMemberList=void 0;var a=r(134),o=n(a),u=r(3),c=n(u),i=r(133),s=n(i),p=r(1),d=n(p),f=r(2),l=n(f),v=window.Logger("group")("interface"),h=(t.getGroupMemberList=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,coreIm.checkEServerOnlineNoToast("getGroupMemberList")){e.next=3;break}return e.abrupt("return",{memberList:[],time_stamp:""});case 3:return e.next=5,new coreTup.HWTupIM;case 5:return r=e.sent,e.next=8,r.getfixedgroupmembers({is_sync_all:1,group_id:t||"",time_stamp:""});case 8:if(n=e.sent,n.result===constant.RESULT.SUCCESS){e.next=12;break}return v.error("getGroupMembers get failed,result",n.result),e.abrupt("return",{memberList:[],time_stamp:""});case 12:if(a=[],!n||!n.param||isNullOrEmpty(n.param.member_info)){e.next=19;break}return o=n.param.time_stamp,n.param.member_info.forEach(function(e){e.group_id=t,a.push(e)}),e.abrupt("return",{memberList:a,time_stamp:o});case 19:return v.error("getGroupMembers no result",t),e.abrupt("return",{memberList:[],time_stamp:""});case 21:e.next=27;break;case 23:return e.prev=23,e.t0=e.catch(0),v.error("getGroupMembers",e.t0.toString()),e.abrupt("return",{memberList:[],time_stamp:""});case 27:case"end":return e.stop()}},e,void 0,[[0,23]])}));return function(t){return e.apply(this,arguments)}}(),t.getGroupInfo=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,o,u;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("getGroupInfo ",t),e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.next=7,r.getfixedgroupdetail({group_id:t});case 7:if(n=e.sent,!isNullOrEmpty(n)){e.next=11;break}return v.error("getGroupInfo getfixedgroupdetail failed,return {}"),e.abrupt("return",{});case 11:if(a=n.param,(o=n.result)!==constant.RESULT.SUCCESS){e.next=23;break}if(v.info("getGroupInfo getfixedgroupdetail suc, id = "+a.id),u=(0,s.default)({},a),!a.id){e.next=23;break}return delete u.id,delete u.joint_flag,u.group_id=a.id,u.auto_join_flag=a.joint_flag,e.next=22,coreGroup.saveGroupInfo(u);case 22:return e.abrupt("return",e.sent);case 23:return v.error("getGroupInfo getfixedgroupdetail failed,return {},errorcode:",o),e.abrupt("return",{});case 27:return e.prev=27,e.t0=e.catch(0),v.error("getGroupInfo",e.t0),e.abrupt("return",{});case 31:case"end":return e.stop()}},e,void 0,[[0,27]])}));return function(t){return e.apply(this,arguments)}}(),t.applyToJoinFixedGroup=function(){var e=(0,l.default)(d.default.mark(function e(){var t,r,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("applyToJoinFixedGroup 用户申请加入固定群",a),e.next=4,new coreTup.HWTupIM;case 4:return t=e.sent,r={group_id:a,group_name:o,display_name:u},e.next=8,t.joinfixedgroup(r);case 8:return n=e.sent,e.abrupt("return",n);case 12:e.prev=12,e.t0=e.catch(0),v.error("applyToJoinFixedGroup",{error:e.t0.toJSON()});case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(){return e.apply(this,arguments)}}(),t.getFixedGroupMembers=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new coreTup.HWTupIM;case 3:return r=e.sent,n=isNullOrEmpty(o)?1:0,e.next=7,r.getfixedgroupmembers({is_sync_all:n,group_id:t||"",time_stamp:o});case 7:return a=e.sent,v.debug("getFixedGroupMembers",a),e.abrupt("return",a);case 12:return e.prev=12,e.t0=e.catch(0),v.error("getFixedGroupMembers",e.t0),e.abrupt("return",{});case 16:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),t.createFixedGroup=function(){var e=(0,l.default)(d.default.mark(function e(t){var r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return r=e.sent,e.next=5,r.addfixedgroup(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.createDiscussGroup=function(){var e=(0,l.default)(d.default.mark(function e(t){var r;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return r=e.sent,e.next=5,r.adddiscussiongroup(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.confirmFixedGroupInvite=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a,o,u,c,i,s;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=r.group_id,a=r.group_name,o=r.member_account,u=r.display_name,v.info("confirmFixedGroupInvite 用户同意固定群邀请",t),e.next=5,new coreTup.HWTupIM;case 5:return c=e.sent,i={agree_join:t,group_id:n,group_name:a,member_account:o,display_name:u},e.next=9,c.confirmfixedgroupinvite(i);case 9:return s=e.sent,e.abrupt("return",s);case 13:e.prev=13,e.t0=e.catch(0),v.error("error",e.t0);case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t,r){return e.apply(this,arguments)}}(),t.changeGroupTypeService=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new coreTup.HWTupIM;case 3:return n=e.sent,a={id:t,group_type:r},e.next=7,n.modifyGroupType(a);case 7:return o=e.sent,v.info("固定群和讨论组互相转换"),e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(0),v.error("error",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t,r){return e.apply(this,arguments)}}(),t.delMembers=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a,o,u;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:if(n=e.sent,a=t.group_type,o=t.group_id,u=void 0,0!==a){e.next=9;break}return e.next=8,n.delfixedgroupmember({group_id:o,account:r});case 8:u=e.sent;case 9:if(1!==a){e.next=13;break}return e.next=12,n.deldiscussiongroupmember({group_id:o,account:r});case 12:u=e.sent;case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.bulkAddGroupMemberService=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a,o,u,c,i,s;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(v.info("bulkAddGroupMemberService begin~"),!isNullOrEmpty(t)){e.next=4;break}return v.info("bulkAddGroupMemberService list is empty!"),e.abrupt("return");case 4:return e.next=6,new coreTup.HWTupIM;case 6:if(n=e.sent,a=r.group_type,o=r.group_id,u=r.name,c=void 0,i=void 0,s=void 0,c=t.getKeyArr("account").join(";"),i={group_id:o,account:c,group_name:u,display_name:u},0!==a){e.next=17;break}return e.next=14,n.addfixedgroupmember(i);case 14:s=e.sent,e.next=21;break;case 17:if(1!==a){e.next=21;break}return e.next=20,n.adddiscussiongroupmember(i);case 20:s=e.sent;case 21:if(null!==s){e.next=24;break}return v.info("批量加人请求超时"),e.abrupt("return",[]);case 24:return s.result!==constant.RESULT.SUCCESS&&(v.info("添加失败"),coreGroup.groupService.clearMarkDeleteGroupNotify()),v.info("批量添加群组成员"),e.abrupt("return",[]);case 27:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.setDisgroupPolicy=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return n=e.sent,e.next=5,n.setDisgroupPolicy({group_id:t,policy:r});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.exitGroupService=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:if(n=e.sent,a=void 0,0!==r){e.next=10;break}return e.next=7,n.leavefixedgroup({arg:t});case 7:a=e.sent,e.next=13;break;case 10:return e.next=12,n.leaveDiscussionGroup({group_id:t});case 12:a=e.sent;case 13:return 0===a.result?coreGroup.groupService.setMarkExitGroupNotify(t,!0):coreGroup.groupService.clearMarkExitGroupNotify(),e.abrupt("return",0===a.result);case 15:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.deleteGroupService=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:if(n=e.sent,a=void 0,0!==r){e.next=10;break}return e.next=7,n.delfixedgroup(t);case 7:a=e.sent,e.next=13;break;case 10:return e.next=12,n.deldiscussiongroup(t);case 12:a=e.sent;case 13:return e.abrupt("return",0===a.result);case 14:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.modifyDisGroupInfoService=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||0!==t.group_type){e.next=2;break}return e.abrupt("return",h(t));case 2:return e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.next=7,r.moddiscussiongroup(t);case 7:return n=e.sent,e.abrupt("return",0===n.result);case 9:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.modifyFixedGroupInfoService=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return r=e.sent,e.next=5,r.modfixedgroup(t);case 5:return n=e.sent,e.abrupt("return",0===n.result);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}());t.joinFlagChgService=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return n=e.sent,e.next=5,n.modfixedgroup({id:t.group_id,name:t.name,capacity:t.capacity,manifesto:t.manifesto,desc:t.desc,owner:t.owner,auto_join_flag:r,msg_policy_type:t.msg_policy_type,group_type:t.group_type,fix_discuss:t.fix_discuss,state:t.state});case 5:return a=e.sent,o=0===a.result,e.abrupt("return",o);case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.searchFixedGroups=function(){var e=(0,l.default)(d.default.mark(function e(){var t,r,n,a,o,u,c,i,s,p,f,l,h,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("searchFixedGroups 查询固定群"),t=m.is_need_amount,r=void 0===t?1:t,n=m.offset,a=void 0===n?0:n,o=m.count,u=void 0===o?20:o,c=m.query_key,i=void 0===c?"":c,s=m.query_type,p=void 0===s?2:s,e.next=5,new coreTup.HWTupIM;case 5:return f=e.sent,l={is_need_amount:r,offset:a,count:u,query_key:i,query_type:p},e.next=9,f.getfixedgroups(l);case 9:return h=e.sent,e.abrupt("return",h);case 13:e.prev=13,e.t0=e.catch(0),v.error("searchFixedGroups",{error:e.t0.toJSON()});case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(){return e.apply(this,arguments)}}(),t.bulkDelGroupMemberService=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a,o,u,i,s;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return n=e.sent,a=r.group_type,o=r.group_id,u=r.name,i=[],e.next=7,t.forEach(function(e){var t={group_id:o,account:e.account,group_name:u,display_name:u},r=void 0;r=0===a?n.delfixedgroupmember(t):n.deldiscussiongroupmember(t),i.push(r)});case 7:return e.next=9,c.default.all(i);case 9:s=e.sent,s.forEach(function(e){e.result===constant.ERROR_CODE.Success?v.info("删除成功"):v.info("删除失败")}),v.info("info");case 12:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.addGroupMemberService=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,o,u,c,i;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.groupType,n=t.groupId,a=t.account,o=t.groupName,u=t.displayName,c={group_id:n,account:a,group_name:o,display_name:u},e.next=5,new coreTup.HWTupIM;case 5:if(i=e.sent,0!==r){e.next=11;break}return v.info("addGroupMemberService","addfixedgroupmember"),e.next=10,i.addfixedgroupmember(c);case 10:return e.abrupt("return",e.sent);case 11:return v.info("addGroupMemberService","adddiscussiongroupmember"),e.next=14,i.adddiscussiongroupmember(c);case 14:return e.abrupt("return",e.sent);case 17:e.prev=17,e.t0=e.catch(0),v.error("error",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t){return e.apply(this,arguments)}}(),t.addGroupPhoneMemberService=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,u;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.groupId,n=t.phoneList,a={group_id:r,phone_list:[].concat((0,o.default)(n))},v.info("add phone to group"),e.next=6,new coreTup.HWTupIM;case 6:return u=e.sent,e.next=9,u.adddiscussiongroupphonemember(a);case 9:return e.abrupt("return",e.sent);case 12:e.prev=12,e.t0=e.catch(0),v.error("error",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),t.bulkAddGroupMember=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a,o,u,c,i,s;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:n=e.sent,a=r.group_type,o=r.group_id,u=r.name,c=r.displayName,i=void 0,s=[],1===t.length?i={group_id:o,account:t[0].account,group_name:u,display_name:u}:t.length>1&&(t.forEach(function(e){s.push(e.account)}),s=s.join(";"),i={group_id:o,accounts:s,group_name:u,display_name:u}),0===a&&n.addfixedgroupmember(i),1===a&&n.adddiscussiongroupmember(i),v.info("info","批量添加群组成员success:");case 9:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.fixedGroupChangeService=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,1===t.group_type?r=0:0===t.group_type&&(r=1),e.next=4,new coreTup.HWTupIM;case 4:return n=e.sent,e.next=7,n.modfixedgroup({id:t.group_id,name:t.name,capacity:t.capacity,manifesto:t.manifesto,desc:t.desc,owner:t.owner,auto_join_flag:t.auto_join_flag,msg_policy_type:t.msg_policy_type,group_type:1,fix_discuss:t.fix_discuss,state:t.state});case 7:return a=e.sent,o=0===a.result,e.abrupt("return",o);case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.transferDiscussionGroupService=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("transferDiscussionGroupService "),e.next=4,new coreTup.HWTupIM;case 4:return n=e.sent,e.next=7,n.transferdiscussiongroup({group_id:t,account:r});case 7:return a=e.sent,o=0===a.result,e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(0),v.error(e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t,r){return e.apply(this,arguments)}}(),t.transferFixedGroupService=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("transferFixedGroupService "),e.next=4,new coreTup.HWTupIM;case 4:return n=e.sent,e.next=7,n.transferfixedgroup({group_id:t,account:r});case 7:return a=e.sent,a&&a.result===constant.ERROR_IM_GROUP_CODE.RESULT_IMGROUP_MAXNUM&&(v.info("transferFixedGroupService 对方拥有的固定群超上限"),window.CLIENTCONFIG.ISMOBILE||window.alert(language.TRANSFER_FIXEDGROUP_FAIL_MAXUM)),o=0===a.result,e.abrupt("return",o);case 13:e.prev=13,e.t0=e.catch(0),v.error("transferFixedGroupService error",e.t0.toJSON());case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t,r){return e.apply(this,arguments)}}(),t.setGroupMsgPolicyType=function(){var e=(0,l.default)(d.default.mark(function e(t,r){var n,a,o,u,c;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("setGroupMsgPolicyType"),e.next=4,new coreTup.HWTupIM;case 4:return n=e.sent,e.next=7,n.setgroupmsgpolicy({group_id:t,msg_policy_type:r});case 7:if(a=e.sent,1!==a.param.ack_result||0!==a.result){e.next=21;break}return e.next=11,coreDb.queryGroup({group_id:t});case 11:return o=e.sent,o.msg_policy_type=r,e.next=15,coreGroup.reloadGroupInfoNew(o);case 15:return e.next=17,coreGroup.saveGroupInfo(o);case 17:return e.next=19,coreIm.getLocalRecent({owner:t});case 19:u=e.sent,isNullOrEmpty(u)||(u.group=o,u.chat_type=coreIm.getChatTypeByGroup(o),coreDb.saveRecent(u),coreIm.updateRecent(u));case 21:return c=0===a.result,e.abrupt("return",c);case 25:e.prev=25,e.t0=e.catch(0),v.error("setGroupMsgPolicyType error",e.t0.toJSON());case 28:case"end":return e.stop()}},e,void 0,[[0,25]])}));return function(t,r){return e.apply(this,arguments)}}(),t.dealFixedGroupApply=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("dealFixedGroupApply"),e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.next=7,r.confirmfixedgroupapply(t);case 7:return n=e.sent,e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),v.error("dealFixedGroupApply",e.t0.toString());case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(t){return e.apply(this,arguments)}}(),t.addDiscussGroup=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("addDiscussGroup"),e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.next=7,r.adddiscussiongroup(t);case 7:return n=e.sent,e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),v.error("addDiscussGroup",e.t0.toString());case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(t){return e.apply(this,arguments)}}(),t.addDiscussGroupMember=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.info("addDiscussGroupMember"),e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.next=7,r.adddiscussiongroupmember(t);case 7:return n=e.sent,e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),v.error("addDiscussGroupMember",e.t0.toString());case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(t){return e.apply(this,arguments)}}()},164:function(e,t,r){var n=r(15);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},165:function(e,t,r){r(166),e.exports=r(8).Object.getPrototypeOf},166:function(e,t,r){var n=r(139),a=r(167);r(145)("getPrototypeOf",function(){return function(e){return a(n(e))}})},167:function(e,t,r){e.exports=r(0)(377)},1763:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.setSign=t.uploadAvatar=t.loginToItMcloud=void 0;var a=r(124),o=n(a),u=r(65),c=n(u),i=r(149),s=n(i),p=r(1),d=n(p),f=r(2),l=n(f),v=t.loginToItMcloud=function(){var e=(0,l.default)(d.default.mark(function e(){var t,r,n,a,o,u;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("loginToItMcloud"),m=coreAccount.getLoginModel(),t=m,r=t.itOAuthUrl,n=t.account,e.next=5,coreSecurity.PasswordManager.getPassword("password");case 5:return a=e.sent,o="loginName="+n+"&password="+a+"&publicKeyFlag=4",e.next=9,b(r,o,{"Content-Type":"application/x-www-form-urlencoded"});case 9:if(u=e.sent,0!==u.result||!u.data){e.next=13;break}return h.info("loginToItMcloud successfully"),e.abrupt("return",{result:0,data:u.data.crypt_token});case 13:return h.info("loginToItMcloud error"),e.abrupt("return",{result:1});case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),h=(t.uploadAvatar=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,o,u=t.imageStr,c=t.fileName;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("itEab uploadAvatar"),e.next=3,v();case 3:if(r=e.sent,n=r.data){e.next=7;break}return e.abrupt("return",{result:1});case 7:return a=x(n),e.next=10,b(m.itUploadHeadImgUrl,{imageStr:u,fileName:c},a);case 10:return o=e.sent,h.info("itEab uploadAvatar result: ",o.result),e.abrupt("return",{result:0===o.result&&o.data.flag?0:1});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.setSign=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h.info("itEab setSign"),e.next=3,v();case 3:if(r=e.sent,n=r.data){e.next=7;break}return e.abrupt("return",{result:1});case 7:return a=x(n),e.next=10,b(m.itSignedUrl,{signed:t,action:"sign"},a);case 10:return o=e.sent,h.info("itEab setSign result: ",o.result),e.abrupt("return",{result:0===o.result&&o.data.flag?0:1});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),window.Logger("logic")("itEab")),m=null,g=function(){var e=(0,l.default)(d.default.mark(function e(t){var r,n,a,o,u,c,i,s,p,f,l,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m||(m=coreAccount.getLoginModel()),e.next=3,new coreHttp.hwTupHttpTransSdk;case 3:return r=e.sent,n=m,a=n.proxyAddress,o=n.proxyPort,u=n.proxyAccount,c=n.isSupportProxy,e.next=7,coreSecurity.PasswordManager.getPassword("proxyPassword");case 7:return i=e.sent,s=coreAccount.getLoginModel(),p=s.isSupportCACertCheck,c||(a="",o=0,u="",i=""),f={url:t,type:v.type,header:v.headers||"",body:v.body||"",proxyInfo:{proxyAddress:a,proxyPort:o,proxyAccount:u,proxyPassword:i},tlsParam:{caCertPath:window.EXEC_PATH,tlsMode:p?1:0},cipherlist:[50331695,50331701,50331708,50331709]},e.next=13,r.sendSyncRequest(f);case 13:if(l=e.sent,200!==l.param.resp_code){e.next=16;break}return e.abrupt("return",{result:0,data:JSON.parse(l.param.recv_body)});case 16:return e.abrupt("return",l);case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,l.default)(d.default.mark(function e(t,r,n){var a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t,{type:constant.REQUEST_TYPE.POST,headers:n,body:"object"===(void 0===r?"undefined":(0,s.default)(r))?(0,c.default)(r):r});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),x=function(e){return(0,o.default)({"Content-Type":"application/json"},{Cookie:"token="+e})}},1764:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.createGroupInfoChangeEvent=t.saveContactInfo=t.saveContactInfoList=void 0;var a=r(1),o=n(a),u=r(2),c=n(u),i=window.Logger("group")("detail"),s=(t.saveContactInfoList=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("saveContactInfoList "),e.next=4,coreDb.bulkPutContact(t);case 4:s(t.map(function(e){return e.account})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),i.error("saveContactInfoList ",e.t0.toString());case 10:case"end":return e.stop()}},e,void 0,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),t.saveContactInfo=function(){var e=(0,c.default)(o.default.mark(function e(t){var r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("saveContactInfo "),e.next=4,coreDb.saveContact(t);case 4:return r=e.sent,s([t.account]),e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(0),i.error("saveContactInfo ",e.t0.toString());case 12:case"end":return e.stop()}},e,void 0,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),t.createGroupInfoChangeEvent=function(e){var t=new Event("contactInfoChange");t.data={accountList:e},window.dispatchEvent(t)})},1765:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getDepartmentTree=t.updateDepartmentTree=t.updateDepartmentUserList=t.initDepartmentTree=t.getMoreDirectorySearchResult=t.getDirectorySearchResult=t.setDirectorySearchValue=t.getDirectoryMenuKeyScroll=t.loadMoreServerContact=t.loadServerContact=void 0;var a=r(124),o=n(a),u=r(1),c=n(u),i=r(65),s=n(i),p=r(134),d=n(p),f=r(2),l=n(f),v=r(959),h=window.Logger("contactGroup")("corporateDirectory"),m=(t.loadServerContact=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,a,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING){e.next=3;break}return h.info("[IT-Meeting] no need to loadServerContact"),e.abrupt("return");case 3:return e.prev=3,h.debug("初始加载企业通讯录"),$dispatch(coreUi.toggleDirectoryInitLoading(!0)),e.next=8,coreContact.searchServerContact(t);case 8:return r=e.sent,n=r.userInformationList,a=r.recordAmount,isNullOrEmpty(n)||$dispatch(coreUi.getRecordInformation(a,n)),window.CLIENTCONFIG.ISMOBILE||isNullOrEmpty(n)||(0,v.detectContactStatus)([].concat((0,d.default)(n)).map(function(e){return{account:e.account}})),o=[],isNullOrEmpty(n)||(o=n.map(function(e){var t=e.account;return handlePhoneNumber(t.substring(0,t.length-4))})),$dispatch(coreUi.toggleDirectoryInitLoading(!1)),h.info("首次加载企业通讯录",o),e.abrupt("return",n);case 19:e.prev=19,e.t0=e.catch(3),h.error("首次加载企业通讯录",{error:(0,s.default)(e.t0)});case 22:case"end":return e.stop()}},e,void 0,[[3,19]])}));return function(t){return e.apply(this,arguments)}}(),t.loadMoreServerContact=function(){var e=(0,l.default)(c.default.mark(function e(t){var r,n,a,o,u,i,s,p,f,l;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=$getState(),n=r.contactGroups.isRecordInformationLoading,a=r.contactGroups.userInformationList,o=r.contactGroups.recordAmount,h.info("loadMoreServerContact",n),a.length!==o){e.next=8;break}return e.abrupt("return");case 8:if(!n){e.next=11;break}return h.info("loadMoreServerContact 正在加载更多用户消息"),e.abrupt("return");case 11:return $dispatch(coreUi.setRecordInformationLoading()),u=$getState().contactGroups.userInformationList.length,e.next=15,coreContact.searchServerContact(t,u);case 15:return i=e.sent,s=i.userInformationList,p=i.recordAmount,isNullOrEmpty(s)||u<p&&$dispatch(coreUi.addRecordInformation(s)),window.CLIENTCONFIG.ISMOBILE||isNullOrEmpty(s)||(0,v.detectContactStatus)([].concat((0,d.default)(s)).map(function(e){return{account:e.account}})),$dispatch(coreUi.setRecordInformationNotLoading()),f=[],isNullOrEmpty(s)||(f=s.map(function(e){var t=e.account;return handlePhoneNumber(t.substring(0,t.length-4))})),h.info("加载更多企业通讯录",f),l=void 0,isNullOrEmpty(s)||(l=a.concat(s)),e.abrupt("return",l);case 28:e.prev=28,e.t0=e.catch(0),h.error("loadMoreServerContact 加载更多企业通讯录",{error:e.t0.toJSON()});case 31:case"end":return e.stop()}},e,void 0,[[0,28]])}));return function(t){return e.apply(this,arguments)}}(),t.getDirectoryMenuKeyScroll=function(){var e=(0,l.default)(c.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.getDirectoryMenuKeyScroll(t));case 1:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.setDirectorySearchValue=function(e,t){$dispatch(coreUi.setDirectorySearchValue(e,t))},t.getDirectorySearchResult=function(e,t){window.isOffline&&window.CLIENTCONFIG.ISMOBILE&&window.Toast(language.THE_NETWORK_IS_ABNORMAL,1,!1),$dispatch(coreUi.getDirectorySearchResult(e,t))},t.getMoreDirectorySearchResult=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,a,o,u,i,s,p,d;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,h.info("加载更多搜索企业通讯录结果"),window.isOffline&&window.CLIENTCONFIG.ISMOBILE&&window.Toast(language.THE_NETWORK_IS_ABNORMAL,1,!1),t=$getState(),r=t.contactGroups,n=r.directorySearchList,a=r.directorySearchValue,o=r.searchRecordAmount,u=[],i=o,!n){e.next=15;break}return s=n.length,e.next=11,coreContact.searchServerContact(a,s);case 11:p=e.sent,d=p.userInformationList||[],i=p.recordAmount,u=n.concat(d);case 15:$dispatch(coreUi.getDirectorySearchResult(u,i)),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),h.error("getMoreDirectorySearchResult 加载更多搜索企业通讯录结果",{error:e.t0.toJSON()});case 21:case"end":return e.stop()}},e,void 0,[[0,18]])}));return function(){return e.apply(this,arguments)}}(),function(){$dispatch(coreUi.updateFlatDepartmentTree("{}")),$dispatch(coreUi.updateDepartmentRoot("")),$dispatch(coreUi.updateMyDepartmentCode("")),$dispatch(coreUi.updateDepartmentInShow(""))}),g=function(e,t){e.hasOwnProperty("childDepts")&&delete e.childDepts;var r=e.deptCode||"";if(!r)return void h.info("invalid deptCode.");t[r]||(t[r]={}),(0,o.default)(t[r],e)},b=function e(t,r){if(t.isSelfNode){if(!t.hasOwnProperty("deptCode"))return void h.info("invalid deptcode.");$dispatch(coreUi.updateMyDepartmentCode(t.deptCode)),$dispatch(coreUi.updateDepartmentInShow(t.deptCode))}if(t.isLeafNode)return g(t,r);if(!t.hasOwnProperty("childDepts"))return g(t,r);var n=t.childDepts||[];delete t.childDepts,t.isLeafNode=!1,t.subDepts=[],n.forEach(function(e){e.hasOwnProperty("deptCode")&&t.subDepts.push(e.deptCode)}),g(t,r),n.forEach(function(t){e(t,r)})},x=t.initDepartmentTree=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("begin init department tree."),!(t=$getState().contactGroups.departmentRoot)){e.next=5;break}return h.info("Department Tree Already init."),e.abrupt("return");case 5:return h.info("init Department Tree"),m(),e.next=9,coreContact.getDeptTree();case 9:if((r=e.sent)&&r.hasOwnProperty("deptCode")){e.next=13;break}return h.info("failed to fetch Department Tree."),e.abrupt("return");case 13:if($dispatch(coreUi.updateDepartmentRoot(r.deptCode)),n={},b(r,n),$dispatch(coreUi.updateFlatDepartmentTree((0,s.default)(n))),a=$getState().contactGroups.myDepartmentCode){e.next=23;break}return h.info("failed to get my department."),e.abrupt("return");case 23:return e.next=25,y(a);case 25:return e.next=27,C(a);case 27:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),C=t.updateDepartmentUserList=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,a,o,u,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h.info("begin update user list in department."),t={},e.prev=2,t=JSON.parse($getState().contactGroups.flatDepartmentUsers),e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(2),h.error("invalid department : "+e.t0),e.abrupt("return");case 10:if(r={},""===i?i=$getState().contactGroups.departmentInShow:r[i]=t[i]||{},r){e.next=15;break}return h.error("invalid department Code."),e.abrupt("return");case 15:if(r.hasOwnProperty(i)||(r[i]={}),n=r[i],(a=n.hasOwnProperty("data")?n.data.length:0)!==n.totalCount){e.next=21;break}return h.info("No Need to fetch User List."),e.abrupt("return");case 21:return $dispatch(coreUi.setRecordInformationLoading()),e.next=24,coreContact.getDeptUserList(i,a,!coreCommon.isMobile());case 24:if(o=e.sent){e.next=29;break}return h.info("failed to get user list in department."),$dispatch(coreUi.setRecordInformationNotLoading()),e.abrupt("return");case 29:n.pageIndex=o.pageIndex,n.totalCount=o.totalCount,n.pageSize=o.pageSize,n.hasOwnProperty("data")?(u={},n.data=n.data.concat(o.data),n.data=n.data.filter(function(e){var t=e.account;if(t){if(u.hasOwnProperty(t))return!1;u[t]=!0}return!0})):n.data=o.data,$dispatch(coreUi.updateFlatDepartmentUsers((0,s.default)(r))),$dispatch(coreUi.setRecordInformationNotLoading());case 35:case"end":return e.stop()}},e,void 0,[[2,6]])}));return function(){return e.apply(this,arguments)}}(),y=t.updateDepartmentTree=function(){var e=(0,l.default)(c.default.mark(function e(){var t,r,n,a,o,u,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h.info("begin update department tree."),""!==i){e.next=3;break}return e.abrupt("return",x());case 3:t=void 0,e.prev=4,t=JSON.parse($getState().contactGroups.flatDepartmentTree),e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(4),h.error("invalid department tree: "+e.t0),e.abrupt("return");case 12:if(r=t[i]||null){e.next=16;break}return h.info("failed to get the specified department info."),e.abrupt("return");case 16:return e.next=18,coreContact.getDeptList(i);case 18:if(n=e.sent){e.next=22;break}return h.info("failed to get sub department list."),e.abrupt("return");case 22:if(n.deptCode===i){e.next=25;break}return h.info("the deptCode for new Department mismatch."),e.abrupt("return");case 25:a=n.childDepts||[],o=[],a.forEach(function(e){e.hasOwnProperty("deptCode")&&""!==e.deptCode&&o.push(e.deptCode)}),u=r.subDepts||[],u.forEach(function(e){-1===o.indexOf(e)&&t.hasOwnProperty(e)&&delete t[e]}),n.subDepts=o,0===n.subDepts.length&&(n.isLeafNode=!0,delete n.subDepts),a.forEach(function(e){e.hasOwnProperty("deptCode")&&""!==e.deptCode&&g(e,t)}),n.hasOwnProperty("childDepts")&&n.childDepts.length>0&&(n.isLeafNode=!1,delete n.childDepts),g(n,t),$dispatch(coreUi.updateFlatDepartmentTree((0,s.default)(t)));case 36:case"end":return e.stop()}},e,void 0,[[4,8]])}));return function(){return e.apply(this,arguments)}}();t.getDepartmentTree=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=void 0;try{r=JSON.parse($getState().contactGroups.flatDepartmentTree)}catch(e){return void h.error("invalid department tree: "+e)}var n=""===t?$getState().contactGroups.departmentRoot:t,a=r[n];if(!n||!a)return h.info("failed to generate department tree."),{};var o={};if(o.deptCode=a.deptCode,o.deptName=a.deptName,o.isLeafNode=a.isLeafNode||!1,o.isSelfNode=a.isSelfNode||!1,o.childDepts=[],a.hasOwnProperty("subDepts")){a.subDepts.forEach(function(t){if(""!==t){var r=e(t);r&&o.childDepts.push(r)}})}return o.childDepts.length<1&&delete o.childDepts,o}},1766:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.setDirectoryMenu=t.togglePageList=void 0;var a=r(1),o=n(a),u=r(2),c=n(u);t.togglePageList=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.updateMobileListContent(t));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.setDirectoryMenu=function(e){$dispatch(coreUi.setDirectoryMenu(e))}},1767:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.setPhoneAddrPageSearching=t.saveInitPhoneContactList=t.setPhoneAddrPageLoadIndex=t.setPhoneAddrPageLoading=t.searchPhoneContact=t.getPhoneContacts=void 0;var a=r(124),o=n(a),u=r(134),c=n(u),i=r(1),s=n(i),p=r(3),d=n(p),f=r(2),l=n(f),v=window.Logger("logic")("phoneContacts"),h=(t.getPhoneContacts=function(){var e=(0,l.default)(s.default.mark(function e(){var t,r,n,a,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(v.info("user click phone address menu,try to access the phone's contacts"),v.info("begin get mobile contacts, bSelect: "+o),t=$getState(),r=t.contactGroups.isPhoneAddrLoading,!r){e.next=6;break}return v.warn("already loading"),e.abrupt("return");case 6:if(!o){e.next=11;break}if(n=$getState(),a=n.common.phoneAddr_ContactList,isNullOrEmpty(a)){e.next=11;break}return v.info("select phone address page, already has contact"),e.abrupt("return");case 11:return g(!0),e.abrupt("return",new d.default(function(e,t){var r=new ContactFindOptions;r.filter=u,r.multiple=!0,r.desiredFields=[navigator.contacts.fieldType.displayName,navigator.contacts.fieldType.phoneNumbers],r.hasPhoneNumber=!0;var n=["displayName","firstName","lastName","familyName","middleName","givenName","name","nickname","phoneNumbers"];navigator.contacts.find(n,function(t){v.info("get mobile contacts success");var r=m(t,o),n=r.mList,a=r.enList,u=window.getRoute();if("phoneAddrListPage"!==u&&"directorySearch"!==u&&"callMain"!==u&&"mConfMemberPage"!==u&&"selectPhoneContact"!==u&&!o)return v.warn("already return from phone contact page"),$dispatch(coreUi.setPhoneAddrLoading(!1)),void b(n,a);o?($dispatch(coreUi.togglePhoneAddrContactList(n)),b(n,a),e()):$dispatch(coreUi.updatePhoneContactList(n,a)),$dispatch(coreUi.setPhoneAddrLoading(!1))},function(e){v.info("get mobile contacts failed, ",e),$dispatch(coreUi.setPhoneAddrLoading(!1)),t(e)},r)}));case 13:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.searchPhoneContact=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return v.info("begin search mobile contacts, "+t),t&&isNullOrEmpty(e)?($dispatch(coreUi.togglePhoneAddrSearchList([])),{}):(g(!0),new d.default(function(r,n){var a=new ContactFindOptions;a.filter=e,a.multiple=!0,a.desiredFields=[navigator.contacts.fieldType.displayName,navigator.contacts.fieldType.phoneNumbers],a.hasPhoneNumber=!0;var o=["displayName","firstName","lastName","familyName","middleName","givenName","name","nickname","phoneNumbers"];navigator.contacts.find(o,function(n){v.info("search mobile contacts success"),g(!1);var a=h(n,e,t),o=a,u=a.length;return r({recordAmount:u,userInformationList:o})},function(e){g(!1),v.info("search mobile contacts failed, ",e),r({})},a)}))},function(e,t,r){v.info("parseSearchContacts: "+e.length);for(var n=e.sort(function(){return function(e,t){var r=window.pinyinUtil.getPinyin(e.displayName),n=window.pinyinUtil.getPinyin(t.displayName);return r.localeCompare(n)}}()),a=[],u=0;u<n.length;u++)if(n[u].phoneNumbers){var i={displayName:n[u].displayName,phoneNumbers:[].concat((0,c.default)(n[u].phoneNumbers)),id:n[u].id};if(r){var s=x(i);(0,o.default)(i,{isSelected:!1,isExpanded:!1,numberInfo:s}),a.push({type:"charItem",item:i,itemKey:i.id})}else a.push({type:"charItem",item:i,itemKey:i.id})}return a}),m=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];v.info("parseContacts: "+e.length);for(var r=e.sort(function(){return function(e,t){var r=window.pinyinUtil.getPinyin(e.displayName),n=window.pinyinUtil.getPinyin(t.displayName);return r.localeCompare(n)}}()),n=[],a=[],u=[],i=1,s=!1,p=0;p<r.length;p++)if(r[p].phoneNumbers&&0!==r[p].phoneNumbers.length){var d={displayName:r[p].displayName,phoneNumbers:[].concat((0,c.default)(r[p].phoneNumbers)),id:r[p].id,pinyin:r[p].displayName?window.pinyinUtil.getPinyin(r[p].displayName):""};if(t){var f=x(d);(0,o.default)(d,{isSelected:!1,isExpanded:!1,numberInfo:f})}var l=!0,h="",m="";d.displayName?(h=window.pinyinUtil.getPinyin(d.displayName.trim()).toLowerCase(),m=h.charAt(0)):l=!1;var g=/^[a-z]$/;l&&""!==m&&isNaN(parseInt(m))&&g.test(m)?(n.includes(m)||(n.push(m),a.push({type:"charTitle",char:m,char_index:i++})),a.push({type:"charItem",item:d,itemKey:d.id})):(s=!0,u.push({type:"charItem",item:d,itemKey:d.id}))}var b=[];return s&&(n.push("#"),b=u.sort(function(){return function(e,t){var r=e.item.displayName,n=t.item.displayName;return r&&n?r.localeCompare(n):!r&&n?(r=e.item.phoneNumbers[0].value,r?r.localeCompare(n):0):r&&!n?(n=t.item.phoneNumbers[0].value,n?r.localeCompare(n):0):r||n?0:(r=e.item.phoneNumbers[0].value,n=t.item.phoneNumbers[0].value,r&&n?r.localeCompare(n):0)}}()),b.unshift({type:"charTitle",char:"#",char_index:27})),a.push.apply(a,(0,c.default)(b)),{mList:a,enList:n}},g=t.setPhoneAddrPageLoading=function(e){$dispatch(coreUi.setPhoneAddrLoading(e))},b=(t.setPhoneAddrPageLoadIndex=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;$dispatch(coreUi.setPhoneAddrLoadIndex(e))},t.saveInitPhoneContactList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[],n=[];if(isNullOrEmpty(e)||isNullOrEmpty(t)){var a=$getState().contactGroups,o=a.mPhoneContactList,u=a.mEnPhoneList;r=o,n=u}else r=e,n=t;$dispatch(coreUi.updatePhoneContactList(r,n))}),x=(t.setPhoneAddrPageSearching=function(e){$dispatch(coreUi.setPhoneAddrSearching(e))},function(e){for(var t={},r=0,n=0,a=0,u=0,c=0;c<e.phoneNumbers.length;c++){var i=e.phoneNumbers[c],s="";"mobile"===i.type||"移动"===i.type?(s="mobile"+(r?r.toString():""),r++):"home"===i.type?(s="home_phone"+(n?n.toString():""),n++):"work"===i.type?(s="office_phone"+(a?a.toString():""),a++):(s="other_phone"+(u?u.toString():""),u++);var p={};p[s]={number:i.value,isSelected:!1},(0,o.default)(t,p)}return t})},1768:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});window.Logger("service")("service/util/contactUtils"),t.getCallNumList=function(e){if(!e)return[];var t=[];return Object.forEach(constant.USER_INFO.CALL_INFO,function(r,n){isNullOrEmpty(e[r])||!isNullOrEmpty(e.bind_no)&&"espacenumber"===r||!isNullOrEmpty(e.short_phone)&&"office_phone2"===r||t.push({key:n,num:e[r]})}),t},t.getVideoNumList=function(e){if(!e)return[];var t=[];return Object.forEach(constant.USER_INFO.VIDEO_INFO,function(r,n){isNullOrEmpty(e[r])||!isNullOrEmpty(e.bind_no)&&"espacenumber"===r||!isNullOrEmpty(e.short_phone)&&"office_phone2"===r||t.push({key:n,num:e[r]})}),t}},1769:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.callClickFunc=t.videoClickFunc=t.playDialAudio=t.clickFunc=void 0;var a=r(1),o=n(a),u=r(133),c=n(u),i=r(2),s=n(i);window.Logger("contact")("recentcall"),t.clickFunc=function(){var e=(0,s.default)(o.default.mark(function e(t,r,n,a,u,i){var s,p,d,f,l,v;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.peeraccount,p=t.calleenumber,d=coreConf.showOrDisabledBtn()){e.next=4;break}return e.abrupt("return");case 4:if(!n||a||!i){e.next=6;break}return e.abrupt("return");case 6:return f=void 0,l=void 0,e.next=9,coreContact.getContactByAccount(s);case 9:if(v=e.sent,u&&u.contact_id&&!u.account?l=(0,c.default)({},u):isNullOrEmpty(v)?l=r===s?coreSearch.getTempCallUserInfo(s,language.VOICE_MAIL_BOX,!0):coreSearch.getTempCallUserInfo(s):(f=v.bind_no,l=v),!i){e.next=17;break}if(!window.SERVERCONFIG.HWUC){e.next=16;break}return e.abrupt("return",alert(language.COMMON_FUNCTION_IS_NOT_AVAILABLE));case 16:return e.abrupt("return",coreCall.CallOut(p,l,!0));case 17:if(isNullOrEmpty(f)||l.bind_no!==p||!window.SERVERCONFIG.HWUC){e.next=19;break}return e.abrupt("return",coreCall.CallOut("*"+p,l));case 19:return e.abrupt("return",coreCall.voiceCallPC(p,l));case 20:case"end":return e.stop()}},e,void 0)}));return function(t,r,n,a,o,u){return e.apply(this,arguments)}}(),t.playDialAudio=function(e,t,r){var n=void 0;if(12===e&&(e=0),window.webView)window.webView.playRing(e+".wav",0);else if((void 0)[e]?(n=t[Number(e)+KEY_AUDIO_LEN],(void 0)[e]=!1):(n=t[e],(void 0)[e]=!0),coreCommon.isMobile()){var a=new Media(KEY_AUDIO_SRC+r[Number(e)],function(){window.log("audio load success.")},function(){window.log("audio load failed.")});a.play()}else n.currentTime=0,n.play()},t.videoClickFunc=function(){var e=(0,s.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreContact.searchServerContact(t,1,1);case 2:r=e.sent,n=r.userInformationList||[],0!==n.length?t.length>=7?coreCall.CallOut(t,n[0],!0):coreCall.CallOut(1===window.SERVERCONFIG.HWUC?"*"+t:t,n[0],!0):t.length>=7?coreCall.CallOut(t,coreSearch.getTempCallUserInfo(t),!0):coreCall.CallOut(1===window.SERVERCONFIG.HWUC?"*"+t:t,coreSearch.getTempCallUserInfo(t),!0);case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.callClickFunc=function(){var e=(0,s.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,coreContact.searchServerContact(t,1,1);case 2:r=e.sent,n=r.userInformationList||[],0!==n.length?t.length>=7?coreCall.voiceCallPC(t,n[0]):coreCall.voiceCallPC(1===window.SERVERCONFIG.HWUC?"*"+t:t,n[0]):t.length>=7?coreCall.voiceCallPC(t,coreSearch.getTempCallUserInfo(t)):coreCall.voiceCallPC(1===window.SERVERCONFIG.HWUC?"*"+t:t,coreSearch.getTempCallUserInfo(t));case 5:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},1770:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.euaserver=void 0;var a=r(134),o=n(a),u=r(119),c=n(u),i=r(4),s=n(i),p=r(120),d=n(p),f=r(121),l=n(f),v=r(3),h=n(v),m=r(65),g=n(m),b=r(1),x=n(b),C=r(2),y=n(C),_=r(1771),w=n(_),k=window.Logger("logic")("login/euaserver"),I=function(){var e=(0,y.default)(x.default.mark(function e(){var t,r,n,a,o,u,c,i,s,p,d,f,l,v,h,m,g,b,C,y,_;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(O()){e.next=2;break}return e.abrupt("return");case 2:return coreUt.utEventStart({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_EAB_SERVER,params:[constant.UT_LOGIN_SERVER_NAME.UT_EAB_SERVER]}),k.info(" start eabserverLogin"),e.next=6,new coreTup.HWTupEaddr;case 6:return t=e.sent,r=coreAccount.getLoginModel(),n=r.account,a=r.eabUri,o=r.groupServer,u=r.serverAddress,c=r.serverPort,i=r.serverUportalAddress,s=r.serverUportalPort,p=r.isSupportProxy,d=r.proxyAddress,f=r.proxyPort,l=r.proxyAccount,v=r.authToken,e.next=10,coreSecurity.PasswordManager.getPassword("proxyPassword");case 10:return h=e.sent,p||(d=null,f=null,l=null,h=null),m=window.CLIENTCONFIG.EAB_SEARCH_NUM||20,g={LogLevel:0,LogFileSize:10240,LogPath:window.LOG_PATH},k.info(" eabserverLogin  eaddrSetLogPara "),e.next=17,t.eaddrSetLogPara(g);case 17:return k.info("eabserverLogin eaddrInit"),e.next=20,t.eaddrInit();case 20:return k.info(" eabserverLogin  eaddrConfig "),b=i||u,C=s||c,y={ServerType:3,HttpServerAddr:a||"https://"+b+":"+C+"/services",AvatarServerAddr:o||"https://"+b+":"+C+"/headportrait",PageCount:m,UserName:n,Token:v,AvatarFilePath:window.avatarPath,HttpsVerifyMode:0,HttpTimeOut:10,RCSType:1,CertFilePath:"",ProxyIpAddr:d,ProxyPort:parseInt(f),ProxyAuthUserName:l,ProxyAuthPassword:h},e.next=26,t.eaddrConfig(y);case 26:if(_=e.sent,0!==_.result){e.next=34;break}return k.info("eabserverLogin  success"),coreCommon.dispatchModuleEvent("login",{event:"eua",code:0}),coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_EAB_SERVER,resultParams:[1],isTrackTimeCosts:!0}),e.abrupt("return",coreCommon.ATOMIC_ACTION_RESULT.SUCCESS);case 34:return k.error("eabserverLogin  failed"),coreCommon.dispatchModuleEvent("login",{event:"eua",code:_}),coreUt.utEventFinish({eventId:constant.EVENT_ID.UT_LOGIN,extraTrackKey:constant.UT_LOGIN_SERVER_NAME.UT_EAB_SERVER,resultParams:[0,_.result],isTrackTimeCosts:!0}),e.abrupt("return",coreCommon.ATOMIC_ACTION_RESULT.FAILED);case 38:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),S=new coreCommon.AtomicAction("eabserverLoginAtomic",I),E=function(e){var t=e&&e.result||e&&e.param&&e.param.result;if(!isNullOrEmpty(t))switch(t){case constant.ERROR_SEARCHINFO_CODE.EADDR_SUCCESS:return!0;case constant.ERROR_SEARCHINFO_CODE.EADDR_FAIL_AUTH:case constant.ERROR_SEARCHINFO_CODE.EADDR_FAIL_TOKEN:N()}return k.info("EUA request error, reason:",t),!1},L=function(e){var t=coreAccount.getLoginModel(),r=t.isSupportAS;return e.forEach(function(e){r&&e.hasOwnProperty("id")?(e.show_account=e.account,e.account=e.id,delete e.id):e.show_account=e.account}),k.debug("convert2uuid entry22",e),e},N=function(){window.CLIENTCONFIG.ENABLE_IT_MEETING?window.refreshImToken():coreAccount.actionRefreshToken()},O=function(){return!(window.CLIENTCONFIG.ISBIGWIN||!coreAccount.getLoginModel().useEab)},T=function(){return!!O()||(k.warn("EUA module is not enabled"),!1)},M=function(){var e=(0,y.default)(x.default.mark(function e(){var t,r,n,a,o,u;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=coreAccount.getLoginModel(),r=t.proxyAddress,n=t.proxyPort,a=t.proxyAccount,o=t.isSupportProxy,e.next=4,coreSecurity.PasswordManager.getPassword("proxyPassword");case 4:return u=e.sent,o||(r="",n=0,a="",u=""),e.abrupt("return",{proxyAddress:r,proxyPort:n,proxyAccount:a,proxyPassword:u});case 7:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),G=function(){var e=(0,y.default)(x.default.mark(function e(t){var r,n,a,o,u,c,i,s,p,d,f,l,v,h,m=t.path,g=void 0===m?"":m,b=t.header,C=void 0===b?{}:b,y=t.body,_=void 0===y?"":y;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M();case 2:if(r=e.sent,n=coreAccount.getLoginModel(),a=n.authToken,o=n.serverUportalAddress,u=n.serverAddress,c=n.serverUportalPort,i=n.serverPort,s=o||u,p=c||i,d="https://"+s+":"+p,"/"===g[0]?d+=g:d=d+"/rest/usg/abs/v1/"+g,f=coreAccount.getLoginModel(),l=f.isSupportCACertCheck,v={caCertPath:window.EXEC_PATH,tlsMode:l?1:0},""!==a){e.next=13;break}return k.error("invalid authToken for EUA Request."),e.abrupt("return",null);case 13:return h={url:d,type:constant.REQUEST_TYPE.GET,header:{Authorization:"Basic "+a},body:_,proxyInfo:r,tlsParam:v,cipherlist:[]},""!==_&&(h.type=constant.REQUEST_TYPE.POST,h.header["Content-Type"]="application/json"),C.hasOwnProperty("etag")&&(h.header.etag=C.etag),e.abrupt("return",h);case 17:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=(0,y.default)(x.default.mark(function e(){var t,r,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="user/_search",s=s||window.CLIENTCONFIG.EAB_SEARCH_NUM,r=parseInt(a/s)+1,n=(0,g.default)({pageIndex:r,pageSize:s,searchKey:u,deptCode:o,querySubDept:c,searchScope:i}),e.abrupt("return",G({path:t,body:n}));case 5:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,y.default)(x.default.mark(function e(){var t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",u=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(a,n,o,u);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,R(t);case 7:return r=e.sent,r&&r.hasOwnProperty("data")&&(r.data=L(r.data)),e.abrupt("return",r);case 10:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),U=function(){var e=(0,y.default)(x.default.mark(function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="user/_detail",e.abrupt("return",G({path:t,body:r}));case 2:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,y.default)(x.default.mark(function e(t){var r,n,a,o=t.id,u=void 0===o?"":o,c=t.filePath,i=void 0===c?"":c,s=t.size,p=void 0===s?"":s,d=t.etag,f=void 0===d?"":d;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="headportrait?id="+u,""!==p&&(r=r+"&size="+p),n={},""!==f&&(n={etag:f}),e.next=6,G({path:r,header:n});case 6:return a=e.sent,a.auth_mode=0,a.filePath=i,e.abrupt("return",a);case 10:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=(0,y.default)(x.default.mark(function e(t){var r,n,a;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t);case 2:if(r=e.sent,k.info("euaRequest: --------------------------------\x3e 3"),r){e.next=7;break}return k.info("Eua Request Failed, invalid response."),e.abrupt("return",null);case 7:if(r.hasOwnProperty("param")&&r.param.hasOwnProperty("ret")&&0===r.param.ret){e.next=10;break}return k.info("Eua Request Failed, result: "+(r.param.ret?r.param.ret:"Unknown Reason.")),e.abrupt("return",null);case 10:if(!r.param.hasOwnProperty("rsp_body")||!r.param.rsp_body.hasOwnProperty("rsp_code")){e.next=19;break}if(304!==r.param.rsp_body.rsp_code&&200!==r.param.rsp_body.rsp_code){e.next=15;break}k.info("Eua Request Succeed: "+r.param.rsp_body.rsp_code),e.next=17;break;case 15:return k.info("Eua Request Failed, rsp: "+r.param.rsp_body.rsp_code),e.abrupt("return",null);case 17:e.next=21;break;case 19:return k.info("Eua Request Failed, rsp: missing rsp_body or rsp_code."),e.abrupt("return",null);case 21:if(n=r.param.rsp_body.rsp_msg||null){e.next=25;break}return k.info("Eua Request Failed, rsp_msg is null."),e.abrupt("return",null);case 25:if(a=JSON.parse(n),k.info("Eua Request Result: "+a.returnMessage.split(".").pop()),"000000000"===a.returnCode){e.next=29;break}return e.abrupt("return",null);case 29:return k.info("Eua Request Succeed."),e.abrupt("return",a.data||!0);case 31:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,y.default)(x.default.mark(function e(t){var r,n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreHttp.hwTupHttpTransSdk;case 2:return r=e.sent,k.info("euaRequest: --------\x3e 1"),e.next=6,r.sendAsyncRequest(t);case 6:if(n=e.sent,k.info("euaRequest: ----------------\x3e 2"),!n.handle){e.next=12;break}return e.abrupt("return",new h.default(function(e){coreHttp.httpAsyncResponse.addHandle(n.handle,e)}));case 12:return k.info("euaRequest: ----------------\x3e 2 ret is null"),e.abrupt("return",null);case 14:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),$=function(e){function t(){var e,r,n,a,u=this;(0,s.default)(this,t);for(var i=arguments.length,p=Array(i),f=0;f<i;f++)p[f]=arguments[f];return r=n=(0,d.default)(this,(e=t.__proto__||(0,c.default)(t)).call.apply(e,[this].concat(p))),n.eaddrUnint=(0,y.default)(x.default.mark(function e(){var t;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(O()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,S.reset();case 4:return k.info("eabserverLogin eaddrUnint"),e.next=7,new coreTup.HWTupEaddr;case 7:return t=e.sent,e.abrupt("return",t.eaddrUninit());case 9:case"end":return e.stop()}},e,u)})),n.searchAvatar=function(){var e=(0,y.default)(x.default.mark(function e(t){var r,n,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:constant.AVATAR_SIZE.BIG,c=arguments[2];return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!coreAccount.getLoginModel().isSupportAS){e.next=8;break}return r=coreCommon.isPc()?window.avatarPath.replaceAll("\\","/"):window.avatarPath,e.next=4,coreContact.syncHeadPortrait(t,""+r+t+".png");case 4:return n=e.sent,e.next=7,coreHttp.httpAsyncResponse.addHandle(n.param.handle,c);case 7:return e.abrupt("return",n);case 8:if(T()){e.next=10;break}return e.abrupt("return",!1);case 10:return e.next=12,S.wait();case 12:return k.debug("searchAvatar",o),a={ServerType:constant.EADDR_SERVER_TYPE.RCS,ucaccount:t,IconSize:o},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.setNotifies({196611:c}),e.eaddrSearchAvatar(a).then(function(e){return k.debug("eaddrSearchAvatar"),E(e),e})}));case 15:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.searchAvatarList=function(){var e=(0,y.default)(x.default.mark(function e(t,r){var n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(T()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,S.wait();case 4:return k.info("searchAvatarList begin"),n={ServerType:constant.EADDR_SERVER_TYPE.RCS,ucaccounts:t,IconSize:0},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.setNotifies({196616:r}),e.eaddrSearchAvatarList(n).then(function(e){return k.debug("searchAvatarList"),E(e),e})}));case 7:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),n.setAvatar=function(){var e=(0,y.default)(x.default.mark(function e(t,r){var n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(T()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,S.wait();case 4:return n={ServerType:3,IconType:1,SmallIconFilePath:t.SmallIconFilePath,MediumIconFilePath:t.MediumIconFilePath,LargeIconFilePath:t.LargeIconFilePath},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.setEaddrBaseEvent({upLoadAvatar:function(e){E(e),r(e)}}),e.eaddrSetAvatar(n).then(function(e){return E(e),e})}));case 6:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),n.searchServerContact=function(){var e=(0,y.default)(x.default.mark(function e(){var t,r,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments[1],c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(T()){e.next=2;break}return e.abrupt("return",{});case 2:return e.next=4,S.wait();case 4:return k.debug("load ent first time"),a=encodeURIComponent(a),a=""===a?" ":a,t=window.CLIENTCONFIG.EAB_SEARCH_NUM||20,o=o||0,r=parseInt(o/t)+1,n={ServerType:3,condition:a,PageIndex:r,SearchType:c,Dept:""},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.eaddrSearchInfo(n).then(function(e){if(E(e)){e.hasOwnProperty("param")&&e.param.hasOwnProperty("entry")&&(e.param.entry=L(e.param.entry));var t=e.param.entry,r=e.param.TotalNum;return k.info("interface server all contacts search finish,count",r),{recordAmount:r,userInformationList:t}}return k.error("searchServerContact failed"),{}})}));case 12:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.queryServerContact=function(){var e=(0,y.default)(x.default.mark(function e(t){var r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(T()){e.next=2;break}return e.abrupt("return",{param:{}});case 2:return e.next=4,S.wait();case 4:return r={ServerType:3,condition:t,PageIndex:1,SearchType:1,Dept:""},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.eaddrSearchInfo(r).then(function(e){return E(e)?(e.hasOwnProperty("param")&&e.param.hasOwnProperty("entry")&&(e.param.entry=L(e.param.entry)),{param:e.param.entry[0],result:e.param.result}):(k.error("queryServerContact failed"),{param:{}})})}));case 6:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.queryUserListFromEaddr=function(){var e=(0,y.default)(x.default.mark(function e(t){var r,a,c,i;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(coreAccount.getLoginModel().isSupportAS&&t instanceof Array)){e.next=12;break}return k.info("query user list in cloudusg"),r=t.map(function(e){return{id:e.username}}),e.next=5,n.syncUserDetails(r);case 5:if(!((a=e.sent)instanceof Array&&a.length>0)){e.next=11;break}if(a.forEach(function(e){e.bind_no=e.number,e.dept_name_cn=e.deptName,e.dept_name_en=e.deptName,e.mobile=e.phone,e.result_code=constant.EADDR_CONTACT_RESULT_CODE.SUCCESS}),!(a instanceof Array&&a.length>0)){e.next=11;break}return c={entry:a,result:0},e.abrupt("return",c);case 11:k.info("query user list in cloudusg failed.");case 12:if(T()){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,S.wait();case 16:return i={users:[].concat((0,o.default)(t))},e.abrupt("return",(new coreTup.HWTupEaddr).then(function(e){return e.eaddrSearchUserList(i).then(function(e){return E(e)?(e.hasOwnProperty("param")&&e.param.hasOwnProperty("entry")&&(e.param.entry=L(e.param.entry)),e.param):(k.error("queryUserListFromEaddr failed"),{})})}));case 18:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.refreshTocken=(0,y.default)(x.default.mark(function e(){return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return k.info("eua refreshToken, just reset eabserverLoginAtomic"),e.abrupt("return",S.reset());case 2:case"end":return e.stop()}},e,u)})),n.getDeptTree=(0,y.default)(x.default.mark(function e(){return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getDeptList();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,u)})),n.getDeptList=function(){var e=(0,y.default)(x.default.mark(function e(){var t,r,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=""===a?"":"/"+a,r="department"+t,e.next=4,G({path:r});case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",null);case 7:return e.next=9,R(n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.getDeptUserList=function(){var e=(0,y.default)(x.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t,r,"",n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.queryDeptUserList=function(){var e=(0,y.default)(x.default.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t,r,n,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.syncUserDetails=function(){var e=(0,y.default)(x.default.mark(function e(){var t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n instanceof Array&&n.length>0)){e.next=11;break}return e.next=3,U((0,g.default)(n));case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,R(t);case 8:if(!((r=e.sent)instanceof Array&&r.length>0)){e.next=11;break}return e.abrupt("return",L(r));case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.syncHeadPortrait=function(){var e=(0,y.default)(x.default.mark(function e(){var t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"large",c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P({id:n,filePath:a,size:o,etag:c});case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,new coreHttp.hwTupHttpTransSdk;case 7:return r=e.sent,e.next=10,r.httpDownloadFile(t);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.uploadHeadPortrait=function(){var e=(0,y.default)(x.default.mark(function e(t){var r,n,a=t.id,o=void 0===a?"":a,c=t.filePath,i=void 0===c?"":c;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P({id:o,filePath:i});case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,new coreHttp.hwTupHttpTransSdk;case 7:return n=e.sent,e.next=10,n.httpUploadFile(r);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.uploadUserInfo=function(){var e=(0,y.default)(x.default.mark(function e(){var t,r,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="/rest/usg/datacenter/v1/member",r=(0,g.default)(a),e.next=4,G({path:t,body:r});case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",null);case 7:return n.type=constant.REQUEST_TYPE.PUT,e.next=10,R(n);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),a=r,(0,d.default)(n,a)}return(0,l.default)(t,e),t}(w.default);t.euaserver=new $},1771:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(1),o=n(a),u=r(2),c=n(u),i=r(119),s=n(i),p=r(4),d=n(p),f=r(120),l=n(f),v=r(121),h=n(v),m=function(e){function t(){var e,r,n,a,u=this;(0,d.default)(this,t);for(var i=arguments.length,p=Array(i),f=0;f<i;f++)p[f]=arguments[f];return r=n=(0,l.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(p))),n.eaddrUnint=(0,c.default)(o.default.mark(function e(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)})),n.searchAvatar=function(){var e=(0,c.default)(o.default.mark(function e(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:constant.AVATAR_SIZE.BIG,arguments[2];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.searchAvatarList=function(){var e=(0,c.default)(o.default.mark(function e(t,r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),n.setAvatar=function(){var e=(0,c.default)(o.default.mark(function e(t,r){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t,r){return e.apply(this,arguments)}}(),n.searchServerContact=function(){var e=(0,c.default)(o.default.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.queryServerContact=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.queryUserListFromEaddr=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.refreshTocken=(0,c.default)(o.default.mark(function e(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)})),n.getDeptTree=(0,c.default)(o.default.mark(function e(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)})),n.getDeptList=function(){var e=(0,c.default)(o.default.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.getDeptUserList=function(){var e=(0,c.default)(o.default.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1],!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.queryDeptUserList=function(){var e=(0,c.default)(o.default.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.syncUserDetails=function(){var e=(0,c.default)(o.default.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.syncHeadPortrait=function(){var e=(0,c.default)(o.default.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),n.uploadHeadPortrait=function(){var e=(0,c.default)(o.default.mark(function e(t){t.id,t.filePath;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n.uploadUserInfo=function(){var e=(0,c.default)(o.default.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,u)}));return function(){return e.apply(this,arguments)}}(),a=r,(0,l.default)(n,a)}return(0,h.default)(t,e),t}(coreCommon.Interface);t.default=m},1772:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=r(1),o=n(a),u=r(2),c=n(u),i=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.code){e.next=11;break}e.t0=t.event,e.next="uportal"===e.t0?4:"total"===e.t0?6:"uportal"===e.t0?8:10;break;case 4:return coreContact.refreshTocken(),e.abrupt("break",11);case 6:return window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING?(coreContact.loadServerContact(),coreContact.getDirectoryMenuKeyScroll()):(coreContact.loadServerContact(),coreContact.initDepartmentTree(),coreContact.getDirectoryMenuKeyScroll(),coreContact.loadMyContactInfoAndAvatar()),e.abrupt("break",11);case 8:return(0,p.teLoadContactAndGroupList)(),e.abrupt("break",11);case 10:return e.abrupt("break",11);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),p=r(1283);window.Logger("contact")("moduleMessager");coreCommon.registeModuleListener("login",i),coreCommon.registeModuleListener("logout",s)},178:function(e,t,r){e.exports=r(0)(385)},180:function(e,t,r){r(24),r(22),e.exports=r(181)},181:function(e,t,r){var n=r(9),a=r(26);e.exports=r(8).getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},186:function(e,t,r){e.exports=r(0)(63)},187:function(e,t,r){"use strict";var n=r(25).f,a=r(390),o=r(29),u=r(11),c=r(28),i=r(23),s=r(391),p=r(392),d=r(37),f=r(30),l=r(178).fastKey,v=r(164),h=f?"_s":"size",m=function(e,t){var r,n=l(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,s){var p=e(function(e,n){c(e,p,t,"_i"),e._t=t,e._i=a(null),e._f=void 0,e._l=void 0,e[h]=0,void 0!=n&&i(n,r,e[s],e)});return o(p.prototype,{clear:function(){for(var e=v(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[h]=0},delete:function(e){var r=v(this,t),n=m(r,e);if(n){var a=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=a),a&&(a.p=o),r._f==n&&(r._f=a),r._l==n&&(r._l=o),r[h]--}return!!n},forEach:function(e){v(this,t);for(var r,n=u(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!m(v(this,t),e)}}),f&&n(p.prototype,"size",{get:function(){return v(this,t)[h]}}),p},def:function(e,t,r){var n,a,o=m(e,t);return o?o.v=r:(e._l=o={i:a=l(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[h]++,"F"!==a&&(e._i[a]=o)),e},getEntry:m,setStrong:function(e,t,r){s(e,t,function(e,r){this._t=v(e,t),this._k=r,this._l=void 0},function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?"keys"==t?p(0,r.k):"values"==t?p(0,r.v):p(0,[r.k,r.v]):(e._t=void 0,p(1))},r?"entries":"values",!r,!0),d(t)}}},188:function(e,t,r){"use strict";var n=r(7),a=r(10),o=r(178),u=r(147),c=r(35),i=r(29),s=r(23),p=r(28),d=r(15),f=r(36),l=r(25).f,v=r(393)(0),h=r(30);e.exports=function(e,t,r,m,g,b){var x=n[e],C=x,y=g?"set":"add",_=C&&C.prototype,w={};return h&&"function"==typeof C&&(b||_.forEach&&!u(function(){(new C).entries().next()}))?(C=t(function(t,r){p(t,C,e,"_c"),t._c=new x,void 0!=r&&s(r,g,t[y],t)}),v("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in _&&(!b||"clear"!=e)&&c(C.prototype,e,function(r,n){if(p(this,C,e),!t&&b&&!d(r))return"get"==e&&void 0;var a=this._c[e](0===r?0:r,n);return t?this:a})}),b||l(C.prototype,"size",{get:function(){return this._c.size}})):(C=m.getConstructor(t,e,g,y),i(C.prototype,r),o.NEED=!0),f(C,e),w[e]=C,a(a.G+a.W+a.F,w),b||m.setStrong(C,e,g),C}},189:function(e,t,r){var n=r(16),a=r(398);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return a(this)}}},190:function(e,t,r){"use strict";var n=r(10);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},191:function(e,t,r){"use strict";var n=r(10),a=r(12),o=r(11),u=r(23);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,c,i=arguments[1];return a(this),t=void 0!==i,t&&a(i),void 0==e?new this:(r=[],t?(n=0,c=o(i,arguments[2],2),u(e,!1,function(e){r.push(c(e,n++))})):u(e,!1,r.push,r),new this(r))}})}},195:function(e,t,r){r(22),r(196),e.exports=r(8).Array.from},196:function(e,t,r){"use strict";var n=r(11),a=r(10),o=r(139),u=r(32),c=r(33),i=r(27),s=r(197),p=r(26);a(a.S+a.F*!r(34)(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,a,d,f=o(e),l="function"==typeof this?this:Array,v=arguments.length,h=v>1?arguments[1]:void 0,m=void 0!==h,g=0,b=p(f);if(m&&(h=n(h,v>2?arguments[2]:void 0,2)),void 0==b||l==Array&&c(b))for(t=i(f.length),r=new l(t);t>g;g++)s(r,g,m?h(f[g],g):f[g]);else for(d=b.call(f),r=new l;!(a=d.next()).done;g++)s(r,g,m?u(d,h,[a.value,g],!0):a.value);return r.length=g,r}})},197:function(e,t,r){"use strict";var n=r(25),a=r(198);e.exports=function(e,t,r){t in e?n.f(e,t,a(0,r)):e[t]=r}},198:function(e,t,r){e.exports=r(0)(62)},358:function(e,t,r){r(359),e.exports=r(8).Object.keys},359:function(e,t,r){var n=r(139),a=r(186);r(145)("keys",function(){return function(e){return a(n(e))}})},367:function(e,t,r){e.exports={default:r(556),__esModule:!0}},390:function(e,t,r){e.exports=r(0)(111)},391:function(e,t,r){e.exports=r(0)(184)},392:function(e,t,r){e.exports=r(0)(381)},393:function(e,t,r){var n=r(11),a=r(394),o=r(139),u=r(27),c=r(395);e.exports=function(e,t){var r=1==e,i=2==e,s=3==e,p=4==e,d=6==e,f=5==e||d,l=t||c;return function(t,c,v){for(var h,m,g=o(t),b=a(g),x=n(c,v,3),C=u(b.length),y=0,_=r?l(t,C):i?l(t,0):void 0;C>y;y++)if((f||y in b)&&(h=b[y],m=x(h,y,g),e))if(r)_[y]=m;else if(m)switch(e){case 3:return!0;case 5:return h;case 6:return y;case 2:_.push(h)}else if(p)return!1;return d?-1:s||p?p:_}}},394:function(e,t,r){e.exports=r(0)(153)},395:function(e,t,r){var n=r(396);e.exports=function(e,t){return new(n(e))(t)}},396:function(e,t,r){var n=r(15),a=r(397),o=r(6)("species");e.exports=function(e){var t;return a(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!a(t.prototype)||(t=void 0),n(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},397:function(e,t,r){e.exports=r(0)(387)},398:function(e,t,r){var n=r(23);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},400:function(e,t,r){e.exports={default:r(401),__esModule:!0}},401:function(e,t,r){r(24),r(22),e.exports=r(402)},402:function(e,t,r){var n=r(16),a=r(6)("iterator"),o=r(17);e.exports=r(8).isIterable=function(e){var t=Object(e);return void 0!==t[a]||"@@iterator"in t||o.hasOwnProperty(n(t))}},436:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAvatarMap=t.updateAvatarMap=t.initAvatarMap=void 0;var a=r(490),o=n(a),u=r(441),c=n(u);t.initAvatarMap=function(){return window.$dispatch(o.initAvatarMap())},t.updateAvatarMap=function(e,t){c.getAvatarPalette(e,t).then(function(){window.$dispatch(o.updateAvatarMap(e))})},t.deleteAvatarMap=function(e){return window.$dispatch(o.deleteAvatarmap(e))}},441:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getColorPickingOpts=t.getDefaultShowImage=t.getAvatarPalette=void 0;var n=r(564),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.getAvatarPalette=a.getAvatarPalette,t.getDefaultShowImage=a.getDefaultShowImage,t.getColorPickingOpts=a.getColorPickingOpts},466:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getEserverUserInfo=t.subscribeUserStatus=t.detectUserStatus=t.getLinkageStatusLogic=t.setLinkageStatusLogic=t.getFullContactList=t.getContactList=t.confirmPreservateLogic=t.modifyCustomContactService=t.addCustomContactService=t.addContactService=t.modifyContactGroupName=t.addContactGroupService=t.removeContactToGroupService=t.deleteContactGroupService=t.deleteContactService=void 0;var a=r(1),o=n(a),u=r(2),c=n(u),i=window.Logger("logic")("tupLogic"),s=(t.deleteContactService=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,c,s,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.USE_IM){e.next=21;break}if(n=$getState().contactGroups.contactUserList,a="",!coreAccount.getLoginModel().isSupportAS){e.next=12;break}u=0;case 5:if(!(u<n.length)){e.next=12;break}if(t!==n[u].contact_id){e.next=9;break}return a=n[u].account,e.abrupt("break",12);case 9:u++,e.next=5;break;case 12:return e.next=14,new coreTup.HWTupIM;case 14:return c=e.sent,e.next=17,coreAccount.getLoginModel().isSupportAS?c.deleteFriend({self_uuid:$getState().myInfo.account,uuid:a,group_id:r}):c.delfriendorcontact({contact_id:t,group_id:r});case 17:return s=e.sent,p=s.result,i.info("delete friend result : ",p),e.abrupt("return",p);case 21:return e.abrupt("return",0);case 22:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.deleteContactGroupService=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,!window.CLIENTCONFIG.USE_IM){e.next=9;break}return e.next=4,new coreTup.HWTupIM;case 4:return n=e.sent,e.next=7,n.delusergroup(t);case 7:a=e.sent,r=0===a.result;case 9:return e.next=11,coreDb.deleteContactGroup({group_id:t});case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.removeContactToGroupService=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.contact_id,n=t.old_group_id,a=t.new_group_id,u=t.type,!window.CLIENTCONFIG.USE_IM){e.next=10;break}return e.next=4,new coreTup.HWTupIM;case 4:return c=e.sent,e.next=7,c.movecontactgroup(t);case 7:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",{result:0});case 11:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.addContactGroupService=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={name:t,index:r},e.next=3,new coreTup.HWTupIM;case 3:return a=e.sent,e.next=6,a.addusergroup(n);case 6:return u=e.sent,e.abrupt("return",u);case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.modifyContactGroupName=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.CLIENTCONFIG.USE_IM){e.next=10;break}return e.next=3,new coreTup.HWTupIM;case 3:return a=e.sent,u={id:t,name:r,index:n},e.next=7,a.modusergroup(u);case 7:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",{result:0});case 11:case"end":return e.stop()}},e,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}(),t.addContactService=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new coreTup.HWTupIM;case 2:return r=e.sent,e.next=5,r.addfriend(t);case 5:return n=e.sent,i.info("add friend result : ",n&&n.result),e.abrupt("return",n);case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.addCustomContactService=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.isEserverOnline){e.next=3;break}return i.error("addCustomContactService eserver is offline!"),e.abrupt("return",{result:1,param:{}});case 3:return e.next=5,new coreTup.HWTupIM;case 5:return r=e.sent,n={id:0,staff_id:0,name:p(t.name),nick_name:"",foreign_name:"",birthday:"",gender:2,corp_name:p(t.crop_name),
//! corp_name 和 crop_name 好坑啊!!!
dept_name:p(t.dept_name),title:p(t.title),mobile:p(t.mobile),office_phone:p(t.office_phone),home_phone:p(t.home_phone),other_phone:p(t.other_phone),fax:p(t.fax),email:p(t.email),website:p(t.website),im_no:p(t.im_no),address:p(t.address),desc:p(t.desc),postcode:p(t.postcode),state:0,other_phone2:p(t.other_phone2),other_mobiles:p(t.other_mobiles),group_id:s(t.group_id)},e.abrupt("return",r.addcontact(n));case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.modifyCustomContactService=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.isEserverOnline){e.next=3;break}return i.error("modifyCustomContactService eserver is offline!"),e.abrupt("return",{result:1,param:{}});case 3:return e.next=5,new coreTup.HWTupIM;case 5:return r=e.sent,n={id:s(t.contact_id),staff_id:s(t.staff_id),name:p(t.name),nick_name:p(t.nick_name),foreign_name:p(t.foreign_name),birthday:p(t.birthday),gender:s(t.gender),corp_name:p(t.crop_name),
//! 设置是corp_name,下发的却是crop_name 好坑啊!!!
dept_name:p(t.dept_name),title:p(t.title),mobile:p(t.mobile),office_phone:p(t.office_phone),home_phone:p(t.home_phone),other_phone:p(t.other_phone),fax:p(t.fax),email:p(t.email),website:p(t.website),im_no:p(t.im_no),address:p(t.address),desc:p(t.desc),postcode:p(t.postcode),state:0,other_phone2:p(t.other_phone2),other_mobiles:p(t.other_mobiles)},e.abrupt("return",r.modcontact(n));case 8:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(e){var t="number"===Object.type(e)?e:parseInt(e);return isNaN(t)?0:t}),p=function(e){return isNullOrEmpty(e)||"object"===Object.type(e)?"":e.toString()};t.confirmPreservateLogic=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new coreTup.HWTupIM;case 3:return n=e.sent,a={id:t.contact_id,staff_id:t.staff_id,name:t.name,nick_name:r,foreign_name:"11"},e.next=7,n.modcontact(a);case 7:if(u=e.sent,0!==u.result){e.next=13;break}return e.next=11,coreContact.saveContactInfo(t);case 11:e.next=14;break;case 13:window.alert(language.SETTING_NICKNAME_FAILED);case 14:return e.abrupt("return",u);case 17:e.prev=17,e.t0=e.catch(0),i.error("error",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t,r){return e.apply(this,arguments)}}(),t.getContactList=function(){var e=(0,c.default)(o.default.mark(function e(){var t,r,n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.info("getContactList"),coreIm.checkEServerOnlineNoToast("getContactList")){e.next=3;break}return e.abrupt("return",{});case 3:return e.next=5,new coreTup.HWTupIM;case 5:return t=e.sent,e.next=8,coreDb.queryUserConfig({key:"increTimeStamp"});case 8:if(r=e.sent,n=r.value,a=void 0,!isNullOrEmpty(n)){e.next=17;break}return e.next=14,t.getcontactlist({is_sync_all:1,time_stamp:""});case 14:a=e.sent,e.next=20;break;case 17:return e.next=19,t.getcontactlist({is_sync_all:0,time_stamp:n});case 19:a=e.sent;case 20:return a&&a.result===constant.ERROR_CODE.Success&&(i.info("getContactList save time_stamp to localstorage"),coreDb.saveUserConfig({key:"increTimeStamp",value:a.param.time_stamp})),e.abrupt("return",a);case 22:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.getFullContactList=function(){var e=(0,c.default)(o.default.mark(function e(){var t,r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("getFullContactList"),e.next=4,new coreTup.HWTupIM;case 4:return t=e.sent,e.next=7,t.getcontactlist({is_sync_all:1,time_stamp:""});case 7:return r=e.sent,e.abrupt("return",r);case 11:e.prev=11,e.t0=e.catch(0),i.error("getFullContactList",e.t0.toString());case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(){return e.apply(this,arguments)}}(),t.setLinkageStatusLogic=function(){var e=(0,c.default)(o.default.mark(function e(t){var r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("setLinkageStatusLogic"),e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.abrupt("return",r.setLinkageStatus(t));case 8:e.prev=8,e.t0=e.catch(0),i.error("setLinkageStatusLogic",e.t0.toString());case 11:case"end":return e.stop()}},e,void 0,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),t.getLinkageStatusLogic=function(){var e=(0,c.default)(o.default.mark(function e(){var t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("getLinkageStatusLogic"),e.next=4,new coreTup.HWTupIM;case 4:return t=e.sent,e.abrupt("return",t.getLinkageStatus({}));case 8:e.prev=8,e.t0=e.catch(0),i.error("getLinkageStatusLogic",e.t0.toString());case 11:case"end":return e.stop()}},e,void 0,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),t.detectUserStatus=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i.info("detectUserStatus"),coreIm.checkEServerOnlineNoToast("detectUserStatus")){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,new coreTup.HWTupIM;case 6:return r=e.sent,e.next=9,r.detectuserstatus(t);case 9:return n=e.sent,e.abrupt("return",n);case 13:e.prev=13,e.t0=e.catch(0),i.error("detectUserStatus",e.t0.toString());case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t){return e.apply(this,arguments)}}(),t.subscribeUserStatus=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("subscribeUserStatus"),e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.next=7,r.subscribeuserstatus(t);case 7:return n=e.sent,e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),i.error("subscribeUserStatus",e.t0.toString());case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(t){return e.apply(this,arguments)}}(),t.getEserverUserInfo=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.info("getEserverUserInfo"),e.next=4,new coreTup.HWTupIM;case 4:return r=e.sent,e.next=7,r.getuserinfo(t);case 7:return n=e.sent,e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),i.error("getEserverUserInfo",e.t0.toString());case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(t){return e.apply(this,arguments)}}()},490:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.clone(f),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,i.default)(e.avatarMap,[]);switch(t.type){case s:return(0,u.default)(r,t.map),(0,u.default)({},e,{avatarMap:r});case p:return(0,u.default)({},e,{avatarMap:{}});case d:return r.hasOwnProperty(t.key)&&delete r[t.key],(0,u.default)({},e,{avatarMap:r});default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAvatarmap=t.initAvatarMap=t.updateAvatarMap=void 0;var o=r(124),u=n(o),c=r(491),i=n(c);t.default=a;var s="common/avatar/updateAvatarMap",p="common/avatar/initAvatarMap",d="common/avatar/deleteAvatarmap",f={avatarMap:{}};t.updateAvatarMap=function(e){return{type:s,map:e}},t.initAvatarMap=function(){return{type:p}},t.deleteAvatarmap=function(e){return{type:d,key:e}}},491:function(e,t,r){e.exports=r(0)(419)},492:function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.clone(p),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.paletteMap,n=e.statusFontColorMap,u="";switch(t.type){case i:return u=t.account,r[u]=t.palette,n[u]=o(a(t.palette[0])),(0,c.default)({},e,{paletteMap:r,statusFontColorMap:n});case s:return coreCommon.isMobile()&&(r=t.map),(0,c.default)({},e,{paletteMap:r});default:return e}}function a(e){return e[0]+(e[1]<<1)+e[2]>>2}function o(e){return e>96}Object.defineProperty(t,"__esModule",{value:!0}),t.initPaletteMap=t.updatePaletteMap=void 0;var u=r(124),c=function(e){return e&&e.__esModule?e:{default:e}}(u);t.default=n;var i=(window.Logger("duck")("common/colorPicking"),"common/colorPicking/updatePaletteMap"),s="common/colorPicking/initPaletteMap",p={paletteMap:{},statusFontColorMap:{}};t.updatePaletteMap=function(e,t){return window.$dispatch({type:i,account:e,palette:t})},t.initPaletteMap=function(e){return window.$dispatch({type:s,map:e})}},556:function(e,t,r){r(31),r(22),r(24),r(557),r(558),r(559),r(560),e.exports=r(8).Set},557:function(e,t,r){"use strict";var n=r(187),a=r(164);e.exports=r(188)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(a(this,"Set"),e=0===e?0:e,e)}},n)},558:function(e,t,r){var n=r(10);n(n.P+n.R,"Set",{toJSON:r(189)("Set")})},559:function(e,t,r){r(190)("Set")},560:function(e,t,r){r(191)("Set")},564:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return e.length>0?o(e.shift(),t).then(function(){return a(e,t)}):f.default.resolve(!0)}function o(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{h.debug("calcImagePalette");var r=$getState().common.paletteMap,n=e.url,a=e.account;return r[a]&&!t?(h.debug("calcImagePalette colorPicking is in ducks,should not calc again"),f.default.resolve(!0)):(h.info("calcImagePalette start readLocalImgFile"),coreCommon.isPc()?coreCommon.colorPicking(n,{scaleX:1,scaleY:1/3}).then(function(e){return e?(h.info("calcImagePalette PC colorPicking success"),v.updatePaletteMap(a,e),f.default.resolve(!0)):(h.error("calcImagePalette PC colorPicking failed",e),f.default.resolve(!1))}):appService.readLocalImgFile(n).then(function(e){return 0===e.result?(h.info("calcImagePalette readLocalImgFile success"),coreCommon.colorPicking(e.file,{scaleX:1,scaleY:1/3})):(h.error("calcImagePalette readLocalImgFile failed",e.result),f.default.resolve(!1))}).then(function(e){return e?(h.info("calcImagePalette colorPicking success"),v.updatePaletteMap(a,e),f.default.resolve(!0)):(h.error("calcImagePalette colorPicking failed",e),f.default.resolve(!1))}))}catch(e){return h.error("calcImagePalette",e.toString()),f.default.resolve(!1)}}function u(){h.info("initDefaultPaletteMap");var e=["1.png","2.png","3.png","call_voice_mail_bg.png"],t=[[[39,44,42],[196,198,210],[163,136,120],[130,141,152],[148,158,180]],[[125,78,68],[28,9,8],[220,217,209],[222,107,112],[182,171,181]],[[172,178,74],[215,220,206],[64,92,46],[213,208,150],[135,83,45]],[[87,70,66],[210,121,90],[251,227,174],[168,108,84],[140,100,92]]],r={};return e.forEach(function(e,n){r[m(e)]=t[n]}),v.initPaletteMap(r),r}Object.defineProperty(t,"__esModule",{value:!0}),t.getColorPickingOpts=t.getAvatarPalette=t.getDefaultShowImage=void 0;var c=r(65),i=n(c),s=r(135),p=n(s),d=r(3),f=n(d),l=r(492),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),h=window.Logger("logic/common")("cellComponent/colorPicking");window.addEventListener("reactRenderReady",function(){h.info("reactRenderReady start calc default image's palette "),u()});var m=t.getDefaultShowImage=function(e){return coreCommon.isAndroid()?cordova.file.applicationDirectory+"www/resources/testImg/"+e:coreCommon.isIos()?(cordova.file.applicationDirectory+"/www/WeLinkProject/resources/testImg/"+e).replace("file://","/local-filesystem"):""};t.getAvatarPalette=function(e,t){return a((0,p.default)(e).map(function(t){return{account:t,url:coreCommon.isIos()?e[t].replace("/local-filesystem","file://"):e[t]}}),t)},t.getColorPickingOpts=function(e){var t=$getState().common,r=t.paletteMap,n=t.avatarMap;if(!isNullOrEmpty(e)){var a=n[e]||"";if(""!==a&&r[e])return{currentImageUrl:a,currentPalette:(0,i.default)(r[e])}}return{currentImageUrl:"",currentPalette:"[]"}}},65:function(e,t,r){e.exports={default:r(66),__esModule:!0}},66:function(e,t,r){var n=r(8),a=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},959:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r=[];return e.forEach(function(e){isNullOrEmpty(t.query({account:e}))&&r.push({username:e,etag:"fffff"})}),r}function o(e,t){return e.map(function(e){return isNullOrEmpty(e)?{}:t[e]||{}})}function u(e){return e.replace(/(^\s*)|(\s*$)/g,"")}Object.defineProperty(t,"__esModule",{value:!0}),t.addContactToGroups=t.autoCreateGroupName=t.changeGroupName=t.testGroupName=t.initContactGroupNameLogic=t.setContactGroupNameLogic=t.reLoadContactInfo=t.loadMyContactInfoAndAvatar=t.getUserDetail=t.dealUserInfoOprNotify=t.dealUserInfoChange=t.checkIsFriendByAccount=t.createContactOrGroupConversation=t.createConversation=t.createConversationLogic=t.selectAddContactList=t.changeContactGroupName=t.queryContactGroupByOpts=t.addContact=t.checkContactGroupName=t.setAddNewContactValueLogic=t.createNewContactGroup=t.createContactGroup=t.moveToOtherGroup=t.queryContactMemerGroupByOpts=t.deleteContactSubmenu=t.deleteContactFromAll=t.deleteContact=t.deleteContactLogic=t.checkIsFriendByQuery=t.reloadContactListData=t.toggleRemoveFromAll=t.openContactConversationByConf=t.openContactConversation=t.createContactConversation=t.clickContact=t.updateSignatureByRecent=t.updateSignatureFromEserver=t.getContactDetailInfo=t.hideGroupAddContacts=t.toggleContactTypeOpen=t.getContactListByAccountList=t.refreshContactInfo=t.getContactByAccount=t.getContactByCallNumber=t.subscribeContactStatus=t.detectContactStatus=t.toggleContactDetailTab=void 0;var c=r(65),i=n(c),s=r(149),p=n(s),d=r(151),f=n(d),l=r(135),v=n(l),h=r(3),m=n(h),g=r(124),b=n(g),x=r(134),C=n(x),y=r(1),_=n(y),w=r(2),k=n(w),I=function(){var e=(0,k.default)(_.default.mark(function e(t){return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(M.length<1)){e.next=2;break}return e.abrupt("return");case 2:coreContact.detectUserStatus({account_list:t});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=(0,k.default)(_.default.mark(function e(t){return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(A.length<1)){e.next=2;break}return e.abrupt("return");case 2:coreContact.subscribeUserStatus({account_list:t});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),E=(t.refreshContactInfo=function(){var e=(0,k.default)(_.default.mark(function e(t,r){var n,a,o;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,coreIm.checkEServerOnlineNoToast("refreshContactInfo")){e.next=4;break}return T.info("refreshContactInfo 当前尚处于离线状态，不查询服务器"),e.abrupt("return",{});case 4:return n={},e.next=7,(0,L.getUserInfo)(t);case 7:if(a=e.sent,o=a&&a.param,!a||a.result){e.next=15;break}n=(0,b.default)(n,o),coreContact.saveContactInfo(n),Q(n,r),e.next=17;break;case 15:return T.error("refreshContactInfo 用户已经不存在"),e.abrupt("return",{});case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),T.error("refreshContactInfo",{error:e.t0.toJSON()});case 22:case"end":return e.stop()}},e,this,[[0,19]])}));return function(t,r){return e.apply(this,arguments)}}(),r(466)),L=r(1054),N=r(994),O=r(436),T=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);t.default=e}(O),window.Logger("logic")("contact")),M=(t.toggleContactDetailTab=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{r=$getState(),n=r.contactGroups.sliderDetailShow,n?$dispatch(coreUi.updateSliderContactDetailTab(t)):$dispatch(coreUi.updateContactDetailTab(t)),T.info("切换联系人详情tab页","sliderDetailShow:tab:"+t),T.info("切换联系人详情tab页")}catch(e){T.error("toggleContactDetailTab",e)}case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),[]),G=null,D=t.detectContactStatus=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreIm.checkEServerOnlineNoToast("detectContactStatus")){e.next=2;break}return e.abrupt("return");case 2:try{G&&clearInterval(G),r=Object.type(t),n=[],"string"===r?n=[{account:t}]:"array"===r?t.length>0&&(n=t[0].account?t:t.map(function(e){return{account:e}})):"object"===r&&(n=[t]),M=M.concat(n),M.length>20?(I([].concat((0,C.default)(M))),M=[]):G=setTimeout(function(){I([].concat((0,C.default)(M))),M=[]},200)}catch(e){T.error("detectContactStatus",e)}case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),A=[],U=null,P=(t.subscribeContactStatus=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreIm.checkEServerOnlineNoToast("subscribeContactStatus")){e.next=2;break}return e.abrupt("return");case 2:try{U&&clearInterval(U),r=Object.type(t),n=[],"string"===r?n=[{account:t}]:"array"===r?t.length>0&&(n=t[0].account?t:t.map(function(e){return{account:e}})):"object"===r&&(n=[t]),A=A.concat(n),A.length>20?(S([].concat((0,C.default)(A))),A=[]):U=setTimeout(function(){S([].concat((0,C.default)(A))),A=[]},200)}catch(e){T.error("detectContactStatus",e)}case 3:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.getContactByCallNumber=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,T.info("getContactByCallNumber begin"),!isNullOrEmpty(t)){e.next=5;break}return T.error("getContactByCallNumber error: callNumber is empty!"),e.abrupt("return","");case 5:return e.next=7,coreDb.queryContactByPhonenumberAccurate(t);case 7:if(r=e.sent,isNullOrEmpty(r)){e.next=11;break}return T.info("getContactByCallNumber has fonded from db!"),e.abrupt("return",r.account);case 11:return e.next=13,coreContact.queryServerContact(t);case 13:if(n=e.sent,n.result!==constant.ERROR_SEARCHINFO_CODE.EADDR_SUCCESS){e.next=21;break}return a=n.param||{},coreUi.getContactAvatar(a.account),coreContact.saveContactInfo(a),e.abrupt("return",a.account);case 21:return e.abrupt("return","");case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(0),T.error("getContactByCallNumber",e.t0);case 27:case"end":return e.stop()}},e,void 0,[[0,24]])}));return function(t){return e.apply(this,arguments)}}(),t.getContactByAccount=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u,c,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=$getState(),n=r.contactGroups.contactUserList,a=r.myInfo,D(t),t!==a.account){e.next=8;break}return s&&coreUi.getContactAvatar(t),e.abrupt("return",a);case 8:if(o=n.query({account:t}),isNullOrEmpty(o)||!o.contact_id){e.next=12;break}return s&&coreUi.getContactAvatar(t),e.abrupt("return",o);case 12:if(isNullOrEmpty(t)){e.next=16;break}return e.next=15,coreDb.queryContact({all:"",accountlist:t});case 15:o=e.sent;case 16:if(o.id&&!s){e.next=30;break}return e.next=19,(0,L.getUserInfo)(t);case 19:if(u=e.sent,c=u&&u.param,!u||u.result){e.next=28;break}return o=(0,b.default)(o,c),(i||s)&&coreContact.saveContactInfo(o),s&&Q(o,r),e.abrupt("return",o);case 28:return T.error("getContactByAccount 用户已经不存在"),e.abrupt("return",{});case 30:return T.info("通过account获取联系人信息","success"),e.abrupt("return",o);case 34:return e.prev=34,e.t0=e.catch(0),T.error("getContactByAccount",e.t0.toString()),e.abrupt("return",{});case 38:case"end":return e.stop()}},e,void 0,[[0,34]])}));return function(t){return e.apply(this,arguments)}}()),R=(t.getContactListByAccountList=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var r=PromiseObject();if(T.info("getContactListByAccountList 通过AccountList获取联系人List"),isNullOrEmpty(e))return T.info("getContactListByAccountList list is empty"),m.default.resolve([]);var n=$getState(),u={};e.forEach(function(e){u[e]||(u[e]=!1)});var c=n.contactGroups.contactUserList,i=n.myInfo,s=[],p=[];if((0,v.default)(u).forEach(function(e){if(isNullOrEmpty(e))u[e]={};else if(!u[e]){var t=void 0;e===i.account?u[e]=i:(t=c.query({account:e}),isNullOrEmpty(t)?s.push(e):u[e]=t,D(e))}}),isNullOrEmpty(s))r.resolve(o(e,u));else{T.info("getContactListByAccountList 查询数据库");var d=s.join(",");T.info("getContactListByAccountList should query from DB:"+s.length),coreDb.queryContactList({all:"",accountlist:d}).then(function(n){if(T.info("getContactListByAccountList DB 查到的联系人:"+n.length),n.forEach(function(e){u[e.account]=e}),n.length===s.length)r.resolve(o(e,u));else{T.info("getContactListByAccountList 查询服务器");a(s,n).splitByNum(20).forEach(function(e){p.push(coreContact.queryUserListFromEaddr(e))}),m.default.all(p).then(function(n){var a=[];n.forEach(function(e){0===e.result&&e.entry.forEach(function(e){e.result_code===constant.EADDR_CONTACT_RESULT_CODE.SUCCESS&&(a.push(e),u[e.account]=e)})}),t&&(T.info("getContactListByAccountList 保存服务器查到的联系人:"+a.length),coreContact.saveContactInfoList(a)),r.resolve(o(e,u))})}})}return r}catch(e){return T.error("getContactListByAccountList",{error:e.toJSON()}),m.default.resolve([])}},t.toggleContactTypeOpen=function(){var e=(0,k.default)(_.default.mark(function e(t,r){var n,a,o,u;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=$getState(),a=n.contactGroups.contactTypeOpen,o=[].concat((0,C.default)(a)),u=0;case 5:if(!(u<o.length)){e.next=12;break}if(o[u].group!==t){e.next=9;break}return o[u].open=r,e.abrupt("break",12);case 9:u++,e.next=5;break;case 12:return e.next=14,$dispatch(coreUi.updateContactTypeOpen(o));case 14:T.info("切换联系人分组折叠展开"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),T.error("toggleContactTypeOpen",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t,r){return e.apply(this,arguments)}}(),t.hideGroupAddContacts=function(){coreUi.hideModal()},t.getContactDetailInfo=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=!0,n={},a={},!isNullOrEmpty(t.account)){e.next=8;break}n=t,e.next=19;break;case 8:if(!t.account){e.next=16;break}return r=!1,o=t.account,e.next=13,P(o,u,u);case 13:a=e.sent,e.next=19;break;case 16:return e.next=18,coreDb.queryContact({contact_id:t.contact_id});case 18:a=e.sent;case 19:return n=isNullOrEmpty(a)?(0,b.default)({},t,{isNotServerInfo:!0}):(0,b.default)({},a,{isNotServerInfo:!1}),T.info("获取联系人详情页信息"),e.abrupt("return",{userInfo:n,customContact:r});case 24:e.prev=24,e.t0=e.catch(0),T.error("getContactDetailInfo",e.t0);case 27:case"end":return e.stop()}},e,void 0,[[0,24]])}));return function(t){return e.apply(this,arguments)}}()),F=(t.updateSignatureFromEserver=function(){var e=(0,k.default)(_.default.mark(function e(t,r){var n,a;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(T.info("updateSignatureFromEserver"),n=r===$getState().myInfo.account,coreIm.checkEServerOnlineNoToast("updateSignatureFromEserver")){e.next=4;break}return e.abrupt("return",t);case 4:return e.next=6,(0,L.getUserInfo)(r,!0);case 6:return a=e.sent,a&&0===a.result&&(t.signature=a.param.signature,n&&$dispatch(coreUi.updateMyInfo(t))),e.abrupt("return",t);case 9:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}(),t.updateSignatureByRecent=function(){var e=(0,k.default)(_.default.mark(function e(t){var r;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNullOrEmpty(t.contact)&&!isNullOrEmpty(t.contact.account)){e.next=3;break}return T.info("is not contact chat, do not query signature"),e.abrupt("return");case 3:if(T.info("updateSignatureByRecent"),coreIm.checkEServerOnlineNoToast("updateSignatureByRecent")){e.next=6;break}return e.abrupt("return");case 6:if(!window.CLIENTCONFIG.ISMOBILE){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,(0,L.getUserInfo)(t.contact.account,!0);case 10:r=e.sent,r&&0===r.result&&(t.contact.signature=r.param.signature,$dispatch(coreUi.selectRecentItem(t)));case 12:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.clickContact=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.contact_id,e.next=4,R(t);case 4:n=e.sent,a=n.userInfo,o=n.customContact,T.info("点击联系人item"),$dispatch(coreUi.updateContactDetail(a,o,r)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),T.error("clickContact",e.t0);case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(t){return e.apply(this,arguments)}}(),t.createContactConversation=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,coreIm.createOrUpdateRecent({contact:t},null,n,a);case 3:return r=e.sent,T.info("创建联系人会话"),e.abrupt("return",r);case 8:e.prev=8,e.t0=e.catch(0),T.error("createContactConversation",e.t0);case 11:case"end":return e.stop()}},e,void 0,[[0,8]])}));return function(t){return e.apply(this,arguments)}}()),$=t.openContactConversation=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=$getState(),n=r.myInfo.account,a=t.account,window.CLIENTCONFIG.USE_IM){e.next=6;break}return e.abrupt("return");case 6:if(!a){e.next=15;break}if(window.CLIENTCONFIG.ISMOBILE){e.next=10;break}return e.next=10,coreCommon.switchNav("recent");case 10:return e.next=12,F(t);case 12:return o=e.sent,isNullOrEmpty(o)?T.error("openContactConversation recent is invalid:",o):(coreIm.openRecentConversation(o),T.info("openContactConversation")),e.abrupt("return",o);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),T.error("openContactConversation error:",e.t0);case 20:case"end":return e.stop()}},e,void 0,[[0,17]])}));return function(t){return e.apply(this,arguments)}}(),B=(t.openContactConversationByConf=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=t.account)){e.next=16;break}if(n=$getState().myInfo.account,r===n){e.next=14;break}return e.next=7,F(t);case 7:if(!(a=e.sent)){e.next=14;break}if(window.CLIENTCONFIG.ISMOBILE){e.next=12;break}return e.next=12,coreCommon.switchNav("recent");case 12:coreIm.toggleRecent(a,o),T.info("openContactConversationByConf 会议中打开联系人会话");case 14:e.next=17;break;case 16:T.info("account is null");case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),T.error("openContactConversationByConf",e.t0);case 22:case"end":return e.stop()}},e,void 0,[[0,19]])}));return function(t){return e.apply(this,arguments)}}(),t.toggleRemoveFromAll=function(){var e=(0,k.default)(_.default.mark(function e(t){return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$dispatch(coreUi.updateRemoveFromAll(t));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.reloadContactListData=function(){var e=(0,k.default)(_.default.mark(function e(){var t,r,n,a,o,u,c,i,s,p;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.default.all([coreDb.queryAllContact(),coreDb.queryAllContactGroupList(),coreDb.queryAllContactMemberGroupList()]);case 3:if(t=e.sent,r=(0,f.default)(t,3),n=r[0],a=r[1],o=r[2],u=n.length>0,c={hasContact:u,contactUserList:n,contactGroup:a,contactMemberGroup:o},T.info("reloadContactListData","success"),$dispatch(coreUi.updateContactListData(c)),!window.CLIENTCONFIG.ISMOBILE){e.next=19;break}return e.next=15,(0,N.sortMUserList)(c.contactUserList);case 15:i=e.sent,s=i.mList,p=i.enList,$dispatch(coreUi.updateMobileContactList(s,p));case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),T.error("reloadContactListData",e.t0);case 24:case"end":return e.stop()}},e,void 0,[[0,21]])}));return function(){return e.apply(this,arguments)}}()),q=t.checkIsFriendByQuery=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,T.info("checkIsFriendByQuery 查找联系人分组对应表"),e.next=4,coreDb.queryAllContactMemberGroupList();case 4:r=e.sent,n=!1,a=0;case 7:if(!(a<r.length)){e.next=15;break}if(o=r[a],o.contact_id!==t){e.next=12;break}return n=!0,e.abrupt("break",15);case 12:a++,e.next=7;break;case 15:return e.abrupt("return",n);case 18:return e.prev=18,e.t0=e.catch(0),T.error("checkIsFriendByQuery",e.t0),e.abrupt("return",!1);case 22:case"end":return e.stop()}},e,void 0,[[0,18]])}));return function(t){return e.apply(this,arguments)}}(),H=t.deleteContactLogic=function(){var e=(0,k.default)(_.default.mark(function e(t,r){var n,a,o,u,c;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,E.deleteContactService)(t,r);case 3:if(n=e.sent){e.next=28;break}return e.next=7,coreDb.deleteContactMemberGroup({contact_id:t,group_id:r});case 7:return e.next=9,q(t);case 9:if(a=e.sent){e.next=28;break}return e.next=13,coreDb.queryContact({contact_id:t});case 13:return o=e.sent,u=o.account,o.contact_id="",e.next=18,coreContact.deleteContactFromDB(o);case 18:return e.next=20,coreIm.getLocalRecent({owner:u});case 20:if(c=e.sent,!c.id){e.next=28;break}return c.contact.contact_id="",e.next=25,coreDb.saveRecent(c);case 25:return c=e.sent,e.next=28,$dispatch(coreUi.updateRecent(c));case 28:T.info("删除单个分组里联系人逻辑"),e.next=34;break;case 31:e.prev=31,e.t0=e.catch(0),T.error("deleteContactLogic",e.t0);case 34:case"end":return e.stop()}},e,void 0,[[0,31]])}));return function(t,r){return e.apply(this,arguments)}}(),j=(t.deleteContact=function(){var e=(0,k.default)(_.default.mark(function e(t,r){var n,a;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H(t,r);case 3:return e.next=5,B();case 5:n=$getState(),a=n.contactGroups.contactInfo.contact_id,t===a&&($dispatch(coreUi.updateSelectedItemKey(-1)),$dispatch(coreUi.updateContactGroupDetailShow("noContent"))),T.info("删除单个分组里联系人"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),T.error("deleteContact",e.t0);case 14:case"end":return e.stop()}},e,void 0,[[0,11]])}));return function(t,r){return e.apply(this,arguments)}}(),t.deleteContactFromAll=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u,c,i,s,p,d;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=$getState(),n=r.contactGroups.contactMemberGroup,a=[].concat((0,C.default)(n)),o=1,u=null,c=0;case 7:if(!(c<a.length)){e.next=22;break}if(t!==a[c].contact_id){e.next=19;break}return u=a[c].group_id,e.next=12,(0,E.deleteContactService)(t,u);case 12:if(!(o=e.sent)){e.next=17;break}return e.abrupt("break",22);case 17:return e.next=19,coreDb.deleteContactMemberGroup({contact_id:t,group_id:u});case 19:c++,e.next=7;break;case 22:if(o){e.next=43;break}return e.next=25,coreDb.queryContact({contact_id:t});case 25:return i=e.sent,s=i.account,i.contact_id="",e.next=30,coreContact.deleteContactFromDB(i);case 30:return e.next=32,coreIm.getLocalRecent({owner:s});case 32:if(p=e.sent,isNullOrEmpty(p)){e.next=40;break}return p.contact.contact_id="",e.next=37,coreDb.saveRecent(p);case 37:return p=e.sent,e.next=40,$dispatch(coreUi.updateRecent(p));case 40:return e.next=42,B();case 42:window.CLIENTCONFIG.ISMOBILE?$dispatch(coreUi.updateMobileContactDetail(i,!1)):(d=r.contactGroups.contactInfo.contact_id,t===d&&($dispatch(coreUi.updateSelectedItemKey(-1)),$dispatch(coreUi.updateContactGroupDetailShow("noContent"))));case 43:T.info("将联系人从全部分组中删除"),e.next=49;break;case 46:e.prev=46,e.t0=e.catch(0),T.error("deleteContactFromAll",e.t0);case 49:case"end":return e.stop()}},e,void 0,[[0,46]])}));return function(t){return e.apply(this,arguments)}}(),t.deleteContactSubmenu=function(){var e=(0,k.default)(_.default.mark(function e(t,r){var n,a;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,coreIm.checkEserverOnline("deleteContactSubmenu")){e.next=4;break}return T.info("deleteContactSubmenu failed due to offline!"),e.abrupt("return");case 4:if(!(r.length>0)){e.next=13;break}n=0;case 6:if(!(n<r.length)){e.next=13;break}return a=r[n].contact_id,e.next=10,H(a,t);case 10:n++,e.next=6;break;case 13:return e.next=15,(0,E.deleteContactGroupService)(t);case 15:return e.next=17,coreDb.deleteContactGroup({group_id:t});case 17:return e.next=19,B();case 19:T.info("deleteContactSubmenu"),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),T.error("deleteContactSubmenu",e.t0);case 25:case"end":return e.stop()}},e,void 0,[[0,22]])}));return function(t,r){return e.apply(this,arguments)}}(),t.queryContactMemerGroupByOpts=function(){var e=(0,k.default)(_.default.mark(function e(t,r){var n,a;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=0;case 2:if(!(n<t.length)){e.next=9;break}if(a=t[n],a.contact_id!==r.contact_id||a.group_id!==r.group_id){e.next=6;break}return e.abrupt("return",a);case 6:n++,e.next=2;break;case 9:T.info("queryContactMemerGroupByOpts","success"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),T.error("queryContactMemerGroupByOpts",e.t0);case 15:case"end":return e.stop()}},e,void 0,[[0,12]])}));return function(t,r){return e.apply(this,arguments)}}()),W=(t.moveToOtherGroup=function(){var e=(0,k.default)(_.default.mark(function e(t,r,n,a,o){var u,c,i,s,p,d,f,l;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u={contact_id:t,old_group_id:r,new_group_id:n,type:a,uuid:o},e.next=4,(0,E.removeContactToGroupService)(u);case 4:if(c=e.sent,T.info("move friend to other group, result : ",c&&c.result),!(i=0===c.result)){e.next=29;break}if(0!==a){e.next=22;break}return s=$getState(),p=s.contactGroups.contactMemberGroup,e.next=13,j(p,{contact_id:t,group_id:r});case 13:return d=e.sent,d.group_id=n,f=(0,b.default)({},d),e.next=18,coreDb.deleteContactMemberGroup({contact_id:t,group_id:r});case 18:return e.next=20,coreDb.bulkPutContactMemberGroup([f]);case 20:e.next=26;break;case 22:if(1!==a){e.next=26;break}return l={contact_id:t,group_id:n,state:48},e.next=26,coreDb.bulkPutContactMemberGroup([l]);case 26:return e.next=28,B();case 28:return e.abrupt("return",i);case 29:T.info("移动/复制到分组"),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(0),T.error("moveToOtherGroup",e.t0);case 35:case"end":return e.stop()}},e,void 0,[[0,32]])}));return function(t,r,n,a,o){return e.apply(this,arguments)}}(),t.createContactGroup=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u,c,i,s,p;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=$getState(),n=r.common.inputValue,a=n.replace(/\s+/g,""),o=0===a.length?"New Group":n,u=W(o),e.next=8,(0,E.addContactGroupService)(u,t);case 8:if(c=e.sent,c.result){e.next=19;break}return i={group_id:c.param.id,index:-1,name:u,state:0},e.next=13,coreDb.bulkPutContactGroup([i]);case 13:return s=r.contactGroups.contactTypeOpen,p=[].concat((0,C.default)(s)),p.push({group:c.param.id,open:!0}),$dispatch(coreUi.updateContactTypeOpen(p)),e.next=19,B();case 19:return T.info("createContactGroup"),e.abrupt("return",c);case 23:e.prev=23,e.t0=e.catch(0),T.error("createContactGroup",e.t0);case 26:case"end":return e.stop()}},e,void 0,[[0,23]])}));return function(t){return e.apply(this,arguments)}}(),t.createNewContactGroup=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u,c,i,s,p;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=$getState(),n=r.contactGroups.addNewName,a=n.replace(/\s+/g,""),!window.CLIENTCONFIG.USE_IM||0!==a.length){e.next=6;break}return e.abrupt("return");case 6:return o=0===a.length?"New Group":n,u=W(o),e.next=10,(0,E.addContactGroupService)(u,t);case 10:if(c=e.sent,c.result){e.next=21;break}return i={group_id:c.param.id,index:-1,name:u,state:0},e.next=15,coreDb.bulkPutContactGroup([i]);case 15:return s=r.contactGroups.contactTypeOpen,p=[].concat((0,C.default)(s)),p.push({group:c.param.id,open:!0}),$dispatch(coreUi.updateContactTypeOpen(p)),e.next=21,B();case 21:return T.info("createNewContactGroup"),e.abrupt("return",c);case 25:e.prev=25,e.t0=e.catch(0),T.error("createNewContactGroup",e.t0);case 28:case"end":return e.stop()}},e,void 0,[[0,25]])}));return function(t){return e.apply(this,arguments)}}(),t.setAddNewContactValueLogic=function(e){try{$dispatch(coreUi.setAddNewContactValue(e))}catch(e){T.error("setAddNewContactValue",e)}},t.checkContactGroupName=function(e){try{T.info("checkContactGroupName");var t=u(e),r=[];$getState().contactGroups.contactGroup.map(function(e){r.push(e.name)});if(-1===r.findIndex(function(e){return e===t}))return t;var n=t.length,a=[];r.map(function(e){var r=e.length;if(r>n){var o=e.substr(0,n),u=e.substr(n+1,1),c=e.substr(r-1,1),i=parseInt(e.substr(n+2,r-n-3));o===t&&i&&"number"==typeof i&&"["===u&&"]"===c&&a.push(i)}});for(var o=0===a.length?0:Math.max.apply(Math,a),c=1;c<o+2;c++){var i=function(e){if(-1===a.findIndex(function(t){return t===e}))return{v:t+" ["+e+"]"}}(c);if("object"===(void 0===i?"undefined":(0,p.default)(i)))return i.v}}catch(e){T.error("checkContactGroupName",e)}}),K=(t.addContact=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u,c,i,s,p,d,f,l,v,h,m,g,b,x;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=$getState(),n=parseInt(window.CLIENTCONFIG["Device.ComCfg.IM.MaxContact"]),!((a=r.contactGroups.contactUserList?r.contactGroups.contactUserList.length:0)>=n)){e.next=7;break}return alert(language.ADD_TO_MAX),e.abrupt("return");case 7:if(o=t.account,u=t.groupId,c=t.displayName,i={account:o,group_id:u,display_name:void 0===c?"":c},s=void 0,window.CLIENTCONFIG.USE_IM||-3===u){e.next=14;break}s={result:0,param:{contact_id:parseInt((new Date).getTime().toString().substring(5))}},e.next=17;break;case 14:return e.next=16,(0,E.addContactService)(i);case 16:s=e.sent;case 17:if(p=s.param.contact_id,s.result){e.next=49;break}return e.next=21,P(o);case 21:return d=e.sent,d.contact_id=p,e.next=25,(0,L.deleteContactPreSave)(o);case 25:return e.next=27,coreContact.saveContactInfo(d);case 27:return d=e.sent,f={contact_id:p,group_id:u,state:48},e.next=31,coreDb.bulkPutContactMemberGroup([f]);case 31:return e.next=33,B();case 33:return e.next=35,coreIm.getLocalRecent({owner:o});case 35:if(l=e.sent,v=r.contactGroups,h=v.detailContent,m=v.contactInfo,g=v.sliderDetailShow,b=v.sliderContent,x=v.sliderContactInfo,!g||"Contact"!==b||x.account!==o){e.next=40;break}return e.next=40,$dispatch(coreUi.updateSliderContactDetail(d,!1));case 40:if("contact"!==h||m.account!==d.account&&m.contact_id!==d.contact_id||$dispatch(coreUi.updateContactDetail(d,!1)),window.CLIENTCONFIG.ISMOBILE&&$dispatch(coreUi.updateMobileContactDetail(d,!1)),!l.id){e.next=49;break}return l.contact.contact_id=p,e.next=46,coreDb.saveRecent(l);case 46:return l=e.sent,e.next=49,$dispatch(coreUi.updateRecent(l));case 49:return T.info("addContact"),e.abrupt("return",s.result);case 53:e.prev=53,e.t0=e.catch(0),T.error("addContact",e.t0);case 56:case"end":return e.stop()}},e,void 0,[[0,53]])}));return function(t){return e.apply(this,arguments)}}(),t.queryContactGroupByOpts=function(){var e=(0,k.default)(_.default.mark(function e(t,r){var n,a;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.length)){e.next=8;break}if(a=t[n],a.group_id!==r.group_id){e.next=5;break}return e.abrupt("return",a);case 5:n++,e.next=1;break;case 8:case"end":return e.stop()}},e,void 0)}));return function(t,r){return e.apply(this,arguments)}}()),V=t.changeContactGroupName=function(){var e=(0,k.default)(_.default.mark(function e(t,r,n){var a,o,u,c,i,s;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=W(r),e.next=4,(0,E.modifyContactGroupName)(t,a,n);case 4:if(o=e.sent,0!==(u=o.result)){e.next=19;break}return c=$getState(),i=c.contactGroups.contactGroup,e.next=11,K(i,{group_id:t});case 11:return s=e.sent,s.name=a,e.next=15,coreDb.deleteContactGroup({group_id:t});case 15:return e.next=17,coreDb.bulkPutContactGroup([s]);case 17:return e.next=19,B();case 19:T.info("changeContactGroupName"),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),T.error("changeContactGroupName",e.t0);case 25:case"end":return e.stop()}},e,void 0,[[0,22]])}));return function(t,r,n){return e.apply(this,arguments)}}(),J=(t.selectAddContactList=function(){var e=(0,k.default)(_.default.mark(function e(t){return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{T.info("selectAddContactList"),$dispatch(coreUi.updateSelectedContactGroupId(t))}catch(e){T.error("selectAddContactList",e)}case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.createConversationLogic=function(){if(!coreIm.checkEserverOnline("createConversationLogic"))return void T.info("createConversationLogic  Offline not allow");var e=$getState(),t=e.recent.currentRecentInfo;return J(t.contact)},t.createConversation=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,$dispatch(coreUi.setCreateLoading()),r=$getState(),n=void 0,n=r.selectBox.selectBox_tempSelectedList,a=r.myInfo,isNullOrEmpty(t)){e.next=20;break}if(1!==n.length){e.next=20;break}if(n[0].account!==t.account){e.next=15;break}return window.alert(language.CONTACT_ALREADY_EXISTS),e.next=12,$dispatch(coreUi.setCreateNotLoading());case 12:return e.abrupt("return");case 15:if(n[0].account!==a.account){e.next=20;break}return window.alert(language.CAN_NOT_ADD_OWN_ACCOUNT),e.next=19,$dispatch(coreUi.setCreateNotLoading());case 19:return e.abrupt("return");case 20:return o=n.findIndex(function(e){return e.account===a.account}),-1!==o&&n.splice(o,1),t&&t.account!==a.account&&n.unshift(t),e.next=25,Y(z(n));case 25:return u=e.sent,e.next=28,$dispatch(coreUi.setCreateNotLoading());case 28:if(!1!==u){e.next=30;break}return e.abrupt("return");case 30:coreUi.hideModal(),T.info("createConversationLogic","success"),e.next=37;break;case 34:e.prev=34,e.t0=e.catch(0),T.error("createConversationLogic",e.t0);case 37:case"end":return e.stop()}},e,void 0,[[0,34]])}));return function(t){return e.apply(this,arguments)}}()),z=function(e){for(var t=[],r=0,n=e.length;r<n;r++){for(var a=r+1;a<n;a++)e[r].account===e[a].account&&(a=++r);t.push(e[r])}return t},Y=t.createContactOrGroupConversation=function(){var e=(0,k.default)(_.default.mark(function e(t){var r;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(coreIm.checkEserverOnline("createContactOrGroupConversation")){e.next=3;break}return T.info("createContactOrGroupConversation Offline not allow"),e.abrupt("return");case 3:if(0!==t.length){e.next=5;break}return e.abrupt("return");case 5:if(1!==t.length){e.next=9;break}return e.next=8,$(t[0]);case 8:return e.abrupt("return",e.sent);case 9:return e.next=11,coreGroup.createDiscussionGroup(t);case 11:if(!((r=e.sent)instanceof Object)){e.next=17;break}return e.next=15,coreIm.openGroupConversation({group_id:r.group_id});case 15:e.next=31;break;case 17:e.t0=r,e.next=1===e.t0?20:32===e.t0?22:35===e.t0?24:29;break;case 20:return window.alert(language.CREAT_FAIL),e.abrupt("break",31);case 22:return window.alert(language.CREATE_GROUP_MAXNUM),e.abrupt("break",31);case 24:return e.next=26,$dispatch(coreUi.setCreateNotLoading());case 26:return coreUi.hideModal(),window.alert(language.CREATE_DISCUSS_MAXNUM),e.abrupt("break",31);case 29:return T.info("createContactOrGroupConversation fail"),e.abrupt("break",31);case 31:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),X=(t.checkIsFriendByAccount=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,T.info("checkIsFriendByAccount"),r=!1,e.next=5,coreDb.queryContact({account:t});case 5:return n=e.sent,n.contact_id&&(r=!0),e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),T.error("checkIsFriendByAccount",e.t0);case 13:case"end":return e.stop()}},e,void 0,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),t.dealUserInfoChange=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u,c,i;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.param){e.next=11;break}if(r=$getState(),n=r.myInfo.account,a=t.param.user_list,o=[],!a||!a.length){e.next=11;break}for(u=0;u<a.length;u++)c=a[u],o.push({id:c.account}),i=c.account,n===i&&coreUi.getContactAvatar(i);return e.next=10,X(o);case 10:T.info("dealUserInfoChange","success");case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),T.error("dealUserInfoChange",e.t0);case 16:case"end":return e.stop()}},e,void 0,[[0,13]])}));return function(t){return e.apply(this,arguments)}}(),t.dealUserInfoOprNotify=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u,c;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,T.info("userInfoOprNotify logic in data = ",(0,i.default)(t.param)),r=t.param.msg_list,n=[],a=[],o=[],u=[],c=0;c<r.length;c++)0===r[c].info_type?2===r[c].opr_type?(T.info("userInfoOprNotify user base info delete logic in"),a.push({id:r[c].user_id,updateTime:r[c].time_stamp})):n.push({id:r[c].user_id,updateTime:r[c].time_stamp}):2===r[c].opr_type?(T.info("userInfoOprNotify user avatar delete logic in"),u.push({id:r[c].user_id,updateTime:r[c].time_stamp})):o.push(r[c].user_id);if(!(n.length>0)){e.next=11;break}return e.next=11,X(n);case 11:if(!(o.length>0)){e.next=14;break}return e.next=14,coreUi.getContactListAvatar(o);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),T.error("userInfoOprNotify",e.t0);case 19:case"end":return e.stop()}},e,void 0,[[0,16]])}));return function(t){return e.apply(this,arguments)}}(),t.getUserDetail=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u,c,i,s;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=$getState(),T.debug("result dealuserInfoOpr userDetailAccountList",t),e.next=4,coreContact.syncUserDetails(t);case 4:if(n=e.sent,T.debug("result dealuserInfoOpr",n),!isNullOrEmpty(n)){e.next=8;break}return e.abrupt("return");case 8:a=0;case 9:if(!(a<n.length)){e.next=32;break}if(o=n[a],0!==o.statusCode){e.next=26;break}return u=o.account,o.dept_name=o.deptName,delete o.deptName,o.bind_no=o.number,delete o.number,e.next=19,coreDb.queryContact({account:u});case 19:return c=e.sent,i=(0,b.default)({},c,o),e.next=23,coreContact.saveContactInfo(i);case 23:return s=e.sent,e.next=26,Q(s,r);case 26:return e.next=28,B();case 28:T.info("userInfoOprNotify","success");case 29:a++,e.next=9;break;case 32:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),Q=(t.loadMyContactInfoAndAvatar=function(){var e=(0,k.default)(_.default.mark(function e(){var t,r,n;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(window.CLIENTCONFIG.ENABLE_IT_MEETING||window.CLIENTCONFIG.IS_LINK_IT_SMC_MEETING||window.CLIENTCONFIG.ISBIGWIN)){e.next=3;break}return T.info("IT Meeting plugin or big win, return"),e.abrupt("return");case 3:if(!coreAccount.getLoginModel().isSupportAS){e.next=14;break}return e.next=6,coreDb.queryRecentList({all:""});case 6:for(t=e.sent,r=[],n=0;n<t.length;n++)0!==t[n].chat_type||isNullOrEmpty(t[n].account)||r.push({id:t[n].account});return r=r.slice(0,50),e.next=12,X(r);case 12:return e.next=14,coreUi.getContactListAvatar(r);case 14:case"end":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}(),t.reLoadContactInfo=function(){var e=(0,k.default)(_.default.mark(function e(t,r){var n,a,o,u,c,i,s,p,d,f,l;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=!0,t.account&&(n=!1),a=r.contactGroups,o=a.detailContent,u=a.contactInfo,c=a.sliderDetailShow,i=a.sliderContent,s=a.sliderContactInfo,p=a.mContactDetailShow,d=a.mContactInfo,!c||"Contact"!==i||s.account!==t.account&&s.contact_id!==t.contact_id||$dispatch(coreUi.updateSliderContactDetail(t,n)),"contact"!==o||u.account!==t.account&&u.contact_id!==t.contact_id||$dispatch(coreUi.updateContactDetail(t,n)),window.CLIENTCONFIG.ISMOBILE&&(!p||d.contact_id!==t.contact_id&&d.account!==t.account||$dispatch(coreUi.updateMobileContactDetail(t,n))),n){e.next=20;break}return f=t.account,e.next=11,coreIm.getLocalRecent({owner:f});case 11:if(l=e.sent,!l.id){e.next=20;break}return l.contact=t,e.next=16,coreDb.saveRecent(l);case 16:if(l=e.sent,l.is_delete!==constant.IS_DELETE.NO){e.next=20;break}return e.next=20,$dispatch(coreUi.updateRecent(l));case 20:T.info("reLoadContactInfo","success"),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(0),T.error("reLoadContactInfo",e.t0);case 26:case"end":return e.stop()}},e,void 0,[[0,23]])}));return function(t,r){return e.apply(this,arguments)}}());t.setContactGroupNameLogic=function(e){$dispatch(coreUi.setContactGroupName(e))},t.initContactGroupNameLogic=function(){$dispatch(coreUi.initContactGroupName())},t.testGroupName=function(e){try{T.info("testGroupName");var t=$getState(),r=t.contactGroups.contactGroupName.trim(),n=t.contactGroups.contactGroup,a=0;return n.map(function(t){t.name===r&&t.group_id!==e&&a++}),0===a}catch(e){T.error("testGroupName",e)}},t.changeGroupName=function(e,t,r){try{T.info("changeGroupName:"),V(e,t,r)}catch(e){T.error("changeGroupName:",e)}},t.autoCreateGroupName=function(e){var t=$getState().contactGroups.contactGroup,r=e.length,n=[];t.map(function(t){var a=t.name.length;if(a>r){var o=t.name.substr(0,r),u=t.name.substr(r+1,1),c=t.name.substr(a-1,1),i=parseInt(t.name.substr(r+2,a-r-3));o===e&&i&&"number"==typeof i&&"["===u&&"]"===c&&n.push(i)}});for(var a=0===n.length?0:Math.max.apply(Math,n),o=1;o<a+2;o++){var u=function(t){if(-1===n.findIndex(function(e){return e===t}))return{v:e+" ["+t+"]"}}(o);if("object"===(void 0===u?"undefined":(0,p.default)(u)))return u.v}},t.addContactToGroups=function(){var e=(0,k.default)(_.default.mark(function e(t){var r,n,a,o,u,c,i,s,p,d,f,l,v,h,m,g,b,x,C,y,w,k;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=$getState(),n=void 0,a=parseInt(window.CLIENTCONFIG["Device.ComCfg.IM.MaxContact"]),!((o=r.contactGroups.contactUserList?r.contactGroups.contactUserList.length:0)>=a)){e.next=7;break}return alert(language.ADD_TO_MAX),e.abrupt("return");case 7:u=t.account,c=t.groupList,i=!0,s=void 0,p=0;case 11:if(!(p<c.length)){e.next=37;break}return d=c[p],f=d.group_id,l={account:u,group_id:f,display_name:""},e.next=17,(0,E.addContactService)(l);case 17:if(v=e.sent,s=v.param.contact_id,v.result){e.next=32;break}return e.next=22,P(u);case 22:return n=e.sent,n.contact_id=s,e.next=26,coreContact.saveContactInfo(n);case 26:return n=e.sent,h={contact_id:s,group_id:f,state:48},e.next=30,coreDb.bulkPutContactMemberGroup([h]);case 30:e.next=34;break;case 32:return i=!1,e.abrupt("break",37);case 34:p++,e.next=11;break;case 37:if(!i){e.next=60;break}return e.next=40,B();case 40:return e.next=42,coreIm.getLocalRecent({owner:u});case 42:if(m=e.sent,g=r.contactGroups,b=g.detailContent,x=g.contactInfo,C=g.sliderDetailShow,y=g.sliderContent,w=g.sliderContactInfo,!C||"Contact"!==y||w.account!==u){e.next=47;break}return e.next=47,$dispatch(coreUi.updateSliderContactDetail(n,!1));case 47:if("contact"!==b||x.account!==n.account&&x.contact_id!==s||$dispatch(coreUi.updateContactDetail(n,!1)),!window.CLIENTCONFIG.ISMOBILE){e.next=53;break}return $dispatch(coreUi.updateMobileContactDetail(n,!1)),k={account:u,contact_id:s},e.next=53,(0,N.tapContact)(k);case 53:if(isNullOrEmpty(m)){e.next=60;break}return m.contact.contact_id=s,e.next=57,coreDb.saveRecent(m);case 57:return m=e.sent,e.next=60,$dispatch(coreUi.updateRecent(m));case 60:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()},994:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.sortMUserListSync=t.sortMUserList=t.tapContact=void 0;var a=r(134),o=n(a),u=r(124),c=n(u),i=r(1),s=n(i),p=r(2),d=n(p),f=r(959),l=(t.tapContact=function(){var e=(0,d.default)(s.default.mark(function e(t){var r,n,a,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=$getState(),n=r.myInfo.account,a=n===t.account,a?window.goRoute("myAccountInfo"):(window.goRoute("contactBasics"),setTimeout(function(){return l(t,o)},10));case 4:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,d.default)(s.default.mark(function e(t){var r,n,a,o,u,i,p,d,l,v,h;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&$dispatch(coreUi.updateMobileContactDetail(t,isNullOrEmpty(t.account))),!t.contact_id||!isNullOrEmpty(t.account)){e.next=3;break}return e.abrupt("return");case 3:return r=[],n="",e.next=7,(0,f.getContactDetailInfo)(t);case 7:return a=e.sent,o=a.userInfo,u=a.customContact,e.next=12,(0,f.updateSignatureFromEserver)(o,t.account);case 12:if(o=e.sent,isNullOrEmpty(o))o=t;else if(o.contact_id){for(i=$getState(),p=i.contactGroups.contactMemberGroup,d=i.contactGroups.contactGroup,l=0;l<p.length;l++)if(p[l].contact_id===o.contact_id)for(v=0;v<d.length;v++)d[v].group_id===p[l].group_id&&r.push(d[v].name);n=r.join(",")}if(h=$getState().contactGroups.contactUserList.query({account:t.account}),$getState().contactGroups.mContactInfo.account===o.account){e.next=17;break}return e.abrupt("return");case 17:$dispatch(coreUi.updateMContactDetailGroup(n)),$dispatch(coreUi.updateMobileContactDetail((0,c.default)({},h,o),u));case 19:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}()),v=(t.sortMUserList=function(){var e=(0,d.default)(s.default.mark(function e(t){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v(t));case 1:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}(),t.sortMUserListSync=function(e){var t=e.sort(function(){return function(e,t){var r=window.pinyinUtil.getPinyin(e.name),n=window.pinyinUtil.getPinyin(t.name);return r.localeCompare(n)}}()),r=[],n=[],a=[],u=1,c=!1;t.forEach(function(e){var t=window.pinyinUtil.getPinyin(e.name.trim()),o=t.charAt(0).toUpperCase();if(/[a-zA-Z]/.test(o))r.includes(o)||(r.push(o),n.push({type:"charTitle",char:o,char_index:u++})),n.push({type:"charItem",item:e,itemKey:e.contact_id});else{if(c=!0,""===o){var i=getContactName(e);e.q_pin_yin=i}a.push({type:"charItem",item:e,itemKey:e.contact_id})}});var i=[];return c&&(r.push("#"),i=a.sort(function(){return function(e,t){var r=e.item.name,n=t.item.name;return r.localeCompare(n)}}()),i.unshift({type:"charTitle",char:"#",char_index:27})),n.push.apply(n,(0,o.default)(i)),{mList:n,enList:r}})}});